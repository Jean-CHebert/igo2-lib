function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(i,e)})(e)}function _construct(e,t,i){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,i){var o=[null];o.push.apply(o,t);var n=new(Function.bind.apply(e,o));return i&&_setPrototypeOf(n,i.prototype),n}).apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _get(e,t,i){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var o=_superPropBase(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(i):n.value}})(e,t,i||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var i,o=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,n)}else i=o.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var i=[],o=!0,n=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(c){n=!0,r=c}finally{try{o||null==s.return||s.return()}finally{if(n)throw r}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw r}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"/2bg":function(e){e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Rester anonyme","connection":"Connexion","login":"Connecter","password":"Mot de passe","signOut":"Se d\xe9connecter","user":"Utilisateur","welcome":"Bienvenue {{name}}!","deconnection":"Vous \xeates d\xe9connect\xe9","home":"Retourner \xe0 la page d\'accueil","error":{"Password expired":"Votre mot de passe est expir\xe9","Maximun logins exceeded":"Nombre maximal de connexions d\xe9pass\xe9","Login lockout":"Nombre maximal d\'essai d\xe9pass\xe9. Votre compte est verrouill\xe9.","Wrong password":"Mot de passe incorrect","Invalid username":"Utilisateur invalide"},"google":{"login":"Se connecter avec Google","logged":"Connect\xe9 avec Google"},"microsoft":{"login":"Se connecter avec Microsoft"}},"common":{"confirmDialog":{"cancelBtn":"Annuler","confirmBtn":"Confirmer","title":"Confirmation"},"table":{"filter":"Filtre"},"form":{"errors":{"required":"Ce champ est requis"}},"actionbar":{"scrollUp":"D\xe9filer vers le haut","scrollDown":"D\xe9filer vers le bas"},"interactiveTour":{"tooltipTourToolButton":"Aide interactive sur l\'outil","disaledTooltipTourToolButton":"Pour avoir acc\xe8s au tour interactif de cet outil, ajouter des contextes ou des couches","buttonTitle":"D\xe9couvrir","exitButton":"Quitter","backButton":"Pr\xe9c\xe9dent","nextButton":"Suivant"},"paginator":{"firstPageLabel":"Premi\xe8re page","itemsPerPageLabel":"Items par page:","lastPageLabel":"Derni\xe8re page","nextPageLabel":"Page suivante","previousPageLabel":"Page pr\xe9c\xe9dente","of":"de"}},"context":{"bookmarkButton":{"create":"Cr\xe9er un contexte","dialog":{"createMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9","createTitle":"Contexte cr\xe9\xe9","placeholder":"Titre","title":"Nouveau contexte"}},"contextManager":{"clone":"Cloner ce contexte","delete":"Supprimer ce contexte","dialog":{"cloneMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 clon\xe9","cloneTitle":"Contexte clon\xe9","copyMsg":"Texte copi\xe9","copyTitle":"Identifiant du contexte","confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer ce contexte ?","deleteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 supprim\xe9","deleteTitle":"Contexte supprim\xe9","favoriteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 d\xe9fini comme favori","favoriteTitle":"Favori enregistr\xe9","saveMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 enregistr\xe9","saveTitle":"Contexte enregistr\xe9"},"edit":"\xc9diter ce contexte","errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur de serveur"},"addPermission":"La permission que vous tentez d\'ajouter est d\xe9j\xe0 pr\xe9sente dans le contexte.","addPermissionEmpty":"La permission que vous tentez d\'ajouter n\'est pas valide","addPermissionTitle":"Erreur d\'ajout de permission"},"favorite":"D\xe9finir comme context favori","form":{"copy":"Copier l\'identifiant du contexte","edit":"Enregistrer","title":"Titre","titleRequired":"Le titre est obligatoire","uri":"Identifiant","uriRequired":"L\'identifiant est obligatoire"},"invalid":{"text":"Le contexte \\"{{value}}\\" est invalide. Le contexte par d\xe9faut a \xe9t\xe9 charg\xe9.","title":"Contexte invalide"},"managePermissions":"G\xe9rer les permissions du contexte","manageTools":"G\xe9rer les outils du contexte","ourContexts":"Mes contextes","publicContexts":"Contextes publics","save":"Sauvegarder ce contexte","sharedContexts":"Contextes partag\xe9s","filterPlaceHolder":"Filtrer par nom","sortAlphabetically":"Trier en ordre alphab\xe9tique","sortContextOrder":"Replacer selon la date de cr\xe9ation","userAccount":"Profils utilisateurs","filterUser":"Filtrer par groupe d\'utilisateur","emptyContext":"Contexte vide","emptyContextTooltip":"Cr\xe9er un nouveau contexte vide","contextMap":"Contexte \xe0 partir de la carte","contextMapTooltip":"Cr\xe9er un nouveau contexte \xe0 partir des couches la carte","hide":"Masquer ce contexte","show":"Montrer ce contexte","showHidden":"Montrer les contextes masqu\xe9s"},"contextImportExport":{"export":{"exportPlaceHolder":"Couches","exportContextName":"Nom du contexte","exportSelectAll":"Tout s\xe9lectionner","success":{"text":"Contexte export\xe9 avec succ\xe8s.","title":"Exportation r\xe9ussie"},"nothing":{"text":"Impossible d\u2019exporter, contexte non valide ou aucun contexte s\xe9lectionn\xe9.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de contexte rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"}},"import":{"success":{"title":"Contexte import\xe9","text":"Le context \'{{value}}\' a \xe9t\xe9 ajout\xe9 \xe0 la carte"},"empty":{"text":"Le context \'{{value}}\' est vide, impossible d\'importer","title":"Contexte vide"},"invalid":{"text":"Le context \'{{value}}\' est invalide.","title":"Context invalide"},"unreadable":{"text":"Le context \'{{value}}\' est impossible \xe0 lire","title":"Context illisible"},"tooLarge":{"text":"Le context \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Context trop volumineux"}}},"permission":{"addBtn":"Ajouter","delete":"Retirer la permission","dialog":{"addMsg":"La permission \'{{value}}\' a \xe9t\xe9 ajout\xe9e","addTitle":"Permission ajout\xe9e","deleteMsg":"La permission \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Permission retir\xe9e","scopeChangedMsg":"La port\xe9e du contexte a \xe9t\xe9 chang\xe9e pour {{value}}","scopeChangedTitle":"Changement de la port\xe9e"},"profil":"Profil","user":"Utilisateur ou groupe","profilRequired":"Le profil est obligatoire","read":"Lecture seule","readOnlyTitle":"Contexte en lecture seule","readOnlyMsg":"Vous pouvez seulement retirer la permission si le contexte est directement partag\xe9 \xe0 votre nom d\'utilisateur.","scope":{"private":"Priv\xe9","protected":"Prot\xe9g\xe9","shared":"Partag\xe9","public":"Public"},"write":"Lecture et \xe9criture"},"poiButton":{"create":"Cr\xe9er une zone d\'int\xe9r\xeat","dialog":{"confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer cette zone d\'int\xe9r\xeat ?","createMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9e","createTitle":"Zone d\'int\xe9r\xeat cr\xe9\xe9e","deleteMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Zone d\'int\xe9r\xeat supprim\xe9e","placeholder":"Titre","title":"Nouvelle zone d\'int\xe9r\xeat"},"placeholder":"Zones d\'int\xe9r\xeat"},"sidenav":{"goBack":"Revenir","mainMenu":"Revenir au menu principal"},"shareMap":{"button":"Partager la carte","copy":"Copier le lien","dialog":{"copyMsg":"Lien copi\xe9","copyTitle":"Lien"},"placeholderLink":"Lien","included":"Inclus dans le lien de partage :","context":"Le contexte ouvert lors de la cr\xe9ation du lien de partage.","center":"Les coordonn\xe9es du centre de la carte (longitude, latitude).","zoom":"Le niveau de zoom de la carte.","addedLayers":"Les couches ajout\xe9es via le catalogue ou via la barre de recherche.","visibleInvisible":"Le statut de visibilit\xe9 des couches.","excluded":"Exclus dans le lien de partage :","order":"L\'ordre des couches.","opacity":"Les modifications effectu\xe9es \xe0 l\'opacit\xe9 des couches.","filterOgc":"Les ajouts/modifications faits aux filtres par attribut.","filterTime":"La valeur en cours pour les filtres temporels."},"tool":{"dialog":{"addMsg":"L\'outil a \xe9t\xe9 ajout\xe9","addTitle":"Outil ajout\xe9","deleteMsg":"L\'outil a \xe9t\xe9 supprim\xe9","deleteTitle":"Outil retir\xe9"}},"userButton":{"dialog":{"email":"Courriel","expiration":"Expiration","user":"Utilisateur"},"infoTitle":"Info sur l\'utilisateur","logout":"Se d\xe9connecter"}},"core":{"errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur serveur"}},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}}},"geo":{"catalog":{"layer.addToMap":"Ajouter \xe0 la carte","layer.addToMapOutRange":"Ajouter \xe0 la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","layer.removeFromMap":"Retirer de la carte","layer.removeFromMapOutRange":"Retirer de la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","group.addToMap":"Ajouter toutes les couches de ce groupe \xe0 la carte","group.removeFromMap":"Retirer toutes les couches de ce groupe de la carte","baseLayers":"Fonds de carte","unavailableTitle":"Catalogue indisponible","unavailable":"Le catalogue \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises."},"clickOnMap":{"clickedFeature":"Entit\xe9s cliqu\xe9es"},"baselayersSwitcher":{"title":"Fonds de carte"},"dataSource":{"unavailableTitle":"Couche indisponible","optionsApiUnavailable":"L\'information sur les couches n\'a pas pu \xeatre r\xe9cup\xe9r\xe9e. Certaines couches pourraient ne pas pr\xe9senter la bonne information.","unavailable":"La couche \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises."},"dropGeoFile":{"invalid":{"text":"Le fichier \'{{value}}\' est invalide. ({{mimeType}})","title":"Fichier invalide"},"empty":{"text":"Le fichier \'{{value}}\' est vide, impossible d\'importer","title":"Fichier vide"},"success":{"text":"La couche \'{{value}}\' a \xe9t\xe9 ajout\xe9e \xe0 la carte","title":"Fichier import\xe9"},"unreadable":{"text":"Le fichier \'{{value}}\' est impossible \xe0 lire","title":"Fichier illisible"},"tooLarge":{"text":"Le fichier \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Fichier trop volumineux"},"invalidSRS":{"text":"La projection est valide. Elle doit commencer par EPSG:","title":"Projection invalid"}},"export":{"nothing":{"text":"Impossible d\u2019exporter, donn\xe9e non valide ou aucune donn\xe9e s\xe9lectionn\xe9e.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"noFormat":{"text":"Aucun format d\'exportation valide pour toutes les couches s\xe9lectionn\xe9es. Veuillez exporter les couches une \xe0 la fois.","title":"Aucun format disponible"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de donn\xe9e rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"},"popupBlocked":{"text":"</br>Veuillez autoriser l\'ouverture des fen\xeatres (popup) dans votre fureteur. </br>Pour Chrome and Edge, \xe0 droite dans la barre d\'adresse).</br>{{extraMessage}}","selectAgain":"Faites le correctif et s\xe9lectionner \xe0 nouveau un format.","retry":"Veuillez recommencer l\'exportation.","title":"Ouverture de fen\xeatre bloqu\xe9e par votre fureteur"},"success":{"text":"Donn\xe9es export\xe9es avec succ\xe8s.","title":"Exportation r\xe9ussie"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (s\xe9parateur virgule)","CSVsemicolon":"CSV (s\xe9parateur point-virgule)","URL":"URL"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Exporter","exportButtonLink":"Ouvrir le lien","exportButtonLinks":"Ouvrir les liens","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Donn\xe9es g\xe9ospatiales","exportFileNamePlaceholder":"Nom du fichier","encodingPlaceholder":"Encodage","exportTabTitle":"Exporter","exportFeatureInExtent":"Seulement les entit\xe9s contenues dans la carte","exportNoLayersExportable":"Aucune couche exportable dans la carte courante","exportSelectedFeature":"Seulement les entit\xe9s s\xe9lectionn\xe9es","importButton":"Importer","importProjPlaceholder":"Syst\xe8me de coordonn\xe9es","importTabTitle":"Importer","importClarifications":"Pr\xe9cisions","importSizeMax":"La taille limite du fichier est de {{size}} Mo","importFormatAuthorized":"Formats autoris\xe9s: geojson, kml, gpx, gml, shapefile","importShpZip":"Les shapefiles doivent \xeatre compress\xe9s (zipp\xe9s)","other":"autre","others":"autres"},"operators":{"caseSensitive":"Sensible \xe0 la case","And":"Et","Or":"Ou","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"entre","During":"durant (temporel)","PropertyIsNull":"est nul","Intersects":"intersecte (g\xe9om\xe9trique)","Within":"contenu dans (g\xe9om\xe9trique)","Contains":"contient (g\xe9om\xe9trique)","tooltip":{"And":"Op\xe9rateur logique entre les filtres o\xf9 les deux conditions doivent \xeatre remplies","Or":"Op\xe9rateur logique entre les filtres o\xf9 au moins une (1) condition doit \xeatre vraie","PropertyIsEqualTo":"Identique (sensible \xe0 la case)","PropertyIsNotEqualTo":"Diff\xe9rent (sensible \xe0 la case)","PropertyIsLike":"Comme. Exemple: *route* trouve toutes les valeurs contenent \'route\', peu importe sa position dans l\'attribut. route* trouve toutes les valeurs commencant par \'route\'. Options avanc\xe9es : wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (sensible \xe0 la case)","PropertyIsGreaterThan":"Plus grand","PropertyIsGreaterThanOrEqualTo":"Plus grand ou \xe9gal","PropertyIsLessThan":"Plus petit","PropertyIsLessThanOrEqualTo":"Plus petit ou \xe9gal","PropertyIsBetween":"Doit \xeatre contenu entre les limites inf\xe9rieure et sup\xe9rieure (les valeurs sont incluses)","During":"Doit \xeatre contenu entre les p\xe9riodes de temps sp\xe9cifi\xe9es","PropertyIsNull":"Dont l\'attribut est nul","Intersects":"Retourne les entit\xe9s \xe9tant en intersection g\xe9om\xe9trique avec la g\xe9om\xe9trie fournie","Within":"Retourne les entit\xe9s \xe9tant enti\xe8rement contenue par la g\xe9om\xe9trie fournie (Within)","Contains":"Retourne les entit\xe9s compl\xe8tement contenues par la g\xe9om\xe9trie fournie (Contains)"}},"sourceFields":{"selectField":"Choisir un champ"},"filter":{"addFilter":"Ajouter un filtre vide \xe0 la liste courante","removeFilter":"Supprimer le pr\xe9sent filtre \xe0 la liste des filtres","toggleFilterState":"Activer/d\xe9sactiver le pr\xe9sent filtre","refreshFilters":"Mettre \xe0 jour la source de donn\xe9e avec les filtres actifs de la liste. Pour activer ce boutton, la couche doit etre visible (et dans les \xe9chelles permises) ou veillez modifier le pr\xe9sent filtre.","layerFiltered":"Cette couche d\'information est pr\xe9sentement filtr\xe9e.","layerFilterable":"Cette couche d\'information est filtrable","filterBy":"Filtrer par","advancedOgcFilters":"Filtres avanc\xe9s","placeholder":"Saisir une valeur","placeholderSnrc":"Ex: 21L14","selectOperator":"Choisir un op\xe9rateur"},"spatialSelector":{"fixedExtent":"\xc9tendue fixe","btnSetExtent":"D\xe9finir l\'\xe9tendue du filtre selon l\'\xe9tendue courante de la carte","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Masquer la couche","hideSelectedLayers":"Masquer les couches s\xe9lectionn\xe9es","lowerLayer":"Mettre en arri\xe8re","filterLowerLayer":"Le d\xe9placement arri\xe8re se fait toujours selon l\'ordre de la carte!","filterPlaceholder":"Filtrer la liste de couches","activateSelectionMode":"Activer le mode de s\xe9lection multiple","deactivateSelectionMode":"D\xe9sactiver le mode de s\xe9lection multiple","tools":"Outils","selectAll":"Tout s\xe9lectionner","deselectAll":"Tout d\xe9s\xe9lectionner","opacity":"Opacit\xe9","raiseLayer":"Mettre en avant","filterRaiseLayer":"Le d\xe9placement avant se fait toujours selon l\'ordre de la carte!","moreOptions":"Options sur la couche","removeLayer":"Retirer la couche de la carte","showFeaturesList":"Afficher la liste des entit\xe9s","showLayer":"Afficher la couche","showSelectedLayers":"Afficher les couches s\xe9lectionn\xe9es","subsetLayersListKeyword":"Limiter l\'affichage de la liste selon le titre ou  par type (wms, wfs,...)","deleteKeyword":"Supprimer le mot-cl\xe9","subsetLayersListOnlyVisible":"Conserver seulement les couches visibles","subsetLayersListOnlyInRange":"Conserver seulement les couches de la plage d\'\xe9chelle active","sortAlphabetically":"Trier la liste des couches en ordre alphab\xe9tique","sortMapOrder":"Replacer les couches selon l\'ordre cartographique","resetLayersList":"R\xe9tablir l\'affichage de l\'ensemble des couches","trackFeature":"Suivre l\'entit\xe9","legend":{"default":"D\xe9faut","loadingLegendText":"Chargement de la l\xe9gende","noLegendText":"Aucune symbologie disponible pour cette couche","noLegendScale":"Aucune symbologie disponible pour cette \xe9chelle","selectStyle":"S\xe9lectionner le style de la l\xe9gende","showAll":"Montrer toutes les couches (non visible et hors \xe9chelle)","noLayersVisibleWithShowAllButton":"Aucune couche actuellement visible. Activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisibleWithShowAllButtonButZoom":"Aucune couche actuellement visible. Si vous zoomez dans la carte, certaines couches appara\xeetront OU activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisible":"Aucune couche actuellement visible.","noLayersVisibleButZoom":"Aucune couche actuellement visible. Par contre, si vous zoomez dans la carte, certaines couches appara\xeetront."}},"download":{"action":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","title":"T\xe9l\xe9chargement des donn\xe9es","start":"V\xe9rifiez la progression du t\xe9l\xe9chargement dans votre navigateur","end":"Termin\xe9"},"mapButtons":{"baselayerSwitcher":"Changer le fond de carte","geolocate":"Afficher votre position","offline":"Passer en mode hors-ligne","online":"Passer en mode en ligne","zoomIn":"Zoomer ({{zoom}})","zoomOut":"D\xe9zoomer ({{zoom}})","resetRotation":"R\xe9initialiser la carte vers le nord","tipRotation":"Maintenez les touches Alt et Majuscule (shift) tout en cliquant sur la carte pour faire pivoter la carte"},"metadata":{"show":"Montrer les m\xe9tadonn\xe9es"},"printForm":{"corsErrorMessageBody":"Impossible d\'imprimer d\xfb \xe0 des droits d\'acc\xe8s non d\xe9tenus","corsErrorMessageHeader":"Impression","comment":"Commentaire","doZipFile":"Compresser le fichier","outputFormat":"Format de sortie","paperFormat":"Format du papier","paperFormats":{"A0":"A0","A1":"A1","A2":"A2","A3":"A3","A4":"A4","A5":"A5","Letter":"Lettre","Legal":"L\xe9gal"},"imageFormat":"Format de l\'image","orientation":"Orientation","landscape":"Paysage","portrait":"Portrait","projection":"Projection","resolution":"R\xe9solution","saveBtn":"Sauvegarder","scale":"\xc9chelle","showLegend":"Afficher la l\xe9gende","showProjection":"Afficher la projection","showScale":"Afficher l\'\xe9chelle","title":"Titre"},"directionsForm":{"start":"D\xe9but","intermediate":"Interm\xe9diaire","end":"Fin","directionsBtn":"Obtenir l\'itin\xe9raire","resetDirectionsBtn":"Supprimer l\'itin\xe9raire","zoomRoute":"Zoomer sur l\'itin\xe9raire","null":"","directions":"Itin\xe9raire","raiseStop":"Prioriser l\'arr\xeat","lowerStop":"Reporter l\'arr\xeat plus loin dans le parcours","addStop":"Ajouter un arr\xeat","removeStop":"Supprimer l\'arr\xeat","drivingOptions":"Choix d\'itin\xe9raires","summary":"R\xe9sum\xe9 de l\'itin\xe9raire","stopsList":"Liste des lieux d\'arr\xeats","instructions":"Indications","copy":"Copier l\'itin\xe9raire","geolocate":"Utiliser sa localisation comme point d\'arr\xeat","link":"Lien","dialog":{"copyMsg":"Itin\xe9raire copi\xe9 dans le presse-papier","copyMsgLink":"Le lien de l\'itin\xe9raire est copi\xe9 dans le presse-papier","copyTitle":"Itin\xe9raire"}},"directions":{"uturn":"demi-tour","sharp right":"fortement \xe0 droite","right":"droite","slight right":"l\xe9g\xe8rement \xe0 droite","sharp left":"fortement \xe0 gauche","left":"gauche","slight left":"l\xe9g\xe8rement \xe0 gauche","straight":"tout droit"},"cardinalPoints":{"n":"nord","ne":"nord-est","e":"est","se":"sud-est","s":"sud","sw":"sud-ouest","w":"ouest","nw":"nord-ouest"},"search":{"placeholder":"Rechercher une localisation ou une couche de donn\xe9es","emptyType.placeholder":"Veuillez choisir un type de recherche","feature.title":"Localisation","feature.placeholder":"Rechercher une localisation","layer.title":"Couche de donn\xe9es","layer.placeholder":"Rechercher une couche de donn\xe9es.","ichercheReverse.name":"Recherche par coordonn\xe9es","ilayer":{"name":"Couches","properties":{"abstract":"Description","groupTitle":"Groupe","title":"Titre","type":"Type","url":"URL","metadataUrl":"M\xe9tadonn\xe9es","name":"Nom de la couche","urlInfo":"Lien du service web WMS/WFS","downloadUrl":"Lien de t\xe9l\xe9chargement de la donn\xe9es"},"type":{"layer":"Couche","groupLayer":"Groupe de couches"}},"nominatim":{"type":{"food":"Restauration","health":"Sant\xe9","entertainment":"Divertissement","finance":"Finance"},"country":{"all":"Le monde","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Adresse","oldAddress":"Ancienne adresse","district":"Arrondissement","postalCode":"Code Postal","city":"Municipalit\xe9","oldCity":"Ancienne municipalit\xe9","mrc":"MRC","regadmin":"R\xe9gion administrative","road":"Route","place":"Lieu","sumi":"Borne SUMI","km":"Rep\xe8re kilom\xe9trique","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordonn\xe9es","coord":"Coordonn\xe9e (longitude, latitude)"},"menu.tooltip":"Options de recherche","settings":{"title":"Param\xe8tres"},"pointerSearchSummary":{"title":"Position du curseur","tooltip":"Afficher les coordonn\xe9es du curseur ainsi que d\'autres informations sur sa position en fonction des types de r\xe9sultats activ\xe9es. Utiliser F2 pour activer / d\xe9sactiver."},"searchSources":{"selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","settings":{"results type":"Type de r\xe9sultat","ecmax":"\xc9cart maximal","radius":"Rayon de recherche","results limit":"Nombre de r\xe9sultats","multiple object":"Objet multiple","restrictExtent":"Restreint l\'\xe9tendue","selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","true":"Oui","false":"Non"}},"displayMoreResults":"Afficher plus de r\xe9sultats"},"geometry":{"geometry":"Geometrie","point":"Point","line":"Ligne","polygon":"Surface"},"targetHtmlUrl":"Ouvrir le lien externe","searchByCoord":"Rechercher par coordonn\xe9es","searchByName":"Rechercher par nom","seeRouting":"Voir l\'itin\xe9raire","timeFilter":{"date":"Date","endDate":"Date de fin","startDate":"Date de d\xe9but","hour":"Heure","minute":"Minute"},"spatialFilter":{"predefined":"Zone Pr\xe9d\xe9finie","draw":"Dessin","polygon":"Polygone","point":"Cercle","drawPolygon":"Dessiner un polygone","drawCircle":"Dessiner un cercle","searchLabel":"Rechercher par","search":"Recherche","drawControl":"Activer le contr\xf4le de dessin","listLabel":"Zone","entity":"Entit\xe9","layer":"Couche","goSearch":"Lancer la recherche","removeLayer":"Retirer les r\xe9sultats","exportLayer":"Exporter les r\xe9sultats","clearForm":"Retirer le dessin","clearSearch":"R\xe9initialiser","Address":"Adresses","Thematics":"Th\xe9matiques","searchResults":"R\xe9sultats de la recherche","type":"Type","radius":"Rayon","radiusAlert":"Le rayon doit \xeatre compris entre 0 et 10000","maxSizeAlert":"Le nombre de r\xe9sultats exc\xe8de 10000. Certains pourraient \xeatre manquants.","zeroResults":"Aucun r\xe9sultat ne correspond \xe0 cette recherche.","warning":"Avertissement","freehandControl":"\xc0 main lev\xe9e","group":{"toponyme":"Toponyme","culturel":"Culturel","education":"\xc9ducation","sante":"Sant\xe9","securite":"S\xe9curit\xe9","sepaq":"S\xc9PAQ","transport":"Transport"}},"terrapi":{"AdmRegion":"R\xe9gions administratives","Mun":"Municipalit\xe9s","Arrond":"Arrondissements","CircFed":"Circonscriptions f\xe9d\xe9rales","CircProv":"Circonscriptions provinciales","DirReg":"Directions r\xe9gionales","MRC":"MRC","RegTour":"R\xe9gions touristiques","bornes":"Bornes sumi","hydro":"Hydrographie","routes":"Routes","bati":"B\xe2timents","batiment":"B\xe2timents","camping":"Camping","equipement":"\xc9quipements","commun":"Commun","geographie":"Lieux naturels","parc":"Parcs","secteur":"Secteurs","immeubles":"Immeubles patrimoniaux","sites":"Sites patrimoniaux","cpe":"Centre de la petite enfance","public":"\xc9coles publiques","prive":"\xc9coles priv\xe9s","gouvernemental":"\xc9coles gouvernementales","colleges":"Coll\xe8ges","universites":"Universit\xe9s","aine":"R\xe9sidences pour a\xeen\xe9s","ambulance":"Zones d\'ambulance","clinique":"Cliniques","etabl":"\xc9tablissements de sant\xe9","gmf":"Groupes de m\xe9decins de famille","naissance":"Maisons de naissances","pharmacie":"Pharmacies","casernes":"Casernes de pompiers","correctionnel":"Centres correctionnels","organisme":"Organismes de s\xe9curit\xe9","palais-justice":"Palais de justice","penitencier-fed":"P\xe9nitenciers f\xe9d\xe9raux","penitencier-prov":"P\xe9nitenciers provinciaux","polices":"Poste de police"},"measure":{"dialog":{"title":"Sommes de la s\xe9lection","length.title":"Distance","area.title":"Superficie","lengthInMeters":"M\xe8tres","lengthInKilometers":"Kilom\xe8tres","lengthInMiles":"Miles","lengthInFeet":"Pieds","areaInSquareMeters":"M\xe8tres\xb2","areaInSquareKilometers":"Kilom\xe8tres\xb2","areaInSquareMiles":"Miles\xb2","areaInHectares":"Hectares","areaInAcres":"Acres","perimeterInMeters":"P\xe9rim\xe8tre en m\xe8tres"},"area":"Superficie","areaHeader":"Superficie","length":"Distance","lengthHeader":"Distance / P\xe9rim\xe8tre","perimeter":"P\xe9rim\xe8tre","meters":"M\xe8tres","m":"m","kilometers":"Kilom\xe8tres","km":"km","miles":"Miles","mi":"mi","feet":"Pieds","ft":"pi","squareMeters":"M\xe8tres\xb2","m\xb2":"m\xb2","squareKilometers":"Kilom\xe8tres\xb2","km\xb2":"km\xb2","squareMiles":"Miles\xb2","mi\xb2":"mi\xb2","squareFeet":"Pieds\xb2","ft\xb2":"pi\xb2","hectares":"Hectares","ha":"ha","acres":"Acres","ac":"ac","toggleActive":"Activer le contr\xf4le de mesure","toggleMapTooltips":"Mesures sur la carte","toggleAutoUnits":"Unit\xe9s automatiques","actionbar":{"calculate.tooltip":"Calculer","delete.tooltip":"Supprimer","modify.tooltip":"Modifier"}},"workspace":{"ogcFilter.close":"Fermer","ogcFilter.title":"Filtres","ogcFilter.tooltip":"Appliquer des filtres sur la couche","download.title":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","download.tooltip":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","inMapExtent.title":"Ne montrer que les enregistrements contenus dans la carte","inMapExtent.active.tooltip":"Ne montrer que les enregistrements contenus dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les enregistrements","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Ne montrer que les enregistrements s\xe9lectionn\xe9s","selected.tooltip":"Ne montrer que les enregistrements s\xe9lectionn\xe9s","clearSelection.title":"Tout d\xe9s\xe9lectionner","clearSelection.tooltip":"D\xe9s\xe9lectionner les enregistrements s\xe9lectionn\xe9s"},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}}},"integration":{"tools":{"catalog":"Catalogue","contexts":"Contextes","directions":"Itin\xe9raire","importExport":"Importer et exporter","ogcFilter":"Filtrer par","map":"Carte","layers":"Couches","legend":"L\xe9gende","measurer":"Mesure","print":"Imprimer","searchResults":"R\xe9sultats de recherche","shareMap":"Partager","timeFilter":"Filtre temporel","about":"\xc0 propos","spatialFilter":"Filtre spatial"},"searchResultsTool":{"noResults":"Aucun r\xe9sultat","doSearch":"Veuillez effectuer une recherche dans la barre de recherche ci-dessus.","examples":"Vous pouvez utiliser des mots cl\xe9s pour pr\xe9ciser votre recherche. Exemples: <ul><li>#mun qu\xe9bec</li><li>#sante L\xe9vis</li><li>#cpe joyeux</li></ul>"},"about.html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Aper\xe7u des fonctionnalit\xe9s</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Recherche </div><div class=\'describe\'> Situ\xe9e dans la portion sup\xe9rieure gauche de l\u2019interface, la barre de recherche permet de vous positionner \xe0 l\u2019aide d\u2019une adresse, d\u2019un lieu ou de coordonn\xe9es GPS et peut \xe9galement servir \xe0 chercher une couche. Il est aussi possible de rechercher un \xe9l\xe9ment par type de r\xe9sultats en utilisant le hashtag \xab # \xbb (par exemple, #municipalites qu\xe9bec). Les accents et les lettres majuscules n\'importent pas lors de l\'utilisation du hashtag.</div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contextes </div><div class=\'describe\'> Visualisez des regroupements de couches faits par th\xe8me ou par contexte de travail. Lorsque vous s\xe9lectionnez un <span class=\'bold_class\'>Contexte</span>, vous trouverez dans <span class=\'bold_class\'>Carte</span> chacune des couches qu\u2019il contient. Vous pouvez y ajouter d\u2019autres couches \xe0 partir du <span class=\'bold_class\'>Catalogue</span> ou de l\u2019outil <span class=\'bold_class\'>Recherche.</span> </div><br><div class=\'red\'> <span class=\'bold_class\'>ATTENTION :</span> Si vous s\xe9lectionnez un autre <span class=\'bold_class\'>Contexte</span>, toutes les couches affich\xe9es dans <span class=\'bold_class\'>Carte</span> seront remplac\xe9es. </div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Carte </div><div class=\'describe\'> Personnalisez votre carte \xe0 partir du <span class=\'bold_class\'>Catalogue</span> ou de l\u2019outil <span class=\'bold_class\'>Recherche.</span> Cet espace permet d\u2019ajouter, de supprimer et d\u2019interroger des couches. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Outil de mesure </div><div class=\'describe\'> Mesurez des distances ou des superficies sur la carte. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Itin\xe9raire </div><div class=\'describe\'> Construisez un itin\xe9raire entre deux points (en placant les deux points dans la carte ou en cherchant des adresses). Vous pourrez ensuite ajouter des points interm\xe9diaires, copier la description de l\'itin\xe9raire dans le presse papier ou partager le lien. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalogue </div><div class=\'describe\'> Trouvez toutes les couches qui peuvent \xeatre ajout\xe9es \xe0 la <span class=\'bold_class\'>Carte.</span> Cliquez sur la couche d\xe9sir\xe9e pour l\u2019ajouter. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Importer/Exporter </div><div class=\'describe\'> Importez ou exportez un fichier vectoriel en sp\xe9cifiant la projection. Vous pouvez aussi sauvegarder ou recharger un contexte localement. Cela vous permet de sauvegarder des contextes en mode non-authentifi\xe9 ou anonyme. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Imprimer </div><div class=\'describe\'> Imprimez la carte affich\xe9e \xe0 l\u2019\xe9cran. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Partager </div><div class=\'describe\'> Cr\xe9ez une adresse URL qui redirige vers une repr\xe9sentation exacte de votre carte qui se trouve \xe0 l\u2019\xe9cran. Ce lien peut \xeatre partag\xe9 ou diffus\xe9 dans un document et permet de \xab&nbspsauvegarder \xbb votre carte pour une utilisation ult\xe9rieure. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> est une solution Web libre en g\xe9omatique, d\xe9velopp\xe9e en mode collaboratif par des sp\xe9cialistes provenant de plusieurs minist\xe8res et organismes du gouvernement du Qu\xe9bec.</p><p>Version :{{version.lib}}</p></div>","mapTool":{"empty":"La carte ne contient aucune couche de donn\xe9es.","customize":"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : ","search-tool":"Recherche","catalog-tool":"Catalogue de donn\xe9es","context-tool":"Gestionnaire de contextes","noLayersVisible":"Aucune couche visible.","noLayersInRange":"Aucune couche visible dans la plage d\'\xe9chelle active. Veuillez zoomer ou d\xe9zoomer pour d\xe9couvrir ces couches."},"importExportTool":{"importExportData":"Couche","importExportContext":"Contexte"},"workspace":{"toggleWorkspace":"Ouvrir/fermer la vue tabulaire"}}}}')},0:function(e,t,i){e.exports=i("QPI1")},"4/ac":function(e){e.exports=JSON.parse('{"igo":{"core":{"errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"}},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}}}}}')},BSSV:function(e){e.exports=JSON.parse('{"igo":{"geo":{"catalog":{"layer.addToMap":"Ajouter \xe0 la carte","layer.addToMapOutRange":"Ajouter \xe0 la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","layer.removeFromMap":"Retirer de la carte","layer.removeFromMapOutRange":"Retirer de la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","group.addToMap":"Ajouter toutes les couches de ce groupe \xe0 la carte","group.removeFromMap":"Retirer toutes les couches de ce groupe de la carte","baseLayers":"Fonds de carte","unavailableTitle":"Catalogue indisponible","unavailable":"Le catalogue \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises."},"clickOnMap":{"clickedFeature":"Entit\xe9s cliqu\xe9es"},"baselayersSwitcher":{"title":"Fonds de carte"},"dataSource":{"unavailableTitle":"Couche indisponible","optionsApiUnavailable":"L\'information sur les couches n\'a pas pu \xeatre r\xe9cup\xe9r\xe9e. Certaines couches pourraient ne pas pr\xe9senter la bonne information.","unavailable":"La couche \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises."},"dropGeoFile":{"invalid":{"text":"Le fichier \'{{value}}\' est invalide. ({{mimeType}})","title":"Fichier invalide"},"empty":{"text":"Le fichier \'{{value}}\' est vide, impossible d\'importer","title":"Fichier vide"},"success":{"text":"La couche \'{{value}}\' a \xe9t\xe9 ajout\xe9e \xe0 la carte","title":"Fichier import\xe9"},"unreadable":{"text":"Le fichier \'{{value}}\' est impossible \xe0 lire","title":"Fichier illisible"},"tooLarge":{"text":"Le fichier \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Fichier trop volumineux"},"invalidSRS":{"text":"La projection est valide. Elle doit commencer par EPSG:","title":"Projection invalid"}},"export":{"nothing":{"text":"Impossible d\u2019exporter, donn\xe9e non valide ou aucune donn\xe9e s\xe9lectionn\xe9e.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"noFormat":{"text":"Aucun format d\'exportation valide pour toutes les couches s\xe9lectionn\xe9es. Veuillez exporter les couches une \xe0 la fois.","title":"Aucun format disponible"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de donn\xe9e rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"},"popupBlocked":{"text":"</br>Veuillez autoriser l\'ouverture des fen\xeatres (popup) dans votre fureteur. </br>Pour Chrome and Edge, \xe0 droite dans la barre d\'adresse).</br>{{extraMessage}}","selectAgain":"Faites le correctif et s\xe9lectionner \xe0 nouveau un format.","retry":"Veuillez recommencer l\'exportation.","title":"Ouverture de fen\xeatre bloqu\xe9e par votre fureteur"},"success":{"text":"Donn\xe9es export\xe9es avec succ\xe8s.","title":"Exportation r\xe9ussie"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (s\xe9parateur virgule)","CSVsemicolon":"CSV (s\xe9parateur point-virgule)","URL":"URL"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Exporter","exportButtonLink":"Ouvrir le lien","exportButtonLinks":"Ouvrir les liens","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Donn\xe9es g\xe9ospatiales","exportFileNamePlaceholder":"Nom du fichier","encodingPlaceholder":"Encodage","exportTabTitle":"Exporter","exportFeatureInExtent":"Seulement les entit\xe9s contenues dans la carte","exportNoLayersExportable":"Aucune couche exportable dans la carte courante","exportSelectedFeature":"Seulement les entit\xe9s s\xe9lectionn\xe9es","importButton":"Importer","importProjPlaceholder":"Syst\xe8me de coordonn\xe9es","importTabTitle":"Importer","importClarifications":"Pr\xe9cisions","importSizeMax":"La taille limite du fichier est de {{size}} Mo","importFormatAuthorized":"Formats autoris\xe9s: geojson, kml, gpx, gml, shapefile","importShpZip":"Les shapefiles doivent \xeatre compress\xe9s (zipp\xe9s)","other":"autre","others":"autres"},"operators":{"caseSensitive":"Sensible \xe0 la case","And":"Et","Or":"Ou","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"entre","During":"durant (temporel)","PropertyIsNull":"est nul","Intersects":"intersecte (g\xe9om\xe9trique)","Within":"contenu dans (g\xe9om\xe9trique)","Contains":"contient (g\xe9om\xe9trique)","tooltip":{"And":"Op\xe9rateur logique entre les filtres o\xf9 les deux conditions doivent \xeatre remplies","Or":"Op\xe9rateur logique entre les filtres o\xf9 au moins une (1) condition doit \xeatre vraie","PropertyIsEqualTo":"Identique (sensible \xe0 la case)","PropertyIsNotEqualTo":"Diff\xe9rent (sensible \xe0 la case)","PropertyIsLike":"Comme. Exemple: *route* trouve toutes les valeurs contenent \'route\', peu importe sa position dans l\'attribut. route* trouve toutes les valeurs commencant par \'route\'. Options avanc\xe9es : wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (sensible \xe0 la case)","PropertyIsGreaterThan":"Plus grand","PropertyIsGreaterThanOrEqualTo":"Plus grand ou \xe9gal","PropertyIsLessThan":"Plus petit","PropertyIsLessThanOrEqualTo":"Plus petit ou \xe9gal","PropertyIsBetween":"Doit \xeatre contenu entre les limites inf\xe9rieure et sup\xe9rieure (les valeurs sont incluses)","During":"Doit \xeatre contenu entre les p\xe9riodes de temps sp\xe9cifi\xe9es","PropertyIsNull":"Dont l\'attribut est nul","Intersects":"Retourne les entit\xe9s \xe9tant en intersection g\xe9om\xe9trique avec la g\xe9om\xe9trie fournie","Within":"Retourne les entit\xe9s \xe9tant enti\xe8rement contenue par la g\xe9om\xe9trie fournie (Within)","Contains":"Retourne les entit\xe9s compl\xe8tement contenues par la g\xe9om\xe9trie fournie (Contains)"}},"sourceFields":{"selectField":"Choisir un champ"},"filter":{"addFilter":"Ajouter un filtre vide \xe0 la liste courante","removeFilter":"Supprimer le pr\xe9sent filtre \xe0 la liste des filtres","toggleFilterState":"Activer/d\xe9sactiver le pr\xe9sent filtre","refreshFilters":"Mettre \xe0 jour la source de donn\xe9e avec les filtres actifs de la liste. Pour activer ce boutton, la couche doit etre visible (et dans les \xe9chelles permises) ou veillez modifier le pr\xe9sent filtre.","layerFiltered":"Cette couche d\'information est pr\xe9sentement filtr\xe9e.","layerFilterable":"Cette couche d\'information est filtrable","filterBy":"Filtrer par","advancedOgcFilters":"Filtres avanc\xe9s","placeholder":"Saisir une valeur","placeholderSnrc":"Ex: 21L14","selectOperator":"Choisir un op\xe9rateur"},"spatialSelector":{"fixedExtent":"\xc9tendue fixe","btnSetExtent":"D\xe9finir l\'\xe9tendue du filtre selon l\'\xe9tendue courante de la carte","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Masquer la couche","hideSelectedLayers":"Masquer les couches s\xe9lectionn\xe9es","lowerLayer":"Mettre en arri\xe8re","filterLowerLayer":"Le d\xe9placement arri\xe8re se fait toujours selon l\'ordre de la carte!","filterPlaceholder":"Filtrer la liste de couches","activateSelectionMode":"Activer le mode de s\xe9lection multiple","deactivateSelectionMode":"D\xe9sactiver le mode de s\xe9lection multiple","tools":"Outils","selectAll":"Tout s\xe9lectionner","deselectAll":"Tout d\xe9s\xe9lectionner","opacity":"Opacit\xe9","raiseLayer":"Mettre en avant","filterRaiseLayer":"Le d\xe9placement avant se fait toujours selon l\'ordre de la carte!","moreOptions":"Options sur la couche","removeLayer":"Retirer la couche de la carte","showFeaturesList":"Afficher la liste des entit\xe9s","showLayer":"Afficher la couche","showSelectedLayers":"Afficher les couches s\xe9lectionn\xe9es","subsetLayersListKeyword":"Limiter l\'affichage de la liste selon le titre ou  par type (wms, wfs,...)","deleteKeyword":"Supprimer le mot-cl\xe9","subsetLayersListOnlyVisible":"Conserver seulement les couches visibles","subsetLayersListOnlyInRange":"Conserver seulement les couches de la plage d\'\xe9chelle active","sortAlphabetically":"Trier la liste des couches en ordre alphab\xe9tique","sortMapOrder":"Replacer les couches selon l\'ordre cartographique","resetLayersList":"R\xe9tablir l\'affichage de l\'ensemble des couches","trackFeature":"Suivre l\'entit\xe9","legend":{"default":"D\xe9faut","loadingLegendText":"Chargement de la l\xe9gende","noLegendText":"Aucune symbologie disponible pour cette couche","noLegendScale":"Aucune symbologie disponible pour cette \xe9chelle","selectStyle":"S\xe9lectionner le style de la l\xe9gende","showAll":"Montrer toutes les couches (non visible et hors \xe9chelle)","noLayersVisibleWithShowAllButton":"Aucune couche actuellement visible. Activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisibleWithShowAllButtonButZoom":"Aucune couche actuellement visible. Si vous zoomez dans la carte, certaines couches appara\xeetront OU activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisible":"Aucune couche actuellement visible.","noLayersVisibleButZoom":"Aucune couche actuellement visible. Par contre, si vous zoomez dans la carte, certaines couches appara\xeetront."}},"download":{"action":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","title":"T\xe9l\xe9chargement des donn\xe9es","start":"V\xe9rifiez la progression du t\xe9l\xe9chargement dans votre navigateur","end":"Termin\xe9"},"mapButtons":{"baselayerSwitcher":"Changer le fond de carte","geolocate":"Afficher votre position","offline":"Passer en mode hors-ligne","online":"Passer en mode en ligne","zoomIn":"Zoomer ({{zoom}})","zoomOut":"D\xe9zoomer ({{zoom}})","resetRotation":"R\xe9initialiser la carte vers le nord","tipRotation":"Maintenez les touches Alt et Majuscule (shift) tout en cliquant sur la carte pour faire pivoter la carte"},"metadata":{"show":"Montrer les m\xe9tadonn\xe9es"},"printForm":{"corsErrorMessageBody":"Impossible d\'imprimer d\xfb \xe0 des droits d\'acc\xe8s non d\xe9tenus","corsErrorMessageHeader":"Impression","comment":"Commentaire","doZipFile":"Compresser le fichier","outputFormat":"Format de sortie","paperFormat":"Format du papier","paperFormats":{"A0":"A0","A1":"A1","A2":"A2","A3":"A3","A4":"A4","A5":"A5","Letter":"Lettre","Legal":"L\xe9gal"},"imageFormat":"Format de l\'image","orientation":"Orientation","landscape":"Paysage","portrait":"Portrait","projection":"Projection","resolution":"R\xe9solution","saveBtn":"Sauvegarder","scale":"\xc9chelle","showLegend":"Afficher la l\xe9gende","showProjection":"Afficher la projection","showScale":"Afficher l\'\xe9chelle","title":"Titre"},"directionsForm":{"start":"D\xe9but","intermediate":"Interm\xe9diaire","end":"Fin","directionsBtn":"Obtenir l\'itin\xe9raire","resetDirectionsBtn":"Supprimer l\'itin\xe9raire","zoomRoute":"Zoomer sur l\'itin\xe9raire","null":"","directions":"Itin\xe9raire","raiseStop":"Prioriser l\'arr\xeat","lowerStop":"Reporter l\'arr\xeat plus loin dans le parcours","addStop":"Ajouter un arr\xeat","removeStop":"Supprimer l\'arr\xeat","drivingOptions":"Choix d\'itin\xe9raires","summary":"R\xe9sum\xe9 de l\'itin\xe9raire","stopsList":"Liste des lieux d\'arr\xeats","instructions":"Indications","copy":"Copier l\'itin\xe9raire","geolocate":"Utiliser sa localisation comme point d\'arr\xeat","link":"Lien","dialog":{"copyMsg":"Itin\xe9raire copi\xe9 dans le presse-papier","copyMsgLink":"Le lien de l\'itin\xe9raire est copi\xe9 dans le presse-papier","copyTitle":"Itin\xe9raire"}},"directions":{"uturn":"demi-tour","sharp right":"fortement \xe0 droite","right":"droite","slight right":"l\xe9g\xe8rement \xe0 droite","sharp left":"fortement \xe0 gauche","left":"gauche","slight left":"l\xe9g\xe8rement \xe0 gauche","straight":"tout droit"},"cardinalPoints":{"n":"nord","ne":"nord-est","e":"est","se":"sud-est","s":"sud","sw":"sud-ouest","w":"ouest","nw":"nord-ouest"},"search":{"placeholder":"Rechercher une localisation ou une couche de donn\xe9es","emptyType.placeholder":"Veuillez choisir un type de recherche","feature.title":"Localisation","feature.placeholder":"Rechercher une localisation","layer.title":"Couche de donn\xe9es","layer.placeholder":"Rechercher une couche de donn\xe9es.","ichercheReverse.name":"Recherche par coordonn\xe9es","ilayer":{"name":"Couches","properties":{"abstract":"Description","groupTitle":"Groupe","title":"Titre","type":"Type","url":"URL","metadataUrl":"M\xe9tadonn\xe9es","name":"Nom de la couche","urlInfo":"Lien du service web WMS/WFS","downloadUrl":"Lien de t\xe9l\xe9chargement de la donn\xe9es"},"type":{"layer":"Couche","groupLayer":"Groupe de couches"}},"nominatim":{"type":{"food":"Restauration","health":"Sant\xe9","entertainment":"Divertissement","finance":"Finance"},"country":{"all":"Le monde","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Adresse","oldAddress":"Ancienne adresse","district":"Arrondissement","postalCode":"Code Postal","city":"Municipalit\xe9","oldCity":"Ancienne municipalit\xe9","mrc":"MRC","regadmin":"R\xe9gion administrative","road":"Route","place":"Lieu","sumi":"Borne SUMI","km":"Rep\xe8re kilom\xe9trique","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordonn\xe9es","coord":"Coordonn\xe9e (longitude, latitude)"},"menu.tooltip":"Options de recherche","settings":{"title":"Param\xe8tres"},"pointerSearchSummary":{"title":"Position du curseur","tooltip":"Afficher les coordonn\xe9es du curseur ainsi que d\'autres informations sur sa position en fonction des types de r\xe9sultats activ\xe9es. Utiliser F2 pour activer / d\xe9sactiver."},"searchSources":{"selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","settings":{"results type":"Type de r\xe9sultat","ecmax":"\xc9cart maximal","radius":"Rayon de recherche","results limit":"Nombre de r\xe9sultats","multiple object":"Objet multiple","restrictExtent":"Restreint l\'\xe9tendue","selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","true":"Oui","false":"Non"}},"displayMoreResults":"Afficher plus de r\xe9sultats"},"geometry":{"geometry":"Geometrie","point":"Point","line":"Ligne","polygon":"Surface"},"targetHtmlUrl":"Ouvrir le lien externe","searchByCoord":"Rechercher par coordonn\xe9es","searchByName":"Rechercher par nom","seeRouting":"Voir l\'itin\xe9raire","timeFilter":{"date":"Date","endDate":"Date de fin","startDate":"Date de d\xe9but","hour":"Heure","minute":"Minute"},"spatialFilter":{"predefined":"Zone Pr\xe9d\xe9finie","draw":"Dessin","polygon":"Polygone","point":"Cercle","drawPolygon":"Dessiner un polygone","drawCircle":"Dessiner un cercle","searchLabel":"Rechercher par","search":"Recherche","drawControl":"Activer le contr\xf4le de dessin","listLabel":"Zone","entity":"Entit\xe9","layer":"Couche","goSearch":"Lancer la recherche","removeLayer":"Retirer les r\xe9sultats","exportLayer":"Exporter les r\xe9sultats","clearForm":"Retirer le dessin","clearSearch":"R\xe9initialiser","Address":"Adresses","Thematics":"Th\xe9matiques","searchResults":"R\xe9sultats de la recherche","type":"Type","radius":"Rayon","radiusAlert":"Le rayon doit \xeatre compris entre 0 et 10000","maxSizeAlert":"Le nombre de r\xe9sultats exc\xe8de 10000. Certains pourraient \xeatre manquants.","zeroResults":"Aucun r\xe9sultat ne correspond \xe0 cette recherche.","warning":"Avertissement","freehandControl":"\xc0 main lev\xe9e","group":{"toponyme":"Toponyme","culturel":"Culturel","education":"\xc9ducation","sante":"Sant\xe9","securite":"S\xe9curit\xe9","sepaq":"S\xc9PAQ","transport":"Transport"}},"terrapi":{"AdmRegion":"R\xe9gions administratives","Mun":"Municipalit\xe9s","Arrond":"Arrondissements","CircFed":"Circonscriptions f\xe9d\xe9rales","CircProv":"Circonscriptions provinciales","DirReg":"Directions r\xe9gionales","MRC":"MRC","RegTour":"R\xe9gions touristiques","bornes":"Bornes sumi","hydro":"Hydrographie","routes":"Routes","bati":"B\xe2timents","batiment":"B\xe2timents","camping":"Camping","equipement":"\xc9quipements","commun":"Commun","geographie":"Lieux naturels","parc":"Parcs","secteur":"Secteurs","immeubles":"Immeubles patrimoniaux","sites":"Sites patrimoniaux","cpe":"Centre de la petite enfance","public":"\xc9coles publiques","prive":"\xc9coles priv\xe9s","gouvernemental":"\xc9coles gouvernementales","colleges":"Coll\xe8ges","universites":"Universit\xe9s","aine":"R\xe9sidences pour a\xeen\xe9s","ambulance":"Zones d\'ambulance","clinique":"Cliniques","etabl":"\xc9tablissements de sant\xe9","gmf":"Groupes de m\xe9decins de famille","naissance":"Maisons de naissances","pharmacie":"Pharmacies","casernes":"Casernes de pompiers","correctionnel":"Centres correctionnels","organisme":"Organismes de s\xe9curit\xe9","palais-justice":"Palais de justice","penitencier-fed":"P\xe9nitenciers f\xe9d\xe9raux","penitencier-prov":"P\xe9nitenciers provinciaux","polices":"Poste de police"},"measure":{"dialog":{"title":"Sommes de la s\xe9lection","length.title":"Distance","area.title":"Superficie","lengthInMeters":"M\xe8tres","lengthInKilometers":"Kilom\xe8tres","lengthInMiles":"Miles","lengthInFeet":"Pieds","areaInSquareMeters":"M\xe8tres\xb2","areaInSquareKilometers":"Kilom\xe8tres\xb2","areaInSquareMiles":"Miles\xb2","areaInHectares":"Hectares","areaInAcres":"Acres","perimeterInMeters":"P\xe9rim\xe8tre en m\xe8tres"},"area":"Superficie","areaHeader":"Superficie","length":"Distance","lengthHeader":"Distance / P\xe9rim\xe8tre","perimeter":"P\xe9rim\xe8tre","meters":"M\xe8tres","m":"m","kilometers":"Kilom\xe8tres","km":"km","miles":"Miles","mi":"mi","feet":"Pieds","ft":"pi","squareMeters":"M\xe8tres\xb2","m\xb2":"m\xb2","squareKilometers":"Kilom\xe8tres\xb2","km\xb2":"km\xb2","squareMiles":"Miles\xb2","mi\xb2":"mi\xb2","squareFeet":"Pieds\xb2","ft\xb2":"pi\xb2","hectares":"Hectares","ha":"ha","acres":"Acres","ac":"ac","toggleActive":"Activer le contr\xf4le de mesure","toggleMapTooltips":"Mesures sur la carte","toggleAutoUnits":"Unit\xe9s automatiques","actionbar":{"calculate.tooltip":"Calculer","delete.tooltip":"Supprimer","modify.tooltip":"Modifier"}},"workspace":{"ogcFilter.close":"Fermer","ogcFilter.title":"Filtres","ogcFilter.tooltip":"Appliquer des filtres sur la couche","download.title":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","download.tooltip":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","inMapExtent.title":"Ne montrer que les enregistrements contenus dans la carte","inMapExtent.active.tooltip":"Ne montrer que les enregistrements contenus dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les enregistrements","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Ne montrer que les enregistrements s\xe9lectionn\xe9s","selected.tooltip":"Ne montrer que les enregistrements s\xe9lectionn\xe9s","clearSelection.title":"Tout d\xe9s\xe9lectionner","clearSelection.tooltip":"D\xe9s\xe9lectionner les enregistrements s\xe9lectionn\xe9s"},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}}}}}')},DKST:function(e){e.exports=JSON.parse('{"igo":{"common":{"confirmDialog":{"cancelBtn":"Annuler","confirmBtn":"Confirmer","title":"Confirmation"},"table":{"filter":"Filtre"},"form":{"errors":{"required":"Ce champ est requis"}},"actionbar":{"scrollUp":"D\xe9filer vers le haut","scrollDown":"D\xe9filer vers le bas"},"interactiveTour":{"tooltipTourToolButton":"Aide interactive sur l\'outil","disaledTooltipTourToolButton":"Pour avoir acc\xe8s au tour interactif de cet outil, ajouter des contextes ou des couches","buttonTitle":"D\xe9couvrir","exitButton":"Quitter","backButton":"Pr\xe9c\xe9dent","nextButton":"Suivant"},"paginator":{"firstPageLabel":"Premi\xe8re page","itemsPerPageLabel":"Items par page:","lastPageLabel":"Derni\xe8re page","nextPageLabel":"Page suivante","previousPageLabel":"Page pr\xe9c\xe9dente","of":"de"}}}}')},"Gt+p":function(e){e.exports=JSON.parse('{"igo":{"common":{"confirmDialog":{"cancelBtn":"Cancel","confirmBtn":"Confirm","title":"Confirm"},"table":{"filter":"Filter"},"form":{"errors":{"required":"This field is required"}},"actionbar":{"scrollUp":"Scroll up","scrollDown":"Scroll down"},"interactiveTour":{"tooltipTourToolButton":"Interactive tour of the application","disaledTooltipTourToolButton":"To have access to this tool\'s tour, add contexts or layers","buttonTitle":"Discover","exitButton":"Exit","backButton":"Back","nextButton":"Next"},"paginator":{"firstPageLabel":"First page","itemsPerPageLabel":"Items per page:","lastPageLabel":"Last page","nextPageLabel":"Next page","previousPageLabel":"Previous page","of":"of"}}}}')},I3Mt:function(e){e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Access as anonymous","connection":"Connection","login":"Login","password":"Password","signOut":"Sign out","user":"User","welcome":"Welcome {{name}}!","deconnection":"You are logged out.","home":"Return to the home page","error":{"Password expired":"Password expired","Maximun logins exceeded":"Maximum logins exceeded","Login lockout":"Maximum number of attempts exceeded. Your account is locked.","Wrong password":"Wrong password","Invalid username":"Invalid username"},"microsoft":{"login":"Sign in with Microsoft"}}}}')},QPI1:function(e,t,i){"use strict";var o,n;i.r(t);var r=i("8Y7J"),a={production:!0,igo:{projections:[{code:"EPSG:32198",alias:"Quebec Lambert",def:"+proj=lcc +lat_1=60 +lat_2=46 +lat_0=44 +lon_0=-68.5 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs",extent:[-886251.0296,180252.9126,897177.3418,2106143.8139]}],auth:{intern:{enabled:!0},allowAnonymous:!0},interactiveTour:{tourInMobile:!0},importExport:{url:"https://geoegl.msp.gouv.qc.ca/apis/ogre"},language:{prefix:"./locale/"},catalog:{sources:[{id:"Gououvert",title:"Gouvouvert",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi"},{id:"DefiningInfoFormat",title:"Defining info_format",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",queryFormat:{html:"*","application/json":["stations_meteoroutieres","histo_stations_meteoroutieres"]},queryHtmlTarget:"iframe",count:30},{id:"catalogwithregex",title:"Filtered catalog by regex",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",regFilters:["zpegt"]},{id:"catalogwithtooltipcontrol",title:"Controling tooltip format",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",tooltipType:"abstract"}]},searchSources:{nominatim:{enabled:!1},icherche:{searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/icherche",order:2,enabled:!0,params:{limit:"8"}},coordinatesreverse:{showInPointerSummary:!0},icherchereverse:{showInPointerSummary:!0,searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/terrapi",order:3,enabled:!0},ilayer:{searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/layers/search",order:4,enabled:!0,params:{limit:"5"}}}}};i("yLV6");var s=i("cUpR"),c=i("omvX"),l=i("Dxy4"),u=i("Tj54"),h=i("SqCe"),d=i("q7Ft"),p=i("l0rg"),g=i("ZFy/"),f=i("iInd"),m=i("SVse"),b=i("PDjf"),v=i("pMoy"),y=i("rJgo"),k=i("IheW"),S=i("nYR2"),C=i("JIr8"),w=i("lJxs"),x=i("vkgz"),O=i("Kj3r"),I=i("JX91"),L=i("2Vo4"),T=i("z6cu"),F=i("LRne"),_=i("itXk"),M=i("xgIS"),D=i("M39V"),P=i("XNiG"),A=i("/uUt"),j=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getByte",value:function(e,t){return e.charCodeAt(t)}},{key:"getByte64",value:function(e,t){return this.ALPHA.indexOf(e.charAt(t))}},{key:"decode",value:function(e){var t,i,o=0,n=e.length,r=[];if(e=String(e),0===n)return e;for(e.charAt(n-1)===this.PADCHAR&&(o=1,e.charAt(n-2)===this.PADCHAR&&(o=2),n-=4),t=0;t<n;t+=4)i=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12|this.getByte64(e,t+2)<<6|this.getByte64(e,t+3),r.push(String.fromCharCode(i>>16,i>>8&255,255&i));switch(o){case 1:i=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12|this.getByte64(e,t+2)<<6,r.push(String.fromCharCode(i>>16,i>>8&255));break;case 2:i=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12,r.push(String.fromCharCode(i>>16))}return r.join("")}},{key:"encode",value:function(e){var t,i,o=[],n=(e=String(e)).length-e.length%3;if(0===e.length)return e;for(t=0;t<n;t+=3)i=this.getByte(e,t)<<16|this.getByte(e,t+1)<<8|this.getByte(e,t+2),o.push(this.ALPHA.charAt(i>>18)),o.push(this.ALPHA.charAt(i>>12&63)),o.push(this.ALPHA.charAt(i>>6&63)),o.push(this.ALPHA.charAt(63&i));switch(e.length-n){case 1:i=this.getByte(e,t)<<16,o.push(this.ALPHA.charAt(i>>18)+this.ALPHA.charAt(i>>12&63)+this.PADCHAR+this.PADCHAR);break;case 2:i=this.getByte(e,t)<<16|this.getByte(e,t+1)<<8,o.push(this.ALPHA.charAt(i>>18)+this.ALPHA.charAt(i>>12&63)+this.ALPHA.charAt(i>>6&63)+this.PADCHAR)}return o.join("")}}]),e}();return e.PADCHAR="=",e.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e}(),R=Object(D.getParser)(window.navigator.userAgent),$=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"copy",value:function(t){var i=!1;if("string"==typeof t){var o=e.createTextArea(t);e.selectText(o),i=e.copyTextToClipboard(),e.destroyTextArea(o)}else e.selectText(t),i=e.copyTextToClipboard();return i}},{key:"createTextArea",value:function(e){var t=document.createElement("textArea");return t.value=e,document.body.appendChild(t),t}},{key:"destroyTextArea",value:function(e){document.body.removeChild(e)}},{key:"selectText",value:function(e){if("iOS"===R.getOSName()){var t=e.contentEditable,i=e.readOnly,o=document.createRange(),n=window.getSelection();e.contenteditable=!0,e.readonly=!1,o.selectNodeContents(e),n.removeAllRanges(),n.addRange(o),e.setSelectionRange(0,999999),e.contentEditable=t,e.readOnly=i}else e.select()}},{key:"copyTextToClipboard",value:function(){return("iOS"!==R.getOSName()||!R.compareVersion("<10"))&&document.execCommand("copy")}}]),e}(),E=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"resolve",value:function(e,t){for(var i=t.replace(/\[/g,".").replace(/\]/g,"").split("."),o=e;i.length;){if("object"!=typeof o)return;o=o[i.shift()]}return o}},{key:"isObject",value:function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&null!==e&&!(e instanceof Date)}},{key:"mergeDeep",value:function(t,i){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Object.assign({},t);return e.isObject(t)&&e.isObject(i)&&Object.keys(i).filter((function(e){return!o||void 0!==i[e]})).forEach((function(r){e.isObject(i[r])&&r in t?n[r]=e.mergeDeep(t[r],i[r],o):Object.assign(n,_defineProperty({},r,i[r]))})),n}},{key:"copyDeep",value:function(e){var t=Array.isArray(e)?[]:{};for(var i in e)if(e.hasOwnProperty(i)){var o=e[i];t[i]=o&&"object"==typeof o?this.copyDeep(o):o}return t}},{key:"removeDuplicateCaseInsensitive",value:function(e){var t={},i={},o=[];for(var n in e)if(e.hasOwnProperty(n)){var r=n.toUpperCase();t.hasOwnProperty(r)?t[r].push(_defineProperty({},n,e[n])):t[r]=[_defineProperty({},n,e[n])],o.push({key:n,count:n.replace(/[^A-Z]/g,"").length})}var a=function(n){if(t.hasOwnProperty(n)&&t.hasOwnProperty(n)){var r=t[n];if(1===r.length){var a=r[0];i[n]=a[Object.keys(a)[0]]}else if(r.length>1){var s=o.filter((function(e){return e.key.toLowerCase()===n.toLowerCase()})).reduce((function(e,t){return e.y<t.y?e:t}));i[s.key.toUpperCase()]=e[s.key]}}};for(var s in t)a(s);for(var c in e)e.hasOwnProperty(c)&&delete e[c];for(var l in i)i.hasOwnProperty(l)&&(e[l]=i[l])}},{key:"removeUndefined",value:function(t){var i={};return e.isObject(t)?(Object.keys(t).filter((function(e){return void 0!==t[e]})).forEach((function(o){i[o]=e.isObject(t[o])||Array.isArray(t[o])?e.removeUndefined(t[o]):t[o]})),i):Array.isArray(t)?t.map((function(t){return e.removeUndefined(t)})):t}},{key:"removeNull",value:function(t){var i={};return e.isObject(t)?(Object.keys(t).filter((function(e){return null!==t[e]})).forEach((function(o){i[o]=e.isObject(t[o])||Array.isArray(t[o])?e.removeNull(t[o]):t[o]})),i):Array.isArray(t)?t.map((function(t){return e.removeNull(t)})):t}},{key:"naturalCompare",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"asc",o=arguments.length>3?arguments[3]:void 0;if("desc"===i&&(t=[e,e=t][0]),null===e||""===e||void 0===e||null===t||""===t||void 0===t){var n=e===t?0:void 0===e?3:void 0===t?-3:null===e?2:null===t?-2:""===e?1:-1;return"desc"===i?!1!==o?n:-1*n:!0===o?-1*n:n}var r=[],a=[];for(t=""+t,(e=""+e).replace(/(\d+)|(\D+)/g,(function(e,t,i){r.push([t||1/0,i||""])})),t.replace(/(\d+)|(\D+)/g,(function(e,t,i){a.push([t||1/0,i||""])}));r.length&&a.length;){var s=r.shift(),c=a.shift(),l=s[0]-c[0]||s[1].localeCompare(c[1]);if(l)return l}return r.length-a.length}},{key:"objectsAreEquivalent",value:function(e,t){if(e===t)return!0;var i=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(t);if(i.length!==o.length)return!1;var n,r=_createForOfIteratorHelper(i);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(e[a]!==t[a])return!1}}catch(s){r.e(s)}finally{r.f()}return!0}},{key:"removeKeys",value:function(e,t){return Object.keys(e).filter((function(e){return t.indexOf(e)<0})).reduce((function(t,i){return t[i]=e[i],t}),{})}}]),e}();function W(e){return e.reduce((function(e,t){return e[t]=t,e}),Object.create(null))}function X(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function G(){return"".concat(X()).concat(X(),"-").concat(X(),"-").concat(X(),"-").concat(X(),"-").concat(X()).concat(X()).concat(X()).toLowerCase()}var B,V,N,z,q=function(e){return e[e.Error=0]="Error",e[e.Done=1]="Done",e[e.Working=2]="Working",e[e.Waiting=3]="Waiting",e}({}),H=function(){function e(){_classCallCheck(this,e),this.status$=new P.a}return _createClass(e,[{key:"subscribe",value:function(e,t){var i=this;this.watch(),this.status$$=this.status$.pipe(Object(A.a)()).subscribe((function(o){i.handleStatusChange(o),e.call(t,i)}))}},{key:"unsubscribe",value:function(){this.unwatch(),void 0!==this.status$$&&(this.status$$.unsubscribe(),this.status$$=void 0),this.status=q.Waiting}},{key:"handleStatusChange",value:function(e){}},{key:"status",get:function(){return this._status},set:function(e){this._status=e,this.status$.next(e)}}]),e}(),U=i("TSSN"),Y=i("La0n"),K=i("HeVh"),Z=function(e){return{closeIcon:e}},J=((N=function(){function e(){_classCallCheck(this,e),this.counter$=new L.a(0),this.ids=[]}return _createClass(e,[{key:"register",value:function(){var e=G();return this.ids.push(e),this.counter$.next(this.ids.length),e}},{key:"unregister",value:function(e){var t=this.ids.indexOf(e);-1!==t&&(this.ids.splice(t,1),this.counter$.next(this.ids.length))}}]),e}()).\u0275fac=function(e){return new(e||N)},N.\u0275prov=Object(r.Nb)({factory:function(){return new N},token:N,providedIn:"root"}),N),Q=((V=function(){function e(t){_classCallCheck(this,e),this.activityService=t}return _createClass(e,[{key:"intercept",value:function(e,t){var i=this,o=e.headers.get("activityInterceptor");if(o){var n=e.clone({headers:e.headers.delete("activityInterceptor")});if("false"===o)return t.handle(n)}var r=this.activityService.register();return t.handle(e).pipe(Object(S.a)((function(){i.activityService.unregister(r)})))}}]),e}()).\u0275fac=function(e){return new(e||V)(r.bc(J))},V.\u0275prov=r.Nb({token:V,factory:V.\u0275fac}),V),ee=((B=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:k.a,useClass:Q,multi:!0}]}}}]),e}()).\u0275mod=r.Pb({type:B}),B.\u0275inj=r.Ob({factory:function(e){return new(e||B)},imports:[[]]}),B),te={lib:"1.5.0",releaseDate:1602875118328},ie=((z=function(){function e(t){_classCallCheck(this,e),this.injector=t,this.config={}}return _createClass(e,[{key:"getConfig",value:function(e){return E.resolve(this.config,e)}},{key:"load",value:function(e){var t=this,i=e.default||{};if(!e.path)return this.config=i,!0;var o=this.injector.get(k.b);return new Promise((function(n,r){o.get(e.path).pipe(Object(C.a)((function(t){return console.log("Configuration file ".concat(e.path," could not be read")),n(!0),Object(T.a)(t.error||"Server error")}))).subscribe((function(e){t.config=E.mergeDeep(E.mergeDeep({version:te},i),e),n(!0)}))}))}}]),e}()).\u0275fac=function(e){return new(e||z)(r.bc(r.t))},z.\u0275prov=Object(r.Nb)({factory:function(){return new z(Object(r.bc)(r.p))},token:z,providedIn:"root"}),z),oe=new r.s("configOptions");function ne(e){return{provide:oe,useValue:e}}function re(e,t){return function(){return e.load(t)}}var ae,se=((ae=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[ne({}),{provide:r.d,useFactory:re,multi:!0,deps:[ie,oe]}]}}}]),e}()).\u0275mod=r.Pb({type:ae}),ae.\u0275inj=r.Ob({factory:function(e){return new(e||ae)},imports:[[]]}),ae),ce=function(){function e(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".json",n=arguments.length>3?arguments[3]:void 0;_classCallCheck(this,e),this.http=t,this.prefix=i,this.suffix=o,this.config=n}return _createClass(e,[{key:"getTranslation",value:function(e){var t=i("uzb9")("./".concat(e,".json")),o=Object(F.a)(t);if(this.config&&!this.prefix&&(this.prefix=this.config.getConfig("language.prefix")),!this.prefix)return o;var n=this.http.get("".concat(this.prefix).concat(e).concat(this.suffix));return Object(_.a)([o,n]).pipe(Object(w.a)((function(e){return E.mergeDeep(e[0],e[1])})))}}]),e}();function le(e,t){return new ce(e,void 0,void 0,t)}var ue,he,de,pe,ge,fe,me,be,ve,ye,ke,Se=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"handle",value:function(e){if(!e.translateService.langs.length)throw new Error("Translations are not yet loaded.          Check that the LanguageService is injected.");if("igo."===e.key.substr(0,4))throw new Error('The Key "'.concat(e.key,'" is missing in locale file.'));return e.key}}]),e}(),Ce=((de=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:U.b,useFactory:le,deps:[k.b,ie]}]}}}]),e}()).\u0275mod=r.Pb({type:de}),de.\u0275inj=r.Ob({factory:function(e){return new(e||de)},imports:[[U.c.forRoot({missingTranslationHandler:{provide:U.a,useClass:Se}})],U.c]}),de),we=((he=function(){function e(){_classCallCheck(this,e),this._options={}}return _createClass(e,[{key:"options",get:function(){return Object.assign({},e.defaultOptions,this._options)},set:function(e){this._options=e}}]),e}()).\u0275fac=function(e){return new(e||he)},he.\u0275cmp=r.Lb({type:he,selectors:[["igo-message-center"]],inputs:{options:"options"},decls:1,vars:4,consts:[[1,"mat-typography",3,"ngClass","options"]],template:function(e,t){1&e&&r.Sb(0,"simple-notifications",0),2&e&&r.oc("ngClass",r.rc(2,Z,t.options.hasCloseIcon))("options",t.options)},directives:[Y.b,m.j],styles:['@charset "UTF-8";[_nghost-%COMP%]     div.simple-notification-wrapper{bottom:0;right:calc(50% - 150px)}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     div.simple-notification-wrapper{left:0;right:0;width:100%}}[_nghost-%COMP%]     div.simple-notification{margin-bottom:5px;min-height:50px;padding-left:45px;padding-right:25px}[_nghost-%COMP%]     div.simple-notification.noIcon{padding-left:25px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     div.simple-notification{margin-bottom:0}}[_nghost-%COMP%]     div.simple-notification .sn-title{font-size:15px;font-weight:700;line-height:23px}[_nghost-%COMP%]     div.simple-notification .sn-content{font-size:15px;line-height:18px}[_nghost-%COMP%]     div.simple-notification .icon{height:100%;left:0;padding:7px;top:0;width:45px}[_nghost-%COMP%]     div.simple-notification .icon\xa0 mat-icon{align-items:center;display:flex;font-size:32px;height:100%}[_nghost-%COMP%]     .closeIcon   .sn-title:after{content:"close";font-family:Material Icons;font-feature-settings:"liga" 1;font-size:24px;font-weight:400;position:absolute;right:5px;top:5px}']}),he.defaultOptions={timeOut:5e3,hasCloseIcon:!1,showProgressBar:!0,pauseOnHover:!0,clickToClose:!0,maxLength:100,maxStack:3,preventDuplicates:!0},he),xe=((ue=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:ue}),ue.\u0275inj=r.Ob({factory:function(e){return new(e||ue)},imports:[[m.c,Y.c.forRoot()]]}),ue),Oe=function(e){return e.ERROR="error",e.ALERT="alert",e.INFO="info",e.SUCCESS="success",e}({}),Ie=((be=function(){function e(t,i){_classCallCheck(this,e),this.notificationService=t,this.configService=i,this.messages$=new L.a([]),this.options=this.configService.getConfig("message")||{}}return _createClass(e,[{key:"showError",value:function(e){return e.error.caught=!0,this.error(e.error.message,e.error.title)}},{key:"message",value:function(e){var t;if(this.messages$.next(this.messages$.value.concat([e])),e.options=e.options||{},(e=this.handleTemplate(e)).text)t=this.notificationService.create(e.title,e.text,e.type,e.options);else{if(!e.html)return;e.icon||(e.options.theClass=e.options.theClass?e.options.theClass+" noIcon":"noIcon"),t=this.notificationService.html(e.html,e.type,e.options)}return void 0!==e.icon&&this.addIcon(t,e.icon),t}},{key:"success",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.message({text:e,title:t,icon:i.icon||"check",options:i,type:Oe.SUCCESS})}},{key:"error",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.message({text:e,title:t,icon:i.icon||"error_outline",options:i,type:Oe.ERROR})}},{key:"info",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.message({text:e,title:t,icon:i.icon||"info_outline",options:i,type:Oe.INFO})}},{key:"alert",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.message({text:e,title:t,icon:i.icon||"access_alarm",options:i,type:Oe.ALERT})}},{key:"remove",value:function(e){this.notificationService.remove(e)}},{key:"addIcon",value:function(e,t){e.icon='\n      <mat-icon class="material-icons mat-icon mat-list-avatar" svgIcon="'.concat(t,'">\n      </mat-icon>')}},{key:"handleTemplate",value:function(e){if(!this.options.template||e.html)return e;var t=this.options.template;return t=(t=(t=t.replace("${text}",e.text)).replace("${title}",e.title)).replace("${icon}",e.icon),e.html=t,e.text=void 0,e.title=void 0,e.icon=void 0,e}}]),e}()).\u0275fac=function(e){return new(e||be)(r.bc(Y.a),r.bc(ie))},be.\u0275prov=Object(r.Nb)({factory:function(){return new be(Object(r.bc)(Y.a),Object(r.bc)(ie))},token:be,providedIn:"root"}),be),Le=((me=function(){function e(t){_classCallCheck(this,e),this.translate=t,this.language=this.translate.getBrowserLang();var i=this.getLanguage();this.translate.setDefaultLang(i)}return _createClass(e,[{key:"getLanguage",value:function(){return this.language.match(/en|fr/)?this.language:"en"}},{key:"setLanguage",value:function(e){this.language=e.match(/en|fr/)?e:"en",this.translate.use(this.language),this.translate.reloadLang(this.language)}}]),e}()).\u0275fac=function(e){return new(e||me)(r.bc(U.e))},me.\u0275prov=Object(r.Nb)({factory:function(){return new me(Object(r.bc)(U.e))},token:me,providedIn:"root"}),me),Te=((fe=function(){function e(t,i){_classCallCheck(this,e),this.messageService=t,this.injector=i}return _createClass(e,[{key:"intercept",value:function(e,t){var i=this,o={httpError:void 0};return t.handle(e).pipe(Object(C.a)((function(e){return i.handleError(e,o)})),Object(S.a)((function(){i.handleCaughtError(o),i.handleUncaughtError(o)})))}},{key:"handleError",value:function(e,t){if(e instanceof k.e){var i="object"===e.error?e.error:{};i.message=e.error.message||e.statusText,i.caught=!1,e=new k.e({error:i,headers:e.headers,status:e.status,statusText:e.statusText,url:e.url})}return t.httpError=e,Object(T.a)(e)}},{key:"handleCaughtError",value:function(e){var t=e.httpError;t&&t.error.toDisplay&&(t.error.caught=!0,this.messageService.error(t.error.message,t.error.title))}},{key:"handleUncaughtError",value:function(e){var t=e.httpError;if(t&&!t.error.caught){var i=this.injector.get(Le).translate,o=i.instant("igo.core.errors.uncaught.message"),n=i.instant("igo.core.errors.uncaught.title");t.error.caught=!0,this.messageService.error(o,n)}}}]),e}()).\u0275fac=function(e){return new(e||fe)(r.bc(Ie),r.bc(r.t))},fe.\u0275prov=Object(r.Nb)({factory:function(){return new fe(Object(r.bc)(Ie),Object(r.bc)(r.p))},token:fe,providedIn:"root"}),fe),Fe=((ge=function(){function e(t){if(_classCallCheck(this,e),t)throw new Error("IgoErrorModule is already loaded. Import it in the AppModule only")}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:k.a,useClass:Te,multi:!0}]}}}]),e}()).\u0275mod=r.Pb({type:ge}),ge.\u0275inj=r.Ob({factory:function(e){return new(e||ge)(r.bc(ge,12))},imports:[[]]}),ge),_e=new r.s("routeServiceOptions"),Me=((pe=function(){function e(t,i){_classCallCheck(this,e),this.route=t,this.options=Object.assign({},{centerKey:"center",zoomKey:"zoom",projectionKey:"projection",contextKey:"context",searchKey:"search",visibleOnLayersKey:"visiblelayers",visibleOffLayersKey:"invisiblelayers",directionsCoordKey:"routing",toolKey:"tool",wmsUrlKey:"wmsUrl",wmsLayersKey:"wmsLayers",wmtsUrlKey:"wmtsUrl",wmtsLayersKey:"wmtsLayers",vectorKey:"vector"},i)}return _createClass(e,[{key:"queryParams",get:function(){return this.route.queryParams}}]),e}()).\u0275fac=function(e){return new(e||pe)(r.bc(f.a),r.bc(_e,8))},pe.\u0275prov=Object(r.Nb)({factory:function(){return new pe(Object(r.bc)(f.a),Object(r.bc)(_e,8))},token:pe,providedIn:"root"}),pe),De=function(e){return e.Mobile="mobile",e.Tablet="tablet",e.Desktop="desktop",e}({}),Pe=function(e){return e.Portrait="portrait",e.Landscape="landscape",e}({}),Ae=((ve=function(){function e(t){var i=this;_classCallCheck(this,e),this.media$=new L.a(void 0),this.orientation$=new L.a(void 0),t.observe([K.b.HandsetLandscape]).subscribe((function(e){e.matches&&(i.media$.next(De.Mobile),i.orientation$.next(Pe.Landscape))})),t.observe([K.b.HandsetPortrait]).subscribe((function(e){e.matches&&(i.media$.next(De.Mobile),i.orientation$.next(Pe.Portrait))})),t.observe([K.b.TabletLandscape]).subscribe((function(e){e.matches&&(i.media$.next(De.Tablet),i.orientation$.next(Pe.Landscape))})),t.observe([K.b.TabletPortrait]).subscribe((function(e){e.matches&&(i.media$.next(De.Tablet),i.orientation$.next(Pe.Portrait))})),t.observe([K.b.WebLandscape]).subscribe((function(e){e.matches&&(i.media$.next(De.Desktop),i.orientation$.next(Pe.Landscape))})),t.observe([K.b.WebPortrait]).subscribe((function(e){e.matches&&(i.media$.next(De.Desktop),i.orientation$.next(Pe.Portrait))}))}return _createClass(e,[{key:"getMedia",value:function(){return this.media$.value}},{key:"getOrientation",value:function(){return this.orientation$.value}},{key:"isTouchScreen",value:function(){return"ontouchstart"in document.documentElement}},{key:"isMobile",value:function(){return"mobile"===this.getMedia()}}]),e}()).\u0275fac=function(e){return new(e||ve)(r.bc(K.a))},ve.\u0275prov=Object(r.Nb)({factory:function(){return new ve(Object(r.bc)(K.a))},token:ve,providedIn:"root"}),ve),je=function(e){return e.SESSION="Session",e.LOCAL="Local",e}({}),Re=function(e){return e.ADDED="Added",e.MODIFIED="Modified",e.REMOVED="Removed",e}({}),$e=((ke=function(){function e(t){_classCallCheck(this,e),this.config=t,this.storageChange$=new L.a(void 0),this.options=this.config.getConfig("storage")||{key:"igo"}}return _createClass(e,[{key:"get",value:function(e,t){var i;if(t&&t!==je.SESSION||(i=sessionStorage.getItem("".concat(this.options.key,".").concat(e))),t!==je.LOCAL&&(i||t)||(i=localStorage.getItem("".concat(this.options.key,".").concat(e))),i)try{i=JSON.parse(i)}catch(o){i=i}return i}},{key:"set",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:je.LOCAL,o=this.get(e,i);i===je.SESSION?sessionStorage.setItem("".concat(this.options.key,".").concat(e),JSON.stringify(t)):localStorage.setItem("".concat(this.options.key,".").concat(e),JSON.stringify(t));var n=this.get(e,i);n!==o&&this.storageChange$.next({key:e,scope:i,event:void 0!==o?Re.MODIFIED:Re.ADDED,previousValue:o,currentValue:n})}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:je.LOCAL,i=this.get(e,t);t===je.SESSION?sessionStorage.removeItem("".concat(this.options.key,".").concat(e)):localStorage.removeItem("".concat(this.options.key,".").concat(e)),this.storageChange$.next({key:e,scope:t,event:Re.REMOVED,previousValue:i})}}]),e}()).\u0275fac=function(e){return new(e||ke)(r.bc(ie))},ke.\u0275prov=Object(r.Nb)({factory:function(){return new ke(Object(r.bc)(ie))},token:ke,providedIn:"root"}),ke),Ee=((ye=function(){function e(t,i){_classCallCheck(this,e),this.messageService=t,this.injector=i,this.stateChangeEventEmitter=new r.o,this.state={connection:window.navigator.onLine},this.checkNetworkState()}return _createClass(e,[{key:"checkNetworkState",value:function(){var e=this;this.onlineSubscription=Object(M.a)(window,"online").subscribe((function(){var t=e.injector.get(Le).translate,i=t.instant("igo.core.network.online.message"),o=t.instant("igo.core.network.online.title");e.messageService.info(i,o),e.state.connection=!0,e.emitEvent()})),this.offlineSubscription=Object(M.a)(window,"offline").subscribe((function(){var t=e.injector.get(Le).translate,i=t.instant("igo.core.network.offline.message"),o=t.instant("igo.core.network.offline.title");e.messageService.info(i,o),e.state.connection=!1,e.emitEvent()}))}},{key:"emitEvent",value:function(){this.stateChangeEventEmitter.emit(this.state)}},{key:"ngOnDestroy",value:function(){try{this.offlineSubscription.unsubscribe(),this.onlineSubscription.unsubscribe()}catch(e){}}},{key:"currentState",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.stateChangeEventEmitter.pipe(Object(O.a)(300),Object(I.a)(this.state)):this.stateChangeEventEmitter.pipe(Object(O.a)(300))}}]),e}()).\u0275fac=function(e){return new(e||ye)(r.bc(Ie),r.bc(r.t))},ye.\u0275prov=Object(r.Nb)({factory:function(){return new ye(Object(r.bc)(Ie),Object(r.bc)(r.p))},token:ye,providedIn:"root"}),ye),We=i("Njdo"),Xe=i.n(We),Ge=i("jtHE"),Be=i("7+OI"),Ve=i("HDdC"),Ne=i("VRyK"),ze=i("zP0r"),qe=i("pLZG"),He=i("IzEk"),Ue=i("eIep"),Ye=i("5QHs"),Ke=i("OaSA"),Ze=i("8Qe2"),Je=i("iELJ"),Qe=i("1z/I"),et=i("e6WT"),tt=i("s7LF"),it=i("Q2Ze"),ot=i("ZTz/"),nt=i("mrSG"),rt=i("LUZP"),at=i("ZpRC"),st=i("jYiU"),ct=i("pu8Q"),lt=i("CtHx"),ut=i("GXRp"),ht=i("GS7A"),dt=i("UhP/"),pt=i("1O3W");function gt(e,t){if(1&e&&(r.Xb(0,"mat-option",4),r.Ic(1),r.Wb()),2&e){var i=r.ic();r.oc("value",i.emptyValue),r.Db(1),r.Jc(i.emptyText)}}function ft(e,t){if(1&e&&(r.Xb(0,"mat-option",4),r.Ic(1),r.jc(2,"async"),r.Wb()),2&e){var i=r.ic();r.oc("value",i.multiSelectValue),r.Db(1),r.Jc(r.kc(2,2,i.multiText$))}}function mt(e,t){if(1&e&&(r.Xb(0,"mat-option",4),r.Ic(1),r.Wb()),2&e){var i=t.$implicit,o=r.ic();r.oc("value",i.entity),r.Db(1),r.Kc(" ",o.titleAccessor(i.entity)," ")}}function bt(e,t){if(1&e){var i=r.Yb();r.Vb(0),r.Xb(1,"mat-checkbox",11),r.ec("change",(function(e){return r.yc(i),r.ic(3).onToggleRows(e.checked)})),r.Wb(),r.Ub()}if(2&e){var o=t.ngIf,n=r.ic(3);r.Db(1),r.oc("checked",o===n.entityTableSelectionState.All)("indeterminate",o===n.entityTableSelectionState.Some)}}function vt(e,t){if(1&e&&(r.Vb(0),r.Gc(1,bt,2,2,"ng-container",10),r.jc(2,"async"),r.Ub()),2&e){var i=r.ic(2);r.Db(1),r.oc("ngIf",r.kc(2,1,i.selectionState$))}}function yt(e,t){if(1&e&&(r.Xb(0,"th",9),r.Gc(1,vt,3,3,"ng-container",10),r.Wb()),2&e){var i=r.ic();r.Db(1),r.oc("ngIf",i.selectMany)}}function kt(e,t){if(1&e){var i=r.Yb();r.Xb(0,"td",12),r.Xb(1,"mat-checkbox",13),r.ec("mousedown",(function(e){return r.yc(i),e.shiftKey?e.preventDefault():null}))("click",(function(e){r.yc(i);var o=t.$implicit,n=r.ic();return e.shiftKey?n.onShiftToggleRow(!n.rowIsSelected(o),o,e):e.stopPropagation()}))("change",(function(e){r.yc(i);var o=t.$implicit;return r.ic().onToggleRow(e.checked,o)})),r.Wb(),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic();r.Db(1),r.oc("checked",n.rowIsSelected(o))}}function St(e,t){if(1&e&&(r.Xb(0,"th",16),r.Ic(1),r.Wb()),2&e){var i=r.ic(2).$implicit;r.Db(1),r.Kc(" ",i.title," ")}}function Ct(e,t){1&e&&(r.Vb(0),r.Gc(1,St,2,1,"th",15),r.Ub())}function wt(e,t){if(1&e&&(r.Xb(0,"th",9),r.Ic(1),r.Wb()),2&e){var i=r.ic(2).$implicit;r.Db(1),r.Kc(" ",i.title," ")}}function xt(e,t){1&e&&(r.Vb(0),r.Gc(1,wt,2,1,"th",3),r.Ub())}function Ot(e,t){if(1&e&&(r.Xb(0,"td",18),r.Ic(1),r.Wb()),2&e){var i=t.$implicit,o=r.ic(3).$implicit,n=r.ic();r.oc("ngClass",n.getCellClass(i,o)),r.Db(1),r.Kc(" ",n.getValue(i,o)," ")}}function It(e,t){1&e&&(r.Vb(0),r.Gc(1,Ot,2,2,"td",17),r.Ub())}function Lt(e,t){if(1&e&&r.Sb(0,"td",20),2&e){var i=t.$implicit,o=r.ic(3).$implicit,n=r.ic();r.oc("ngClass",n.getCellClass(i,o))("innerHTML",n.getValue(i,o),r.zc)}}function Tt(e,t){1&e&&(r.Vb(0),r.Gc(1,Lt,1,2,"td",19),r.Ub())}function Ft(e,t){if(1&e&&(r.Sb(0,"td",20),r.jc(1,"sanitizeHtml")),2&e){var i=t.$implicit,o=r.ic(3).$implicit,n=r.ic();r.oc("ngClass",n.getCellClass(i,o))("innerHTML",r.kc(1,2,n.getValue(i,o)),r.zc)}}function _t(e,t){1&e&&(r.Vb(0),r.Gc(1,Ft,2,4,"td",19),r.Ub())}function Mt(e,t){if(1&e&&(r.Xb(0,"td",18),r.Sb(1,"mat-icon",21),r.Wb()),2&e){var i=t.$implicit,o=r.ic(3).$implicit,n=r.ic();r.oc("ngClass",n.getCellClass(i,o)),r.Db(1),r.pc("svgIcon",n.getValue(i,o))}}function Dt(e,t){1&e&&(r.Vb(0),r.Gc(1,Mt,2,2,"td",17),r.Ub())}function Pt(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",25),r.ec("click",(function(){r.yc(i);var e=r.ic().$implicit,t=r.ic().$implicit;return r.ic(4).onButtonClick(e.click,t)})),r.Sb(1,"mat-icon",21),r.Wb()}if(2&e){var o=r.ic().$implicit;r.oc("color",o.color),r.Db(1),r.pc("svgIcon",o.icon)}}function At(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",26),r.ec("click",(function(){r.yc(i);var e=r.ic().$implicit,t=r.ic().$implicit;return r.ic(4).onButtonClick(e.click,t)})),r.Sb(1,"mat-icon",21),r.Wb()}if(2&e){var o=r.ic().$implicit;r.oc("color",o.color),r.Db(1),r.pc("svgIcon",o.icon)}}function jt(e,t){if(1&e&&(r.Xb(0,"span"),r.Gc(1,Pt,2,2,"button",23),r.Gc(2,At,2,2,"button",24),r.Wb()),2&e){var i=t.$implicit;r.Db(1),r.oc("ngIf","mat-icon-button"===i.style),r.Db(1),r.oc("ngIf","mat-icon-button"!==i.style)}}function Rt(e,t){if(1&e&&(r.Xb(0,"td",18),r.Gc(1,jt,3,2,"span",22),r.Wb()),2&e){var i=t.$implicit,o=r.ic(3).$implicit,n=r.ic();r.oc("ngClass",n.getCellClass(i,o)),r.Db(1),r.oc("ngForOf",n.getValue(i,o))}}function $t(e,t){1&e&&(r.Vb(0),r.Gc(1,Rt,2,2,"td",17),r.Ub())}function Et(e,t){if(1&e&&(r.Vb(0),r.Gc(1,It,2,0,"ng-container",10),r.Gc(2,Tt,2,0,"ng-container",10),r.Gc(3,_t,2,0,"ng-container",10),r.Gc(4,Dt,2,0,"ng-container",10),r.Gc(5,$t,2,0,"ng-container",10),r.Ub()),2&e){var i=t.ngIf,o=r.ic(2);r.Db(1),r.oc("ngIf",i===o.entityTableColumnRenderer.Default),r.Db(1),r.oc("ngIf",i===o.entityTableColumnRenderer.HTML),r.Db(1),r.oc("ngIf",i===o.entityTableColumnRenderer.UnsanitizedHTML),r.Db(1),r.oc("ngIf",i===o.entityTableColumnRenderer.Icon),r.Db(1),r.oc("ngIf",i===o.entityTableColumnRenderer.ButtonGroup)}}function Wt(e,t){if(1&e&&(r.Vb(0,14),r.Gc(1,Ct,2,0,"ng-container",10),r.Gc(2,xt,2,0,"ng-container",10),r.Gc(3,Et,6,5,"ng-container",10),r.Ub()),2&e){var i=t.$implicit,o=r.ic();r.oc("matColumnDef",i.name),r.Db(1),r.oc("ngIf",o.columnIsSortable(i)),r.Db(1),r.oc("ngIf",!o.columnIsSortable(i)),r.Db(1),r.oc("ngIf",o.getColumnRenderer(i))}}function Xt(e,t){if(1&e&&r.Sb(0,"tr",27),2&e){var i=r.ic();r.oc("ngClass",i.getHeaderClass())}}function Gt(e,t){if(1&e){var i=r.Yb();r.Xb(0,"tr",28),r.ec("select",(function(){r.yc(i);var e=t.$implicit;return r.ic().onRowSelect(e)}))("click",(function(){r.yc(i);var e=t.$implicit;return r.ic().onRowClick(e)})),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic();r.oc("scrollBehavior",n.scrollBehavior)("ngClass",n.getRowClass(o))("selection",n.selection)("selected",n.rowIsSelected(o))}}function Bt(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-entity-table-paginator",29),r.ec("paginatorChange",(function(e){return r.yc(i),r.ic().paginatorChange(e)})),r.Wb()}if(2&e){var o=r.ic();r.oc("store",o.store)("paginatorOptions",o.paginatorOptions)("entitySortChange$",o.entitySortChange$)}}function Vt(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",5),r.Xb(1,"button",6),r.ec("click",(function(){return r.yc(i),r.ic(2).scrollUp()})),r.jc(2,"translate"),r.Sb(3,"mat-icon",7),r.Wb(),r.Wb()}2&e&&(r.Db(1),r.oc("matTooltip",r.kc(2,1,"igo.common.actionbar.scrollUp")))}function Nt(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-actionbar-item",8),r.ec("trigger",(function(){r.yc(i);var e=r.ic(2);return e.onTriggerAction(e.toggleCollapseAction)})),r.Wb()}if(2&e){var o=r.ic(2);r.oc("withTitle",!1)("withIcon",!0)("color",o.color)("disabled",o.store.view.empty)("action",o.toggleCollapseAction)}}function zt(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-actionbar-item",11),r.ec("trigger",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).onTriggerAction(e)})),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic(3);r.oc("withTitle",n.withTitle)("withIcon",n.withIcon)("withTooltip",n.withTooltip)("color",n.color)("disabled",n.store.state.get(o).disabled)("action",o)}}function qt(e,t){if(1&e&&(r.Gc(0,zt,1,6,"ng-template",9,10,r.Hc),r.jc(2,"async")),2&e){var i=r.ic(2);r.oc("ngForOf",r.kc(2,1,i.store.view.all$()))}}function Ht(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",12),r.Xb(1,"button",6),r.ec("click",(function(){return r.yc(i),r.ic(2).scrollDown()})),r.jc(2,"translate"),r.Sb(3,"mat-icon",13),r.Wb(),r.Wb()}2&e&&(r.Db(1),r.oc("matTooltip",r.kc(2,1,"igo.common.actionbar.scrollDown")))}function Ut(e,t){if(1&e&&(r.Xb(0,"mat-list"),r.Gc(1,Vt,4,3,"div",2),r.Gc(2,Nt,1,5,"igo-actionbar-item",3),r.Gc(3,qt,3,3,void 0,0),r.Gc(4,Ht,4,3,"div",4),r.Wb()),2&e){var i=r.ic();r.Db(1),r.oc("ngIf",i.heightCondition&&i.positionConditionTop&&i.isDesktop),r.Db(1),r.oc("ngIf",i.withToggleButton),r.Db(1),r.oc("ngIf",!i.collapsed),r.Db(1),r.oc("ngIf",i.heightCondition&&i.positionConditionLow&&i.isDesktop)}}function Yt(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-actionbar-item",18),r.ec("trigger",(function(){r.yc(i);var e=t.$implicit;return r.ic(2).onTriggerAction(e)})),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic(2);r.oc("withTitle",n.withTitle)("withIcon",n.withIcon)("color",n.color)("action",o)}}function Kt(e,t){if(1&e&&(r.Xb(0,"div"),r.Xb(1,"button",14),r.Sb(2,"mat-icon",15),r.Wb(),r.Xb(3,"mat-menu",16,17),r.Xb(5,"mat-list"),r.Gc(6,Yt,1,4,"ng-template",9),r.jc(7,"async"),r.Wb(),r.Wb(),r.Wb()),2&e){var i=r.vc(4),o=r.ic();r.Db(1),r.oc("matMenuTriggerFor",i)("disabled",o.store.view.empty)("color",o.iconColor),r.Db(1),r.oc("svgIcon",o.icon),r.Db(1),r.Fb(o.overlayClass),r.oc("xPosition",o.xPosition)("yPosition",o.yPosition),r.Db(3),r.oc("ngForOf",r.kc(7,9,o.store.view.all$()))}}function Zt(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-actionbar-item",18),r.ec("trigger",(function(){r.yc(i);var e=t.$implicit;return r.ic(2).onTriggerAction(e)})),r.Wb(),r.Sb(1,"br")}if(2&e){var o=t.$implicit,n=r.ic(2);r.oc("withTitle",n.withTitle)("withIcon",n.withIcon)("color",n.color)("action",o)}}function Jt(e,t){if(1&e&&(r.Xb(0,"mat-card",19),r.Xb(1,"mat-list"),r.Gc(2,Zt,2,4,"ng-template",9),r.jc(3,"async"),r.Wb(),r.Wb()),2&e){var i=r.ic();r.Db(2),r.oc("ngForOf",r.kc(3,1,i.store.view.all$()))}}function Qt(e,t){if(1&e&&(r.Sb(0,"mat-icon",7),r.jc(1,"async")),2&e){var i=r.ic(3);r.pc("svgIcon",r.kc(1,1,i.icon$))}}function ei(e,t){if(1&e&&(r.Xb(0,"button",5),r.jc(1,"async"),r.Gc(2,Qt,2,3,"mat-icon",6),r.Wb()),2&e){var i=r.ic(2);r.oc("color",i.color)("disabled",r.kc(1,3,i.disabled$)),r.Db(2),r.oc("ngIf",i.withIcon)}}function ti(e,t){if(1&e&&(r.Xb(0,"h4",8),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e){var i=r.ic(2);r.Db(1),r.Jc(r.kc(2,1,i.title))}}function ii(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-list-item",2),r.ec("click",(function(){return r.yc(i),r.ic().onClick()})),r.jc(1,"translate"),r.jc(2,"async"),r.jc(3,"async"),r.Gc(4,ei,3,5,"button",3),r.Gc(5,ti,3,3,"h4",4),r.Wb()}if(2&e){var o=r.ic();r.oc("matTooltip",o.withTooltip?r.kc(1,4,r.kc(2,6,o.tooltip$)||o.title):"")("ngClass",r.kc(3,8,o.ngClass$)),r.Db(4),r.oc("ngIf",o.withIcon),r.Db(1),r.oc("ngIf",o.withTitle)}}function oi(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-checkbox",11),r.ec("change",(function(){return r.yc(i),r.ic(2).action.handler()})),r.jc(1,"async"),r.Ic(2),r.jc(3,"translate"),r.Wb()}if(2&e){var o=r.ic(2);r.oc("checked",r.kc(1,2,o.checkCondition$)),r.Db(2),r.Kc(" ",r.kc(3,4,o.title)," ")}}function ni(e,t){if(1&e&&(r.Xb(0,"mat-list-item",9),r.jc(1,"translate"),r.jc(2,"async"),r.jc(3,"async"),r.Gc(4,oi,4,6,"mat-checkbox",10),r.Wb()),2&e){var i=r.ic();r.oc("matTooltip",i.withTooltip?r.kc(1,3,r.kc(2,5,i.tooltip$)||i.title):"")("ngClass",r.kc(3,7,i.ngClass$)),r.Db(4),r.oc("ngIf",i.withTitle)}}var ri=["*"],ai=["target"];function si(e,t){}var ci=["buttons"],li=["*",[["","formButtons",""]]],ui=function(e){return{"igo-form-body-with-buttons":e}},hi=["*","[formButtons]"];function di(e,t){if(1&e&&(r.Vb(0),r.Sb(1,"igo-dynamic-outlet",1),r.Ub()),2&e){var i=r.ic();r.Db(1),r.oc("component",i.getFieldComponent())("inputs",i.getFieldInputs())("subscribers",i.getFieldSubscribers())}}function pi(e,t){if(1&e&&(r.Xb(0,"div",5),r.Sb(1,"igo-form-field",6),r.Wb()),2&e){var i=t.$implicit,o=r.ic(2);r.oc("ngClass",o.getFieldNgClass(i)),r.Db(1),r.oc("field",i)}}function gi(e,t){if(1&e&&(r.Xb(0,"div",3),r.Gc(1,pi,2,2,"div",4),r.Wb()),2&e){var i=r.ic();r.Db(1),r.oc("ngForOf",i.group.fields)}}function fi(e,t){if(1&e&&(r.Xb(0,"mat-error"),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e){var i=r.ic();r.Db(1),r.Jc(r.kc(2,1,i.getErrorMessage()))}}function mi(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",1),r.ec("click",(function(){return r.yc(i),r.ic().startInteractiveTour()})),r.Xb(1,"span",2),r.Ic(2),r.jc(3,"translate"),r.jc(4,"translate"),r.jc(5,"async"),r.Wb(),r.Sb(6,"mat-icon",3),r.jc(7,"translate"),r.jc(8,"translate"),r.Wb()}if(2&e){var o=r.ic();r.oc("ngClass",o.getClass())("disabled",o.disabledTourButton),r.Db(2),r.Lc("",r.kc(3,5,"igo.common.interactiveTour.buttonTitle")," ",r.kc(4,7,r.kc(5,9,o.discoverTitleInLocale$)),""),r.Db(4),r.oc("matTooltip",o.disabledTourButton?r.kc(7,11,"igo.common.interactiveTour.disaledTooltipTourToolButton"):r.kc(8,13,"igo.common.interactiveTour.tooltipTourToolButton"))}}var bi=function(e){return{selectable:e}};function vi(e,t){if(1&e&&(r.Xb(0,"div",2),r.Xb(1,"h3"),r.mc(2,1),r.Xb(3,"div",3),r.Ic(4),r.mc(5,2),r.Wb(),r.mc(6,3),r.Wb(),r.Wb()),2&e){var i=r.ic();r.Db(4),r.Kc(" ",i.title," ")}}var yi=["*",[["","panelLeftButton",""]],[["","panelHeader",""]],[["","panelRightButton",""]]],ki=["*","[panelLeftButton]","[panelHeader]","[panelRightButton]"],Si=function(e){return{"igo-spinner-container":!0,"igo-spinner-shown":e}},Ci=["filter"];function wi(e,t){1&e&&(r.Xb(0,"div",12),r.Xb(1,"mat-form-field",13),r.Sb(2,"input",14,15),r.jc(4,"translate"),r.Wb(),r.Wb()),2&e&&(r.Db(2),r.oc("placeholder",r.kc(4,1,"igo.common.table.filter")))}function xi(e,t){if(1&e){var i=r.Yb();r.Xb(0,"th",16),r.Xb(1,"mat-checkbox",17),r.ec("change",(function(e){r.yc(i);var t=r.ic();return e?t.masterToggle():null})),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(1),r.oc("checked",o.selection.hasValue()&&o.isAllSelected())("indeterminate",o.selection.hasValue()&&!o.isAllSelected())}}function Oi(e,t){if(1&e){var i=r.Yb();r.Xb(0,"td",18),r.Xb(1,"mat-checkbox",19),r.ec("click",(function(e){return r.yc(i),e.stopPropagation()}))("change",(function(e){r.yc(i);var o=t.$implicit,n=r.ic();return e?n.selection.toggle(o):null})),r.Wb(),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic();r.Db(1),r.oc("checked",n.selection.isSelected(o))}}function Ii(e,t){if(1&e&&(r.Xb(0,"th",25),r.Ic(1),r.Wb()),2&e){var i=r.ic(2).$implicit;r.Db(1),r.Kc(" ",i.title," ")}}function Li(e,t){1&e&&(r.Vb(0),r.Gc(1,Ii,2,1,"th",24),r.Ub())}function Ti(e,t){if(1&e&&(r.Xb(0,"th",16),r.Ic(1),r.Wb()),2&e){var i=r.ic(2).$implicit;r.Db(1),r.Kc(" ",i.title," ")}}function Fi(e,t){1&e&&(r.Vb(0),r.Gc(1,Ti,2,1,"th",6),r.Ub())}var _i=function(){return{}};function Mi(e,t){if(1&e&&(r.Xb(0,"td",27),r.Ic(1),r.Wb()),2&e){var i=t.$implicit,o=r.ic(2).$implicit,n=r.ic();r.oc("ngClass",n.model.cellClassFunc?n.model.cellClassFunc(i,o):r.qc(2,_i)),r.Db(1),r.Kc(" ",n.getValue(i,o.name)," ")}}function Di(e,t){1&e&&(r.Vb(0),r.Gc(1,Mi,2,3,"td",26),r.Ub())}function Pi(e,t){if(1&e&&r.Sb(0,"td",29),2&e){var i=t.$implicit,o=r.ic(2).$implicit,n=r.ic();r.oc("ngClass",n.model.cellClassFunc?n.model.cellClassFunc(i,o):r.qc(2,_i))("innerHTML",n.getValue(i,o.name),r.zc)}}function Ai(e,t){1&e&&r.Gc(0,Pi,1,3,"td",28)}function ji(e,t){if(1&e&&(r.Vb(0,20),r.Gc(1,Li,2,0,"ng-container",21),r.Gc(2,Fi,2,0,"ng-container",21),r.Gc(3,Di,2,0,"ng-container",22),r.Gc(4,Ai,1,0,"ng-template",null,23,r.Hc),r.Ub()),2&e){var i=t.$implicit,o=r.vc(5);r.oc("matColumnDef",i.name),r.Db(1),r.oc("ngIf",i.sortable),r.Db(1),r.oc("ngIf",!i.sortable),r.Db(1),r.oc("ngIf",!i.html)("ngIfElse",o)}}function Ri(e,t){1&e&&r.Sb(0,"th",16)}function $i(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",31),r.ec("click",(function(e){r.yc(i);var o=t.$implicit,n=r.ic().$implicit;return r.ic().handleClickAction(e,o,n)})),r.Sb(1,"mat-icon",32),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic(2);r.oc("color",n.getActionColor(o.color)),r.Db(1),r.pc("svgIcon",o.icon)}}function Ei(e,t){if(1&e&&(r.Xb(0,"td",18),r.Gc(1,$i,2,2,"button",30),r.Wb()),2&e){var i=r.ic();r.Db(1),r.oc("ngForOf",i.model.actions)}}function Wi(e,t){1&e&&r.Sb(0,"tr",33)}function Xi(e,t){if(1&e){var i=r.Yb();r.Xb(0,"tr",34),r.ec("click",(function(){r.yc(i);var e=t.$implicit;return r.ic().selection.toggle(e)})),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic();r.oc("ngClass",n.model.rowClassFunc?n.model.rowClassFunc(o):r.qc(1,_i))}}function Gi(e,t){if(1&e&&(r.Sb(0,"igo-actionbar",2),r.jc(1,"async"),r.jc(2,"async"),r.jc(3,"async")),2&e){var i=r.ic();r.oc("store",i.actionStore)("withIcon",!0)("withTitle",r.kc(1,6,i.toolbarWithTitle$))("withTooltip",!r.kc(2,8,i.toolbarWithTitle$))("scrollActive",r.kc(3,10,i.toolbarWithTitle$))("horizontal",!1)}}var Bi=function(e,t){return{"igo-tool-container-with-toolbar":e,"igo-tool-container-with-animation":t}};function Vi(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",3),r.ec("@toolSlideInOut.start",(function(){return r.yc(i),r.ic().onAnimationStart()}))("@toolSlideInOut.done",(function(){return r.yc(i),r.ic().onAnimationComplete()})),r.jc(1,"async"),r.Sb(2,"igo-dynamic-outlet",4),r.Wb()}if(2&e){var o=t.ngIf,n=r.ic();r.oc("ngClass",r.sc(6,Bi,!n.actionStore.empty,n.animate))("@toolSlideInOut",r.kc(1,4,n.animation$)),r.Db(2),r.oc("component",o.component)("inputs",n.getToolInputs(o))}}function Ni(e,t){if(1&e&&r.Sb(0,"igo-dynamic-outlet",1),2&e){var i=r.ic();r.oc("component",i.widget)("inputs",i.inputs)("subscribers",i.getEffectiveSubscribers())}}function zi(e,t){if(1&e){var i=r.Yb();r.Vb(0),r.Xb(1,"igo-widget-outlet",1),r.ec("cancel",(function(){r.yc(i);var e=t.ngIf;return r.ic().onWidgetCancel(e)}))("complete",(function(){r.yc(i);var e=t.ngIf;return r.ic().onWidgetComplete(e)})),r.jc(2,"async"),r.jc(3,"async"),r.Wb(),r.Ub()}if(2&e){var o=t.ngIf,n=r.ic();r.Db(1),r.oc("widget",o)("inputs",r.kc(2,3,n.widgetInputs$))("subscribers",r.kc(3,5,n.widgetSubscribers$))}}var qi=function(e){return e.Default="Default",e.HTML="HTML",e.UnsanitizedHTML="UnsanitizedHTML",e.Icon="Icon",e.ButtonGroup="ButtonGroup",e}({}),Hi=function(e){return e.Auto="auto",e.Instant="instant",e.Smooth="smooth",e}({}),Ui=function(e){return e.None="None",e.All="All",e.Some="Some",e}({});function Yi(e,t){return Xe()(e,t).safeObject}function Ki(e){var t=e.meta||{};return t.id?t.id:Yi(e,t.idProperty||"id")}function Zi(e){var t=e.meta||{};return t.title?t.title:Yi(e,t.titleProperty||"title")}function Ji(e){var t=e.meta||{};return t.icon?t.icon:Yi(e,t.iconProperty||"icon")}var Qi,eo,to,io,oo,no,ro,ao,so,co,lo,uo,ho,po,go,fo,mo,bo,vo,yo,ko,So,Co,wo,xo,Oo,Io,Lo,To,Fo,_o,Mo,Do,Po,Ao,jo,Ro,$o,Eo,Wo,Xo,Go,Bo,Vo,No,zo,qo,Ho,Uo,Yo,Ko,Zo,Jo,Qo,en,tn,on,nn,rn,an,sn,cn,ln=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.index=new Map,this.change$=new Ge.a(1),this.store=t.store?t.store:void 0,this.getKey=t.getKey?t.getKey:this.store?this.store.getKey:Ki,this.next()}return _createClass(e,[{key:"clear",value:function(){this.index.size>0&&(this.index.clear(),this.next())}},{key:"get",value:function(e){return this.index.get(this.getKey(e))||{}}},{key:"set",value:function(e,t){this.setMany([e],t)}},{key:"setMany",value:function(e,t){var i=this;e.forEach((function(e){i.index.set(i.getKey(e),Object.assign({},t))})),this.next()}},{key:"setAll",value:function(e){var t=this;Array.from(this.index.keys()).forEach((function(i){t.index.set(i,Object.assign({},e))})),this.next()}},{key:"update",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.updateMany([e],t,i)}},{key:"updateMany",value:function(e,t){var i=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!0===o)return this.updateManyExclusive(e,t);e.forEach((function(e){var o=Object.assign({},i.get(e),t);i.index.set(i.getKey(e),o)})),this.next()}},{key:"reverse",value:function(e,t){this.reverseMany([e],t)}},{key:"reverseMany",value:function(e,t){var i=this;e.forEach((function(e){var o=i.get(e),n=t.reduce((function(e,t){return e[t]=o[t]||!1,e}),{}),r=i.reverseChanges(n),a=Object.assign({},o,r);i.index.set(i.getKey(e),a)})),this.next()}},{key:"updateAll",value:function(e){var t=this,i=this.getAllKeys();Array.from(i).forEach((function(i){var o=Object.assign({},t.index.get(i),e);t.index.set(i,o)})),this.next()}},{key:"updateManyExclusive",value:function(e,t){var i=this,o=this.reverseChanges(t),n=e.map((function(e){return i.getKey(e)}));new Set(n.concat(Array.from(this.getAllKeys()))).forEach((function(e){var r=i.index.get(e)||{};n.indexOf(e)>=0?i.index.set(e,Object.assign({},r,t)):!0===Object.keys(o).some((function(e){return void 0!==r[e]&&r[e]!==o[e]}))&&i.index.set(e,Object.assign({},r,o))})),this.next()}},{key:"reverseChanges",value:function(e){return Object.entries(e).reduce((function(e,t){var i=_slicedToArray(t,2),o=i[0],n=i[1];return"boolean"==typeof n&&(e[o]=!n),e}),{})}},{key:"getAllKeys",value:function(){var e=this.store?Array.from(this.store.index.keys()):[];return new Set(Array.from(this.index.keys()).concat(e))}},{key:"next",value:function(){this.change$.next()}}]),e}(),un=function(){function e(t){_classCallCheck(this,e),this.source$=t,this.values$=new L.a([]),this.lifted=!1,this.joins=[],this.filter$=new L.a(void 0),this.filters$=new L.a([]),this.filterIndex=new Map,this.sort$=new L.a(void 0),this.getKey$=new L.a(void 0),this.count$=new L.a(0),this.empty$=new L.a(!0)}return _createClass(e,[{key:"get",value:function(e){if(void 0===this._index)throw new Error("This view has no index, therefore, this method is unavailable.");return this.index.get(e)}},{key:"all",value:function(){return this.values$.value}},{key:"all$",value:function(){return this.values$}},{key:"firstBy",value:function(e){return this.values$.value.find(e)}},{key:"firstBy$",value:function(e){return this.values$.pipe(Object(w.a)((function(t){return t.find(e)})))}},{key:"manyBy",value:function(e){return this.values$.value.filter(e)}},{key:"manyBy$",value:function(e){return this.values$.pipe(Object(w.a)((function(t){return t.filter(e)})))}},{key:"clear",value:function(){this.filter(void 0),this.sort(void 0)}},{key:"destroy",value:function(){void 0!==this.values$$&&this.values$$.unsubscribe(),this.clear()}},{key:"createIndex",value:function(e){return this._index=new Map,this.getKey$.next(e),this}},{key:"join",value:function(e){if(!0===this.lifted)throw new Error("This view has already been lifted, therefore, no join is allowed.");return this.joins.push(e),this}},{key:"filter",value:function(e){return this.filter$.next(e),this}},{key:"addFilter",value:function(e){var t=G();return this.filterIndex.set(t,e),this.filters$.next(Array.from(this.filterIndex.values())),t}},{key:"removeFilter",value:function(e){this.filterIndex.delete(e),this.filters$.next(Array.from(this.filterIndex.values()))}},{key:"sort",value:function(e){return this.sort$.next(e),this}},{key:"lift",value:function(){var e=this;this.lifted=!0;var t=[this.joins.length>0?this.liftJoinedSource():this.liftSource(),this.filters$,this.filter$,this.sort$,this.getKey$];this.values$$=Object(_.a)(t).pipe(Object(ze.a)(1),Object(O.a)(5)).subscribe((function(t){var i=_slicedToArray(t,5),o=i[0],n=i[1],r=i[2],a=i[3],s=i[4],c=e.processValues(o,n,r,a);e.setValues(c,void 0!==s)}))}},{key:"liftSource",value:function(){return this.source$}},{key:"liftJoinedSource",value:function(){var e=this,t=[this.source$,Object(_.a)(this.joins.map((function(e){return e.source})))];return Object(_.a)(t).pipe(Object(w.a)((function(t){var i=_slicedToArray(t,2),o=i[0],n=i[1];return o.reduce((function(t,i){var o=e.computeJoinedValue(i,n);return void 0!==o&&t.push(o),t}),[])})))}},{key:"computeJoinedValue",value:function(e,t){for(var i=e,o=0;void 0!==i&&o<this.joins.length;)i=this.joins[o].reduce(i,t[o]),o+=1;return i}},{key:"processValues",value:function(e,t,i,o){return e=e.slice(0),e=this.filterValues(e,t.concat([i])),this.sortValues(e,o)}},{key:"filterValues",value:function(e,t){return 0===t.length?e:e.filter((function(e){return t.filter((function(e){return void 0!==e})).every((function(t){return t(e)}))}))}},{key:"sortValues",value:function(e,t){return void 0===t?e:e.sort((function(e,i){return E.naturalCompare(t.valueAccessor(e),t.valueAccessor(i),t.direction,t.nullsFirst)}))}},{key:"setValues",value:function(e,t){!0===t&&(this._index=this.generateIndex(e)),this.values$.next(e);var i=e.length,o=0===i;this.count$.next(i),this.empty$.next(o)}},{key:"generateIndex",value:function(e){var t=this,i=e.map((function(e){return[t.getKey(e),e]}));return new Map(i)}},{key:"getKey",get:function(){return this.getKey$.value}},{key:"count",get:function(){return this.count$.value}},{key:"empty",get:function(){return this.empty$.value}},{key:"index",get:function(){return this._index}}]),e}(),hn=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),this.entities$=new L.a([]),this.count$=new L.a(0),this.empty$=new L.a(!0),this._pristine=!0,this.strategies=[],this.getKey=i.getKey?i.getKey:Ki,this.getProperty=i.getProperty?i.getProperty:Yi,this.state=this.createStateManager(),this.view=this.createDataView(),this.stateView=this.createStateView(),this.view.lift(),this.stateView.lift(),t.length>0?this.load(t):this._index=this.generateIndex(t)}return _createClass(e,[{key:"get",value:function(e){return this.index.get(e)}},{key:"all",value:function(){return this.entities$.value}},{key:"load",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._index=this.generateIndex(e),this._pristine=t,this.next()}},{key:"softClear",value:function(){this.index&&this.index.size>0?(this.index.clear(),this._pristine=!0,this.next()):this.index&&this.updateCount()}},{key:"clear",value:function(){this.stateView.clear(),this.view.clear(),this.state.clear(),this.softClear()}},{key:"destroy",value:function(){this.stateView.destroy(),this.view.destroy(),this.clear()}},{key:"insert",value:function(e){this.insertMany([e])}},{key:"insertMany",value:function(e){var t=this;e.forEach((function(e){return t.index.set(t.getKey(e),e)})),this._pristine=!1,this.next()}},{key:"update",value:function(e){this.updateMany([e])}},{key:"updateMany",value:function(e){var t=this;e.forEach((function(e){return t.index.set(t.getKey(e),e)})),this._pristine=!1,this.next()}},{key:"delete",value:function(e){this.deleteMany([e])}},{key:"deleteMany",value:function(e){var t=this;e.forEach((function(e){return t.index.delete(t.getKey(e))})),this._pristine=!1,this.next()}},{key:"addStrategy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0!==this.strategies.find((function(t){return e.constructor===t.constructor})))throw new Error("A strategy of this type already exists on that EntityStore.");return this.strategies.push(e),e.bindStore(this),!0===t&&e.activate(),this}},{key:"removeStrategy",value:function(e){var t=this.strategies.indexOf(e);return t>=0&&(this.strategies.splice(t,1),e.unbindStore(this)),this}},{key:"getStrategyOfType",value:function(e){return this.strategies.find((function(t){return t instanceof e}))}},{key:"activateStrategyOfType",value:function(e){var t=this.getStrategyOfType(e);void 0!==t&&t.activate()}},{key:"deactivateStrategyOfType",value:function(e){var t=this.getStrategyOfType(e);void 0!==t&&t.deactivate()}},{key:"generateIndex",value:function(e){var t=this,i=e.map((function(e){return[t.getKey(e),e]}));return new Map(i)}},{key:"next",value:function(){this.entities$.next(Array.from(this.index.values())),this.updateCount()}},{key:"updateCount",value:function(){var e=this.index.size,t=0===e;this.count$.next(e),this.empty$.next(t)}},{key:"createStateManager",value:function(){return new ln({store:this})}},{key:"createDataView",value:function(){return new un(this.entities$)}},{key:"createStateView",value:function(){var e=this;return new un(this.view.all$()).join({source:this.state.change$,reduce:function(t){var i=e.getKey(t),o=e.state.get(t),n=e.stateView.get(i);if(void 0!==n&&n.entity===t&&e.statesAreTheSame(n.state,o))return n;var r=n?n.revision+1:1;return{entity:t,state:o,revision:r,ref:"".concat(i,"-").concat(r)}}}).createIndex((function(t){return e.getKey(t.entity)}))}},{key:"statesAreTheSame",value:function(e,t){if(e===t)return!0;var i=0===Object.keys(e).length,o=0===Object.keys(t).length;return i&&o}},{key:"count",get:function(){return this.count$.value}},{key:"empty",get:function(){return this.empty$.value}},{key:"index",get:function(){return this._index}},{key:"pristine",get:function(){return this._pristine}}]),e}(),dn=function(){function e(t,i){_classCallCheck(this,e),this.innerStateIndex=new Map,this.setChangeDetector(i),this.setStore(t)}return _createClass(e,[{key:"destroy",value:function(){this.setChangeDetector(void 0),this.setStore(void 0)}},{key:"setStore",value:function(e){if(void 0===e)return this.teardownObservers(),this.innerStateIndex.clear(),void(this.store=void 0);this.setStore(void 0),this.store=e,this.setupObservers(),this.detectChanges()}},{key:"setChangeDetector",value:function(e){this.cdRef=e}},{key:"setupObservers",value:function(){var e=this;this.teardownObservers(),this.entities$$=this.store.entities$.subscribe((function(t){return e.onEntitiesChange(t)})),this.state$$=this.store.state.change$.pipe(Object(ze.a)(1)).subscribe((function(){return e.onStateChange()}))}},{key:"teardownObservers",value:function(){void 0!==this.entities$$&&this.entities$$.unsubscribe(),void 0!==this.state$$&&this.state$$.unsubscribe(),this.entities$$=void 0,this.state$$=void 0}},{key:"onEntitiesChange",value:function(e){this.detectChanges()}},{key:"onStateChange",value:function(){var e=!1,t=this.store.state.index,i=this.innerStateIndex;t.size!==i.size&&(e=this.detectChanges());for(var o=0,n=Array.from(t.keys());o<n.length;o++){var r=n[o],a=t.get(r),s=i.get(r);!1===e&&(void 0===s?e=this.detectChanges():E.objectsAreEquivalent(a,s)||(e=this.detectChanges())),this.innerStateIndex.set(r,Object.assign({},a))}}},{key:"detectChanges",value:function(){return void 0!==this.cdRef&&this.cdRef.detectChanges(),!0}}]),e}(),pn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.options=t,this.stores=[],this.active$=new L.a(!1),this.options=t}return _createClass(e,[{key:"activate",value:function(){!0===this.active&&this.doDeactivate(),this.active$.next(!0),this.doActivate()}},{key:"deactivate",value:function(){this.active$.next(!1),this.doDeactivate()}},{key:"bindStore",value:function(e){this.stores.indexOf(e)<0&&this.stores.push(e)}},{key:"unbindStore",value:function(e){var t=this.stores.indexOf(e);t>=0&&this.stores.splice(t,1)}},{key:"doActivate",value:function(){}},{key:"doDeactivate",value:function(){}},{key:"active",get:function(){return this.active$.value}}]),e}(),gn=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this,e)).options=e,o.filters=new Map,o}return _createClass(i,[{key:"bindStore",value:function(e){_get(_getPrototypeOf(i.prototype),"bindStore",this).call(this,e),!0===this.active&&this.filterStore(e)}},{key:"unbindStore",value:function(e){_get(_getPrototypeOf(i.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.unfilterStore(e)}},{key:"doActivate",value:function(){this.filterAll()}},{key:"doDeactivate",value:function(){this.unfilterAll()}},{key:"filterAll",value:function(){var e=this;this.stores.forEach((function(t){return e.filterStore(t)}))}},{key:"unfilterAll",value:function(){var e=this;this.stores.forEach((function(t){return e.unfilterStore(t)}))}},{key:"filterStore",value:function(e){this.filters.set(e,e.stateView.addFilter(this.options.filterClauseFunc))}},{key:"unfilterStore",value:function(e){var t=this.filters.get(e);void 0!==t&&(e.stateView.removeFilter(t),this.filters.delete(e))}}]),i}(pn),fn=function(e){_inherits(i,e);var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),(e=t.apply(this,arguments)).filters=new Map,e}return _createClass(i,[{key:"bindStore",value:function(e){_get(_getPrototypeOf(i.prototype),"bindStore",this).call(this,e),!0===this.active&&this.filterStore(e)}},{key:"unbindStore",value:function(e){_get(_getPrototypeOf(i.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.unfilterStore(e)}},{key:"doActivate",value:function(){this.filterAll()}},{key:"doDeactivate",value:function(){this.unfilterAll()}},{key:"filterAll",value:function(){var e=this;this.stores.forEach((function(t){return e.filterStore(t)}))}},{key:"unfilterAll",value:function(){var e=this;this.stores.forEach((function(t){return e.unfilterStore(t)}))}},{key:"filterStore",value:function(e){this.filters.has(e)||this.filters.set(e,e.stateView.addFilter((function(e){return!0===e.state.selected})))}},{key:"unfilterStore",value:function(e){var t=this.filters.get(e);void 0!==t&&(e.stateView.removeFilter(t),this.filters.delete(e))}}]),i}(pn),mn=((to=function(){function e(t){_classCallCheck(this,e),this.cdRef=t,this.selected$=new L.a(void 0),this.multiText$=new L.a(void 0),this.multiSelectValue={id:"IGO_MULTI_SELECT"},this.emptyValue={id:"IGO_EMPTY_SELECT"},this.titleAccessor=Zi,this.emptyText=void 0,this.multi=!1,this.multiAllText="All",this.multiNoneText="None",this.disabled=!1,this.selectedChange=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watcher=new dn(this.store,this.cdRef),this.selected$$=this.store.stateView.manyBy$((function(e){return!0===e.state.selected})).subscribe((function(t){var i=t.map((function(e){return e.entity}));e.onSelectFromStore(i)}))}},{key:"ngOnDestroy",value:function(){this.watcher.destroy(),this.selected$$.unsubscribe()}},{key:"onSelectionChange",value:function(e){var t=this,i=e.value instanceof Array?e.value:[e.value],o=i.find((function(e){return e===t.multiSelectValue})),n=i.filter((function(e){return e!==t.multiSelectValue}));void 0!==o&&(n.length===this.store.count?n=[]:n.length<this.store.count&&(n=this.store.all())),0===(n=n.filter((function(e){return e!==t.emptyValue}))).length?this.store.state.updateAll({selected:!1}):this.store.state.updateMany(n,{selected:!0},!0),this.selectedChange.emit({selected:!0,value:this.multi?n:e.value})}},{key:"onSelectFromStore",value:function(e){this.selected$.next(!0===this.multi?e:e.length>0?e[0]:void 0),this.updateMultiToggleWithEntities(e)}},{key:"updateMultiToggleWithEntities",value:function(e){e.length===this.store.count&&this.multiText$.value!==this.multiNoneText?this.multiText$.next(this.multiNoneText):e.length<this.store.count&&this.multiText$.value!==this.multiAllText&&this.multiText$.next(this.multiAllText)}}]),e}()).\u0275fac=function(e){return new(e||to)(r.Rb(r.h))},to.\u0275cmp=r.Lb({type:to,selectors:[["igo-entity-selector"]],inputs:{titleAccessor:"titleAccessor",emptyText:"emptyText",multi:"multi",multiAllText:"multiAllText",multiNoneText:"multiNoneText",disabled:"disabled",store:"store",placeholder:"placeholder"},outputs:{selectedChange:"selectedChange"},decls:7,vars:11,consts:[[1,"igo-entity-selector"],[3,"disabled","value","multiple","placeholder","selectionChange"],[3,"value",4,"ngIf"],["ngFor","",3,"ngForOf"],[3,"value"]],template:function(e,t){1&e&&(r.Xb(0,"mat-form-field",0),r.Xb(1,"mat-select",1),r.ec("selectionChange",(function(e){return t.onSelectionChange(e)})),r.jc(2,"async"),r.Gc(3,gt,2,2,"mat-option",2),r.Gc(4,ft,3,4,"mat-option",2),r.Gc(5,mt,2,2,"ng-template",3),r.jc(6,"async"),r.Wb(),r.Wb()),2&e&&(r.Db(1),r.oc("disabled",t.disabled)("value",r.kc(2,7,t.selected$))("multiple",t.multi)("placeholder",t.placeholder),r.Db(2),r.oc("ngIf",void 0!==t.emptyText&&!1===t.multi),r.Db(1),r.oc("ngIf",!0===t.multi),r.Db(1),r.oc("ngForOf",r.kc(6,9,t.store.stateView.all$())))},directives:[it.c,ot.a,m.l,m.k,dt.o],pipes:[m.b],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),to),bn=((eo=function(){function e(t){_classCallCheck(this,e),this.cdRef=t,this.entitySortChange$=new L.a(!1),this.entityTableColumnRenderer=qi,this.entityTableSelectionState=Ui,this.selectionState$=new L.a(void 0),this.scrollBehavior=Hi.Auto,this.sortNullsFirst=!1,this.withPaginator=!1,this.entityClick=new r.o,this.entitySelectChange=new r.o,this.entitySortChange=new r.o(void 0),this.dataSource=new Ke.k}return _createClass(e,[{key:"ngOnInit",value:function(){this.handleDatasource(),this.dataSource.paginator=this.paginator}},{key:"ngOnChanges",value:function(e){var t=e.store;t&&t.currentValue!==t.previousValue&&this.handleDatasource()}},{key:"handleDatasource",value:function(){var e=this;this.unsubscribeStore(),this.selection$$=this.store.stateView.manyBy$((function(e){return!0===e.state.selected})).subscribe((function(t){var i=t[0],o=e.store.stateView.all().indexOf(i),n=e.paginator.pageSize*(e.paginator.pageIndex+1);if(e.paginator&&o<n-e.paginator.pageSize||o>=n){var r=Math.floor(o/e.paginator.pageSize);e.dataSource.paginator.pageIndex=r}e.selectionState$.next(e.computeSelectionState(t))})),this.dataSource$$=this.store.stateView.all$().subscribe((function(t){e.dataSource.data=t}))}},{key:"ngOnDestroy",value:function(){this.unsubscribeStore()}},{key:"unsubscribeStore",value:function(){this.selection$$&&this.selection$$.unsubscribe(),this.dataSource$$&&this.dataSource$$.unsubscribe()}},{key:"getTrackByFunction",value:function(){return function(e,t){return t.ref}}},{key:"refresh",value:function(){this.cdRef.detectChanges()}},{key:"paginatorChange",value:function(e){this.paginator=e}},{key:"onSort",value:function(e){var t=this,i=e.direction,o=this.template.columns.find((function(t){return t.name===e.active}));"asc"===i||"desc"===i?(this.store.stateView.sort({valueAccessor:function(e){return t.getValue(e,o)},direction:i,nullsFirst:this.sortNullsFirst}),this.entitySortChange.emit({column:o,direction:i}),this.entitySortChange$.next(!0)):this.store.stateView.sort(void 0)}},{key:"onRowClick",value:function(e){this.lastRecordCheckedKey=this.store.stateView.getKey(e),this.entityClick.emit(e.entity)}},{key:"onRowSelect",value:function(e){if(!1!==this.selection){var t=e.entity;this.store.state.update(t,{selected:!0},!0),this.entitySelectChange.emit({added:[t]})}}},{key:"onToggleRows",value:function(e){if(!1!==this.selection&&(this.store.state.updateAll({selected:e}),!0===e)){var t=this.store.stateView.all().map((function(e){return e.entity}));this.entitySelectChange.emit({added:[t]})}}},{key:"onToggleRow",value:function(e,t){if(!1!==this.selection){var i=t.entity;this.store.state.update(i,{selected:e},!0===e&&!this.selectMany),!0===e&&this.entitySelectChange.emit({added:[i]}),this.lastRecordCheckedKey=this.store.stateView.getKey(t)}}},{key:"onShiftToggleRow",value:function(e,t,i){if(!1!==this.selection)if(!1!==this.selectMany&&void 0!==this.lastRecordCheckedKey){var o=window.document.createRange();o.selectNode(i.target),window.getSelection().removeAllRanges(),window.getSelection().addRange(o),i.stopImmediatePropagation();var n=this.store.stateView.all(),r=n.indexOf(t),a=this.store.stateView.get(this.lastRecordCheckedKey),s=[r,n.indexOf(a)],c=n.slice(Math.min.apply(Math,s),Math.max.apply(Math,s)+1).map((function(e){return e.entity}));this.store.state.updateMany(c,{selected:e}),!0===e&&this.entitySelectChange.emit({added:c}),this.lastRecordCheckedKey=this.store.stateView.getKey(t)}else this.onToggleRow(e,t)}},{key:"computeSelectionState",value:function(e){var t=e.length;return 0===t?Ui.None:t===this.store.stateView.count?Ui.All:Ui.Some}},{key:"columnIsSortable",value:function(e){var t=e.sort;return void 0===t&&(t=void 0!==this.template.sort&&this.template.sort),t}},{key:"rowIsSelected",value:function(e){var t=e.state;return!!t.selected&&t.selected}},{key:"getValue",value:function(e,t){var i=e.entity;return void 0!==t.valueAccessor?t.valueAccessor(i,e):void 0!==this.template.valueAccessor?this.template.valueAccessor(i,t.name,e):this.store.getProperty(i,t.name)}},{key:"getColumnRenderer",value:function(e){return void 0!==e.renderer?e.renderer:qi.Default}},{key:"getTableClass",value:function(){return{"igo-entity-table-with-selection":this.selection}}},{key:"getHeaderClass",value:function(){var e=this.template.headerClassFunc;return e instanceof Function?e():{}}},{key:"getRowClass",value:function(e){var t=this.template.rowClassFunc;return t instanceof Function?t(e.entity,e):{}}},{key:"getCellClass",value:function(e,t){var i=e.entity,o={},n=this.template.cellClassFunc;n instanceof Function&&Object.assign(o,n(i,t,e));var r=t.cellClassFunc;return r instanceof Function&&Object.assign(o,r(i,e)),o}},{key:"onButtonClick",value:function(e,t){"function"==typeof e&&e(t.entity,t)}},{key:"paginator",set:function(e){this._paginator=e,this.dataSource.paginator=e},get:function(){return this._paginator}},{key:"headers",get:function(){var e=this.template.columns.filter((function(e){return!1!==e.visible})).map((function(e){return e.name}));return!0===this.selectionCheckbox&&(e=["selectionCheckbox"].concat(e)),e}},{key:"selection",get:function(){return this.template.selection||!1}},{key:"selectionCheckbox",get:function(){return this.template.selectionCheckbox||!1}},{key:"selectMany",get:function(){return this.template.selectMany||!1}},{key:"fixedHeader",get:function(){return void 0===this.template.fixedHeader||this.template.fixedHeader}}]),e}()).\u0275fac=function(e){return new(e||eo)(r.Rb(r.h))},eo.\u0275cmp=r.Lb({type:eo,selectors:[["igo-entity-table"]],inputs:{scrollBehavior:"scrollBehavior",sortNullsFirst:"sortNullsFirst",withPaginator:"withPaginator",paginator:"paginator",store:"store",template:"template",paginatorOptions:"paginatorOptions"},outputs:{entityClick:"entityClick",entitySelectChange:"entitySelectChange",entitySortChange:"entitySortChange"},features:[r.Bb],decls:9,vars:8,consts:[[1,"table-container"],["mat-table","","matSort","",3,"ngClass","dataSource","trackBy","matSortChange"],["matColumnDef","selectionCheckbox",1,"mat-cell-checkbox"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",3,"ngClass",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","igoEntityTableRow","",3,"scrollBehavior","ngClass","selection","selected","select","click",4,"matRowDef","matRowDefColumns"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange",4,"ngIf"],["mat-header-cell",""],[4,"ngIf"],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","mousedown","click","change"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"matCellDef"],["mat-cell","",1,"mat-cell-text",3,"ngClass"],["mat-cell","","class","mat-cell-text",3,"ngClass","innerHTML",4,"matCellDef"],["mat-cell","",1,"mat-cell-text",3,"ngClass","innerHTML"],[3,"svgIcon"],[4,"ngFor","ngForOf"],["igoStopPropagation","","mat-icon-button","",3,"color","click",4,"ngIf"],["igoStopPropagation","","mat-mini-fab","",3,"color","click",4,"ngIf"],["igoStopPropagation","","mat-icon-button","",3,"color","click"],["igoStopPropagation","","mat-mini-fab","",3,"color","click"],["mat-header-row","",3,"ngClass"],["mat-row","","igoEntityTableRow","",3,"scrollBehavior","ngClass","selection","selected","select","click"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange"]],template:function(e,t){1&e&&(r.Xb(0,"div",0),r.Xb(1,"table",1),r.ec("matSortChange",(function(e){return t.onSort(e)})),r.Vb(2,2),r.Gc(3,yt,2,1,"th",3),r.Gc(4,kt,2,1,"td",4),r.Ub(),r.Gc(5,Wt,4,4,"ng-container",5),r.Gc(6,Xt,1,1,"tr",6),r.Gc(7,Gt,1,4,"tr",7),r.Wb(),r.Gc(8,Bt,1,3,"igo-entity-table-paginator",8),r.Wb()),2&e&&(r.Db(1),r.oc("ngClass",t.getTableClass())("dataSource",t.dataSource)("trackBy",t.getTrackByFunction()),r.Db(4),r.oc("ngForOf",t.template.columns),r.Db(1),r.oc("matHeaderRowDef",t.headers)("matHeaderRowDefSticky",t.fixedHeader),r.Db(1),r.oc("matRowDefColumns",t.headers),r.Db(1),r.oc("ngIf",t.withPaginator))},directives:function(){return[Ke.j,rt.a,m.j,Ke.c,Ke.e,Ke.b,m.k,Ke.g,Ke.i,m.l,Ke.d,v.a,Ke.a,rt.b,u.a,l.a,ir,Ke.f,Ke.h,nr,vn]},pipes:function(){return[m.b,$n]},styles:["[_nghost-%COMP%]{display:block;height:100%;width:100%}.table-compact[_nghost-%COMP%]     .mat-checkbox .mat-checkbox-ripple, .table-compact[_nghost-%COMP%]   tr.mat-header-row[_ngcontent-%COMP%]{height:36px}.table-compact[_nghost-%COMP%]     .mat-checkbox .mat-checkbox-ripple, .table-compact[_nghost-%COMP%]   tr.mat-row[_ngcontent-%COMP%]{height:28px}.table-container[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;height:100%;overflow:auto}.mat-cell-text[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word}td.mat-cell[_ngcontent-%COMP%], td.mat-footer-cell[_ngcontent-%COMP%], th.mat-header-cell[_ngcontent-%COMP%]{padding:0 3px}entity-table[_ngcontent-%COMP%]   table.igo-entity-table-with-selection[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{-o-box-shadow:2px 0 2px 0 #ddd;box-shadow:2px 0 2px 0 #ddd;cursor:pointer}table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:7px}"],changeDetection:0}),eo),vn=((Qi=function(){function e(t,i){var o=this;_classCallCheck(this,e),this.languageService=t,this.mediaService=i,this.disabled=!1,this.hidePageSize=!1,this.pageIndex=0,this.pageSize=50,this.pageSizeOptions=[5,10,20,50,100,200],this.showFirstLastButtons=!0,this.paginationLabelTranslation$$=[],this.entitySortChange$=new L.a(!1),this.length=0,this.paginatorChange=new r.o,this.rangeLabel=function(e,t,i){var n=new L.a("");if(o.paginationLabelTranslation$$.push(o.languageService.translate.get("igo.common.paginator.of").subscribe((function(e){n.next(e)}))),0===i||0===t)return"0 ".concat(n.value," ").concat(i);var r=e*t;return"".concat(r+1," - ").concat(r<(i=Math.max(i,0))?Math.min(r+t,i):r+t," ").concat(n.value," ").concat(i)}}return _createClass(e,[{key:"ngOnChanges",value:function(){var e=this;this.unsubscribeAll(),this.count$$=this.store.stateView.count$.subscribe((function(t){e.length=t,e.emitPaginator()})),this.entitySortChange$$=this.entitySortChange$.subscribe((function(){e.paginator&&e.paginator.firstPage()})),this.initPaginatorOptions(),this.translateLabels()}},{key:"initPaginatorOptions",value:function(){var e,t,i,o,n,r;this.disabled=(null===(e=this.paginatorOptions)||void 0===e?void 0:e.disabled)||this.disabled,this.pageIndex=(null===(t=this.paginatorOptions)||void 0===t?void 0:t.pageIndex)||this.pageIndex,this.pageSize=(null===(i=this.paginatorOptions)||void 0===i?void 0:i.pageSize)||this.pageSize,this.pageSizeOptions=(null===(o=this.paginatorOptions)||void 0===o?void 0:o.pageSizeOptions)||this.pageSizeOptions,this.mediaService.isMobile()?(this.showFirstLastButtons=!1,this.hidePageSize=!0):(this.showFirstLastButtons=(null===(n=this.paginatorOptions)||void 0===n?void 0:n.showFirstLastButtons)||this.showFirstLastButtons,this.hidePageSize=(null===(r=this.paginatorOptions)||void 0===r?void 0:r.hidePageSize)||this.hidePageSize)}},{key:"translateLabels",value:function(){var e=this;this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.firstPageLabel").subscribe((function(t){e.paginator._intl.firstPageLabel=t}))),this.paginator._intl.getRangeLabel=this.rangeLabel,this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.itemsPerPageLabel").subscribe((function(t){e.paginator._intl.itemsPerPageLabel=t}))),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.lastPageLabel").subscribe((function(t){e.paginator._intl.lastPageLabel=t}))),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.nextPageLabel").subscribe((function(t){e.paginator._intl.nextPageLabel=t}))),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.previousPageLabel").subscribe((function(t){e.paginator._intl.previousPageLabel=t})))}},{key:"unsubscribeAll",value:function(){this.paginationLabelTranslation$$.map((function(e){return e.unsubscribe()})),this.count$$&&this.count$$.unsubscribe(),this.entitySortChange$$&&this.entitySortChange$$.unsubscribe()}},{key:"ngOnDestroy",value:function(){this.unsubscribeAll()}},{key:"emitPaginator",value:function(){this.paginatorChange.emit(this.paginator)}}]),e}()).\u0275fac=function(e){return new(e||Qi)(r.Rb(Le),r.Rb(Ae))},Qi.\u0275cmp=r.Lb({type:Qi,selectors:[["igo-entity-table-paginator"]],viewQuery:function(e,t){var i;1&e&&r.Ec(Ye.a,!0),2&e&&r.uc(i=r.fc())&&(t.paginator=i.first)},inputs:{entitySortChange$:"entitySortChange$",store:"store",paginatorOptions:"paginatorOptions"},outputs:{paginatorChange:"paginatorChange",page:"page"},features:[r.Bb],decls:1,vars:7,consts:[[3,"disabled","hidePageSize","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons","page"]],template:function(e,t){1&e&&(r.Xb(0,"mat-paginator",0),r.ec("page",(function(){return t.emitPaginator()})),r.Wb()),2&e&&r.oc("disabled",t.disabled)("hidePageSize",t.hidePageSize)("length",t.length)("pageIndex",t.pageIndex)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("showFirstLastButtons",t.showFirstLastButtons)},directives:[Ye.a],styles:["[_nghost-%COMP%]{margin-top:-10px;padding-right:15px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]{margin-top:0;padding-right:5px}}"],changeDetection:0}),Qi),yn=function(e){return e.Dock="dock",e.Overlay="overlay",e.Context="context",e}({}),kn=function(e){_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return i}(hn),Sn=((So=function(){function e(t,i,o,n){var r=this;_classCallCheck(this,e),this.overlay=t,this.elRef=i,this.cdRef=o,this.mediaService=n,this.actionbarMode=yn,this.collapsed=!1,this.toggleCollapseAction={id:"actionbar_toggle",icon:"dots-vertical",handler:function(){r.collapsed=!r.collapsed}},this.heightCondition$=new L.a(!1),this.positionConditionTop$=new L.a(!0),this.positionConditionLow$=new L.a(!0),this.mode=yn.Dock,this.withToggleButton=!1,this.horizontal=!1,this.color="default",this.iconColor="default",this.withTitle=!0,this.withTooltip=!0,this.scrollActive=!0,this.withIcon=!0,this.icon="dots-horizontal",this.xPosition="before",this.yPosition="above",this._overlayClass=""}return _createClass(e,[{key:"ngOnChanges",value:function(e){var t=e.store;t&&t.currentValue!==t.previousValue&&(void 0!==this.watcher&&this.watcher.destroy(),this.watcher=new dn(this.store,this.cdRef))}},{key:"ngOnDestroy",value:function(){this.watcher.destroy()}},{key:"onTriggerAction",value:function(e){e.handler.apply(e,_toConsumableArray(e.args||[]))}},{key:"scrollDown",value:function(){this.elRef.nativeElement.scrollBy(0,52)}},{key:"scrollUp",value:function(){this.elRef.nativeElement.scrollBy(0,-52)}},{key:"overlayClass",set:function(e){this._overlayClass=e},get:function(){return[this._overlayClass,"igo-actionbar-overlay"].join(" ")}},{key:"withTitleClass",get:function(){return this.withTitle}},{key:"withIconClass",get:function(){return this.withIcon}},{key:"horizontalClass",get:function(){return this.horizontal}},{key:"heightCondition",get:function(){var e=this.elRef.nativeElement;return!1===this.scrollActive&&e.clientHeight<e.scrollHeight}},{key:"positionConditionTop",get:function(){return 0!==this.elRef.nativeElement.scrollTop}},{key:"positionConditionLow",get:function(){var e=this.elRef.nativeElement;return!(e.scrollTop>=e.scrollHeight-e.clientHeight)}},{key:"isDesktop",get:function(){return this.mediaService.getMedia()===De.Desktop}}]),e}()).\u0275fac=function(e){return new(e||So)(r.Rb(pt.c),r.Rb(r.l),r.Rb(r.h),r.Rb(Ae))},So.\u0275cmp=r.Lb({type:So,selectors:[["igo-actionbar"]],hostVars:6,hostBindings:function(e,t){2&e&&r.Ib("with-title",t.withTitleClass)("with-icon",t.withIconClass)("horizontal",t.horizontalClass)},inputs:{mode:"mode",withToggleButton:"withToggleButton",horizontal:"horizontal",color:"color",iconColor:"iconColor",withTitle:"withTitle",withTooltip:"withTooltip",scrollActive:"scrollActive",withIcon:"withIcon",icon:"icon",xPosition:"xPosition",yPosition:"yPosition",overlayClass:"overlayClass",store:"store"},features:[r.Bb],decls:3,vars:3,consts:[[4,"ngIf"],["class","context-menu-card mat-elevation-z4",4,"ngIf"],["id","topChevron",4,"ngIf"],["color","accent",3,"withTitle","withIcon","color","disabled","action","trigger",4,"ngIf"],["id","lowChevron",4,"ngIf"],["id","topChevron"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click"],["svgIcon","chevron-up"],["color","accent",3,"withTitle","withIcon","color","disabled","action","trigger"],["ngFor","",3,"ngForOf"],["buttonContent",""],["color","accent",3,"withTitle","withIcon","withTooltip","color","disabled","action","trigger"],["id","lowChevron"],["svgIcon","chevron-down"],["mat-icon-button","",1,"buttonOverlay",3,"matMenuTriggerFor","disabled","color"],[3,"svgIcon"],["overlapTrigger","true",1,"igo-compact-menu","igo-no-min-width-menu",3,"xPosition","yPosition"],["actionbarMenu","matMenu"],["color","accent",3,"withTitle","withIcon","color","action","trigger"],[1,"context-menu-card","mat-elevation-z4"]],template:function(e,t){1&e&&(r.Gc(0,Ut,5,4,"mat-list",0),r.Gc(1,Kt,8,11,"div",0),r.Gc(2,Jt,4,3,"mat-card",1)),2&e&&(r.oc("ngIf",t.mode===t.actionbarMode.Dock),r.Db(1),r.oc("ngIf",t.mode===t.actionbarMode.Overlay),r.Db(1),r.oc("ngIf",t.mode===t.actionbarMode.Context))},directives:function(){return[m.l,h.a,l.a,g.a,u.a,Cn,m.k,y.c,y.d,b.a]},pipes:function(){return[U.d,m.b]},styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:auto;position:relative}button[_ngcontent-%COMP%]{margin:4px}.buttonOverlay[_ngcontent-%COMP%]{margin:0}mat-list[_ngcontent-%COMP%]{padding-top:0}.horizontal[_nghost-%COMP%]{max-width:100%;overflow:unset}.horizontal[_nghost-%COMP%]   mat-list[_ngcontent-%COMP%]{white-space:nowrap;width:auto}.horizontal[_nghost-%COMP%]   igo-actionbar-item[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]     .mat-list .mat-list-item .mat-list-text>*{-webkit-box-orient:vertical;-webkit-line-clamp:2;display:-webkit-box;line-height:18px;max-height:36px;overflow:hidden;text-overflow:ellipsis;white-space:normal}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar{height:46px}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content{display:-webkit-flex;height:46px;padding:3px}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content>mat-icon{padding:8px}igo-actionbar-item[_ngcontent-%COMP%]     mat-list-item [mat-list-avatar]{height:auto;width:40px}igo-actionbar-item[_ngcontent-%COMP%]     mat-list-item:hover{cursor:pointer}.context-menu-card[_ngcontent-%COMP%]{margin:10px;padding:8px 3px}#lowChevron[_ngcontent-%COMP%], #topChevron[_ngcontent-%COMP%]{background-color:#fff;position:fixed;z-index:3}#lowChevron[_ngcontent-%COMP%]{bottom:0}"],changeDetection:0}),So),Cn=((ko=function(){function e(){_classCallCheck(this,e),this.disabled$=new L.a(!1),this.checkCondition$=new L.a(void 0),this.icon$=new L.a(void 0),this.tooltip$=new L.a(void 0),this.noDisplay$=new L.a(!1),this.ngClass$=new L.a({}),this.color="default",this.withTitle=!0,this.withIcon=!0,this.withTooltip=!0,this.trigger=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){var e,t,i,o=this,n=this.action.args||[];void 0!==this.action.ngClass&&(this.ngClass$$=(e=this.action).ngClass.apply(e,_toConsumableArray(n)).subscribe((function(e){return o.updateNgClass(e)}))),Object(Be.a)(this.action.icon)?this.icon$$=this.action.icon.subscribe((function(e){return o.updateIcon(e)})):this.updateIcon(this.action.icon),Object(Be.a)(this.action.checkCondition)?this.checkCondition$$=this.action.checkCondition.subscribe((function(e){return o.updateCheckCondition(e)})):this.updateCheckCondition(this.action.checkCondition),Object(Be.a)(this.action.tooltip)?this.tooltip$$=this.action.tooltip.subscribe((function(e){return o.updateTooltip(e)})):this.updateTooltip(this.action.tooltip),void 0!==this.action.availability&&(this.availability$$=(t=this.action).availability.apply(t,_toConsumableArray(n)).subscribe((function(e){return o.disabled=!e}))),this.disabled$$=this.disabled$.subscribe((function(e){return o.updateNgClass({"igo-actionbar-item-disabled":e})})),void 0!==this.action.display&&(this.display$$=(i=this.action).display.apply(i,_toConsumableArray(n)).subscribe((function(e){return o.noDisplay=!e}))),this.noDisplay$$=this.noDisplay$.subscribe((function(e){return o.updateNgClass({"igo-actionbar-item-no-display":e})}))}},{key:"ngOnDestroy",value:function(){void 0!==this.ngClass$$&&(this.ngClass$$.unsubscribe(),this.ngClass$$=void 0),void 0!==this.availability$$&&(this.availability$$.unsubscribe(),this.availability$$=void 0),void 0!==this.display$$&&(this.display$$.unsubscribe(),this.display$$=void 0),void 0!==this.checkCondition$$&&(this.checkCondition$$.unsubscribe(),this.checkCondition$$=void 0),void 0!==this.icon$$&&(this.icon$$.unsubscribe(),this.icon$$=void 0),void 0!==this.tooltip$$&&(this.tooltip$$.unsubscribe(),this.tooltip$$=void 0),this.disabled$$.unsubscribe(),this.noDisplay$$.unsubscribe()}},{key:"onClick",value:function(){!0!==this.disabled&&this.trigger.emit(this.action)}},{key:"updateNgClass",value:function(e){this.ngClass$.next(Object.assign({},this.ngClass$.value,e))}},{key:"updateTooltip",value:function(e){this.tooltip$.next(e)}},{key:"updateCheckCondition",value:function(e){this.checkCondition$.next(e)}},{key:"updateIcon",value:function(e){this.icon$.next(e)}},{key:"disabled",set:function(e){this.disabled$.next(e)},get:function(){return this.disabled$.value}},{key:"noDisplay",set:function(e){this.noDisplay$.next(e)},get:function(){return this.noDisplay$.value}},{key:"title",get:function(){return this.action.title}}]),e}()).\u0275fac=function(e){return new(e||ko)},ko.\u0275cmp=r.Lb({type:ko,selectors:[["igo-actionbar-item"]],inputs:{color:"color",withTitle:"withTitle",withIcon:"withIcon",withTooltip:"withTooltip",disabled:"disabled",noDisplay:"noDisplay",action:"action"},outputs:{trigger:"trigger"},decls:2,vars:2,consts:[["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass","click",4,"ngIf"],["class","item-checkbox","matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass",4,"ngIf"],["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass","click"],["mat-list-avatar","","mat-icon-button","",3,"color","disabled",4,"ngIf"],["matLine","",4,"ngIf"],["mat-list-avatar","","mat-icon-button","",3,"color","disabled"],[3,"svgIcon",4,"ngIf"],[3,"svgIcon"],["matLine",""],["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",1,"item-checkbox",3,"matTooltip","ngClass"],[3,"checked","change",4,"ngIf"],[3,"checked","change"]],template:function(e,t){1&e&&(r.Gc(0,ii,6,10,"mat-list-item",0),r.Gc(1,ni,5,9,"mat-list-item",1)),2&e&&(r.oc("ngIf",!t.action.checkbox),r.Db(1),r.oc("ngIf",t.action.checkbox))},directives:[m.l,h.d,g.a,m.j,l.a,h.b,u.a,dt.k,v.a],pipes:[U.d,m.b],styles:["mat-list-item.igo-actionbar-item-disabled[_ngcontent-%COMP%]{color:rgba(0,0,0,.26);cursor:default!important}mat-list-item.igo-actionbar-item-no-display[_ngcontent-%COMP%]{display:none}mat-checkbox[_ngcontent-%COMP%]{padding:12px}.item-checkbox[_ngcontent-%COMP%]{height:56px}.item-checkbox[_ngcontent-%COMP%]     .mat-checkbox-label{margin-left:20px}"],changeDetection:0}),ko),wn=((yo=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:yo}),yo.\u0275inj=r.Ob({factory:function(e){return new(e||yo)},imports:[[m.c,Ce,l.b,u.b,g.b,y.b,h.e,b.d,v.b]]}),yo),xn=((vo=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:vo}),vo.\u0275inj=r.Ob({factory:function(e){return new(e||vo)},providers:[],imports:[[m.c,wn],wn]}),vo),On=((bo=function(){function e(t,i){_classCallCheck(this,e),this.el=t,this.matIconRegistry=i,this.hidden=!1,this.disabled=!1,this.inverseColor=!1,this.inheritColor=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.badge.style.alignItems="center",this.badge.style.justifyContent="center",this.updateHidden(),this.updateColor(),this.updateSvg()}},{key:"updateSvg",value:function(){this.badge&&(this.badge.innerHTML="",this.svg&&this.badge.appendChild(this.svg))}},{key:"updateColor",value:function(){this.badge&&(this.inheritColor?this.inverseColor?(this.badge.style.color="currentColor",this.badge.style.background="none"):(this.badge.style.color="",this.badge.style.background="currentColor"):this.inverseColor?(this.badge.style.color=window.getComputedStyle(this.badge,null).getPropertyValue("background-color"),this.badge.style.background="none"):(this.badge.style.color="",this.badge.style.background=""),this.originalColor=this.badge.style.color,this.updateDisabled())}},{key:"updateHidden",value:function(){this.badge&&(this.badge.style.display=this.hidden?"none":"flex")}},{key:"updateDisabled",value:function(){this.badge&&this.inverseColor&&(this.disabled?(this.originalColor=this.badge.style.color,this.badge.style.color="#b9b9b9"):this.badge.style.color=this.originalColor)}},{key:"igoMatBadgeIcon",set:function(e){var t=this;this.matIconRegistry.getNamedSvgIcon(e).subscribe((function(e){t.svg=e,t.updateSvg()}))}},{key:"matBadgeHidden",set:function(e){this.hidden=e,this.updateHidden()}},{key:"matBadgeDisabled",set:function(e){this.disabled=e,this.updateDisabled()}},{key:"igoMatBadgeInverseColor",set:function(e){this.inverseColor=e,this.updateColor()}},{key:"igoMatBadgeInheritColor",set:function(e){this.inheritColor=e,this.updateColor()}},{key:"badge",get:function(){return this.el.nativeElement.querySelector(".mat-badge-content")}}]),e}()).\u0275fac=function(e){return new(e||bo)(r.Rb(r.l),r.Rb(u.c))},bo.\u0275dir=r.Mb({type:bo,selectors:[["","igoMatBadgeIcon",""]],inputs:{igoMatBadgeIcon:"igoMatBadgeIcon",matBadgeHidden:"matBadgeHidden",matBadgeDisabled:"matBadgeDisabled",igoMatBadgeInverseColor:"igoMatBadgeInverseColor",igoMatBadgeInheritColor:"igoMatBadgeInheritColor"}}),bo),In=((mo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:mo}),mo.\u0275inj=r.Ob({factory:function(e){return new(e||mo)},imports:[[Ze.b,u.b],Ze.b]}),mo),Ln=((fo=function(){function e(t){_classCallCheck(this,e),this.el=t,this.clickout=new r.o}return _createClass(e,[{key:"handleMouseClick",value:function(e,t){t&&(this.el.nativeElement.contains(t)||this.clickout.emit(e))}}]),e}()).\u0275fac=function(e){return new(e||fo)(r.Rb(r.l))},fo.\u0275dir=r.Mb({type:fo,selectors:[["","igoClickout",""]],hostBindings:function(e,t){1&e&&r.ec("click",(function(e){return t.handleMouseClick(e,e.target)}),!1,r.xc)},outputs:{clickout:"clickout"}}),fo),Tn=((go=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:go}),go.\u0275inj=r.Ob({factory:function(e){return new(e||go)},imports:[[]]}),go),Fn=((po=function(){function e(t,i){_classCallCheck(this,e),this.renderer=t,this.el=i,this._collapsed=!1,this.toggle=new r.o}return _createClass(e,[{key:"click",value:function(){this.collapsed=!this.collapsed}},{key:"collapseTarget",value:function(){this.renderer.addClass(this.target,"igo-collapsed"),this.renderer.addClass(this.el.nativeElement,"collapsed")}},{key:"expandTarget",value:function(){this.renderer.removeClass(this.target,"igo-collapsed"),this.renderer.removeClass(this.el.nativeElement,"collapsed")}},{key:"target",get:function(){return this._target},set:function(e){this._target=e}},{key:"collapsed",get:function(){return this._collapsed},set:function(e){e?this.collapseTarget():this.expandTarget(),this._collapsed=e,this.toggle.emit(e)}}]),e}()).\u0275fac=function(e){return new(e||po)(r.Rb(r.I),r.Rb(r.l))},po.\u0275dir=r.Mb({type:po,selectors:[["","igoCollapse",""]],hostBindings:function(e,t){1&e&&r.ec("click",(function(){return t.click()}))},inputs:{target:"target",collapsed:"collapsed"},outputs:{toggle:"toggle"}}),po),_n=((ho=function(){function e(){_classCallCheck(this,e),this._title="",this._collapsed=!1,this.toggle=new r.o}return _createClass(e,[{key:"title",get:function(){return this._title},set:function(e){this._title=e}},{key:"collapsed",get:function(){return this._collapsed},set:function(e){this._collapsed=e,this.toggle.emit(e)}}]),e}()).\u0275fac=function(e){return new(e||ho)},ho.\u0275cmp=r.Lb({type:ho,selectors:[["igo-collapsible"]],inputs:{title:"title",collapsed:"collapsed"},outputs:{toggle:"toggle"},ngContentSelectors:ri,decls:7,vars:3,consts:[["svgIcon","chevron-up","mat-list-avatar","","igoCollapse","",1,"igo-chevron",3,"target","collapsed","toggle"],["matLine",""],["content",""]],template:function(e,t){if(1&e&&(r.nc(),r.Xb(0,"mat-list-item"),r.Xb(1,"mat-icon",0),r.ec("toggle",(function(e){return t.collapsed=e})),r.Wb(),r.Xb(2,"h4",1),r.Ic(3),r.Wb(),r.Wb(),r.Xb(4,"div",null,2),r.mc(6),r.Wb()),2&e){var i=r.vc(5);r.Db(1),r.oc("target",i)("collapsed",t.collapsed),r.Db(2),r.Jc(t.title)}},directives:[h.d,u.a,h.b,Fn,dt.k],styles:["[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-avatar{height:auto;padding:0;width:auto}mat-list-item[_ngcontent-%COMP%]{overflow:hidden}"]}),ho),Mn=((uo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:uo}),uo.\u0275inj=r.Ob({factory:function(e){return new(e||uo)},imports:[[u.b,h.e]]}),uo),Dn=((lo=function e(t){_classCallCheck(this,e),this.dialogRef=t}).\u0275fac=function(e){return new(e||lo)(r.Rb(Je.f))},lo.\u0275cmp=r.Lb({type:lo,selectors:[["igo-confirm-dialog"]],decls:12,vars:10,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],["mat-dialog-actions",""],["mat-button","","color","primary",3,"click"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(r.Xb(0,"h2",0),r.Ic(1),r.jc(2,"translate"),r.Wb(),r.Xb(3,"div",1),r.Ic(4),r.Wb(),r.Xb(5,"div",2),r.Xb(6,"button",3),r.ec("click",(function(){return t.dialogRef.close(!0)})),r.Ic(7),r.jc(8,"translate"),r.Wb(),r.Xb(9,"button",4),r.ec("click",(function(){return t.dialogRef.close(!1)})),r.Ic(10),r.jc(11,"translate"),r.Wb(),r.Wb()),2&e&&(r.Db(1),r.Jc(r.kc(2,4,"igo.common.confirmDialog.title")),r.Db(3),r.Jc(t.confirmMessage),r.Db(3),r.Jc(r.kc(8,6,"igo.common.confirmDialog.confirmBtn")),r.Db(3),r.Jc(r.kc(11,8,"igo.common.confirmDialog.cancelBtn")))},directives:[Je.g,Je.d,Je.c,l.a],pipes:[U.d],styles:["h2[_ngcontent-%COMP%]{margin:5px 0 10px}div[mat-dialog-content][_ngcontent-%COMP%]{max-width:200px}div[mat-dialog-actions][_ngcontent-%COMP%]{margin:10px 0 0}"]}),lo),Pn=((co=function(){function e(t){_classCallCheck(this,e),this.dialog=t}return _createClass(e,[{key:"open",value:function(e){var t=this.dialog.open(Dn,{disableClose:!1});return t.componentInstance.confirmMessage=e,t.afterClosed()}}]),e}()).\u0275fac=function(e){return new(e||co)(r.bc(Je.b))},co.\u0275prov=r.Nb({token:co,factory:co.\u0275fac}),co),An=((so=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:so}),so.\u0275inj=r.Ob({factory:function(e){return new(e||so)},providers:[Pn],imports:[[l.b,Je.e,Ce]]}),so),jn=((ao=function(){function e(t,i,o){_classCallCheck(this,e),this.overlay=t,this.viewContainerRef=i,this.elementRef=o,this.menuPosition=new r.o}return _createClass(e,[{key:"onContextMenu",value:function(e){var t=this,i=e.x,o=e.y;this.close(),e.preventDefault(),this.menuPosition.emit({x:i,y:o}),this.overlayRef=null;var n=this.overlay.position().flexibleConnectedTo({x:i,y:o}).withPositions([{originX:"end",originY:"bottom",overlayX:"start",overlayY:"top"}]);this.overlayRef=this.overlay.create({positionStrategy:n,scrollStrategy:this.overlay.scrollStrategies.close()}),this.overlayRef.attach(new Qe.h(this.menuContext,this.viewContainerRef,{$implicit:void 0})),this.sub=Object(M.a)(document,"click").pipe(Object(qe.a)((function(e){var i=e.target;return t.close(),!!t.overlayRef&&!t.overlayRef.overlayElement.contains(i)})),Object(He.a)(1)).subscribe((function(){return t.close()})),this.sub=Object(M.a)(document,"contextmenu").pipe(Object(qe.a)((function(e){var i=e.target;if(i&&!t.elementRef.nativeElement.contains(i)&&!t.overlayRef.overlayElement.contains(i))return!0;e.preventDefault()})),Object(He.a)(1)).subscribe((function(){return t.close()}))}},{key:"close",value:function(){this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null),this.sub&&this.sub.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||ao)(r.Rb(pt.c),r.Rb(r.T),r.Rb(r.l))},ao.\u0275dir=r.Mb({type:ao,selectors:[["","igoContextMenu",""]],hostBindings:function(e,t){1&e&&r.ec("contextmenu",(function(e){return t.onContextMenu(e)}))},inputs:{menuContext:["igoContextMenu","menuContext"]},outputs:{menuPosition:"menuPosition"}}),ao),Rn=((ro=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:ro}),ro.\u0275inj=r.Ob({factory:function(e){return new(e||ro)},imports:[[]]}),ro),$n=((no=function(){function e(t){_classCallCheck(this,e),this._sanitizer=t}return _createClass(e,[{key:"transform",value:function(e){return this._sanitizer.bypassSecurityTrustHtml(e)}}]),e}()).\u0275fac=function(e){return new(e||no)(r.Rb(s.b))},no.\u0275pipe=r.Qb({name:"sanitizeHtml",type:no,pure:!0}),no),En=((oo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}()).\u0275mod=r.Pb({type:oo}),oo.\u0275inj=r.Ob({factory:function(e){return new(e||oo)},imports:[[m.c,u.b,g.b,et.c,l.b,Ce]]}),oo),Wn=((io=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:io}),io.\u0275inj=r.Ob({factory:function(e){return new(e||io)},imports:[[]]}),io),Xn=function(){function e(t){_classCallCheck(this,e),this.componentFactory=t,this.subscriptions=[],this.inputs={},this.inputs$$={},this.subscribers={}}return _createClass(e,[{key:"setTarget",value:function(e){this.target=e,this.componentRef=e.createComponent(this.componentFactory),this.updateInputs(this.inputs),this.updateSubscribers(this.subscribers)}},{key:"destroy",value:function(){void 0!==this.target&&this.target.clear(),void 0!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=void 0),this.unobserveAllInputs(),this.unsubscribeAll()}},{key:"updateInputs",value:function(e){var t=this;if(this.inputs=e,void 0!==this.componentRef){var i=this.componentRef.instance;this.componentFactory.inputs.forEach((function(o){var n=o.propName;t.unobserveInput(n);var r=e[n];e.hasOwnProperty(n)&&(r instanceof Ve.a?t.observeInput(n,r):t.setInputValue(i,n,r))})),"function"==typeof i.onUpdateInputs&&i.onUpdateInputs()}}},{key:"setInputValue",value:function(e,t,i){if(i!==e[t]){var o=Object.getPrototypeOf(e),n=Object.getOwnPropertyDescriptor(o,t);void 0!==n&&void 0!==n.set?n.set.call(e,i):e[t]=i}}},{key:"updateSubscribers",value:function(e){var t=this;if(this.subscribers=e,void 0!==this.componentRef){var i=this.componentRef.instance;this.componentFactory.outputs.forEach((function(o){var n=o.propName;if(e.hasOwnProperty(n)){var r=i[n],a=e[n];Array.isArray(a)?a.forEach((function(e){t.subscriptions.push(r.subscribe(e))})):t.subscriptions.push(r.subscribe(a))}}))}}},{key:"observeInput",value:function(e,t){var i=this;this.inputs$$[e]=t.subscribe((function(t){var o=i.componentRef.instance;i.setInputValue(o,e,t),"function"==typeof o.onUpdateInputs&&o.onUpdateInputs()}))}},{key:"unobserveInput",value:function(e){void 0!==this.inputs$$[e]&&(this.inputs$$[e].unsubscribe(),this.inputs$$[e]=void 0)}},{key:"unobserveAllInputs",value:function(){Object.values(this.inputs$$).forEach((function(e){void 0!==e&&e.unsubscribe()})),this.inputs$$={}}},{key:"unsubscribeAll",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()})),this.subscriptions=[]}}]),e}(),Gn=((qo=function(){function e(t){_classCallCheck(this,e),this.resolver=t}return _createClass(e,[{key:"create",value:function(e){var t=this.resolver.resolveComponentFactory(e);return new Xn(t)}}]),e}()).\u0275fac=function(e){return new(e||qo)(r.bc(r.j))},qo.\u0275prov=Object(r.Nb)({factory:function(){return new qo(Object(r.bc)(r.j))},token:qo,providedIn:"root"}),qo),Bn=((zo=function(){function e(t,i){_classCallCheck(this,e),this.dynamicComponentService=t,this.cdRef=i,this.inputs={},this.subscribers={}}return _createClass(e,[{key:"ngOnChanges",value:function(e){var t=e.component,i=e.inputs,o=e.subscribers,n=E.objectsAreEquivalent;if(t&&t.currentValue!==t.previousValue)this.createComponent(t.currentValue);else{var r=i&&n(i.currentValue||{},i.previousValue||{}),a=o&&n(o.currentValue||{},o.previousValue||{});!1===r&&this.updateInputs(),!1===a&&this.updateSubscribers()}this.cdRef.detectChanges()}},{key:"ngOnDestroy",value:function(){this.dynamicComponent&&this.dynamicComponent.destroy()}},{key:"createComponent",value:function(e){void 0!==this.dynamicComponent&&this.dynamicComponent.destroy(),this.dynamicComponent=e instanceof Xn?e:this.dynamicComponentService.create(e),this.renderComponent()}},{key:"renderComponent",value:function(){this.updateInputs(),this.updateSubscribers(),this.dynamicComponent.setTarget(this.target)}},{key:"updateInputs",value:function(){this.dynamicComponent.updateInputs(this.inputs)}},{key:"updateSubscribers",value:function(){this.dynamicComponent.updateSubscribers(this.subscribers)}}]),e}()).\u0275fac=function(e){return new(e||zo)(r.Rb(Gn),r.Rb(r.h))},zo.\u0275cmp=r.Lb({type:zo,selectors:[["igo-dynamic-outlet"]],viewQuery:function(e,t){var i;1&e&&r.Ec(ai,!0,r.T),2&e&&r.uc(i=r.fc())&&(t.target=i.first)},inputs:{inputs:"inputs",subscribers:"subscribers",component:"component"},features:[r.Bb],decls:2,vars:0,consts:[["target",""]],template:function(e,t){1&e&&r.Gc(0,si,0,0,"ng-template",null,0,r.Hc)},styles:["[_nghost-%COMP%]{display:block;height:100%;width:100%}"],changeDetection:0}),zo),Vn=((No=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:No}),No.\u0275inj=r.Ob({factory:function(e){return new(e||No)},imports:[[m.c]]}),No),Nn=((Vo=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Vo}),Vo.\u0275inj=r.Ob({factory:function(e){return new(e||Vo)},providers:[Gn],imports:[[m.c,Vn],Vn]}),Vo),zn=((Bo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:Bo}),Bo.\u0275inj=r.Ob({factory:function(e){return new(e||Bo)},imports:[[]]}),Bo),qn=((Go=function(){function e(){_classCallCheck(this,e),this.autocomplete="off",this.submitForm=new r.o}return _createClass(e,[{key:"ngOnChanges",value:function(e){var t=e.formData;t&&t.currentValue!==t.previousValue&&(void 0===t.currentValue?this.clear():this.setData(t.currentValue))}},{key:"onSubmit",value:function(){this.submitForm.emit(this.getData())}},{key:"getData",value:function(){var e,t=this,i={};return(e=this.form,e.groups.reduce((function(e,t){return e.concat(t.fields)}),[].concat(e.fields))).forEach((function(e){t.updateDataWithFormField(i,e)})),i}},{key:"setData",value:function(e){this.form.fields.forEach((function(t){t.control.setValue(Xe()(e,t.name).safeObject)})),this.form.groups.forEach((function(t){t.fields.forEach((function(t){t.control.setValue(Xe()(e,t.name).safeObject)}))}))}},{key:"updateDataWithFormField",value:function(e,t){var i=t.control;i.disabled||(e[t.name]=i.value)}},{key:"clear",value:function(){this.form.control.reset()}},{key:"hasButtons",get:function(){return 0!==this.buttons.nativeElement.children.length}}]),e}()).\u0275fac=function(e){return new(e||Go)},Go.\u0275cmp=r.Lb({type:Go,selectors:[["igo-form"]],viewQuery:function(e,t){var i;1&e&&r.Ec(ci,!0),2&e&&r.uc(i=r.fc())&&(t.buttons=i.first)},inputs:{autocomplete:"autocomplete",form:"form",formData:"formData"},outputs:{submitForm:"submitForm"},features:[r.Bb],ngContentSelectors:hi,decls:7,vars:5,consts:[[3,"autocomplete","formGroup","ngSubmit"],[1,"igo-form-body",3,"ngClass"],[1,"igo-form-content"],[1,"igo-form-buttons"],["buttons",""]],template:function(e,t){1&e&&(r.nc(li),r.Xb(0,"form",0),r.ec("ngSubmit",(function(){return t.onSubmit()})),r.Xb(1,"div",1),r.Xb(2,"div",2),r.mc(3),r.Wb(),r.Xb(4,"div",3,4),r.mc(6,1),r.Wb(),r.Wb(),r.Wb()),2&e&&(r.oc("autocomplete",t.autocomplete)("formGroup",t.form.control),r.Db(1),r.oc("ngClass",r.rc(3,ui,t.hasButtons)))},directives:[tt.x,tt.q,tt.i,m.j],styles:["[_nghost-%COMP%]{display:block}form[_ngcontent-%COMP%]{width:100%}.igo-form-body[_ngcontent-%COMP%], .igo-form-content[_ngcontent-%COMP%], form[_ngcontent-%COMP%]{height:100%}.igo-form-body-with-buttons[_ngcontent-%COMP%]   .igo-form-content[_ngcontent-%COMP%]{height:calc(100% - 56px)}.igo-form-content[_ngcontent-%COMP%]{display:flex}"],changeDetection:0}),Go),Hn=((Xo=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Xo}),Xo.\u0275inj=r.Ob({factory:function(e){return new(e||Xo)},imports:[[m.c,tt.k,tt.u],tt.k,tt.u]}),Xo),Un=((Wo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getFieldByType",value:function(t){return e.fields[t]}}],[{key:"register",value:function(t,i){e.fields[t]=i}}]),e}()).\u0275fac=function(e){return new(e||Wo)},Wo.fields={},Wo.\u0275prov=Object(r.Nb)({factory:function(){return new Wo},token:Wo,providedIn:"root"}),Wo),Yn=((Eo=function(){function e(t){_classCallCheck(this,e),this.formBuilder=t}return _createClass(e,[{key:"form",value:function(e,t){var i=this.formBuilder.group({});return e.forEach((function(e){i.addControl(e.name,e.control)})),t.forEach((function(e){i.addControl(e.name,e.control)})),{fields:e,groups:t,control:i}}},{key:"group",value:function(e,t){var i=e.options||{},o=this.formBuilder.group({});return t.forEach((function(e){o.addControl(e.name,e.control)})),o.setValidators(i.validator),Object.assign({},e,{fields:t,control:o})}},{key:"field",value:function(e){var t=e.options||{},i=Object.assign({value:""},{disabled:t.disabled}),o=this.formBuilder.control(i);return o.setValidators(t.validator),Object.assign({type:"text"},e,{control:o})}},{key:"extendFieldConfig",value:function(e,t){var i=Object.assign({},e.options||{},t.options||{}),o=Object.assign({},e.inputs||{},t.inputs||{}),n=Object.assign({},e.subscribers||{},t.subscribers||{});return Object.assign({},e,{options:i,inputs:o,subscribers:n})}}]),e}()).\u0275fac=function(e){return new(e||Eo)(r.bc(tt.e))},Eo.\u0275prov=Object(r.Nb)({factory:function(){return new Eo(Object(r.bc)(tt.e))},token:Eo,providedIn:"root"}),Eo),Kn=(($o=function(){function e(t){_classCallCheck(this,e),this.formFieldService=t,this.fieldInputs=void 0,this.fieldSubscribers=void 0}return _createClass(e,[{key:"getFieldComponent",value:function(){return this.formFieldService.getFieldByType(this.field.type||"text")}},{key:"getFieldInputs",value:function(){if(void 0!==this.fieldInputs)return this.fieldInputs;var e=this.fieldOptions.errors||{};return this.fieldInputs=Object.assign({placeholder:this.field.title,disableSwitch:this.fieldOptions.disableSwitch||!1},Object.assign({},this.field.inputs||{}),{formControl:this.field.control,errors:Object.assign({},{required:"igo.common.form.errors.required"},e)}),this.fieldInputs}},{key:"getFieldSubscribers",value:function(){return void 0!==this.fieldSubscribers||(this.fieldSubscribers=Object.assign({},this.field.subscribers||{})),this.fieldSubscribers}},{key:"fieldOptions",get:function(){return this.field.options||{}}}]),e}()).\u0275fac=function(e){return new(e||$o)(r.Rb(Un))},$o.\u0275cmp=r.Lb({type:$o,selectors:[["igo-form-field"]],inputs:{field:"field"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"component","inputs","subscribers"]],template:function(e,t){1&e&&r.Gc(0,di,2,3,"ng-container",0),2&e&&r.oc("ngIf",void 0!==t.field)},directives:[m.l,Bn],styles:["mat-form-field{width:100%}  .igo-form-disable-switch{margin-right:8px}"],changeDetection:0}),$o),Zn=((Ro=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Ro}),Ro.\u0275inj=r.Ob({factory:function(e){return new(e||Ro)},imports:[[m.c,tt.k,tt.u,u.b,it.e,et.c,ot.b,Ce,Vn]]}),Ro),Jn=((jo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getFieldColSpan",value:function(e){var t=2,i=e.options||{};return i.cols&&i.cols>0&&(t=Math.min(i.cols,2)),t}},{key:"getFieldNgClass",value:function(e){return _defineProperty({},"igo-form-field-colspan-"+this.getFieldColSpan(e),!0)}},{key:"getErrorMessage",value:function(){return e=this.formControl,t=(this.group.options||{}).errors||{},(i=Object.keys(e.errors||{}).map((function(e){return t[e]})).filter((function(e){return void 0!==e}))).length>0?i[0]:"";var e,t,i}},{key:"formControl",get:function(){return this.group.control}}]),e}()).\u0275fac=function(e){return new(e||jo)},jo.\u0275cmp=r.Lb({type:jo,selectors:[["igo-form-group"]],inputs:{group:"group",errors:"errors"},ngContentSelectors:ri,decls:4,vars:2,consts:[["class","igo-form-group-fields",4,"ngIf"],[1,"igo-form-group-extra-content"],[4,"ngIf"],[1,"igo-form-group-fields"],["class","igo-form-field-wrapper",3,"ngClass",4,"ngFor","ngForOf"],[1,"igo-form-field-wrapper",3,"ngClass"],[3,"field"]],template:function(e,t){1&e&&(r.nc(),r.Gc(0,gi,2,1,"div",0),r.Xb(1,"div",1),r.mc(2),r.Wb(),r.Gc(3,fi,3,3,"mat-error",2)),2&e&&(r.oc("ngIf",t.group&&t.group.fields.length>0),r.Db(3),r.oc("ngIf",t.formControl.errors))},directives:[m.l,m.k,m.j,Kn,it.b],pipes:[U.d],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:auto;padding:10px 5px;width:100%}.igo-form-field-wrapper[_ngcontent-%COMP%]{display:inline-block;padding:0 5px}.igo-form-field-colspan-2[_ngcontent-%COMP%]{width:100%}.igo-form-field-colspan-1[_ngcontent-%COMP%]{width:50%}"],changeDetection:0}),jo),Qn=((Ao=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Ao}),Ao.\u0275inj=r.Ob({factory:function(e){return new(e||Ao)},imports:[[m.c,it.e,Ce,Zn]]}),Ao),er=((Po=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Po}),Po.\u0275inj=r.Ob({factory:function(e){return new(e||Po)},providers:[Yn,Un],imports:[[m.c,Qn,Zn],Hn,Qn,Zn]}),Po),tr=((Do=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Do}),Do.\u0275inj=r.Ob({factory:function(e){return new(e||Do)},imports:[[m.c,tt.k,ot.b]]}),Do),ir=((Mo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"onClick",value:function(e){e.stopPropagation()}}]),e}()).\u0275fac=function(e){return new(e||Mo)},Mo.\u0275dir=r.Mb({type:Mo,selectors:[["","igoStopPropagation",""]],hostBindings:function(e,t){1&e&&r.ec("click",(function(e){return t.onClick(e)}))}}),Mo),or=((_o=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:_o}),_o.\u0275inj=r.Ob({factory:function(e){return new(e||_o)},imports:[[]]}),_o),nr=((Fo=function(){function e(t,i){_classCallCheck(this,e),this.renderer=t,this.el=i,this.selection=!1,this.selectOnClick=!0,this.highlightSelection=!0,this._selected=!1,this.scrollBehavior=Hi.Auto,this.select=new r.o}return _createClass(e,[{key:"onClick",value:function(){!1!==this.selection&&!1!==this.selectOnClick&&(this.toggleSelected(!0),this.select.emit(this))}},{key:"toggleSelected",value:function(t){this._selected=t,!0===t?(this.addCls(e.selectedCls),!0===this.highlightSelection&&this.addCls(e.highlightedCls)):(this.removeCls(e.selectedCls),this.removeCls(e.highlightedCls))}},{key:"scroll",value:function(){!0===this._selected&&Object(at.a)(this.el.nativeElement,{scrollMode:"if-needed",block:"center",inline:"center"})}},{key:"addCls",value:function(e){this.renderer.addClass(this.el.nativeElement,e)}},{key:"removeCls",value:function(e){this.renderer.removeClass(this.el.nativeElement,e)}},{key:"selected",set:function(e){!1!==this.selection&&e!==this._selected&&(this.toggleSelected(e),this.scroll())},get:function(){return this._selected}}]),e}()).\u0275fac=function(e){return new(e||Fo)(r.Rb(r.I),r.Rb(r.l))},Fo.\u0275dir=r.Mb({type:Fo,selectors:[["","igoEntityTableRow",""]],hostBindings:function(e,t){1&e&&r.ec("click",(function(){return t.onClick()}))},inputs:{selection:"selection",selectOnClick:"selectOnClick",highlightSelection:"highlightSelection",scrollBehavior:"scrollBehavior",selected:"selected"},outputs:{select:"select"}}),Fo.selectedCls="igo-entity-table-row-selected",Fo.highlightedCls="igo-entity-table-row-highlighted",Fo),rr=((To=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:To}),To.\u0275inj=r.Ob({factory:function(e){return new(e||To)},imports:[[Ye.b]]}),To),ar=((Lo=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Lo}),Lo.\u0275inj=r.Ob({factory:function(e){return new(e||Lo)},imports:[[m.c,Ke.l,rt.c,u.b,l.b,v.b,Ye.b,or,En,rr]]}),Lo),sr=((Io=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Io}),Io.\u0275inj=r.Ob({factory:function(e){return new(e||Io)},imports:[[m.c],tr,ar,rr]}),Io),cr=((Oo=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"transform",value:function(e){return this.http.get(e,{headers:{activityInterceptor:"false"},responseType:"blob"}).pipe(Object(Ue.a)((function(e){return new Ve.a((function(t){var i=new FileReader;i.readAsDataURL(e),i.onloadend=function(){t.next(i.result)}}))})))}}]),e}()).\u0275fac=function(e){return new(e||Oo)(r.Rb(k.b))},Oo.\u0275pipe=r.Qb({name:"secureImage",type:Oo,pure:!0}),Oo),lr=((xo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:xo}),xo.\u0275inj=r.Ob({factory:function(e){return new(e||xo)},imports:[[]]}),xo),ur=((wo=function(){function e(t,i){_classCallCheck(this,e),this.http=t,this.configService=i,this.jsonURL=this.getPathToConfigFile()}return _createClass(e,[{key:"loadConfigTour",value:function(){var e=this;this.getJSON().subscribe((function(t){e.allToursOptions=t}),(function(e){throw new Error("Problem with Interactive tour configuration file: interactiveTour.json not find. Check if the file and is path is set correctly.")}))}},{key:"getPathToConfigFile",value:function(){return this.configService.getConfig("interactiveTour.pathToConfigFile")||"./config/interactiveTour.json"}},{key:"getJSON",value:function(){return this.http.get(this.jsonURL).pipe(Object(C.a)((function(e){throw e.error.caught=!0,e})))}},{key:"getTourOptionData",value:function(e){if(void 0!==this.allToursOptions){var t=e;return t=t.replace(/\s/g,""),this.allToursOptions[t]}}}]),e}()).\u0275fac=function(e){return new(e||wo)(r.bc(k.b),r.bc(ie))},wo.\u0275prov=r.Nb({token:wo,factory:wo.\u0275fac}),wo),hr=((Co=function(){function e(t,i,o,n,r){_classCallCheck(this,e),this.configService=t,this.mediaService=i,this.languageService=o,this.interactiveTourLoader=n,this.shepherdService=r,this.isAppHaveTour()&&this.interactiveTourLoader.loadConfigTour()}return _createClass(e,[{key:"isAppHaveTour",value:function(){var e=this.configService.getConfig("interactiveTour.activateInteractiveTour");return void 0===e||e}},{key:"isToolHaveTourConfig",value:function(e){return void 0!==this.interactiveTourLoader.getTourOptionData(e)}},{key:"disabledTourButton",value:function(e){var t=this.interactiveTourLoader.getTourOptionData(e);return!(!(null==t?void 0:t.condition)||null!==document.querySelector(t.condition))}},{key:"isMobile",value:function(){return this.mediaService.isMobile()}},{key:"isTourDisplayInMobile",value:function(){return void 0===this.configService.getConfig("interactiveTour.tourInMobile")||this.configService.getConfig("interactiveTour.tourInMobile")}},{key:"getButtons",value:function(e){return"noBackButton"===e?[{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]:"first"===e?[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.exitButton"),type:"cancel"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]:"last"===e?[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.backButton"),type:"back"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.exitButton"),type:"cancel"}]:[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.backButton"),type:"back"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]}},{key:"getAction",value:function(e){return{click:"click"}[e.toLowerCase()]}},{key:"addProgress",value:function(){var e=this,t=0,i=setInterval((function(){if(e.getCurrentStep()){if(e.getCurrentStep().options.attachTo.element&&!document.querySelector(e.getCurrentStep().options.attachTo.element)){e.getCurrentStep().hide();var o=e.getCurrentStep().id;if(e.steps.findIndex((function(e){return e.id===o}))===e.steps.length-1)return;return e.next(),void e.removeStep(o)}var n=e.getCurrentStep().getElement();n&&n.querySelectorAll(".shepherd-content, .shepherd-text").forEach((function(e){e.classList.add("mat-typography")}));var r=n?n.querySelector(".shepherd-header"):void 0;if(t++,(r||t>21)&&clearInterval(i),r){var a=e.steps,s=document.createElement("span");s.className="shepherd-progress",s.innerText="".concat(a.indexOf(e.getCurrentStep())+1,"/").concat(a.length),r.insertBefore(s,n.querySelector(".shepherd-cancel-icon"))}}}),100)}},{key:"executeAction",value:function(e,t){if(t&&(!t.condition||!("!"===t.condition.charAt(0)&&document.querySelector(t.condition.slice(1))||"!"!==t.condition.charAt(0)&&!document.querySelector(t.condition)))){var i=document.querySelector(t.element||e.element),o=this.getAction(t.action);i&&o&&i[o]()}}},{key:"executeActionPromise",value:function(e,t){var i=this;return new Promise((function(o){if(i.executeAction(e,t),t&&t.waitFor)var n=0,r=t.maxWait?t.maxWait/100:20,a=setInterval((function(){(++n>r||document.querySelector(t.waitFor))&&(clearInterval(a),o())}),100);else o()}))}},{key:"getShepherdSteps",value:function(e){var t,i=this,o=[],n=0,r=_createForOfIteratorHelper(e.steps);try{var a=function(){var r=t.value;o.push({attachTo:{element:r.element,on:r.position||e.position},popperOptions:{modifiers:[{name:"offset",options:{offset:[0,15]}}]},beforeShowPromise:function(){return Promise.all([i.executeActionPromise(i.previousStep,i.previousStep?i.previousStep.beforeChange:void 0),i.executeActionPromise(r,r.beforeShow)])},buttons:i.getButtons(0===n?"first":n+1===e.steps.length?"last":e.steps[n].noBackButton?"noBackButton":void 0),classes:r.class,highlightClass:r.highlightClass,scrollTo:r.scrollToElement||e.scrollToElement||!0,canClickTarget:r.disableInteraction?!r.disableInteraction:void 0,title:i.languageService.translate.instant(r.title||e.title),text:[i.languageService.translate.instant(r.text)],when:{show:function(){i.executeAction(r,r.onShow)},hide:function(){i.previousStep=r,i.executeAction(r,r.onHide)}}}),n++};for(r.s();!(t=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}return o}},{key:"startTour",value:function(e){var t=this.interactiveTourLoader.getTourOptionData(e);this.shepherdService.defaultStepOptions={classes:t.class,highlightClass:t.highlightClass,canClickTarget:!t.disableInteraction||!t.disableInteraction,cancelIcon:{enabled:!0}};var i=this.getShepherdSteps(t);this.shepherdService.modal=!0,this.shepherdService.confirmCancel=!1,this.shepherdService.addSteps(i),this.shepherdService.tourObject.on("show",this.addProgress),this.shepherdService.start()}}]),e}()).\u0275fac=function(e){return new(e||Co)(r.bc(ie),r.bc(Ae),r.bc(Le),r.bc(ur),r.bc(st.a))},Co.\u0275prov=Object(r.Nb)({factory:function(){return new Co(Object(r.bc)(ie),Object(r.bc)(Ae),Object(r.bc)(Le),Object(r.bc)(ur),Object(r.bc)(st.a))},token:Co,providedIn:"root"}),Co),dr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.options=t,this.activeTool$=new L.a(void 0),this.toolbar$=new L.a([]),this.activeToolHistory=[],this.store=new hn([],{getKey:function(e){return e.name}}),this.setToolbar(t.toolbar),this.initStore()}return _createClass(e,[{key:"destroy",value:function(){this.activeTool$$.unsubscribe(),this.store.destroy()}},{key:"getTool",value:function(e){return this.store.get(e)}},{key:"getTools",value:function(){return this.store.all()}},{key:"setTools",value:function(e){this.store.load(e)}},{key:"getToolbar",value:function(){return this.toolbar$.getValue()}},{key:"setToolbar",value:function(e){this.toolbar$.next(e||[])}},{key:"activateTool",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getTool(e);void 0!==i&&this.store.state.update(i,{active:!0,options:t},!0)}},{key:"activatePreviousTool",value:function(){if(this.activeToolHistory.length<=1)this.deactivateTool();else{var e=_slicedToArray(this.activeToolHistory.splice(-2,2),2),t=e[0];e[1];this.activateTool(t)}}},{key:"deactivateTool",value:function(){this.clearActiveToolHistory(),this.store.state.updateAll({active:!1})}},{key:"initStore",value:function(){var e=this;this.store=new hn([],{getKey:function(e){return e.name}}),this.activeTool$$=this.store.stateView.firstBy$((function(e){return!0===e.state.active})).subscribe((function(t){if(void 0!==t){var i=t.entity,o=Object.assign({},i.options||{},t.state.options||{});e.setActiveTool(Object.assign({},i,{options:o}))}else e.setActiveTool(void 0)}))}},{key:"setActiveTool",value:function(e){this.activeTool$.next(e),void 0===e?this.clearActiveToolHistory():this.activeToolHistory=this.activeToolHistory.filter((function(t){return t!==e.name})).concat([e.name])}},{key:"clearActiveToolHistory",value:function(){this.activeToolHistory=[]}},{key:"tools$",get:function(){return this.store.entities$}}]),e}(),pr=((an=function(){function e(){_classCallCheck(this,e),this.toolbox=new dr,this.toolbox.setTools(this.getTools())}return _createClass(e,[{key:"getTool",value:function(t){return e.tools[t]}},{key:"getTools",value:function(){return Object.values(e.tools)}}],[{key:"register",value:function(t){e.tools[t.name]=t}}]),e}()).\u0275fac=function(e){return new(e||an)},an.tools={},an.\u0275prov=Object(r.Nb)({factory:function(){return new an},token:an,providedIn:"root"}),an),gr=((rn=function(){function e(t,i){_classCallCheck(this,e),this.interactiveTourService=t,this.toolService=i,this.tourToStart="",this.discoverTitleInLocale$=Object(F.a)("IGO")}return _createClass(e,[{key:"getClass",value:function(){return{"tour-button-tool-icon":"icon"===this.styleButton,"tour-button-tool":"raised"===this.styleButton}}},{key:"getTourToStart",value:function(){return this.tourToStart?this.tourToStart:this.activeToolName}},{key:"startInteractiveTour",value:function(){var e=this.getTourToStart();e&&this.interactiveTourService.startTour(e)}},{key:"toolbox",get:function(){return this.toolService.toolbox}},{key:"activeToolName",get:function(){return this.toolbox?this.isActiveTool?this.toolbox.activeTool$.getValue().name:"global":void 0}},{key:"isActiveTool",get:function(){return this.toolbox?void 0!==this.toolbox.activeTool$.getValue():void 0}},{key:"isToolHaveTour",get:function(){return!("about"===this.activeToolName&&!this.tourToStart)&&this.interactiveTourService.isToolHaveTourConfig(this.getTourToStart())}},{key:"showTourButton",get:function(){return!1!==this.isToolHaveTour&&(!this.interactiveTourService.isMobile()||!1!==this.isTourDisplayInMobile)}},{key:"isTourDisplayInMobile",get:function(){return this.interactiveTourService.isTourDisplayInMobile()}},{key:"disabledTourButton",get:function(){return this.interactiveTourService.disabledTourButton(this.activeToolName)}}]),e}()).\u0275fac=function(e){return new(e||rn)(r.Rb(hr),r.Rb(pr))},rn.\u0275cmp=r.Lb({type:rn,selectors:[["igo-interactive-tour"]],inputs:{tourToStart:"tourToStart",discoverTitleInLocale$:"discoverTitleInLocale$",styleButton:"styleButton"},decls:1,vars:1,consts:[["mat-raised-button","","tooltip-position","below","matTooltipShowDelay","500",3,"ngClass","disabled","click",4,"ngIf"],["mat-raised-button","","tooltip-position","below","matTooltipShowDelay","500",3,"ngClass","disabled","click"],[1,"interactive-tour-button-title"],["svgIcon","presentation-play",3,"matTooltip"]],template:function(e,t){1&e&&r.Gc(0,mi,9,15,"button",0),2&e&&r.oc("ngIf",t.showTourButton)},directives:[m.l,l.a,m.j,u.a,g.a],pipes:[U.d,m.b],styles:[".shepherd-has-title .shepherd-content .shepherd-header{padding:.5em .75em}.shepherd-title{margin:0!important}.shepherd-progress{color:#737373;margin-right:15px}"],encapsulation:2}),rn),fr=((nn=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:nn}),nn.\u0275inj=r.Ob({factory:function(e){return new(e||nn)},providers:[hr,ur],imports:[[m.c,u.b,l.b,g.b,Ce]]}),nn),mr=((on=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e,t){var i=[];return Object.getOwnPropertyNames(e).forEach((function(t){return i.push({key:t,value:e[t]})})),i}}]),e}()).\u0275fac=function(e){return new(e||on)},on.\u0275pipe=r.Qb({name:"keyvalue",type:on,pure:!0}),on),br=((tn=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:tn}),tn.\u0275inj=r.Ob({factory:function(e){return new(e||tn)},imports:[[]]}),tn),vr=((en=function(){function e(t,i){_classCallCheck(this,e),this.renderer=t,this.el=i,this._color="primary",this._focused=!1,this._selected=!1,this._disabled=!1,this.beforeSelect=new r.o,this.beforeFocus=new r.o,this.beforeUnselect=new r.o,this.beforeUnfocus=new r.o,this.beforeDisable=new r.o,this.beforeEnable=new r.o,this.focus=new r.o,this.unfocus=new r.o,this.select=new r.o,this.unselect=new r.o,this.disable=new r.o,this.enable=new r.o}return _createClass(e,[{key:"onClick",value:function(){this.selected=!0}},{key:"getOffsetTop",value:function(){return this.el.nativeElement.offsetTop-5}},{key:"toggleFocusedClass",value:function(){this.focused?this.addCls(e.focusedCls):this.removeCls(e.focusedCls)}},{key:"toggleSelectedClass",value:function(){this.selected?(this.addCls(e.selectedCls),this.removeCls(e.focusedCls)):this.removeCls(e.selectedCls)}},{key:"toggleDisabledClass",value:function(){this.disabled?this.addCls(e.disabledCls):this.removeCls(e.disabledCls)}},{key:"addCls",value:function(e){this.renderer.addClass(this.el.nativeElement,e)}},{key:"removeCls",value:function(e){this.renderer.removeClass(this.el.nativeElement,e)}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"focused",get:function(){return this._focused},set:function(e){e!==this._focused&&(this.disabled||(e?this.beforeFocus.emit(this):this.beforeUnfocus.emit(this),this._focused=e,!0!==this.selected&&this.toggleFocusedClass(),e?this.focus.emit(this):this.unfocus.emit(this)))}},{key:"selected",get:function(){return this._selected},set:function(e){e!==this._selected&&(this.disabled||(e?this.beforeSelect.emit(this):this.beforeUnselect.emit(this),this._selected=e,this._focused=e,this.toggleSelectedClass(),e?this.select.emit(this):this.unselect.emit(this)))}},{key:"disabled",get:function(){return this._disabled},set:function(e){e!==this._disabled&&(!0===e&&(this.selected=!1),e?this.beforeDisable.emit(this):this.beforeEnable.emit(this),this._disabled=e,this.toggleDisabledClass(),e?this.disable.emit(this):this.enable.emit(this))}}]),e}()).\u0275fac=function(e){return new(e||en)(r.Rb(r.I),r.Rb(r.l))},en.\u0275dir=r.Mb({type:en,selectors:[["","igoListItem",""]],hostBindings:function(e,t){1&e&&r.ec("click",(function(){return t.onClick()}))},inputs:{color:"color",focused:"focused",selected:"selected",disabled:"disabled"},outputs:{beforeSelect:"beforeSelect",beforeFocus:"beforeFocus",beforeUnselect:"beforeUnselect",beforeUnfocus:"beforeUnfocus",beforeDisable:"beforeDisable",beforeEnable:"beforeEnable",focus:"focus",unfocus:"unfocus",select:"select",unselect:"unselect",disable:"disable",enable:"enable"}}),en.focusedCls="igo-list-item-focused",en.selectedCls="igo-list-item-selected",en.disabledCls="igo-list-item-disabled",en),yr=((Qo=function(){function e(t){_classCallCheck(this,e),this.el=t,this._navigation=!0,this._selection=!0,this.subscriptions=[]}return _createClass(e,[{key:"handleKeyboardEvent",value:function(e){this.navigationEnabled&&("ArrowUp"===e.key||"ArrowDown"===e.key?(e.preventDefault(),this.navigate(e.key)):"Enter"===e.key&&this.select(this.focusedItem))}},{key:"ngOnInit",value:function(){this.enableNavigation()}},{key:"ngAfterViewInit",value:function(){var e=this;this.listItems.length&&this.init(),this.listItems$$=this.listItems.changes.subscribe((function(t){return e.init()}))}},{key:"ngOnDestroy",value:function(){this.listItems$$.unsubscribe()}},{key:"focus",value:function(e){this.selection&&(this.unfocus(),void 0!==e&&(e.focused=!0))}},{key:"unfocus",value:function(){void 0!==this.focusedItem&&(this.focusedItem.focused=!1),this.focusedItem=void 0}},{key:"focusNext",value:function(){var e,t=this.listItems.toArray(),i=this.el.nativeElement,o=!0,n=this.getFocusedIndex();for(void 0===n&&(n=-1);o&&n<t.length-1;)o=(e=t[n+=1]).disabled;void 0!==e&&this.focus(e),t[n+1]?void 0===e||this.isScrolledIntoView(e.el.nativeElement)||(i.scrollTop=e.el.nativeElement.offsetTop+e.el.nativeElement.children[0].offsetHeight-i.clientHeight):i.scrollTop=i.scrollHeight-i.clientHeight}},{key:"focusPrevious",value:function(){for(var e,t=this.listItems.toArray(),i=this.el.nativeElement,o=!0,n=this.getFocusedIndex();o&&n>0;)o=(e=t[n-=1]).disabled;void 0!==e&&this.focus(e),t[n-1]?void 0===e||this.isScrolledIntoView(e.el.nativeElement)||(i.scrollTop=e.el.nativeElement.offsetTop-3):i.scrollTop=0}},{key:"select",value:function(e){this.selection&&(this.unselect(),void 0!==e&&(e.selected=!0))}},{key:"unselect",value:function(){this.unfocus(),void 0!==this.selectedItem&&(this.selectedItem.selected=!1),this.selectedItem=void 0}},{key:"enableNavigation",value:function(){this.navigation&&(this.navigationEnabled=!0)}},{key:"disableNavigation",value:function(){this.navigationEnabled=!1}},{key:"scrollToItem",value:function(e){this.el.nativeElement.scrollTop=e.getOffsetTop()}},{key:"isScrolledIntoView",value:function(e){var t=this.el.nativeElement.scrollTop+this.el.nativeElement.offsetTop,i=e.offsetTop;return i+e.children[0].offsetHeight<=t+this.el.nativeElement.clientHeight&&i>=t}},{key:"init",value:function(){this.subscribe(),this.selectedItem=this.findSelectedItem(),this.focusedItem=this.findFocusedItem(),this.enableNavigation()}},{key:"subscribe",value:function(){var e=this;this.unsubscribe(),this.listItems.toArray().forEach((function(t){e.subscriptions.push(t.beforeSelect.subscribe((function(t){return e.handleItemBeforeSelect(t)}))),e.subscriptions.push(t.select.subscribe((function(t){return e.handleItemSelect(t)}))),e.subscriptions.push(t.beforeFocus.subscribe((function(t){return e.handleItemBeforeFocus(t)}))),e.subscriptions.push(t.focus.subscribe((function(t){return e.handleItemFocus(t)})))}),this)}},{key:"unsubscribe",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()})),this.subscriptions=[]}},{key:"handleItemBeforeFocus",value:function(e){e!==this.focusedItem&&this.unfocus()}},{key:"handleItemFocus",value:function(e){this.focusedItem=e}},{key:"handleItemBeforeSelect",value:function(e){e!==this.focusedItem&&this.unselect()}},{key:"handleItemSelect",value:function(e){this.selectedItem=e}},{key:"findSelectedItem",value:function(){return this.listItems.toArray().find((function(e){return e.selected}))}},{key:"findFocusedItem",value:function(){return this.listItems.toArray().find((function(e){return e.focused}))}},{key:"getFocusedIndex",value:function(){var e=this;return this.listItems.toArray().findIndex((function(t){return t===e.focusedItem}))}},{key:"navigate",value:function(e){switch(e){case"ArrowUp":this.focusPrevious();break;case"ArrowDown":this.focusNext()}}},{key:"navigation",get:function(){return this._navigation},set:function(e){this._navigation=e}},{key:"selection",get:function(){return this._selection},set:function(e){this._selection=e}},{key:"selectedItem",get:function(){return this._selectedItem},set:function(e){this.focusedItem=e,this._selectedItem=e}},{key:"focusedItem",get:function(){return this._focusedItem},set:function(e){this._focusedItem=e}}]),e}()).\u0275fac=function(e){return new(e||Qo)(r.Rb(r.l))},Qo.\u0275cmp=r.Lb({type:Qo,selectors:[["igo-list"]],contentQueries:function(e,t,i){var o;1&e&&r.Kb(i,vr,!0),2&e&&r.uc(o=r.fc())&&(t.listItems=o)},hostBindings:function(e,t){1&e&&r.ec("keydown",(function(e){return t.handleKeyboardEvent(e)}),!1,r.xc)("enter",(function(e){return t.handleKeyboardEvent(e)}),!1,r.xc)},inputs:{navigation:"navigation",selection:"selection"},ngContentSelectors:ri,decls:2,vars:3,consts:[["igoClickout","",3,"ngClass","clickout","click"]],template:function(e,t){1&e&&(r.nc(),r.Xb(0,"mat-list",0),r.ec("clickout",(function(){return t.disableNavigation()}))("click",(function(){return t.enableNavigation()})),r.mc(1),r.Wb()),2&e&&r.oc("ngClass",r.rc(1,bi,t.selection))},directives:[h.a,Ln,m.j],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:auto;position:relative}mat-list[_ngcontent-%COMP%]{padding-top:0}[_nghost-%COMP%]{position:static}[_nghost-%COMP%]     .mat-list .mat-list-item .mat-list-text>*{-webkit-box-orient:vertical;-webkit-line-clamp:2;display:-webkit-box;line-height:18px;max-height:36px;overflow:hidden;text-overflow:ellipsis;white-space:normal}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar .mat-list-item-content{display:-webkit-flex;height:46px;padding:3px}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar{height:46px}[_nghost-%COMP%]     .mat-list   igo-collapsible>.mat-list-item>.mat-list-item-content>.mat-list-text>.mat-line{font-weight:700;opacity:.9}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar .mat-list-item-content>mat-icon{padding:8px}[_nghost-%COMP%]     [igolistitem] mat-list-item [mat-list-avatar]{height:auto;width:40px}[_nghost-%COMP%]   mat-list.selectable[_ngcontent-%COMP%]     [igolistitem]:not(.igo-list-item-disabled) mat-list-item:hover{cursor:pointer}[_nghost-%COMP%]     [igolistitem]:focus{outline:none}"]}),Qo),kr=((Jo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:Jo}),Jo.\u0275inj=r.Ob({factory:function(e){return new(e||Jo)},imports:[[m.c,u.b,h.e,Tn]]}),Jo),Sr=((Zo=function(){function e(){_classCallCheck(this,e),this._withHeader=!0}return _createClass(e,[{key:"title",get:function(){return this._title},set:function(e){this._title=e}},{key:"withHeader",get:function(){return this._withHeader},set:function(e){this._withHeader=e}}]),e}()).\u0275fac=function(e){return new(e||Zo)},Zo.\u0275cmp=r.Lb({type:Zo,selectors:[["igo-panel"]],hostVars:2,hostBindings:function(e,t){2&e&&r.Ib("igo-panel-with-header",t.withHeader)},inputs:{title:"title",withHeader:"withHeader"},ngContentSelectors:ki,decls:3,vars:1,consts:[["class","igo-panel-header mat-typography","title","",4,"ngIf"],["title","",1,"igo-panel-content"],["title","",1,"igo-panel-header","mat-typography"],[1,"igo-panel-title"]],template:function(e,t){1&e&&(r.nc(yi),r.Gc(0,vi,7,1,"div",0),r.Xb(1,"div",1),r.mc(2),r.Wb()),2&e&&r.oc("ngIf",t.withHeader)},directives:[m.l],styles:["[_nghost-%COMP%]{display:block}.igo-panel-header[_ngcontent-%COMP%]{height:46px;padding:3px;text-align:center}.igo-panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{height:40px;margin:0}.igo-panel-header[_ngcontent-%COMP%]     [panelleftbutton]{float:left;margin-right:-40px}.igo-panel-header[_ngcontent-%COMP%]     [panelrightbutton]{float:right}.igo-panel-content[_ngcontent-%COMP%]{overflow:auto}.igo-panel-with-header[_nghost-%COMP%]   .igo-panel-content[_ngcontent-%COMP%]{height:calc(100% - 46px)}[_nghost-%COMP%]:not(.igo-panel-with-header)   .igo-panel-content[_ngcontent-%COMP%]{height:100%}.igo-panel-title[_ngcontent-%COMP%]{display:block;float:left;font-size:1.17em;font-weight:700;height:100%;line-height:40px;margin-left:40px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:calc(100% - 80px)}"],changeDetection:0}),Zo),Cr=((Ko=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Ko}),Ko.\u0275inj=r.Ob({factory:function(e){return new(e||Ko)},imports:[[m.c]]}),Ko),wr=((Yo=function(){function e(){_classCallCheck(this,e),this.shown$=new L.a(!1)}return _createClass(e,[{key:"show",value:function(){this.shown=!0}},{key:"hide",value:function(){this.shown=!1}},{key:"shown",set:function(e){this.shown$.next(e)},get:function(){return this.shown$.value}}]),e}()).\u0275fac=function(e){return new(e||Yo)},Yo.\u0275cmp=r.Lb({type:Yo,selectors:[["igo-spinner"]],inputs:{shown:"shown"},decls:4,vars:5,consts:[[3,"ngClass"],[1,"igo-spinner-background"],["diameter","40","mode","indeterminate"]],template:function(e,t){1&e&&(r.Xb(0,"div",0),r.jc(1,"async"),r.Sb(2,"div",1),r.Sb(3,"mat-progress-spinner",2),r.Wb()),2&e&&r.oc("ngClass",r.rc(3,Si,r.kc(1,1,t.shown$)))},directives:[m.j,ct.a],pipes:[m.b],styles:[".igo-spinner-container[_ngcontent-%COMP%]{display:none;pointer-events:none}.igo-spinner-container.igo-spinner-shown[_ngcontent-%COMP%]{display:block}mat-progress-spinner[_ngcontent-%COMP%]{border-radius:50%;height:40px;width:40px}.igo-spinner-background[_ngcontent-%COMP%]{border:4px solid #fff;border-radius:50%;height:36px;left:2px;position:absolute;top:2px;width:36px}"]}),Yo),xr=((Uo=function(){function e(t,i){_classCallCheck(this,e),this.spinner=t,this.activityService=i}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.counter$$=this.activityService.counter$.pipe(Object(O.a)(50)).subscribe((function(t){t>0?e.spinner.show():e.spinner.hide()}))}},{key:"ngOnDestroy",value:function(){this.counter$$.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||Uo)(r.Rb(wr,2),r.Rb(J))},Uo.\u0275dir=r.Mb({type:Uo,selectors:[["","igoSpinnerActivity",""]],features:[r.Cb([wr])]}),Uo),Or=((Ho=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Ho}),Ho.\u0275inj=r.Ob({factory:function(e){return new(e||Ho)},imports:[[m.c,ct.b]]}),Ho),Ir=function(){function e(t){_classCallCheck(this,e),this.dataChange=new L.a([]),t&&this.dataChange.next(t)}return _createClass(e,[{key:"set",value:function(e){this.dataChange.next(e)}},{key:"add",value:function(e){var t=this.data.slice();t.push(e),this.set(t)}},{key:"remove",value:function(e){var t=this.data.slice(),i=t.indexOf(e);t.splice(i,1),this.set(t)}},{key:"data",get:function(){return this.dataChange.value}}]),e}(),Lr=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o,n){var r;return _classCallCheck(this,i),(r=t.call(this))._database=e,r._model=o,r._sort=n,r._filterChange=new L.a(""),r}return _createClass(i,[{key:"connect",value:function(){var e=this;if(!this._database)return Object(Ne.a)([]);var t=[this._database.dataChange,this._filterChange,this._sort.sortChange];return Object(Ne.a).apply(void 0,t).pipe(Object(w.a)((function(){return e.getFilteredData(e._database.data)})),Object(w.a)((function(t){return e.getSortedData(t)})))}},{key:"disconnect",value:function(){}},{key:"getFilteredData",value:function(e){var t=this;return this.filter?e.slice().filter((function(e){return-1!==t._model.columns.filter((function(e){return e.filterable})).map((function(t){return E.resolve(e,t.name)})).join(" ").toLowerCase().indexOf(t.filter.toLowerCase())})):e}},{key:"getSortedData",value:function(e){var t=this;return this._sort.active&&""!==this._sort.direction?e.sort((function(e,i){var o=E.resolve(e,t._sort.active),n=E.resolve(i,t._sort.active);return E.naturalCompare(n,o,t._sort.direction)})):e}},{key:"filter",get:function(){return this._filterChange.value},set:function(e){this._filterChange.next(e)}}]),i}(lt.b),Tr=function(e){return e[e.primary=0]="primary",e[e.accent=1]="accent",e[e.warn=2]="warn",e}({}),Fr=((cn=function(){function e(){_classCallCheck(this,e),this._hasFIlterInput=!0,this.selection=new lt.c(!0,[]),this.select=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.dataSource=new Lr(this.database,this.model,this.sort),this.model&&(this.displayedColumns=this.model.columns.filter((function(e){return!1!==e.displayed})).map((function(e){return e.name})),this.model.selectionCheckbox&&this.displayedColumns.unshift("selectionCheckbox"),this.model.actions&&this.model.actions.length&&this.displayedColumns.push("action")),this.selection.changed.subscribe((function(t){return e.select.emit(t)}))}},{key:"ngAfterViewInit",value:function(){var e=this;this.filter&&Object(M.a)(this.filter.nativeElement,"keyup").pipe(Object(O.a)(150),Object(A.a)()).subscribe((function(){e.dataSource&&(e.dataSource.filter=e.filter.nativeElement.value)}))}},{key:"ngOnChanges",value:function(e){e.database&&(this.dataSource=new Lr(this.database,this.model,this.sort),this.selection.clear())}},{key:"getActionColor",value:function(e){return Tr[e]}},{key:"getValue",value:function(e,t){return E.resolve(e,t)}},{key:"isAllSelected",value:function(){return this.selection.selected.length===this.database.data.length}},{key:"masterToggle",value:function(){var e=this;this.isAllSelected()?this.selection.clear():this.database.data.forEach((function(t){return e.selection.select(t)}))}},{key:"handleClickAction",value:function(e,t,i){e.stopPropagation(),t.click(i)}},{key:"database",get:function(){return this._database},set:function(e){this._database=e}},{key:"model",get:function(){return this._model},set:function(e){this._model=e}},{key:"hasFilterInput",get:function(){return this._hasFIlterInput},set:function(e){this._hasFIlterInput=e}}]),e}()).\u0275fac=function(e){return new(e||cn)},cn.\u0275cmp=r.Lb({type:cn,selectors:[["igo-table"]],viewQuery:function(e,t){var i;1&e&&(r.Oc(Ci,!0),r.Ec(rt.a,!0)),2&e&&(r.uc(i=r.fc())&&(t.filter=i.first),r.uc(i=r.fc())&&(t.sort=i.first))},inputs:{database:"database",model:"model",hasFilterInput:"hasFilterInput"},outputs:{select:"select"},features:[r.Bb],decls:14,vars:5,consts:[[1,"table-box"],["class","table-header",4,"ngIf"],[1,"table-container"],["mat-table","","matSort","",3,"dataSource"],["table",""],["matColumnDef","selectionCheckbox"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[1,"table-header"],["floatPlaceholder","never"],["matInput","",3,"placeholder"],["filter",""],["mat-header-cell",""],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","click","change"],[3,"matColumnDef"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["cellHTML",""],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"matCellDef"],["mat-cell","",1,"mat-cell-text",3,"ngClass"],["mat-cell","","class","mat-cell-text",3,"ngClass","innerHTML",4,"matCellDef"],["mat-cell","",1,"mat-cell-text",3,"ngClass","innerHTML"],["mat-mini-fab","",3,"color","click",4,"ngFor","ngForOf"],["mat-mini-fab","",3,"color","click"],[3,"svgIcon"],["mat-header-row",""],["mat-row","",3,"ngClass","click"]],template:function(e,t){1&e&&(r.Xb(0,"div",0),r.Gc(1,wi,5,3,"div",1),r.Xb(2,"div",2),r.Xb(3,"table",3,4),r.Vb(5,5),r.Gc(6,xi,2,2,"th",6),r.Gc(7,Oi,2,1,"td",7),r.Ub(),r.Gc(8,ji,6,5,"ng-container",8),r.Vb(9,9),r.Gc(10,Ri,1,0,"th",6),r.Gc(11,Ei,2,1,"td",7),r.Ub(),r.Gc(12,Wi,1,0,"tr",10),r.Gc(13,Xi,1,2,"tr",11),r.Wb(),r.Wb(),r.Wb()),2&e&&(r.Db(1),r.oc("ngIf",t.hasFilterInput),r.Db(2),r.oc("dataSource",t.dataSource),r.Db(5),r.oc("ngForOf",t.model.columns),r.Db(4),r.oc("matHeaderRowDef",t.displayedColumns),r.Db(1),r.oc("matRowDefColumns",t.displayedColumns))},directives:[m.l,Ke.j,rt.a,Ke.c,Ke.e,Ke.b,m.k,Ke.g,Ke.i,it.c,et.b,Ke.d,v.a,Ke.a,rt.b,m.j,l.a,u.a,Ke.f,Ke.h],pipes:[U.d],styles:["[_nghost-%COMP%]{display:block;height:100%;width:100%}.table-container[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;height:100%;overflow:auto}.table-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.table-header[_ngcontent-%COMP%]{align-items:baseline;display:flex;flex:0 1 auto;font-size:20px;justify-content:space-between;max-width:500px;min-height:64px;padding:8px 24px 0}tr[mat-header-row][_ngcontent-%COMP%], tr[mat-row][_ngcontent-%COMP%]{height:60px}.mat-cell-text[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word}td[mat-cell][_ngcontent-%COMP%]{padding-right:15px}th.mat-header-cell[_ngcontent-%COMP%]{padding-right:5px}button[_ngcontent-%COMP%]{margin-right:10px}"]}),cn),_r=((sn=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:sn}),sn.\u0275inj=r.Ob({factory:function(e){return new(e||sn)},imports:[[m.c,tt.k,ut.r,u.b,l.b,Ke.l,it.e,et.c,rt.c,v.b,Ce]]}),sn),Mr=function(e){return e.White="white",e.Grey="grey",e.Primary="primary",e}({});function Dr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"300ms",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ease-in-out";return Object(ht.n)("toolSlideInOut",[Object(ht.k)("enter",Object(ht.l)({transform:"translate3d(0, 0, 0)"})),Object(ht.m)("void => enter",Object(ht.e)(e+" "+t))])}var Pr,Ar,jr,Rr,$r,Er,Wr,Xr,Gr,Br,Vr,Nr,zr,qr,Hr,Ur,Yr,Kr,Zr,Jr,Qr,ea,ta,ia,oa,na,ra=((Wr=function(){function e(){_classCallCheck(this,e),this.activeTool$=new L.a(void 0),this.actionStore=new kn([]),this.animation$=new L.a("none"),this.toolbar$=new L.a([]),this.toolbarWithTitle$=this.activeTool$.pipe(Object(w.a)((function(e){return void 0===e}))),this.animating$=new L.a(!1),this.animate=!1,this.color=Mr.White}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.toolbar$$=this.toolbox.toolbar$.subscribe((function(t){return e.onToolbarChange(t)})),this.activeTool$$=this.toolbox.activeTool$.subscribe((function(t){return e.onActiveToolChange(t)}))}},{key:"ngOnDestroy",value:function(){this.toolbar$$.unsubscribe(),this.activeTool$$.unsubscribe(),this.actionStore.destroy()}},{key:"onAnimationStart",value:function(){this.animating$.next(!0)}},{key:"onAnimationComplete",value:function(){this.animating$.next(!1)}},{key:"getToolInputs",value:function(e){return e.options||{}}},{key:"onToolbarChange",value:function(e){this.setToolbar(e)}},{key:"onActiveToolChange",value:function(e){var t=this;this.animate?this.onAnimate((function(){return t.setActiveTool(e)})):this.setActiveTool(e)}},{key:"setActiveTool",value:function(e){if(void 0===e)this.actionStore.state.updateAll({active:!1});else{var t=this.actionStore.get(e.name);void 0!==t&&this.actionStore.state.update(t,{active:!0},!0)}this.activeTool$.next(e),this.animate&&this.animation$.next("enter")}},{key:"setToolbar",value:function(e){var t=this,i=e.reduce((function(e,i){var o=t.toolbox.getTool(i);return void 0===o||e.push({id:o.name,title:o.title,icon:o.icon,tooltip:o.tooltip,args:[o,t.toolbox],handler:function(e,t){t.activateTool(e.name)},ngClass:function(e,i){return t.toolbox.activeTool$.pipe(Object(w.a)((function(t){var i=!1;void 0!==t&&e.name===t.name&&(i=!0);var o=!1;return void 0!==t&&e.name===t.parent&&(o=!0),{"tool-activated":i,"children-tool-activated":o}})))}}),e}),[]);this.actionStore.load(i),this.toolbar$.next(e)}},{key:"onAnimate",value:function(e){var t=this;this.unAnimate(),this.animating$$=this.animating$.subscribe((function(i){i||(e.call(t),t.unAnimate())}))}},{key:"unAnimate",value:function(){this.animating$$&&this.animating$$.unsubscribe()}},{key:"classColorGrey",get:function(){return this.color===Mr.Grey}},{key:"classColorPrimary",get:function(){return this.color===Mr.Primary}}]),e}()).\u0275fac=function(e){return new(e||Wr)},Wr.\u0275cmp=r.Lb({type:Wr,selectors:[["igo-toolbox"]],hostVars:4,hostBindings:function(e,t){2&e&&r.Ib("color-grey",t.classColorGrey)("color-primary",t.classColorPrimary)},inputs:{animate:"animate",color:"color",toolbox:"toolbox"},decls:4,vars:6,consts:[[3,"store","withIcon","withTitle","withTooltip","scrollActive","horizontal",4,"ngIf"],["class","igo-tool-container",3,"ngClass",4,"ngIf"],[3,"store","withIcon","withTitle","withTooltip","scrollActive","horizontal"],[1,"igo-tool-container",3,"ngClass"],[3,"component","inputs"]],template:function(e,t){1&e&&(r.Gc(0,Gi,4,12,"igo-actionbar",0),r.jc(1,"async"),r.Gc(2,Vi,3,9,"div",1),r.jc(3,"async")),2&e&&(r.oc("ngIf",r.kc(1,2,t.toolbar$).length>0),r.Db(2),r.oc("ngIf",r.kc(3,4,t.activeTool$)))},directives:[m.l,Sn,m.j,Bn],pipes:[m.b],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:hidden;position:relative;width:100%}.igo-tool-container[_ngcontent-%COMP%]{bottom:0;left:0;position:absolute;right:0;top:0}.igo-tool-container-with-animation[_ngcontent-%COMP%]{transform:translate3d(100%,0,0)}.igo-tool-container-with-toolbar[_ngcontent-%COMP%]{left:50px}igo-actionbar[_ngcontent-%COMP%]{height:100%}igo-actionbar.with-title[_ngcontent-%COMP%]{overflow:auto;width:100%}igo-actionbar[_ngcontent-%COMP%]:not(.with-title){-o-box-shadow:2px 0 2px 0 #ddd;box-shadow:2px 0 2px 0 #ddd;overflow:hidden;width:48px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){igo-actionbar[_ngcontent-%COMP%]:not(.with-title){overflow:auto}}igo-dynamic-outlet[_ngcontent-%COMP%]{overflow:auto}"],data:{animation:[Dr()]},changeDetection:0}),Wr),aa=((Er=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Er}),Er.\u0275inj=r.Ob({factory:function(e){return new(e||Er)},imports:[[m.c,xn,Nn]]}),Er),sa=(($r=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[pr]}}}]),e}()).\u0275mod=r.Pb({type:$r}),$r.\u0275inj=r.Ob({factory:function(e){return new(e||$r)},imports:[[m.c],aa]}),$r),ca=((Rr=function(){function e(){var t=this;_classCallCheck(this,e),this.baseSubscribers={cancel:function(e){return t.onCancel(e)},complete:function(e){return t.onComplete(e)}},this.subscribers={},this.complete=new r.o,this.cancel=new r.o}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.destroyWidget()}},{key:"getEffectiveSubscribers",value:function(){var e=this,t=Object.assign({},this.subscribers);return Object.keys(this.baseSubscribers).forEach((function(i){var o=t[i],n=e.baseSubscribers[i];t[i]=void 0!==o?function(e){o(e),n(e)}:n})),t}},{key:"onCancel",value:function(e){this.cancel.emit(e),this.destroyWidget()}},{key:"onComplete",value:function(e){this.complete.emit(e),this.destroyWidget()}},{key:"destroyWidget",value:function(){void 0!==this.widget&&this.widget.destroy(),this.widget=void 0}}]),e}()).\u0275fac=function(e){return new(e||Rr)},Rr.\u0275cmp=r.Lb({type:Rr,selectors:[["igo-widget-outlet"]],inputs:{subscribers:"subscribers",widget:"widget",inputs:"inputs"},outputs:{complete:"complete",cancel:"cancel"},decls:1,vars:1,consts:[[3,"component","inputs","subscribers",4,"ngIf"],[3,"component","inputs","subscribers"]],template:function(e,t){1&e&&r.Gc(0,Ni,1,3,"igo-dynamic-outlet",0),2&e&&r.oc("ngIf",t.widget)},directives:[m.l,Bn],styles:["igo-dynamic-outlet[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),Rr),la=((jr=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:jr}),jr.\u0275inj=r.Ob({factory:function(e){return new(e||jr)},imports:[[m.c,Nn]]}),jr),ua=((Ar=function(){function e(t){_classCallCheck(this,e),this.dynamicComponentService=t}return _createClass(e,[{key:"create",value:function(e){return this.dynamicComponentService.create(e)}}]),e}()).\u0275fac=function(e){return new(e||Ar)(r.bc(Gn))},Ar.\u0275prov=Object(r.Nb)({factory:function(){return new Ar(Object(r.bc)(Gn))},token:Ar,providedIn:"root"}),Ar),ha=((Pr=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Pr}),Pr.\u0275inj=r.Ob({factory:function(e){return new(e||Pr)},providers:[ua],imports:[[m.c,la],la]}),Pr),da=function(e){_inherits(i,e);var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),(e=t.apply(this,arguments)).activeWorkspace$=new L.a(void 0),e}return _createClass(i,[{key:"activateWorkspace",value:function(e){var t=this.activeWorkspace$.value;void 0!==t&&t.deactivate(),this.deactivateWorkspace(),void 0!==e&&(this.state.update(e,{active:!0,selected:!0},!0),this.activeWorkspace$.next(e),e.activate())}},{key:"deactivateWorkspace",value:function(){var e=this.activeWorkspace$.value;void 0!==e&&(e.deactivate(),this.activeWorkspace$.next(void 0))}}]),i}(hn),pa=((Gr=function(){function e(){_classCallCheck(this,e),this.selectedChange=new r.o}return _createClass(e,[{key:"getWorkspaceTitle",value:function(e){return Zi(e)}},{key:"onSelectedChange",value:function(e){var t=e.value;this.store.activateWorkspace(t),this.selectedChange.emit({selected:!0,value:t})}}]),e}()).\u0275fac=function(e){return new(e||Gr)},Gr.\u0275cmp=r.Lb({type:Gr,selectors:[["igo-workspace-selector"]],inputs:{store:"store"},outputs:{selectedChange:"selectedChange"},decls:1,vars:3,consts:[[3,"store","multi","titleAccessor","selectedChange"]],template:function(e,t){1&e&&(r.Xb(0,"igo-entity-selector",0),r.ec("selectedChange",(function(e){return t.onSelectedChange(e)})),r.Wb()),2&e&&r.oc("store",t.store)("multi",!1)("titleAccessor",t.getWorkspaceTitle)},directives:[mn],styles:["igo-entity-selector[_ngcontent-%COMP%]     mat-form-field .mat-form-field-infix{padding:0}igo-entity-selector[_ngcontent-%COMP%]     mat-form-field .mat-form-field-wrapper{padding-bottom:1.75em}"],changeDetection:0}),Gr),ga=((Xr=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Xr}),Xr.\u0275inj=r.Ob({factory:function(e){return new(e||Xr)},imports:[[m.c,tr]]}),Xr),fa=function(){function e(t){_classCallCheck(this,e),this.options=t,this.widget$=new L.a(void 0),this.widgetInputs$=new L.a({}),this.widgetSubscribers$=new L.a({}),this.change=new P.a,this.active$=new L.a(!1)}return _createClass(e,[{key:"activate",value:function(){var e=this;!0===this.active&&this.deactivate(),this.active$.next(!0),void 0!==this.entityStore&&(this.entities$$=this.entityStore.stateView.all$().subscribe((function(){return e.onStateChange()}))),this.change.next()}},{key:"deactivate",value:function(){this.active$.next(!1),this.deactivateWidget(),void 0!==this.entities$$&&this.entities$$.unsubscribe(),void 0!==this.change$&&this.change$.unsubscribe()}},{key:"activateWidget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.widget$.next(e),this.widgetInputs$.next(t),this.widgetSubscribers$.next(i),this.change.next()}},{key:"deactivateWidget",value:function(){this.widget$.next(void 0),this.change.next()}},{key:"onStateChange",value:function(){this.change.next()}},{key:"id",get:function(){return this.options.id}},{key:"title",get:function(){return this.options.title}},{key:"meta",get:function(){return this.options.meta||{}}},{key:"entityStore",get:function(){return this.options.entityStore}},{key:"actionStore",get:function(){return this.options.actionStore}},{key:"widget",get:function(){return this.widget$.value}},{key:"hasWidget",get:function(){return void 0!==this.widget}},{key:"active",get:function(){return this.active$.value}}]),e}(),ma=((Nr=function(){function e(){_classCallCheck(this,e),this.deactivateWidget=new r.o}return _createClass(e,[{key:"onWidgetCancel",value:function(e){this.workspace.deactivateWidget(),this.deactivateWidget.emit(e)}},{key:"onWidgetComplete",value:function(e){this.workspace.deactivateWidget(),this.deactivateWidget.emit(e)}},{key:"widget$",get:function(){return this.workspace.widget$}},{key:"widgetInputs$",get:function(){return this.workspace.widgetInputs$}},{key:"widgetSubscribers$",get:function(){return this.workspace.widgetSubscribers$}}]),e}()).\u0275fac=function(e){return new(e||Nr)},Nr.\u0275cmp=r.Lb({type:Nr,selectors:[["igo-workspace-widget-outlet"]],inputs:{workspace:"workspace"},outputs:{deactivateWidget:"deactivateWidget"},decls:2,vars:3,consts:[[4,"ngIf"],[3,"widget","inputs","subscribers","cancel","complete"]],template:function(e,t){1&e&&(r.Gc(0,zi,4,7,"ng-container",0),r.jc(1,"async")),2&e&&r.oc("ngIf",r.kc(1,1,t.widget$))},directives:[m.l,ca],pipes:[m.b],styles:["igo-widget-outlet[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),Nr),ba=((Vr=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Vr}),Vr.\u0275inj=r.Ob({factory:function(e){return new(e||Vr)},imports:[[m.c,la]]}),Vr),va=((Br=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Br}),Br.\u0275inj=r.Ob({factory:function(e){return new(e||Br)},imports:[[m.c],ga,ba]}),Br),ya=f.e.forChild([{path:"home",component:(zr=function(){function e(t){_classCallCheck(this,e),this.interactiveTourService=t}return _createClass(e,[{key:"startTour",value:function(){this.interactiveTourService.startTour("global")}}]),e}(),zr.\u0275fac=function(e){return new(e||zr)(r.Rb(hr))},zr.\u0275cmp=r.Lb({type:zr,selectors:[["app-home"]],decls:56,vars:0,consts:[[2,"text-align","center"],["id","igo-title"],["width","180","src","assets/igo2/core/logo.png",1,"igo-logo"],["tourToStart","global","menuIsOpen","true","styleButton","raised"],["target","_blank","rel","noopener","href","https://github.com/infra-geo-ouverte/igo2-lib/blob/master/README.md#user-installation"],["target","_blank","rel","noopener","href","https://angular.io/docs"]],template:function(e,t){1&e&&(r.Xb(0,"div",0),r.Xb(1,"h1",1),r.Ic(2," Welcome to IGO "),r.Wb(),r.Sb(3,"img",2),r.Wb(),r.Xb(4,"p"),r.Sb(5,"igo-interactive-tour",3),r.Wb(),r.Xb(6,"p"),r.Ic(7," IGO2 library contains many components and services that may benefit any web application. "),r.Sb(8,"br"),r.Ic(9," IGO2 library is open source project using Angular, Angular Material and OpenLayers.\n"),r.Wb(),r.Xb(10,"h3"),r.Ic(11,"IGO2 library is divided into several elements: "),r.Wb(),r.Xb(12,"ul"),r.Xb(13,"li"),r.Xb(14,"b"),r.Ic(15,"@igo2/utils"),r.Wb(),r.Ic(16," : Basic utilies without dependency (ex: base64, clipboard, uuid)"),r.Wb(),r.Xb(17,"li"),r.Xb(18,"b"),r.Ic(19,"@igo2/core"),r.Wb(),r.Ic(20," : Element affecting the core of the application (ex: config, language, message, media, request)"),r.Wb(),r.Xb(21,"li"),r.Xb(22,"b"),r.Ic(23,"@igo2/common"),r.Wb(),r.Ic(24," : Library containing reusable components (ex: clickout, drag-drop, list, panel, spinner, table)"),r.Wb(),r.Xb(25,"li"),r.Xb(26,"b"),r.Ic(27,"@igo2/auth"),r.Wb(),r.Ic(28," : Library grouping the authentication and security module"),r.Wb(),r.Xb(29,"li"),r.Xb(30,"b"),r.Ic(31,"@igo2/geo"),r.Wb(),r.Ic(32," : Library containing the geomatic components. Depends on Openlayers."),r.Wb(),r.Xb(33,"li"),r.Xb(34,"b"),r.Ic(35,"@igo2/context"),r.Wb(),r.Ic(36," : Library of components uniting @igo2/geo and @igo2/auth"),r.Wb(),r.Xb(37,"li"),r.Xb(38,"b"),r.Ic(39,"@igo2/integration"),r.Wb(),r.Ic(40," : Library integrate basic components"),r.Wb(),r.Wb(),r.Xb(41,"h2"),r.Ic(42,"Here are some links to help you start: "),r.Wb(),r.Xb(43,"ul"),r.Xb(44,"li"),r.Xb(45,"h2"),r.Xb(46,"a",4),r.Ic(47,"Installation"),r.Wb(),r.Wb(),r.Wb(),r.Xb(48,"li"),r.Xb(49,"h2"),r.Xb(50,"a",5),r.Ic(51,"Angular Documentation"),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Ic(52," *** Modules in "),r.Xb(53,"code"),r.Ic(54,"@igo2/core"),r.Wb(),r.Ic(55," must be imported only once\n"))},directives:[gr],styles:[""]}),zr)}]),ka=((qr=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:qr}),qr.\u0275inj=r.Ob({factory:function(e){return new(e||qr)},imports:[[ya,fr,g.b,u.b,l.b]]}),qr),Sa=f.e.forChild([{path:"activity",component:(Hr=function(){function e(t){_classCallCheck(this,e),this.activityService=t,this.idsActivity=[]}return _createClass(e,[{key:"register",value:function(){this.idsActivity.push(this.activityService.register())}},{key:"unregister",value:function(){this.activityService.unregister(this.idsActivity.pop())}},{key:"counter",get:function(){return this.activityService.counter$.value}}]),e}(),Hr.\u0275fac=function(e){return new(e||Hr)(r.Rb(J))},Hr.\u0275cmp=r.Lb({type:Hr,selectors:[["app-activity"]],decls:31,vars:1,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/activity"],["mat-raised-button","",3,"click"],["igoSpinnerActivity",""]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Core"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Activity"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"p"),r.Ic(7,"Register activities in service. Use to display a loading icon"),r.Wb(),r.Xb(8,"li"),r.Ic(9,"Import "),r.Xb(10,"code"),r.Ic(11,"IgoActivityModule"),r.Wb(),r.Ic(12," only if you want register http calls"),r.Wb(),r.Xb(13,"li"),r.Ic(14,"Import "),r.Xb(15,"code"),r.Ic(16,"IgoActivityModule"),r.Wb(),r.Ic(17," only once"),r.Wb(),r.Sb(18,"br"),r.Ic(19," See the "),r.Xb(20,"a",0),r.Ic(21," code of this example"),r.Wb(),r.Sb(22,"hr"),r.Wb(),r.Xb(23,"mat-card-actions"),r.Xb(24,"button",1),r.ec("click",(function(){return t.register()})),r.Ic(25,"Register"),r.Wb(),r.Xb(26,"button",1),r.ec("click",(function(){return t.unregister()})),r.Ic(27,"Unregister"),r.Wb(),r.Wb(),r.Xb(28,"p"),r.Ic(29),r.Wb(),r.Sb(30,"igo-spinner",2),r.Wb()),2&e&&(r.Db(29),r.Kc("Counter: ",t.counter,""))},directives:[b.a,b.e,b.f,b.c,b.b,l.a,wr,xr],styles:[""]}),Hr)}]),Ca=((Ur=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Ur}),Ur.\u0275inj=r.Ob({factory:function(e){return new(e||Ur)},imports:[[Sa,b.d,l.b,ee.forRoot(),Or]]}),Ur),wa=f.e.forChild([{path:"config",component:(Yr=function e(t){_classCallCheck(this,e),this.configService=t,this.configLanguage=this.configService.getConfig("language")},Yr.\u0275fac=function(e){return new(e||Yr)(r.Rb(ie))},Yr.\u0275cmp=r.Lb({type:Yr,selectors:[["app-config"]],decls:26,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/config"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Core"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"config"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"p"),r.Ic(7,"Load config in your angular application"),r.Wb(),r.Xb(8,"li"),r.Ic(9,"Import "),r.Xb(10,"code"),r.Ic(11,"IgoConfigModule"),r.Wb(),r.Ic(12," only once"),r.Wb(),r.Sb(13,"br"),r.Ic(14," See the "),r.Xb(15,"a",0),r.Ic(16," code of this example"),r.Wb(),r.Sb(17,"br"),r.Ic(18," See the "),r.Xb(19,"a",1),r.Ic(20," environment config"),r.Wb(),r.Sb(21,"hr"),r.Wb(),r.Xb(22,"p"),r.Ic(23),r.jc(24,"json"),r.Wb(),r.Sb(25,"p"),r.Wb()),2&e&&(r.Db(23),r.Kc("Config language: ",r.kc(24,1,t.configLanguage),""))},directives:[b.a,b.e,b.f,b.c],pipes:[m.f],styles:[""]}),Yr)}]),xa=((Kr=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Kr}),Kr.\u0275inj=r.Ob({factory:function(e){return new(e||Kr)},providers:[ne({default:a.igo})],imports:[[wa,m.c,b.d,l.b,se.forRoot()]]}),Kr),Oa=f.e.forChild([{path:"language",component:(Zr=function(){function e(t){_classCallCheck(this,e),this.languageService=t,this.app={title:"IGO"}}return _createClass(e,[{key:"changeLanguage",value:function(e){this.languageService.setLanguage(e),console.log(this.languageService)}}]),e}(),Zr.\u0275fac=function(e){return new(e||Zr)(r.Rb(Le))},Zr.\u0275cmp=r.Lb({type:Zr,selectors:[["app-language"]],decls:35,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/language"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/locale"],["mat-raised-button","",3,"click"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Core"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"language"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"p"),r.Ic(7,"Translate your angular application"),r.Wb(),r.Xb(8,"li"),r.Ic(9,"Import "),r.Xb(10,"code"),r.Ic(11,"IgoLanguageModule"),r.Wb(),r.Ic(12," only once"),r.Wb(),r.Sb(13,"br"),r.Ic(14," See the "),r.Xb(15,"a",0),r.Ic(16,"code of this example"),r.Wb(),r.Sb(17,"br"),r.Ic(18," See language section of the "),r.Xb(19,"a",1),r.Ic(20," environment config"),r.Wb(),r.Sb(21,"br"),r.Ic(22," See "),r.Xb(23,"a",2),r.Ic(24,"locale files"),r.Wb(),r.Sb(25,"hr"),r.Wb(),r.Xb(26,"mat-card-actions"),r.Xb(27,"button",3),r.ec("click",(function(){return t.changeLanguage("en")})),r.Ic(28,"English"),r.Wb(),r.Xb(29,"button",3),r.ec("click",(function(){return t.changeLanguage("fr")})),r.Ic(30,"Fran\xe7ais"),r.Wb(),r.Wb(),r.Xb(31,"p"),r.Ic(32),r.jc(33,"translate"),r.Wb(),r.Sb(34,"p"),r.Wb()),2&e&&(r.Db(32),r.Jc(r.lc(33,1,"welcome",t.app)))},directives:[b.a,b.e,b.f,b.c,b.b,l.a],pipes:[U.d],styles:[""]}),Zr)}]),Ia=((Jr=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Jr}),Jr.\u0275inj=r.Ob({factory:function(e){return new(e||Jr)},imports:[[Oa,b.d,l.b,Ce.forRoot()]]}),Jr),La=f.e.forChild([{path:"media",component:(Qr=function(){function e(t){_classCallCheck(this,e),this.mediaService=t}return _createClass(e,[{key:"media",get:function(){return this.mediaService.getMedia()}},{key:"orientation",get:function(){return this.mediaService.getOrientation()}},{key:"isTouchScreen",get:function(){return this.mediaService.isTouchScreen()}}]),e}(),Qr.\u0275fac=function(e){return new(e||Qr)(r.Rb(Ae))},Qr.\u0275cmp=r.Lb({type:Qr,selectors:[["app-media"]],decls:19,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/media"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Core"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Media"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"p"),r.Ic(7,"Detect type of media (mobile, tablet, desktop)"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"hr"),r.Wb(),r.Xb(13,"p"),r.Ic(14),r.Wb(),r.Xb(15,"p"),r.Ic(16),r.Wb(),r.Xb(17,"p"),r.Ic(18),r.Wb(),r.Wb()),2&e&&(r.Db(14),r.Kc("Current media: ",t.media,""),r.Db(2),r.Kc("Current orientation: ",t.orientation,""),r.Db(2),r.Kc("Device mode: ",t.isTouchScreen?"Touch device":"Not a touch device ",""))},directives:[b.a,b.e,b.f,b.c],styles:[""]}),Qr)}]),Ta=((ea=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:ea}),ea.\u0275inj=r.Ob({factory:function(e){return new(e||ea)},imports:[[La,b.d]]}),ea),Fa=f.e.forChild([{path:"message",component:(ta=function(){function e(t){_classCallCheck(this,e),this.messageService=t}return _createClass(e,[{key:"success",value:function(){this.messageService.success("Congratulations","Success")}},{key:"info",value:function(){this.messageService.info("Welcome to IGO","Info")}},{key:"alert",value:function(){this.messageService.alert("Warning","Alert")}},{key:"error",value:function(){this.messageService.error("There is a bug","Error")}}]),e}(),ta.\u0275fac=function(e){return new(e||ta)(r.Rb(Ie))},ta.\u0275cmp=r.Lb({type:ta,selectors:[["app-message"]],decls:30,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/message"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Core"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Message"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"p"),r.Ic(7,"Show message to user."),r.Wb(),r.Xb(8,"li"),r.Ic(9,"Import "),r.Xb(10,"code"),r.Ic(11,"IgoMessageModule"),r.Wb(),r.Ic(12," only once"),r.Wb(),r.Xb(13,"li"),r.Ic(14,"Dependencies: BrowserAnimationsModule "),r.Wb(),r.Sb(15,"br"),r.Ic(16," See the "),r.Xb(17,"a",0),r.Ic(18,"code of this example"),r.Wb(),r.Sb(19,"hr"),r.Wb(),r.Xb(20,"mat-card-actions"),r.Xb(21,"button",1),r.ec("click",(function(){return t.success()})),r.Ic(22,"Success message"),r.Wb(),r.Xb(23,"button",2),r.ec("click",(function(){return t.info()})),r.Ic(24,"Info message"),r.Wb(),r.Xb(25,"button",3),r.ec("click",(function(){return t.alert()})),r.Ic(26,"Alert message"),r.Wb(),r.Xb(27,"button",4),r.ec("click",(function(){return t.error()})),r.Ic(28,"Error message"),r.Wb(),r.Wb(),r.Wb(),r.Sb(29,"igo-message-center"))},directives:[b.a,b.e,b.f,b.c,b.b,l.a,we],styles:[""]}),ta)}]),_a=((ia=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:ia}),ia.\u0275inj=r.Ob({factory:function(e){return new(e||ia)},imports:[[Fa,b.d,l.b,xe.forRoot()]]}),ia),Ma=f.e.forChild([{path:"request",component:(oa=function(){function e(t,i){_classCallCheck(this,e),this.http=t,this.languageService=i}return _createClass(e,[{key:"callHttp",value:function(){this.http.get("https://geoegl.msp.gouv.qc.ca/apis/icherche/info").subscribe((function(e){console.log(e)}))}},{key:"callHttpError",value:function(){this.http.get("404").subscribe((function(e){console.log(e)}))}}]),e}(),oa.\u0275fac=function(e){return new(e||oa)(r.Rb(k.b),r.Rb(Le))},oa.\u0275cmp=r.Lb({type:oa,selectors:[["app-request"]],decls:30,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/request"],["mat-raised-button","",3,"click"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Core"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Request"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"p"),r.Ic(7,"Register http calls in console"),r.Wb(),r.Xb(8,"li"),r.Ic(9,"Import "),r.Xb(10,"code"),r.Ic(11,"IgoLoggingModule"),r.Wb(),r.Ic(12," only if you want register http calls in console"),r.Wb(),r.Xb(13,"li"),r.Ic(14,"Import "),r.Xb(15,"code"),r.Ic(16,"IgoErrorModule"),r.Wb(),r.Ic(17," only if you want register errors from http call in console"),r.Wb(),r.Xb(18,"li"),r.Ic(19,"Import modules only once"),r.Wb(),r.Sb(20,"br"),r.Ic(21," See the "),r.Xb(22,"a",0),r.Ic(23,"code of this example"),r.Wb(),r.Sb(24,"hr"),r.Wb(),r.Xb(25,"mat-card-actions"),r.Xb(26,"button",1),r.ec("click",(function(){return t.callHttp()})),r.Ic(27,"Log"),r.Wb(),r.Xb(28,"button",1),r.ec("click",(function(){return t.callHttpError()})),r.Ic(29,"Error"),r.Wb(),r.Wb(),r.Wb())},directives:[b.a,b.e,b.f,b.c,b.b,l.a],styles:[""]}),oa)}]),Da=((na=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:na}),na.\u0275inj=r.Ob({factory:function(e){return new(e||na)},imports:[[Ma,b.d,l.b,k.d,Ce.forRoot(),Fe.forRoot()]]}),na);function Pa(e,t){if(1&e&&r.Sb(0,"igo-actionbar",4),2&e){var i=r.ic();r.oc("store",i.store)("withIcon",!0)("horizontal",!0)("mode","context")}}var Aa,ja,Ra,$a,Ea,Wa,Xa,Ga,Ba=f.e.forChild([{path:"action",component:(Aa=function(){function e(t,i,o){_classCallCheck(this,e),this.overlay=t,this.mediaService=i,this.languageService=o,this.store=new kn([]),this.added$=new L.a(!1)}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.store.load([{id:"add",title:"Add",icon:"plus",tooltip:"Add Tooltip",handler:function(){alert("Add!"),e.added$.next(!0)}},{id:"edit",title:"Edit",icon:"pencil",tooltip:"Edit Tooltip",args:["1"],handler:function(e){alert("Edit item ".concat(e,"!"))},availability:function(){return e.added$}},{id:"delete",title:"Delete",tooltip:"Delete Tooltip",icon:"delete",handler:function(){alert("Delete!"),e.added$.next(!1)},availability:function(){return e.added$}}])}},{key:"ngOnDestroy",value:function(){this.store.destroy()}},{key:"actionbarMode",get:function(){return this.mediaService.media$.value===De.Desktop&&this.mediaService.orientation$.value===Pe.Landscape?yn.Dock:yn.Overlay}}]),e}(),Aa.\u0275fac=function(e){return new(e||Aa)(r.Rb(pt.c),r.Rb(Ae),r.Rb(Le))},Aa.\u0275cmp=r.Lb({type:Aa,selectors:[["app-action"]],decls:19,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/action"],[3,"store","withIcon","withTitle","horizontal","mode"],[3,"igoContextMenu"],["actionbarMenu",""],[3,"store","withIcon","horizontal","mode"]],template:function(e,t){if(1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Common"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Action"),r.Wb(),r.Xb(5,"mat-card-content"),r.Ic(6," See the "),r.Xb(7,"a",0),r.Ic(8,"code of this example"),r.Wb(),r.Wb(),r.Sb(9,"igo-actionbar",1),r.Wb(),r.Sb(10,"p"),r.Xb(11,"mat-card",2),r.Xb(12,"mat-card-subtitle"),r.Ic(13,"Common"),r.Wb(),r.Xb(14,"mat-card-title"),r.Ic(15,"Action context-menu"),r.Wb(),r.Sb(16,"div"),r.Wb(),r.Gc(17,Pa,1,4,"ng-template",null,3,r.Hc)),2&e){var i=r.vc(18);r.Db(9),r.oc("store",t.store)("withIcon",!0)("withTitle","overlay"===t.actionbarMode)("horizontal",!0)("mode",t.actionbarMode),r.Db(2),r.oc("igoContextMenu",i)}},directives:[b.a,b.e,b.f,b.c,Sn,jn],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),Aa)}]),Va=(($a=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:$a}),$a.\u0275inj=r.Ob({factory:function(e){return new(e||$a)},imports:[[Ba,l.b,b.d,xn,Rn]]}),$a),Na=((Ra=function(){function e(t){_classCallCheck(this,e),this.cdRef=t}return _createClass(e,[{key:"onUpdateInputs",value:function(){this.cdRef.detectChanges()}}]),e}()).\u0275fac=function(e){return new(e||Ra)(r.Rb(r.h))},Ra.\u0275cmp=r.Lb({type:Ra,selectors:[["app-salutation-component"]],inputs:{name:"name"},decls:2,vars:1,template:function(e,t){1&e&&(r.Xb(0,"p"),r.Ic(1),r.Wb()),2&e&&(r.Db(1),r.Kc("Hello, my name is ",t.name,"."))},encapsulation:2,changeDetection:0}),Ra),za=((ja=function(){function e(t){_classCallCheck(this,e),this.cdRef=t}return _createClass(e,[{key:"onUpdateInputs",value:function(){this.cdRef.detectChanges()}}]),e}()).\u0275fac=function(e){return new(e||ja)(r.Rb(r.h))},ja.\u0275cmp=r.Lb({type:ja,selectors:[["app-explanation-component"]],decls:2,vars:0,template:function(e,t){1&e&&(r.Xb(0,"p"),r.Ic(1,"I am a dynamic component, rendered into an IgoDynamicOutlet."),r.Wb())},encapsulation:2,changeDetection:0}),ja),qa=f.e.forChild([{path:"dynamic-component",component:(Ea=function(){function e(){_classCallCheck(this,e),this.component=Na,this.inputs={name:"Bob"}}return _createClass(e,[{key:"toggleComponent",value:function(){this.component=this.component===Na?za:Na}}]),e}(),Ea.\u0275fac=function(e){return new(e||Ea)},Ea.\u0275cmp=r.Lb({type:Ea,selectors:[["app-dynamic-component"]],decls:12,vars:2,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/dynamic-component"],[3,"component","inputs"],["mat-flat-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Common"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Dynamic Component"),r.Wb(),r.Xb(5,"mat-card-content"),r.Ic(6," See the "),r.Xb(7,"a",0),r.Ic(8,"code of this example"),r.Wb(),r.Wb(),r.Sb(9,"igo-dynamic-outlet",1),r.Xb(10,"button",2),r.ec("click",(function(){return t.toggleComponent()})),r.Ic(11,"Toggle Component"),r.Wb(),r.Wb()),2&e&&(r.Db(9),r.oc("component",t.component)("inputs",t.inputs))},directives:[b.a,b.e,b.f,b.c,Bn,l.a],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),Ea)}]),Ha=((Wa=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Wa}),Wa.\u0275inj=r.Ob({factory:function(e){return new(e||Wa)},imports:[[qa,l.b,b.d,Nn]]}),Wa),Ua=f.e.forChild([{path:"entity-table",component:(Xa=function(){function e(t){var i=this;_classCallCheck(this,e),this.languageService=t,this.store=new hn([]),this.entitySortChange$=new L.a(!1),this.paginatorOptions={pageSize:10},this.template={selection:!0,selectionCheckbox:!0,selectMany:!0,sort:!0,valueAccessor:function(e,t){return Yi(e,t)},columns:[{name:"selected",title:"Selected",valueAccessor:function(e){return i.store.state.get(e).selected?"radiobox-marked":"radiobox-blank"},renderer:qi.Icon},{name:"id",title:"ID"},{name:"name",title:"Name"},{name:"description",title:"Description",renderer:qi.HTML},{name:"action",title:"",valueAccessor:function(e){return[{icon:"home",color:"warn",click:function(e){console.log(e)}}]},renderer:qi.ButtonGroup}]}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=[2,1,3,4,5,6,7,8,9,10,11,12,13].map((function(e){return{id:e,name:"Name "+e,description:"<b>Description ".concat(e,"</b>")}}));this.store.load(e)}},{key:"entitySortChange",value:function(){this.entitySortChange$.next(!0)}},{key:"paginatorChange",value:function(e){this.paginator=e}},{key:"ngOnDestroy",value:function(){this.store.destroy()}}]),e}(),Xa.\u0275fac=function(e){return new(e||Xa)(r.Rb(Le))},Xa.\u0275cmp=r.Lb({type:Xa,selectors:[["app-entity-table"]],decls:10,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/entity-table"],[3,"store","withPaginator","paginatorOptions","template","entitySortChange"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Common"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Entity Table"),r.Wb(),r.Xb(5,"mat-card-content"),r.Ic(6," See the "),r.Xb(7,"a",0),r.Ic(8,"code of this example"),r.Wb(),r.Wb(),r.Xb(9,"igo-entity-table",1),r.ec("entitySortChange",(function(){return t.entitySortChange()})),r.Wb(),r.Wb()),2&e&&(r.Db(9),r.oc("store",t.store)("withPaginator",!0)("paginatorOptions",t.paginatorOptions)("template",t.template))},directives:[b.a,b.e,b.f,b.c,bn],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),Xa)}]),Ya=((Ga=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Ga}),Ga.\u0275inj=r.Ob({factory:function(e){return new(e||Ga)},imports:[[Ua,b.d,ar,rr]]}),Ga);function Ka(e,t){if(1&e&&(r.Xb(0,"div"),r.Xb(1,"p"),r.Ic(2),r.Wb(),r.Xb(3,"p"),r.Ic(4),r.Wb(),r.Xb(5,"p"),r.Ic(6,"Description: "),r.Sb(7,"span",3),r.Wb(),r.Wb()),2&e){var i=t.ngIf;r.Db(2),r.Kc("ID: ",i.id,""),r.Db(2),r.Kc("Name: ",i.name,""),r.Db(3),r.oc("innerHtml",i.description,r.zc)}}var Za,Ja,Qa=f.e.forChild([{path:"entity-selector",component:(Za=function(){function e(t){_classCallCheck(this,e),this.languageService=t,this.store=new hn([]),this.selected$=new L.a(void 0)}return _createClass(e,[{key:"ngOnInit",value:function(){this.store.load([{id:"2",name:"Name 2",description:"<b>Description 2</b>"},{id:"1",name:"Name 1",description:"<b>Description 1</b>"},{id:"3",name:"Name 3",description:"<b>Description 3</b>"}])}},{key:"ngOnDestroy",value:function(){this.store.destroy()}},{key:"getTitle",value:function(e){return e.name}},{key:"onSelectedChange",value:function(e){this.selected$.next(e.entity)}}]),e}(),Za.\u0275fac=function(e){return new(e||Za)(r.Rb(Le))},Za.\u0275cmp=r.Lb({type:Za,selectors:[["app-entity-selector"]],decls:12,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/entity-selector"],[3,"store","titleAccessor","emptyText","placeholder","selectedChange"],[4,"ngIf"],[3,"innerHtml"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Common"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Entity Selector"),r.Wb(),r.Xb(5,"mat-card-content"),r.Ic(6," See the "),r.Xb(7,"a",0),r.Ic(8,"code of this example"),r.Wb(),r.Wb(),r.Xb(9,"igo-entity-selector",1),r.ec("selectedChange",(function(e){return t.onSelectedChange(e)})),r.Wb(),r.Gc(10,Ka,8,3,"div",2),r.jc(11,"async"),r.Wb()),2&e&&(r.Db(9),r.oc("store",t.store)("titleAccessor",t.getTitle)("emptyText","")("placeholder","Select an entity"),r.Db(1),r.oc("ngIf",r.kc(11,5,t.selected$)))},directives:[b.a,b.e,b.f,b.c,mn,m.l],pipes:[m.b],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),Za)}]),es=((Ja=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Ja}),Ja.\u0275inj=r.Ob({factory:function(e){return new(e||Ja)},imports:[[m.c,Qa,b.d,tr]]}),Ja);function ts(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-form",2),r.ec("submitForm",(function(e){return r.yc(i),r.ic().onSubmit(e)})),r.jc(1,"async"),r.Sb(2,"igo-form-group",3),r.Xb(3,"div",4),r.Xb(4,"button",5),r.ec("click",(function(){return r.yc(i),r.ic().fillForm()})),r.Ic(5," Fill Form "),r.Wb(),r.Xb(6,"button",5),r.ec("click",(function(){return r.yc(i),r.ic().clearForm()})),r.Ic(7," Clear Form "),r.Wb(),r.Xb(8,"button",6),r.Ic(9," Submit "),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=t.ngIf,n=r.ic();r.oc("form",o)("formData",r.kc(1,4,n.data$)),r.Db(2),r.oc("group",o.groups[0]),r.Db(6),r.oc("disabled",n.submitDisabled)}}var is,os,ns,rs,as=f.e.forChild([{path:"form",component:(is=function(){function e(t,i){_classCallCheck(this,e),this.formService=t,this.languageService=i,this.form$=new L.a(void 0),this.data$=new L.a(void 0),this.submitDisabled=!0}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this,t=[{name:"id",title:"ID",options:{cols:1,validator:tt.w.required}},{name:"name",title:"Name",options:{cols:1,validator:tt.w.required}},{name:"status",title:"Status",type:"select",options:{cols:2},inputs:{choices:[{value:1,title:"Single"},{value:2,title:"Married"}]}}].map((function(t){return e.formService.field(t)})),i=this.formService.form([],[this.formService.group({name:"info"},t)]);this.valueChanges$$=i.control.valueChanges.subscribe((function(){e.submitDisabled=!i.control.valid})),this.form$.next(i)}},{key:"ngOnDestroy",value:function(){this.valueChanges$$.unsubscribe()}},{key:"fillForm",value:function(){this.data$.next({id:1,name:"Bob",status:2})}},{key:"clearForm",value:function(){this.form$.value.control.reset()}},{key:"onSubmit",value:function(e){alert(JSON.stringify(e))}}]),e}(),is.\u0275fac=function(e){return new(e||is)(r.Rb(Yn),r.Rb(Le))},is.\u0275cmp=r.Lb({type:is,selectors:[["app-form"]],decls:11,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/form"],[3,"form","formData","submitForm",4,"ngIf"],[3,"form","formData","submitForm"],[3,"group"],["formButtons",""],["mat-stroked-button","","type","button","color","primary",3,"click"],["mat-flat-button","","type","submit","color","primary",3,"disabled"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Common"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Form"),r.Wb(),r.Xb(5,"mat-card-content"),r.Ic(6," See the "),r.Xb(7,"a",0),r.Ic(8,"code of this example"),r.Wb(),r.Wb(),r.Gc(9,ts,10,6,"igo-form",1),r.jc(10,"async"),r.Wb()),2&e&&(r.Db(9),r.oc("ngIf",r.kc(10,1,t.form$)))},directives:[b.a,b.e,b.f,b.c,m.l,qn,Jn,l.a],pipes:[m.b],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),is)}]),ss=((os=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:os}),os.\u0275inj=r.Ob({factory:function(e){return new(e||os)},imports:[[m.c,as,l.b,b.d,er]]}),os),cs=f.e.forChild([{path:"table",component:(ns=function(){function e(t){var i=this;_classCallCheck(this,e),this.languageService=t,this.model={columns:[{name:"id",title:"ID",sortable:!1,filterable:!0},{name:"name",title:"Name",sortable:!0,filterable:!0},{name:"description",title:"Description",sortable:!0,filterable:!0}],actions:[{icon:"file-document",color:Tr.primary,click:function(e){return i.showName(e.name)}}],selectionCheckbox:!0}}return _createClass(e,[{key:"ngOnInit",value:function(){this.database=new Ir([{id:"2",name:"Name 2",description:"Hello 2"},{id:"1",name:"Name 1",description:"Bonjour 1"},{id:"3",name:"Name 3",description:"Hola 3"}])}},{key:"showName",value:function(e){alert(e)}},{key:"handleSelect",value:function(e){console.log(e)}}]),e}(),ns.\u0275fac=function(e){return new(e||ns)(r.Rb(Le))},ns.\u0275cmp=r.Lb({type:ns,selectors:[["app-table"]],decls:10,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/table"],[3,"database","model","hasFilterInput","select"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Common"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Table"),r.Wb(),r.Xb(5,"mat-card-content"),r.Ic(6," See the "),r.Xb(7,"a",0),r.Ic(8,"code of this example"),r.Wb(),r.Wb(),r.Xb(9,"igo-table",1),r.ec("select",(function(e){return t.handleSelect(e)})),r.Wb(),r.Wb()),2&e&&(r.Db(9),r.oc("database",t.database)("model",t.model)("hasFilterInput",!0))},directives:[b.a,b.e,b.f,b.c,Fr],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),ns)}]),ls=((rs=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:rs}),rs.\u0275inj=r.Ob({factory:function(e){return new(e||rs)},imports:[[cs,b.d,_r]]}),rs);function us(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",6),r.ec("click",(function(){return r.yc(i),r.ic().toolbox.activatePreviousTool()})),r.Sb(1,"mat-icon",7),r.Wb()}}function hs(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",8),r.ec("click",(function(){return r.yc(i),r.ic().toolbox.deactivateTool()})),r.Sb(1,"mat-icon",9),r.Wb()}}var ds,ps,gs,fs,ms,bs=f.e.forChild([{path:"tool",component:(ds=function(){function e(t,i){_classCallCheck(this,e),this.toolService=t,this.languageService=i,this.toolbox=new dr}return _createClass(e,[{key:"ngOnInit",value:function(){this.toolbox.setToolbar(["demo-salutation","demo-about"]),this.toolbox.setTools(this.toolService.getTools())}},{key:"ngOnDestroy",value:function(){this.toolbox.destroy()}},{key:"activateSalutationTool",value:function(){this.toolbox.activateTool("demo-salutation",{name:"Bob"})}},{key:"activeTool$",get:function(){return this.toolbox.activeTool$}},{key:"panelTitle",get:function(){return this.activeTool$.value?this.activeTool$.value.title:"Toolbox"}}]),e}(),ds.\u0275fac=function(e){return new(e||ds)(r.Rb(pr),r.Rb(Le))},ds.\u0275cmp=r.Lb({type:ds,selectors:[["app-tool"]],decls:17,vars:9,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/tool"],[3,"title"],["mat-icon-button","","panelLeftButton","",3,"click",4,"ngIf"],["mat-icon-button","","panelRightButton","",3,"click",4,"ngIf"],[3,"toolbox","animate"],["mat-flat-button","","type","button","color","primary",3,"click"],["mat-icon-button","","panelLeftButton","",3,"click"],["svgIcon","arrow-back"],["mat-icon-button","","panelRightButton","",3,"click"],["svgIcon","menu"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Common"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Tool"),r.Wb(),r.Xb(5,"mat-card-content"),r.Ic(6," See the "),r.Xb(7,"a",0),r.Ic(8,"code of this example"),r.Wb(),r.Wb(),r.Xb(9,"igo-panel",1),r.Gc(10,us,2,0,"button",2),r.jc(11,"async"),r.Gc(12,hs,2,0,"button",3),r.jc(13,"async"),r.Sb(14,"igo-toolbox",4),r.Wb(),r.Xb(15,"button",5),r.ec("click",(function(){return t.activateSalutationTool()})),r.Ic(16," Activate Salutation Tool "),r.Wb(),r.Wb()),2&e&&(r.Db(9),r.oc("title",t.panelTitle),r.Db(1),r.oc("ngIf",r.kc(11,5,t.activeTool$)),r.Db(2),r.oc("ngIf",r.kc(13,7,t.activeTool$)),r.Db(2),r.oc("toolbox",t.toolbox)("animate",!0))},directives:[b.a,b.e,b.f,b.c,Sr,m.l,ra,l.a,u.a],pipes:[m.b],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),ds)}]),vs=((gs=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:gs}),gs.\u0275inj=r.Ob({factory:function(e){return new(e||gs)},imports:[[m.c,bs,l.b,u.b,b.d,Ce,Cr,sa.forRoot()]]}),gs),ys=((ps=function(){function e(t){_classCallCheck(this,e),this.cdRef=t,this.complete=new r.o,this.cancel=new r.o}return _createClass(e,[{key:"onUpdateInputs",value:function(){this.cdRef.detectChanges()}}]),e}()).\u0275fac=function(e){return new(e||ps)(r.Rb(r.h))},ps.\u0275cmp=r.Lb({type:ps,selectors:[["app-salutation-widget"]],inputs:{name:"name"},outputs:{complete:"complete",cancel:"cancel"},decls:6,vars:1,consts:[["mat-flat-button","",3,"click"]],template:function(e,t){1&e&&(r.Xb(0,"p"),r.Ic(1),r.Wb(),r.Xb(2,"button",0),r.ec("click",(function(){return t.complete.emit(t.name)})),r.Ic(3,"Nice to meet you"),r.Wb(),r.Xb(4,"button",0),r.ec("click",(function(){return t.cancel.emit(t.name)})),r.Ic(5,"Dismiss"),r.Wb()),2&e&&(r.Db(1),r.Kc("Hello, my name is ",t.name,"."))},directives:[l.a],encapsulation:2,changeDetection:0}),ps),ks=f.e.forChild([{path:"widget",component:(fs=function(){function e(t){_classCallCheck(this,e),this.widgetService=t,this.widget=this.widgetService.create(ys),this.inputs={name:"Bob"}}return _createClass(e,[{key:"onWidgetComplete",value:function(e){alert(e+" emitted event 'complete' then got automatically destroyed.")}},{key:"onWidgetCancel",value:function(){alert("Widget emitted event 'cancel' then got automatically destroyed.")}}]),e}(),fs.\u0275fac=function(e){return new(e||fs)(r.Rb(ua))},fs.\u0275cmp=r.Lb({type:fs,selectors:[["app-widget"]],decls:10,vars:2,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/widget"],[3,"widget","inputs","complete","cancel"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Common"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Widget"),r.Wb(),r.Xb(5,"mat-card-content"),r.Ic(6," See the "),r.Xb(7,"a",0),r.Ic(8,"code of this example"),r.Wb(),r.Wb(),r.Xb(9,"igo-widget-outlet",1),r.ec("complete",(function(e){return t.onWidgetComplete(e)}))("cancel",(function(){return t.onWidgetCancel()})),r.Wb(),r.Wb()),2&e&&(r.Db(9),r.oc("widget",t.widget)("inputs",t.inputs))},directives:[b.a,b.e,b.f,b.c,ca],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),fs)}]),Ss=((ms=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:ms}),ms.\u0275inj=r.Ob({factory:function(e){return new(e||ms)},imports:[[ks,l.b,b.d,ha]]}),ms),Cs=i("fERl"),ws=i("BOF4"),xs=i.n(ws),Os=i("kScs"),Is=i("l+12");function Ls(e,t){1&e&&r.Sb(0,"div",3)}function Ts(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-auth-google",7),r.ec("login",(function(){return r.yc(i),r.ic(3).onLogin()})),r.Wb()}}function Fs(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-auth-microsoft",7),r.ec("login",(function(){return r.yc(i),r.ic(3).onLogin()})),r.Wb()}}function _s(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-auth-facebook",7),r.ec("login",(function(){return r.yc(i),r.ic(3).onLogin()})),r.Wb()}}function Ms(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-auth-intern",8),r.ec("login",(function(){return r.yc(i),r.ic(3).onLogin()})),r.Wb()}if(2&e){var o=r.ic(3);r.oc("allowAnonymous",o.options.allowAnonymous)}}function Ds(e,t){if(1&e&&(r.Xb(0,"div",4),r.Xb(1,"h1"),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Gc(4,Ts,1,0,"igo-auth-google",5),r.Gc(5,Fs,1,0,"igo-auth-microsoft",5),r.Gc(6,_s,1,0,"igo-auth-facebook",5),r.Gc(7,Ms,1,1,"igo-auth-intern",6),r.Wb()),2&e){var i=r.ic(2);r.Db(2),r.Jc(r.kc(3,5,"igo.auth.connection")),r.Db(2),r.oc("ngIf",i.options.google&&!1!==i.options.google.enabled),r.Db(1),r.oc("ngIf",i.options.microsoft&&!1!==i.options.microsoft.enabled),r.Db(1),r.oc("ngIf",i.options.facebook&&!1!==i.options.facebook.enabled),r.Db(1),r.oc("ngIf",!i.options.intern||!1!==i.options.intern.enabled)}}function Ps(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",4),r.Xb(1,"p"),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Xb(4,"button",9),r.ec("click",(function(){return r.yc(i),r.ic(2).logout()})),r.Ic(5),r.jc(6,"translate"),r.Wb(),r.Wb()}if(2&e){var o=r.ic(2);r.Db(2),r.Jc(r.lc(3,2,"igo.auth.welcome",o.user)),r.Db(3),r.Jc(r.kc(6,5,"igo.auth.signOut"))}}function As(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",9),r.ec("click",(function(){return r.yc(i),r.ic(3).home()})),r.Ic(1),r.jc(2,"translate"),r.Wb()}2&e&&(r.Db(1),r.Jc(r.kc(2,1,"igo.auth.home")))}function js(e,t){if(1&e&&(r.Xb(0,"div",4),r.Xb(1,"p"),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Gc(4,As,3,3,"button",10),r.Wb()),2&e){var i=r.ic(2);r.Db(2),r.Jc(r.kc(3,2,"igo.auth.deconnection")),r.Db(2),r.oc("ngIf",i.options.homeRoute)}}function Rs(e,t){if(1&e&&(r.Xb(0,"div"),r.Gc(1,Ls,1,0,"div",1),r.Gc(2,Ds,8,7,"div",2),r.Gc(3,Ps,7,7,"div",2),r.Gc(4,js,5,4,"div",2),r.Wb()),2&e){var i=r.ic();r.Db(1),r.oc("ngIf",!i.auth.logged&&i.backgroundDisable),r.Db(1),r.oc("ngIf",!i.auth.logged&&i.showLoginDiv),r.Db(1),r.oc("ngIf",i.auth.logged&&i.showAlreadyConnectedDiv),r.Db(1),r.oc("ngIf",i.showLogoutDiv)}}function $s(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",7),r.ec("click",(function(){return r.yc(i),r.ic().loginAnonymous()})),r.Ic(1),r.jc(2,"translate"),r.Wb()}if(2&e){var o=r.ic();r.oc("disabled",o.loading),r.Db(1),r.Kc(" ",r.kc(2,2,"igo.auth.accessAnonymous")," ")}}function Es(e,t){if(1&e&&(r.Xb(0,"div"),r.Sb(1,"br"),r.Xb(2,"font",8),r.Ic(3),r.Wb(),r.Wb()),2&e){var i=r.ic();r.Db(3),r.Jc(i.error)}}var Ws,Xs,Gs,Bs,Vs,Ns,zs,qs=((zs=function(){function e(t){_classCallCheck(this,e),this.injector=t}return _createClass(e,[{key:"set",value:function(e){localStorage.setItem(this.tokenKey,e)}},{key:"remove",value:function(){localStorage.removeItem(this.tokenKey)}},{key:"get",value:function(){return localStorage.getItem(this.tokenKey)}},{key:"decode",value:function(){var e=this.get();if(e)return xs()(e)}},{key:"isExpired",value:function(){var e=this.decode(),t=(new Date).getTime()/1e3;return!(e&&t<e.exp)}},{key:"tokenKey",get:function(){var e=this.injector.get(ie);return this.options=e.getConfig("auth")||{},this.options.tokenKey}}]),e}()).\u0275fac=function(e){return new(e||zs)(r.bc(r.t))},zs.\u0275prov=Object(r.Nb)({factory:function(){return new zs(Object(r.bc)(r.p))},token:zs,providedIn:"root"}),zs),Hs=((Ns=function(){function e(t,i,o,n,r,a){var s=this;_classCallCheck(this,e),this.http=t,this.tokenService=i,this.config=o,this.languageService=n,this.messageService=r,this.router=a,this.authenticate$=new L.a(void 0),this.logged$=new L.a(void 0),this.anonymous=!1,this.authenticate$.next(this.authenticated),this.authenticate$.subscribe((function(e){s.logged$.next(e),Cs.b.next()}))}return _createClass(e,[{key:"login",value:function(e,t){var i=new k.f;i.append("Content-Type","application/json");var o=JSON.stringify({username:e,password:this.encodePassword(t)});return this.loginCall(o,i)}},{key:"loginWithToken",value:function(e,t){var i=new k.f;i.append("Content-Type","application/json");var o=JSON.stringify({token:e,typeConnection:t});return this.loginCall(o,i)}},{key:"loginAnonymous",value:function(){return this.anonymous=!0,this.logged$.next(!0),Object(F.a)(!0)}},{key:"refresh",value:function(){var e=this,t=this.config.getConfig("auth.url");return this.http.post(t+"/refresh",{}).pipe(Object(x.a)((function(t){e.tokenService.set(t.token)})),Object(C.a)((function(e){throw e.error.caught=!0,e})))}},{key:"logout",value:function(){return this.anonymous=!1,this.tokenService.remove(),this.authenticate$.next(!1),Object(F.a)(!0)}},{key:"isAuthenticated",value:function(){return!this.tokenService.isExpired()}},{key:"getToken",value:function(){return this.tokenService.get()}},{key:"decodeToken",value:function(){return!!this.isAuthenticated()&&this.tokenService.decode()}},{key:"goToRedirectUrl",value:function(){if(this.router){var e=this.redirectUrl||this.router.url,t=this.config.getConfig("auth")||{};e===t.loginRoute?this.router.navigateByUrl(t.homeRoute||"/"):e&&this.router.navigateByUrl(e)}}},{key:"getUserInfo",value:function(){var e=this.config.getConfig("auth.url")+"/info";return this.http.get(e)}},{key:"getProfils",value:function(){var e=this.config.getConfig("auth.url");return this.http.get(e+"/profils")}},{key:"updateUser",value:function(e){var t=this.config.getConfig("auth.url");return this.http.patch(t,JSON.stringify(e))}},{key:"encodePassword",value:function(e){return j.encode(e)}},{key:"loginCall",value:function(e,t){var i=this,o=this.config.getConfig("auth.url");return this.http.post(o+"/login",e,{headers:t}).pipe(Object(x.a)((function(e){i.tokenService.set(e.token);var t=i.decodeToken();t&&t.user&&(t.user.locale&&i.languageService.setLanguage(t.user.locale),t.user.isExpired&&i.languageService.translate.get("igo.auth.error.Password expired").subscribe((function(e){return i.messageService.alert(e)}))),i.authenticate$.next(!0)})),Object(C.a)((function(e){throw e.error.caught=!0,e})))}},{key:"logged",get:function(){return this.authenticated||this.isAnonymous}},{key:"isAnonymous",get:function(){return this.anonymous}},{key:"authenticated",get:function(){return this.isAuthenticated()}},{key:"isAdmin",get:function(){var e=this.decodeToken();return!!(e&&e.user&&e.user.isAdmin)}}]),e}()).\u0275fac=function(e){return new(e||Ns)(r.bc(k.b),r.bc(qs),r.bc(ie),r.bc(Le),r.bc(Ie),r.bc(f.c,8))},Ns.\u0275prov=Object(r.Nb)({factory:function(){return new Ns(Object(r.bc)(k.b),Object(r.bc)(qs),Object(r.bc)(ie),Object(r.bc)(Le),Object(r.bc)(Ie),Object(r.bc)(f.c,8))},token:Ns,providedIn:"root"}),Ns),Us=((Vs=function(){function e(t,i,o){_classCallCheck(this,e),this.auth=t,this.config=i,this.router=o,this._backgroundDisable=!0,this._hasAlreadyConnectedDiv=!0,this._hasLogoutDiv=!0,this._showAlreadyConnectedDiv=!1,this._showLogoutDiv=!1,this.login=new r.o,this.visible=!0,this.options=this.config.getConfig("auth")||{},this.visible=0!==Object.getOwnPropertyNames(this.options).length}return _createClass(e,[{key:"ngOnInit",value:function(){this.analyzeRoute(),this.getName()}},{key:"onLogin",value:function(){this.auth.goToRedirectUrl(),this.getName(),this.login.emit(!0)}},{key:"logout",value:function(){var e=this;this.auth.logout().subscribe((function(){e.user=void 0,e.router&&(e.options.logoutRoute?e.router.navigate([e.options.logoutRoute]):e.options.homeRoute&&e.router.navigate([e.options.homeRoute]))}))}},{key:"home",value:function(){this.router&&this.options.homeRoute&&this.router.navigate([this.options.homeRoute])}},{key:"getName",value:function(){var e=this.auth.decodeToken();e&&(this.user={name:e.user.firstName||e.user.sourceId})}},{key:"analyzeRoute",value:function(){var e=this;this.router&&this.router.events.pipe(Object(qe.a)((function(e){return e instanceof f.b}))).subscribe((function(t){if(t.url){var i=t.url,o=e.options.loginRoute;e.isLogoutRoute=i===e.options.logoutRoute,e.isLoginRoute=i===o,e.isLogoutRoute&&e.auth.logout()}}))}},{key:"backgroundDisable",get:function(){return!this.isLogoutRoute&&!this.isLogoutRoute&&this._backgroundDisable},set:function(e){this._backgroundDisable="true"===e.toString()}},{key:"hasAlreadyConnectedDiv",get:function(){return this._hasAlreadyConnectedDiv},set:function(e){this._hasAlreadyConnectedDiv="true"===e.toString()}},{key:"hasLogoutDiv",get:function(){return this._hasLogoutDiv},set:function(e){this._hasLogoutDiv="true"===e.toString()}},{key:"showAlreadyConnectedDiv",get:function(){return this.isLogoutRoute?this.hasAlreadyConnectedDiv:this._showAlreadyConnectedDiv},set:function(e){this._showAlreadyConnectedDiv="true"===e.toString()}},{key:"showLogoutDiv",get:function(){return this.isLogoutRoute?this.hasLogoutDiv:this._showLogoutDiv},set:function(e){this._showLogoutDiv="true"===e.toString()}},{key:"showLoginDiv",get:function(){if(!this.isLogoutRoute)return!0}}]),e}()).\u0275fac=function(e){return new(e||Vs)(r.Rb(Hs),r.Rb(ie),r.Rb(f.c,8))},Vs.\u0275cmp=r.Lb({type:Vs,selectors:[["igo-auth-form"]],inputs:{backgroundDisable:"backgroundDisable",hasAlreadyConnectedDiv:"hasAlreadyConnectedDiv",hasLogoutDiv:"hasLogoutDiv",showAlreadyConnectedDiv:"showAlreadyConnectedDiv",showLogoutDiv:"showLogoutDiv"},outputs:{login:"login"},decls:1,vars:1,consts:[[4,"ngIf"],["class","backgroundDisable",4,"ngIf"],["class","login center-block",4,"ngIf"],[1,"backgroundDisable"],[1,"login","center-block"],[3,"login",4,"ngIf"],[3,"allowAnonymous","login",4,"ngIf"],[3,"login"],[3,"allowAnonymous","login"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button",3,"click",4,"ngIf"]],template:function(e,t){1&e&&r.Gc(0,Rs,5,4,"div",0),2&e&&r.oc("ngIf",t.visible)},directives:function(){return[m.l,Zs,sc,Ks,Ys,l.a]},pipes:function(){return[U.d]},styles:["[_nghost-%COMP%]{z-index:999}div.login[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #888;max-width:600px;min-width:360px;padding:25px 50px;width:90%;z-index:200}.center-block[_ngcontent-%COMP%]{left:50%;position:fixed;top:20%;transform:translate(-50%)}.backgroundDisable[_ngcontent-%COMP%]{background:#000;height:100%;left:0;opacity:.8;position:fixed;top:0;width:100%;z-index:100}"]}),Vs),Ys=((Bs=function(){function e(t,i,o){_classCallCheck(this,e),this.auth=t,this.languageService=i,this._allowAnonymous=!0,this.error="",this.loading=!1,this.login=new r.o,this.form=o.group({username:["",tt.w.required],password:["",tt.w.required]})}return _createClass(e,[{key:"loginUser",value:function(e){var t=this;return this.loading=!0,this.auth.login(e.username,e.password).subscribe((function(){t.login.emit(!0),t.loading=!1}),(function(e){try{t.languageService.translate.get("igo.auth.error."+e.error.message).subscribe((function(e){return t.error=e}))}catch(i){t.error=e.error.message}t.loading=!1})),!1}},{key:"loginAnonymous",value:function(){var e=this;this.auth.loginAnonymous().subscribe((function(){e.login.emit(!0)}))}},{key:"allowAnonymous",get:function(){return this._allowAnonymous},set:function(e){this._allowAnonymous=e}}]),e}()).\u0275fac=function(e){return new(e||Bs)(r.Rb(Hs),r.Rb(Le),r.Rb(tt.e))},Bs.\u0275cmp=r.Lb({type:Bs,selectors:[["igo-auth-intern"]],inputs:{allowAnonymous:"allowAnonymous"},outputs:{login:"login"},decls:14,vars:13,consts:[["role","form",3,"formGroup","ngSubmit"],[1,"full-width"],["matInput","","required","","formControlName","username",3,"placeholder"],["matInput","","required","","type","password","formControlName","password",3,"placeholder"],["mat-raised-button","","type","submit",3,"disabled"],["mat-raised-button","","class","anonymous","type","button",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["mat-raised-button","","type","button",1,"anonymous",3,"disabled","click"],["size","3","color","red"]],template:function(e,t){1&e&&(r.Xb(0,"form",0),r.ec("ngSubmit",(function(){return t.loginUser(t.form.value)})),r.Xb(1,"div"),r.Xb(2,"mat-form-field",1),r.Sb(3,"input",2),r.jc(4,"translate"),r.Wb(),r.Wb(),r.Xb(5,"div"),r.Xb(6,"mat-form-field",1),r.Sb(7,"input",3),r.jc(8,"translate"),r.Wb(),r.Wb(),r.Xb(9,"button",4),r.Ic(10),r.jc(11,"translate"),r.Wb(),r.Gc(12,$s,3,4,"button",5),r.Gc(13,Es,4,1,"div",6),r.Wb()),2&e&&(r.oc("formGroup",t.form),r.Db(3),r.pc("placeholder",r.kc(4,7,"igo.auth.user")),r.Db(4),r.pc("placeholder",r.kc(8,9,"igo.auth.password")),r.Db(2),r.oc("disabled",!t.form.valid||t.loading),r.Db(1),r.Jc(r.kc(11,11,"igo.auth.login")),r.Db(2),r.oc("ngIf",t.allowAnonymous),r.Db(1),r.oc("ngIf",t.error))},directives:[tt.x,tt.q,tt.i,it.c,et.b,tt.c,tt.v,tt.p,tt.h,l.a,m.l],pipes:[U.d],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.anonymous[_ngcontent-%COMP%]{margin-left:10px}"]}),Bs),Ks=((Gs=function(){function e(t,i,o){_classCallCheck(this,e),this.authService=t,this.config=i,this.appRef=o,this.login=new r.o,this.options=this.config.getConfig("auth.facebook")||{},this.options.appId?this.loadSDKFacebook():console.warn('Facebook authentification needs "appId" option')}return _createClass(e,[{key:"subscribeEvents",value:function(){var e=this;window.FB.Event.subscribe("auth.statusChange",(function(t){e.statusChangeCallback(t)}))}},{key:"statusChangeCallback",value:function(e){"connected"===e.status&&this.loginFacebook(e.authResponse.accessToken)}},{key:"loginFacebook",value:function(e){var t=this;this.authService.loginWithToken(e,"facebook").subscribe((function(){t.appRef.tick(),t.login.emit(!0)}))}},{key:"loadSDKFacebook",value:function(){var e=this;if(!document.getElementById("facebook-jssdk")){var t=document.getElementsByTagName("script")[0],i=document.createElement("script");i.id="facebook-jssdk",i.src="https://connect.facebook.net/fr_CA/sdk.js#xfbml=1&version=v2.9&appId="+this.options.appId,i.onload=function(){e.subscribeEvents()},t.parentNode.insertBefore(i,t)}}}]),e}()).\u0275fac=function(e){return new(e||Gs)(r.Rb(Hs),r.Rb(ie),r.Rb(r.g))},Gs.\u0275cmp=r.Lb({type:Gs,selectors:[["igo-auth-facebook"]],outputs:{login:"login"},decls:1,vars:0,consts:[["scope","public_profile,email","data-max-rows","1","data-size","large","data-button-type","login_with","data-show-faces","false","data-auto-logout-link","false","data-use-continue-as","false",1,"fb-login-button"]],template:function(e,t){1&e&&r.Sb(0,"div",0)},styles:["[_nghost-%COMP%]{display:inline-block;padding:10px 10px 10px 0;position:relative;top:-3px}"],changeDetection:0}),Gs),Zs=((Xs=function(){function e(t,i,o,n){_classCallCheck(this,e),this.authService=t,this.config=i,this.languageService=o,this.appRef=n,this.login=new r.o,this.options=this.config.getConfig("auth.google")||{},this.options.apiKey&&this.options.clientId?(this.loadSDKGoogle(),this.loadPlatform()):console.warn('Google authentification needs "apiKey" and "clientId" options')}return _createClass(e,[{key:"handleSignInClick",value:function(){window.gapi.auth2.getAuthInstance().signIn()}},{key:"handleSignOutClick",value:function(){window.gapi.auth2.getAuthInstance().signOut()}},{key:"handleClientLoad",value:function(){var e=this;window.gapi.load("client:auth2",(function(){return e.initClient()}))}},{key:"initClient",value:function(){var e=this;window.gapi.client.init({apiKey:this.options.apiKey,clientId:this.options.clientId,discoveryDocs:["https://people.googleapis.com/$discovery/rest?version=v1"],scope:"profile"}).then((function(){e.handleSignOutClick(),e.updateTextButton(),window.gapi.auth2.getAuthInstance().isSignedIn.listen((function(t){e.updateSigninStatus(t)}))}))}},{key:"updateSigninStatus",value:function(e){this.updateTextButton(),e&&this.loginGoogle(window.gapi.client.getToken().access_token)}},{key:"updateTextButton",value:function(){var e=document.querySelector('span[id^="not_signed_"]');e&&"en"!==this.languageService.getLanguage()&&("Sign in with Google"===e.innerHTML?e.innerHTML=this.languageService.translate.instant("igo.auth.google.login"):"Signed in with Google"===e.innerHTML&&(e.innerHTML=this.languageService.translate.instant("igo.auth.google.logged")))}},{key:"loginGoogle",value:function(e){var t=this;this.authService.loginWithToken(e,"google").subscribe((function(){t.appRef.tick(),t.login.emit(!0)}))}},{key:"loadSDKGoogle",value:function(){var e=this,t=document.getElementsByTagName("script")[0],i=document.createElement("script");i.id="google-jssdk",i.src="https://apis.google.com/js/api.js",i.onload=function(){e.handleClientLoad()},t.parentNode.insertBefore(i,t)}},{key:"loadPlatform",value:function(){var e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.id="google-platform",t.src="https://apis.google.com/js/platform.js",e.parentNode.insertBefore(t,e)}}]),e}()).\u0275fac=function(e){return new(e||Xs)(r.Rb(Hs),r.Rb(ie),r.Rb(Le),r.Rb(r.g))},Xs.\u0275cmp=r.Lb({type:Xs,selectors:[["igo-auth-google"]],outputs:{login:"login"},decls:1,vars:0,consts:[["data-height","40","data-width","265","data-longtitle","true",1,"g-signin2","google-login-button"]],template:function(e,t){1&e&&r.Sb(0,"div",0)},styles:["[_nghost-%COMP%]{display:inline-block;padding:10px 10px 10px 0}.google-login-button[_ngcontent-%COMP%]     .abcRioButton{color:rgba(0,0,0,.87)}"],changeDetection:0}),Xs),Js=((Ws=function(){function e(t,i,o){_classCallCheck(this,e),this.config=t,this.tokenService=i,this.http=o,this.refreshInProgress=!1}return _createClass(e,[{key:"intercept",value:function(e,t){this.refreshToken();var i=this.tokenService.get(),o=document.createElement("a");if(o.href=e.url,""===o.host&&(o.href=o.href),!i||-1===this.trustHosts.indexOf(o.hostname))return t.handle(e);var n=e.clone({headers:e.headers.set("Authorization","Bearer "+i)}),r=this.tokenService.decode();if("true"===n.params.get("_i")&&r&&r.user&&r.user.sourceId){var a=Os.Md5.hashStr(r.user.sourceId);n=n.clone({params:n.params.set("_i",a)})}else"true"===n.params.get("_i")&&(n=n.clone({params:n.params.delete("_i")}));return t.handle(n)}},{key:"interceptXhr",value:function(e,t){this.refreshToken();var i=document.createElement("a");i.href=t;var o=this.tokenService.get();return!(!o||-1===this.trustHosts.indexOf(i.hostname)||(e.setRequestHeader("Authorization","Bearer "+o),0))}},{key:"refreshToken",value:function(){var e=this,t=this.tokenService.decode(),i=(new Date).getTime()/1e3;if(!this.refreshInProgress&&t&&i<t.exp&&i>t.exp-1800){this.refreshInProgress=!0;var o=this.config.getConfig("auth.url");return this.http.post(o+"/refresh",{}).subscribe((function(t){e.tokenService.set(t.token),e.refreshInProgress=!1}),(function(e){return e.error.caught=!0,e}))}}},{key:"trustHosts",get:function(){var e=this.config.getConfig("auth.trustHosts")||[];return e.push(window.location.hostname),e}}]),e}()).\u0275fac=function(e){return new(e||Ws)(r.bc(ie),r.bc(qs),r.bc(k.b))},Ws.\u0275prov=Object(r.Nb)({factory:function(){return new Ws(Object(r.bc)(ie),Object(r.bc)(qs),Object(r.bc)(k.b))},token:Ws,providedIn:"root"}),Ws);function Qs(e){return{auth:{clientId:(e.getConfig("auth.microsoft")||{}).clientId,authority:"https://login.microsoftonline.com/organizations",redirectUri:window.location.href},cache:{cacheLocation:"sessionStorage"}}}function ec(){return{popUp:!0,consentScopes:["user.read"]}}var tc,ic,oc,nc,rc,ac=((oc=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o,n){var r,a;return _classCallCheck(this,i),(a=t.call(this,e)).http=o,a.authService=n,a.authService.authenticate$.subscribe((function(e){e&&a.options.url&&a.http.get(a.options.url).subscribe((function(e){if(e&&e.preference)for(var t=0,o=Object.keys(e.preference);t<o.length;t++){var n=o[t];_get((r=_assertThisInitialized(a),_getPrototypeOf(i.prototype)),"set",r).call(r,n,e.preference[n])}}))})),a}return _createClass(i,[{key:"set",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:je.LOCAL;if(o===je.LOCAL&&this.authService.authenticated&&this.options.url){var n={};n[e]=t,this.http.patch(this.options.url,{preference:n}).subscribe()}_get(_getPrototypeOf(i.prototype),"set",this).call(this,e,t,o)}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:je.LOCAL;if(t===je.LOCAL&&this.authService.authenticated&&this.options.url){var o={};o[e]=void 0,this.http.patch(this.options.url,{preference:o}).subscribe()}return _get(_getPrototypeOf(i.prototype),"remove",this).call(this,e,t)}}]),i}($e)).\u0275fac=function(e){return new(e||oc)(r.bc(ie),r.bc(k.b),r.bc(Hs))},oc.\u0275prov=Object(r.Nb)({factory:function(){return new oc(Object(r.bc)(ie),Object(r.bc)(k.b),Object(r.bc)(Hs))},token:oc,providedIn:"root"}),oc),sc=((ic=function(){function e(t,i,o,n,a){var s=this;_classCallCheck(this,e),this.authService=t,this.config=i,this.appRef=o,this.broadcastService=n,this.msalService=a,this.login=new r.o,this.options=this.config.getConfig("auth.microsoft")||{},this.options.clientId?this.broadcastService.subscribe("msal:loginSuccess",(function(){s.checkAccount()})):console.warn('Microsoft authentification needs "clientId" option')}return _createClass(e,[{key:"loginMicrosoft",value:function(){this.msalService.loginPopup()}},{key:"checkAccount",value:function(){var e=this;this.msalService.acquireTokenSilent({scopes:["user.read"]}).then((function(t){e.authService.loginWithToken(t.accessToken,"microsoft").subscribe((function(){e.appRef.tick(),e.login.emit(!0)}))}))}}]),e}()).\u0275fac=function(e){return new(e||ic)(r.Rb(Hs),r.Rb(ie),r.Rb(r.g),r.Rb(Is.a),r.Rb(Is.e))},ic.\u0275cmp=r.Lb({type:ic,selectors:[["igo-auth-microsoft"]],outputs:{login:"login"},decls:4,vars:3,consts:[["mat-raised-button","",1,"microsoft-login-button",3,"click"],["svgIcon","microsoft"]],template:function(e,t){1&e&&(r.Xb(0,"button",0),r.ec("click",(function(){return t.loginMicrosoft()})),r.Sb(1,"mat-icon",1),r.Ic(2),r.jc(3,"translate"),r.Wb()),2&e&&(r.Db(2),r.Kc(" ",r.kc(3,1,"igo.auth.microsoft.login"),"\n"))},directives:[l.a,u.a],pipes:[U.d],styles:["[_nghost-%COMP%]{display:inline-block;padding:10px 10px 10px 0;position:relative;top:-15px}[_nghost-%COMP%] > button[_ngcontent-%COMP%]{font-size:15px;height:40px;width:265px}mat-icon[_ngcontent-%COMP%]{margin-right:10px}"],changeDetection:0}),ic),cc=((tc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:k.a,useClass:Js,multi:!0},{provide:$e,useClass:ac},{provide:Is.b,useFactory:Qs,deps:[ie]},{provide:Is.c,useFactory:ec},Is.e]}}}]),e}()).\u0275mod=r.Pb({type:tc}),tc.\u0275inj=r.Ob({factory:function(e){return new(e||tc)},imports:[[m.c,tt.u,it.e,et.c,u.b,l.b,Ce,Is.d]]}),tc),lc=f.e.forChild([{path:"auth-form",component:(nc=function e(t){_classCallCheck(this,e),this.languageService=t,this.idsActivity=[]},nc.\u0275fac=function(e){return new(e||nc)(r.Rb(Le))},nc.\u0275cmp=r.Lb({type:nc,selectors:[["app-auth-form"]],decls:17,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/auth/auth-form"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Auth"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Authentification"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"Dependencies: ConfigService, LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"br"),r.Ic(13," See auth section of the "),r.Xb(14,"a",1),r.Ic(15," environment config"),r.Wb(),r.Wb(),r.Wb(),r.Sb(16,"igo-auth-form"))},directives:[b.a,b.e,b.f,b.c,Us],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),nc)}]),uc=((rc=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:rc}),rc.\u0275inj=r.Ob({factory:function(e){return new(e||rc)},imports:[[lc,b.d,cc.forRoot()]]}),rc),hc=i("cp0P"),dc=i("1uah"),pc=i("EY2u"),gc=i("PqYM"),fc=i("bOdf"),mc=i("32Ea"),bc=i("5+tZ"),vc=i("SxV6"),yc=i("6eBy"),kc=i("JW8z"),Sc=i("YX0d"),Cc=i("fzGS"),wc=i("WDFe"),xc=i("J8cP"),Oc=i("0OmE"),Ic=i("LvFn"),Lc=i("cV7i"),Tc=i("WwCA"),Fc=i("ZNkr"),_c=i("PFxp"),Mc=i("wd/R"),Dc=i("zZjW"),Pc=i("u+Ei"),Ac=i("BZGc"),jc=i("5NB/"),Rc=i("Z5JD"),$c=i("1RAW"),Ec=i("btgn"),Wc=i("CvXi"),Xc=i("gETL"),Gc=i("BdKp"),Bc=i("UEPW"),Vc=i("TN97"),Nc=i("eNsl"),zc=i("/bf1"),qc=i("Vb2V"),Hc=i("B2q1"),Uc=i("FeBf"),Yc=i("p5/s"),Kc=i("vIFP"),Zc=i("yBBP"),Jc=i("SAzV"),Qc=i("Pmt0"),el=i("Nafy"),tl=i("ykKD"),il=i("XDhV"),ol=i("g03e"),nl=i("l+a/"),rl=i("Xu5n"),al=i("oscj"),sl=i("9T9f"),cl=i("nUcq"),ll=i("Ojm/"),ul=i("+CJY"),hl=i("Uhtb"),dl=i("W8M7"),pl=i("9ANI"),gl=i("egkh"),fl=i("ouHB"),ml=i("JfxD"),bl=i("1h4k"),vl=i("DfXE"),yl=i("BSbQ"),kl=i("jMqV"),Sl=i("mPVK"),Cl=i("9d2U"),wl=i("oxbM"),xl=i("vrAh"),Ol=i("Ynp+"),Il=i("TN/R"),Ll=i("zQhy"),Tl=i("M9ds"),Fl=i("OLiY"),_l=i("Y9kJ"),Ml=i("BxA5"),Dl=i("eQqr"),Pl=i("bHcU"),Al=(i("sk2A"),i("/rf6"),i("rCk2")),jl=i("yAeK"),Rl=i("0FFk"),$l=i("BJ1j"),El=i("y7ui"),Wl=i("Iab2"),Xl=i("5RHE"),Gl=i("wOnQ"),Bl=i.n(Gl),Vl=i("xOOu"),Nl=i("Bviv");function zl(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",1),r.ec("click",(function(){r.yc(i);var e=r.ic();return e.openMetadata(e.options.metadata)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",2),r.Wb()}if(2&e){var o=r.ic();r.oc("matTooltip",r.kc(1,2,"igo.geo.metadata.show"))("color",o.color)}}var ql=["*"],Hl=function(e){return{zoom:e}};function Ul(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",1),r.jc(1,"translate"),r.jc(2,"translate"),r.Xb(3,"button",2),r.ec("click",(function(){return r.yc(i),r.ic().map.viewController.resetRotation()})),r.Sb(4,"mat-icon",3),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.oc("matTooltip",o.rotated?r.kc(1,4,"igo.geo.mapButtons.resetRotation"):r.kc(2,6,"igo.geo.mapButtons.tipRotation")),r.Db(3),r.oc("color",o.color)("disabled",!o.rotated),r.Db(1),r.oc("ngStyle",o.rotationStyle(o.map.viewController.getRotation()))}}function Yl(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",1),r.jc(1,"translate"),r.jc(2,"translate"),r.Xb(3,"button",2),r.ec("click",(function(){return r.yc(i),r.ic().map.viewController.resetRotation()})),r.Sb(4,"mat-icon",3),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.oc("matTooltip",o.rotated?r.kc(1,4,"igo.geo.mapButtons.resetRotation"):r.kc(2,6,"igo.geo.mapButtons.tipRotation")),r.Db(3),r.oc("color",o.color)("disabled",!o.rotated),r.Db(1),r.oc("ngStyle",o.rotationStyle(o.map.viewController.getRotation()))}}function Kl(e,t){if(1&e){var i=r.Yb();r.Vb(0),r.Xb(1,"igo-catalog-browser-group",3),r.ec("addedChange",(function(e){return r.yc(i),r.ic(2).onGroupAddedChange(e)}))("layerAddedChange",(function(e){return r.yc(i),r.ic(2).onLayerAddedChange(e)})),r.jc(2,"async"),r.Wb(),r.Ub()}if(2&e){var o=r.ic().$implicit,n=r.ic();r.Db(1),r.oc("catalog",n.catalog)("group",o)("state",n.store.state)("resolution",r.kc(2,6,n.resolution$))("catalogAllowLegend",n.catalogAllowLegend)("toggleCollapsed",n.toggleCollapsedGroup)}}function Zl(e,t){if(1&e){var i=r.Yb();r.Vb(0),r.Xb(1,"igo-catalog-browser-layer",4),r.ec("addedChange",(function(e){return r.yc(i),r.ic(2).onLayerAddedChange(e)})),r.jc(2,"async"),r.Wb(),r.Ub()}if(2&e){var o=r.ic().$implicit,n=r.ic();r.Db(1),r.oc("layer",o)("resolution",r.kc(2,4,n.resolution$))("catalogAllowLegend",n.catalogAllowLegend)("added",n.store.state.get(o).added)}}function Jl(e,t){if(1&e&&(r.Gc(0,Kl,3,8,"ng-container",2),r.Gc(1,Zl,3,6,"ng-container",2)),2&e){var i=t.$implicit,o=r.ic();r.oc("ngIf",o.isGroup(i)),r.Db(1),r.oc("ngIf",o.isLayer(i))}}function Ql(e,t){1&e&&r.Sb(0,"mat-icon",8)}function eu(e,t){if(1&e&&(r.Sb(0,"igo-layer-legend",2),r.jc(1,"async")),2&e){var i=r.ic();r.oc("layer",r.kc(1,1,i.igoLayer$))}}function tu(e,t){if(1&e){var i=r.Yb();r.Vb(0),r.Xb(1,"button",6),r.ec("click",(function(){return r.yc(i),r.ic().onToggleClick()})),r.jc(2,"translate"),r.jc(3,"async"),r.Sb(4,"mat-icon",7),r.Wb(),r.Ub()}if(2&e){var o=r.ic();r.Db(1),r.oc("matTooltip",r.kc(2,2,"igo.geo.catalog.group.removeFromMap"))("disabled",r.kc(3,4,o.disabled$))}}function iu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",8),r.ec("click",(function(){return r.yc(i),r.ic().onToggleClick()})),r.jc(1,"translate"),r.jc(2,"async"),r.Sb(3,"mat-icon",9),r.Wb()}if(2&e){var o=r.ic();r.oc("matTooltip",r.kc(1,2,"igo.geo.catalog.group.addToMap"))("disabled",r.kc(2,4,o.disabled$))}}function ou(e,t){1&e&&r.Tb(0)}function nu(e,t){if(1&e){var i=r.Yb();r.Vb(0),r.Xb(1,"igo-catalog-browser-layer",11),r.ec("addedLayerIsPreview",(function(e){return r.yc(i),r.ic(2).onLayerPreview(e)}))("addedChange",(function(e){return r.yc(i),r.ic(2).onLayerAddedChange(e)})),r.Wb(),r.Ub()}if(2&e){var o=r.ic().$implicit,n=r.ic();r.Db(1),r.oc("layer",o)("resolution",n.resolution)("catalogAllowLegend",n.catalogAllowLegend)("added",n.state.get(o).added)}}function ru(e,t){if(1&e&&(r.Gc(0,ou,1,0,"ng-container",10),r.Gc(1,nu,2,4,"ng-container",10)),2&e){var i=t.$implicit,o=r.ic();r.oc("ngIf",o.isGroup(i)),r.Db(1),r.oc("ngIf",o.isLayer(i))}}function au(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-checkbox",9),r.ec("change",(function(){return r.yc(i),r.ic().check()})),r.Wb()}if(2&e){var o=r.ic();r.oc("checked",o.layerCheck)}}var su=function(e){return{disabled:e}};function cu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",10),r.ec("click",(function(){return r.yc(i),r.ic().toggleVisibility()})),r.jc(1,"translate"),r.jc(2,"translate"),r.Sb(3,"mat-icon",11),r.jc(4,"async"),r.jc(5,"async"),r.Wb()}if(2&e){var o=r.ic();r.oc("color",o.layer.visible?"primary":"default")("matTooltip",o.layer.visible?r.kc(1,5,"igo.geo.layer.hideLayer"):r.kc(2,7,"igo.geo.layer.showLayer")),r.Db(3),r.oc("matBadgeHidden",r.kc(4,9,o.queryBadgeHidden$))("ngClass",r.rc(13,su,!r.kc(5,11,o.inResolutionRange$)))("svgIcon",o.layer.visible?"eye":"eye-off")}}function lu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",12),r.ec("click",(function(){return r.yc(i),r.ic().toggleVisibility()})),r.jc(1,"translate"),r.jc(2,"translate"),r.Sb(3,"mat-icon",11),r.jc(4,"async"),r.jc(5,"async"),r.Wb()}if(2&e){var o=r.ic();r.oc("color",o.layer.visible?"primary":"default")("matTooltip",o.layer.visible?r.kc(1,5,"igo.geo.layer.hideLayer"):r.kc(2,7,"igo.geo.layer.showLayer")),r.Db(3),r.oc("matBadgeHidden",r.kc(4,9,o.queryBadgeHidden$))("ngClass",r.rc(13,su,!r.kc(5,11,o.inResolutionRange$)))("svgIcon",o.layer.visible?"eye":"eye-off")}}function uu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",13),r.ec("click",(function(){return r.yc(i),r.ic().toggleLayerTool()})),r.jc(1,"translate"),r.Sb(2,"mat-icon",14),r.Wb()}2&e&&r.oc("matTooltip",r.kc(1,1,"igo.geo.layer.moreOptions"))}function hu(e,t){if(1&e&&r.Sb(0,"igo-layer-legend",15),2&e){var i=r.ic();r.oc("layer",i.layer)("updateLegendOnResolutionChange",i.updateLegendOnResolutionChange)}}var du=["renderedLegend"];function pu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-list-item"),r.Xb(1,"mat-icon",7),r.ec("toggle",(function(e){r.yc(i);var t=r.ic().$implicit;return r.ic(3).toggleLegendItem(e,t)})),r.Wb(),r.Xb(2,"h4",8),r.Ic(3),r.jc(4,"async"),r.Wb(),r.Wb()}if(2&e){var o=r.ic().$implicit,n=r.vc(4),a=r.ic(3);r.Db(1),r.oc("target",n)("collapsed",o.collapsed),r.Db(2),r.Kc("",r.kc(4,3,a.computeItemTitle(o))," ")}}function gu(e,t){if(1&e&&(r.Xb(0,"mat-option",11),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i.name),r.Db(1),r.Jc(i.title)}}function fu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div"),r.Xb(1,"mat-form-field"),r.Xb(2,"mat-select",9),r.ec("ngModelChange",(function(e){return r.yc(i),r.ic(4).currentStyle=e}))("selectionChange",(function(){return r.yc(i),r.ic(4).onChangeStyle()})),r.jc(3,"translate"),r.Gc(4,gu,2,2,"mat-option",10),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=r.ic(4);r.Db(2),r.oc("matTooltip",r.kc(3,3,"igo.geo.layer.legend.selectStyle"))("ngModel",o.currentStyle),r.Db(2),r.oc("ngForOf",o.styles)}}function mu(e,t){1&e&&(r.Xb(0,"small"),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e&&(r.Db(1),r.Kc(" ",r.kc(2,1,"igo.geo.layer.legend.noLegendScale")," "))}function bu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div"),r.Xb(1,"img",13,14),r.ec("load",(function(){r.yc(i);var e=r.ic(2).$implicit;return r.ic(3).onLoadImage(e.title)})),r.jc(3,"async"),r.jc(4,"secureImage"),r.jc(5,"translate"),r.Wb(),r.Gc(6,mu,3,3,"small",0),r.Wb()}if(2&e){var o=r.ic(2).$implicit,n=r.ic(3);r.Db(1),r.pc("id",o.title),r.pc("src",r.kc(3,4,r.kc(4,6,o.url)),r.Bc),r.pc("alt",r.kc(5,8,"igo.geo.layer.legend.loadingLegendText")),r.Db(5),r.oc("ngIf",n.imagesHeight[o.title]<16)}}function vu(e,t){if(1&e&&r.Sb(0,"div",15),2&e){var i=r.ic(2).$implicit;r.oc("ngStyle",i.style)("innerHTML",i.html,r.zc)}}function yu(e,t){if(1&e&&(r.Xb(0,"div"),r.Gc(1,bu,7,10,"div",0),r.Gc(2,vu,1,2,"div",12),r.Wb()),2&e){var i=r.ic().$implicit;r.Db(1),r.oc("ngIf",i.url),r.Db(1),r.oc("ngIf",i.html)}}var ku=function(e){return{"with-title":e}};function Su(e,t){if(1&e&&(r.Vb(0,null,4),r.Gc(2,pu,5,5,"mat-list-item",0),r.Xb(3,"div",5,6),r.Gc(5,fu,5,5,"div",0),r.Gc(6,yu,3,2,"div",0),r.Wb(),r.Ub()),2&e){var i=t.$implicit,o=r.ic(3);r.Db(2),r.oc("ngIf",i.title),r.Db(1),r.oc("ngClass",r.rc(4,ku,i.title)),r.Db(2),r.oc("ngIf",void 0!==o.currentStyle),r.Db(1),r.oc("ngIf",!i.collapsed)}}function Cu(e,t){if(1&e&&(r.Vb(0),r.Gc(1,Su,7,6,"ng-container",3),r.Ub()),2&e){var i=r.ic().ngIf;r.Db(1),r.oc("ngForOf",i.slice().reverse())}}function wu(e,t){1&e&&(r.Xb(0,"small"),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e&&(r.Db(1),r.Kc(" ",r.kc(2,1,"igo.geo.layer.legend.noLegendText")," "))}function xu(e,t){if(1&e&&(r.Vb(0),r.Gc(1,Cu,2,1,"ng-container",1),r.Gc(2,wu,3,3,"ng-template",null,2,r.Hc),r.Ub()),2&e){var i=t.ngIf,o=r.vc(3);r.Db(1),r.oc("ngIf",i.length)("ngIfElse",o)}}var Ou=["igoLayerItemToolbar"];function Iu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-layer-list-tool",5),r.ec("appliedFilterAndSort",(function(e){return r.yc(i),r.ic().onAppliedFilterAndSortChange(e)}))("selection",(function(e){return r.yc(i),r.ic().toggleSelectionMode(e)})),r.Wb()}if(2&e){var o=r.ic();r.oc("layersAreAllVisible",o.layersAreAllVisible)("term",o.layerFilterAndSortOptions.keyword)("onlyVisible",o.layerFilterAndSortOptions.onlyVisible)("sortAlpha",o.layerFilterAndSortOptions.sortAlpha)}}function Lu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-layer-item",7),r.ec("action",(function(e){return r.yc(i),r.ic(2).toggleLayerTool(e)}))("checkbox",(function(e){return r.yc(i),r.ic(2).layersCheck(e)})),r.Wb()}if(2&e){var o=r.ic().$implicit,n=r.ic();r.oc("layer",o)("activeLayer",n.activeLayer)("orderable",n.orderable&&!o.baseLayer)("lowerDisabled",n.getLowerLayer().id===o.id)("raiseDisabled",n.getUpperLayer().id===o.id)("queryBadge",n.queryBadge)("expandLegendIfVisible",n.expandLegendOfVisibleLayers)("updateLegendOnResolutionChange",n.updateLegendOnResolutionChange)("toggleLegendOnVisibilityChange",n.toggleLegendOnVisibilityChange)("selectionMode",n.selection)("selectAll",n.selectAllCheck)("layerCheck",o.options.check)("changeDetection",n.layerItemChangeDetection$)}}function Tu(e,t){if(1&e&&r.Gc(0,Lu,1,13,"igo-layer-item",6),2&e){var i=t.$implicit,o=r.ic();r.oc("ngIf",!(o.excludeBaseLayers&&i.baseLayer))}}var Fu=function(e){return{layer:e}};function _u(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-panel",8),r.Xb(1,"div",9),r.Tb(2,10),r.mc(3),r.Xb(4,"button",11),r.jc(5,"translate"),r.Sb(6,"mat-icon",12),r.Wb(),r.Xb(7,"mat-menu",13,14),r.Xb(9,"div",15),r.Xb(10,"mat-slider",16),r.ec("ngModelChange",(function(e){return r.yc(i),r.ic().opacity=e}))("click",(function(e){return r.yc(i),e.stopPropagation()})),r.jc(11,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Xb(12,"button",17),r.ec("click",(function(){r.yc(i);var e=r.ic();return e.activeLayer.map.raiseLayer(e.activeLayer)})),r.jc(13,"translate"),r.jc(14,"translate"),r.Sb(15,"mat-icon",18),r.Wb(),r.Xb(16,"button",19),r.ec("click",(function(){r.yc(i);var e=r.ic();return e.activeLayer.map.lowerLayer(e.activeLayer)})),r.jc(17,"translate"),r.jc(18,"translate"),r.Sb(19,"mat-icon",20),r.Wb(),r.Xb(20,"button",21),r.ec("click",(function(){return r.yc(i),r.ic().removeLayers()})),r.jc(21,"translate"),r.Sb(22,"mat-icon",22),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=r.vc(8),n=r.ic();r.oc("title",n.activeLayer.title),r.Db(2),r.oc("ngTemplateOutlet",n.templateLayerToolbar)("ngTemplateOutletContext",r.rc(33,Fu,n.activeLayer)),r.Db(2),r.oc("matMenuTriggerFor",o)("matTooltip",r.kc(5,19,"igo.geo.layer.opacity")),r.Db(2),r.oc("matBadge",n.badgeOpacity),r.Db(4),r.oc("min",0)("max",100)("ngModel",n.opacity)("matTooltip",r.kc(11,21,"igo.geo.layer.opacity")),r.Db(2),r.oc("matTooltip",n.sortAlpha||n.onlyVisible||n.keyword?r.kc(13,23,"igo.geo.layer.filterRaiseLayer"):r.kc(14,25,"igo.geo.layer.raiseLayer"))("disabled",n.raiseDisabled),r.Db(3),r.oc("matBadge",n.sortAlpha||n.onlyVisible||n.keyword?"!":"")("matBadgeHidden",n.raiseDisabled),r.Db(1),r.oc("matTooltip",n.sortAlpha||n.onlyVisible||n.keyword?r.kc(17,27,"igo.geo.layer.filterLowerLayer"):r.kc(18,29,"igo.geo.layer.lowerLayer"))("disabled",n.lowerDisabled),r.Db(3),r.oc("matBadge",n.sortAlpha||n.onlyVisible||n.keyword?"!":"")("matBadgeHidden",n.lowerDisabled),r.Db(1),r.oc("matTooltip",r.kc(21,31,"igo.geo.layer.removeLayer"))}}function Mu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-slider",16),r.ec("ngModelChange",(function(e){return r.yc(i),r.ic(2).checkOpacity=e}))("click",(function(e){return r.yc(i),e.stopPropagation()})),r.jc(1,"translate"),r.Wb()}if(2&e){var o=r.ic(2);r.oc("min",0)("max",100)("ngModel",o.checkOpacity)("matTooltip",r.kc(1,4,"igo.geo.layer.opacity"))}}function Du(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-panel",8),r.jc(1,"translate"),r.Xb(2,"div",9),r.Xb(3,"button",23),r.ec("click",(function(){return r.yc(i),r.ic().selectAll()})),r.jc(4,"translate"),r.jc(5,"translate"),r.Ic(6),r.jc(7,"translate"),r.jc(8,"translate"),r.Wb(),r.Xb(9,"button",24),r.jc(10,"translate"),r.Sb(11,"mat-icon",25),r.Wb(),r.Xb(12,"mat-menu",13,14),r.Xb(14,"div",15),r.Gc(15,Mu,2,6,"mat-slider",26),r.Wb(),r.Wb(),r.Xb(16,"button",17),r.ec("click",(function(){r.yc(i);var e=r.ic();return e.raiseLayers(e.layersChecked)})),r.jc(17,"translate"),r.jc(18,"translate"),r.Sb(19,"mat-icon",18),r.Wb(),r.Xb(20,"button",19),r.ec("click",(function(){r.yc(i);var e=r.ic();return e.lowerLayers(e.layersChecked)})),r.jc(21,"translate"),r.jc(22,"translate"),r.Sb(23,"mat-icon",20),r.Wb(),r.Xb(24,"button",27),r.ec("click",(function(){r.yc(i);var e=r.ic();return e.toggleVisibility(e.layersChecked)})),r.jc(25,"translate"),r.jc(26,"translate"),r.Sb(27,"mat-icon",28),r.Wb(),r.Xb(28,"button",29),r.ec("click",(function(){r.yc(i);var e=r.ic();return e.removeLayers(e.layersChecked)})),r.jc(29,"translate"),r.Sb(30,"mat-icon",22),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=r.vc(13),n=r.ic();r.oc("title",r.kc(1,21,"igo.geo.layer.tools")),r.Db(3),r.oc("disabled",0===n.layers.length)("matTooltip",n.selectAllCheck?r.kc(4,23,"igo.geo.layer.deselectAll"):r.kc(5,25,"igo.geo.layer.selectAll")),r.Db(3),r.Kc(" ",n.selectAllCheck?r.kc(7,27,"igo.geo.layer.deselectAll"):r.kc(8,29,"igo.geo.layer.selectAll")," "),r.Db(3),r.oc("disabled",0===n.layersChecked.length)("matMenuTriggerFor",o)("matTooltip",r.kc(10,31,"igo.geo.layer.opacity")),r.Db(6),r.oc("ngIf",n.layersChecked.length),r.Db(1),r.oc("matTooltip",n.sortAlpha||n.onlyVisible||n.keyword?r.kc(17,33,"igo.geo.layer.filterRaiseLayer"):r.kc(18,35,"igo.geo.layer.raiseLayer"))("disabled",n.raiseDisabledSelection),r.Db(3),r.oc("matBadge",n.sortAlpha||n.onlyVisible||n.keyword?"!":"")("matBadgeHidden",n.raiseDisabledSelection),r.Db(1),r.oc("matTooltip",n.sortAlpha||n.onlyVisible||n.keyword?r.kc(21,37,"igo.geo.layer.filterLowerLayer"):r.kc(22,39,"igo.geo.layer.lowerLayer"))("disabled",n.lowerDisabledSelection),r.Db(3),r.oc("matBadge",n.sortAlpha||n.onlyVisible||n.keyword?"!":"")("matBadgeHidden",n.lowerDisabledSelection),r.Db(1),r.oc("disabled",0===n.layersChecked.length)("matTooltip","ALL_HIDDEN"===n.statusSelectedLayersCheck?r.kc(25,41,"igo.geo.layer.showSelectedLayers"):r.kc(26,43,"igo.geo.layer.hideSelectedLayers")),r.Db(3),r.oc("svgIcon","ALL_HIDDEN"===n.statusSelectedLayersCheck?"eye-off":"eye"),r.Db(1),r.oc("disabled",0===n.layersChecked.length)("matTooltip",r.kc(29,45,"igo.geo.layer.removeLayer"))}}var Pu=[[["","igoLayerItemToolbar",""]]],Au=["[igoLayerItemToolbar]"];function ju(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",9),r.ec("click",(function(){return r.yc(i),r.ic().clearTerm()})),r.Sb(1,"mat-icon",10),r.Wb()}}function Ru(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-slide-toggle",5),r.ec("change",(function(e){return r.yc(i),r.ic().toggleShowAllLegends(e.checked)})),r.jc(1,"translate"),r.Ic(2),r.jc(3,"translate"),r.Wb()}if(2&e){var o=r.ic();r.oc("matTooltip",r.kc(1,4,"igo.geo.layer.legend.showAll"))("checked",o.showAllLegendsValue)("labelPosition","before"),r.Db(2),r.Kc(" ",r.kc(3,6,"igo.geo.layer.legend.showAll"),"\n")}}function $u(e,t){1&e&&r.Sb(0,"mat-divider")}function Eu(e,t){if(1&e&&r.Sb(0,"igo-layer-legend-item",7),2&e){var i=r.ic().$implicit,o=r.ic();r.oc("layer",i)("updateLegendOnResolutionChange",o.updateLegendOnResolutionChange)}}function Wu(e,t){if(1&e&&r.Gc(0,Eu,1,2,"igo-layer-legend-item",6),2&e){var i=t.$implicit,o=r.ic();r.oc("ngIf",!(o.excludeBaseLayers&&i.baseLayer))}}function Xu(e,t){1&e&&(r.Xb(0,"p",8),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e&&(r.Db(1),r.Kc(" ",r.kc(2,1,"igo.geo.layer.legend.noLayersVisibleWithShowAllButton")," "))}function Gu(e,t){1&e&&(r.Xb(0,"p",8),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e&&(r.Db(1),r.Kc(" ",r.kc(2,1,"igo.geo.layer.legend.noLayersVisibleWithShowAllButtonButZoom")," "))}function Bu(e,t){1&e&&(r.Xb(0,"p",8),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e&&(r.Db(1),r.Kc(" ",r.kc(2,1,"igo.geo.layer.legend.noLayersVisible")," "))}function Vu(e,t){1&e&&(r.Xb(0,"p",8),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e&&(r.Db(1),r.Kc(" ",r.kc(2,1,"igo.geo.layer.legend.noLayersVisibleButZoom")," "))}function Nu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",1),r.ec("click",(function(){return r.yc(i),r.ic().toggleTrackFeature()})),r.jc(1,"translate"),r.Sb(2,"mat-icon",2),r.Wb()}if(2&e){var o=r.ic();r.oc("matTooltip",r.kc(1,2,"igo.geo.layer.trackFeature"))("color",o.color)}}function zu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-catalog-library-item",2),r.ec("select",(function(){r.yc(i);var e=t.$implicit;return r.ic().onCatalogSelect(e)})),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic();r.oc("map",n.map)("catalog",o)}}function qu(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",1),r.ec("click",(function(){r.yc(i);var e=r.ic();return e.openDownload(e.layer)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",2),r.Wb()}if(2&e){var o=r.ic();r.oc("matTooltip",r.kc(1,2,"igo.geo.download.action"))("color",o.color)}}function Hu(e,t){if(1&e&&(r.Xb(0,"td"),r.Sb(1,"mat-icon",7),r.Wb()),2&e){var i=r.ic(3);r.Db(1),r.pc("svgIcon",i.icon)}}function Uu(e,t){if(1&e&&(r.Xb(0,"td"),r.Xb(1,"a",8),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Wb()),2&e){var i=r.ic().$implicit,o=r.ic(2);r.Db(1),r.pc("href",i.value,r.Bc),r.Db(1),r.Lc(" ",r.kc(3,3,"igo.geo.targetHtmlUrl")," ",o.title,"")}}function Yu(e,t){if(1&e&&(r.Xb(0,"td",9),r.Ic(1),r.Wb()),2&e){var i=r.ic().$implicit;r.Db(1),r.Kc(" ",i.key," ")}}function Ku(e,t){if(1&e&&r.Sb(0,"td",10),2&e){var i=r.ic().$implicit;r.oc("innerHTML",i.value,r.zc)}}function Zu(e,t){if(1&e&&(r.Sb(0,"img",13),r.jc(1,"async"),r.jc(2,"secureImage")),2&e){var i=r.ic(2).$implicit;r.pc("src",r.kc(1,1,r.kc(2,3,i.value)),r.Bc)}}function Ju(e,t){1&e&&(r.Xb(0,"span"),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e&&(r.Db(1),r.Kc("",r.kc(2,1,"igo.geo.targetHtmlUrl")," "))}function Qu(e,t){if(1&e&&(r.Xb(0,"td"),r.Xb(1,"a",8),r.Gc(2,Zu,3,5,"img",11),r.Gc(3,Ju,3,3,"ng-template",null,12,r.Hc),r.Wb(),r.Wb()),2&e){var i=r.vc(4),o=r.ic().$implicit,n=r.ic(2);r.Db(1),r.pc("href",o.value,r.Bc),r.Db(1),r.oc("ngIf",n.isImg(o.value))("ngIfElse",i)}}function eh(e,t){if(1&e&&(r.Sb(0,"td",10),r.jc(1,"json")),2&e){var i=r.ic().$implicit;r.oc("innerHTML",r.kc(1,1,i.value),r.zc)}}function th(e,t){if(1&e&&(r.Xb(0,"tr"),r.Gc(1,Hu,2,1,"td",4),r.Gc(2,Uu,4,5,"td",4),r.Gc(3,Yu,2,1,"td",5),r.Gc(4,Ku,1,1,"td",6),r.Gc(5,Qu,5,3,"td",4),r.Gc(6,eh,2,3,"td",6),r.Wb()),2&e){var i=t.$implicit,o=r.ic(2);r.Db(1),r.oc("ngIf","_blank"===o.feature.properties.target&&"url"===i.key),r.Db(1),r.oc("ngIf","_blank"===o.feature.properties.target&&"url"===i.key),r.Db(1),r.oc("ngIf",void 0===o.feature.properties.target),r.Db(1),r.oc("ngIf",void 0===o.feature.properties.target&&!o.isObject(i.value)&&!o.isUrl(i.value)),r.Db(1),r.oc("ngIf",void 0===o.feature.properties.target&&!o.isObject(i.value)&&o.isUrl(i.value)),r.Db(1),r.oc("ngIf",void 0===o.feature.properties.target&&o.isObject(i.value))}}function ih(e,t){if(1&e&&(r.Xb(0,"table",2),r.Xb(1,"tbody"),r.Gc(2,th,7,6,"tr",3),r.jc(3,"keyvalue"),r.Wb(),r.Wb()),2&e){var i=r.ic();r.Db(2),r.oc("ngForOf",r.kc(3,1,i.filterFeatureProperties(i.feature)))}}function oh(e,t){if(1&e&&r.Sb(0,"iframe",14),2&e){var i=r.ic();r.oc("src",i.htmlSanitizer(i.feature.properties.url),r.Ac)}}var nh=["table"];function rh(e,t){if(1&e){var i=r.Yb();r.Vb(0),r.Xb(1,"igo-measurer-item",12),r.ec("measureUnitChange",(function(e){return r.yc(i),r.ic().onLengthUnitChange(e)})),r.jc(2,"translate"),r.Wb(),r.Xb(3,"igo-measurer-item",12),r.ec("measureUnitChange",(function(e){return r.yc(i),r.ic().onAreaUnitChange(e)})),r.jc(4,"translate"),r.Wb(),r.Ub()}if(2&e){var o=t.ngIf,n=r.ic();r.Db(1),r.oc("measureType",n.measureType.Length)("measureUnit",n.measureLengthUnit.Meters)("measure",o.length)("auto",n.measureUnitsAuto)("placeholder",r.kc(2,10,n.activeMeasureType===n.measureType.Area?"igo.geo.measure.perimeter":"igo.geo.measure.length")),r.Db(2),r.oc("measureType",n.measureType.Area)("measureUnit",n.measureAreaUnit.SquareMeters)("measure",o.area)("auto",n.measureUnitsAuto)("placeholder",r.kc(4,12,"igo.geo.measure.area"))}}function ah(e,t){}function sh(e,t){if(1&e&&(r.Xb(0,"button",2),r.jc(1,"translate"),r.Sb(2,"mat-icon",3),r.Wb()),2&e){var i=r.ic();r.oc("matTooltip",r.kc(1,3,"igo.geo.filter.filterBy"))("color",i.color),r.Db(2),r.oc("matBadge",i.badge)}}function ch(e,t){if(1&e&&r.Sb(0,"igo-time-filter-item",7),2&e){var i=r.ic(2);r.oc("header",!1)("layer",i.layer)}}function lh(e,t){if(1&e&&(r.Xb(0,"div",4,5),r.Gc(2,ch,1,2,"igo-time-filter-item",6),r.Wb()),2&e){var i=r.ic();r.Db(2),r.oc("ngIf",i.timeFilterCollapse&&i.options.timeFilter)}}function uh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",3),r.Xb(1,"mat-form-field"),r.Sb(2,"mat-datetimepicker-toggle",4),r.Sb(3,"mat-datetimepicker",5,6),r.Xb(5,"input",7),r.ec("ngModelChange",(function(e){return r.yc(i),r.ic(2).date=e}))("dateChange",(function(e){return r.yc(i),r.ic(2).handleDateChange(e)})),r.jc(6,"translate"),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=r.vc(4),n=r.ic(2);r.Db(2),r.oc("for",o),r.Db(1),r.pc("type",n.type),r.Db(2),r.pc("placeholder",r.kc(6,7,"igo.geo.timeFilter.date")),r.oc("matDatetimepicker",o)("ngModel",n.date)("min",n.min)("max",n.max)}}function hh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div"),r.Xb(1,"div",8),r.Xb(2,"mat-form-field"),r.Sb(3,"mat-datetimepicker-toggle",4),r.Sb(4,"mat-datetimepicker",5,9),r.Xb(6,"input",10),r.ec("ngModelChange",(function(e){return r.yc(i),r.ic(2).startDate=e}))("input",(function(){return r.yc(i),r.ic(2).startDate}))("dateChange",(function(e){return r.yc(i),r.ic(2).handleDateChange(e)})),r.jc(7,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Xb(8,"div",8),r.Xb(9,"mat-form-field"),r.Sb(10,"mat-datetimepicker-toggle",4),r.Sb(11,"mat-datetimepicker",5,11),r.Xb(13,"input",7),r.ec("ngModelChange",(function(e){return r.yc(i),r.ic(2).endDate=e}))("dateChange",(function(e){return r.yc(i),r.ic(2).handleDateChange(e)})),r.jc(14,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=r.vc(5),n=r.vc(12),a=r.ic(2);r.Db(3),r.oc("for",o),r.Db(1),r.pc("type",a.type),r.Db(2),r.pc("placeholder",r.kc(7,14,"igo.geo.timeFilter.startDate")),r.oc("matDatetimepicker",o)("ngModel",a.startDate)("min",a.min)("max",a.getRangeMaxDate()),r.Db(4),r.oc("for",n),r.Db(1),r.pc("type",a.type),r.Db(2),r.pc("placeholder",r.kc(14,16,"igo.geo.timeFilter.endDate")),r.oc("matDatetimepicker",n)("ngModel",a.endDate)("min",a.getRangeMinDate())("max",a.max)}}function dh(e,t){if(1&e&&(r.Xb(0,"div"),r.Gc(1,uh,7,9,"div",2),r.Gc(2,hh,15,18,"div",0),r.Wb()),2&e){var i=r.ic();r.Db(1),r.oc("ngIf",!i.isRange),r.Db(1),r.oc("ngIf",i.isRange)}}function ph(e,t){if(1&e&&(r.Xb(0,"mat-option",14),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i),r.Db(1),r.Jc(i)}}function gh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",3),r.Xb(1,"mat-form-field"),r.Xb(2,"mat-select",12),r.ec("ngModelChange",(function(e){return r.yc(i),r.ic(2).year=e}))("selectionChange",(function(e){return r.yc(i),r.ic(2).handleYearChange(e)})),r.jc(3,"translate"),r.Gc(4,ph,2,2,"mat-option",13),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=r.ic(2);r.Db(2),r.pc("placeholder",r.kc(3,3,"igo.geo.timeFilter.date")),r.oc("ngModel",o.year),r.Db(2),r.oc("ngForOf",o.listYears)}}function fh(e,t){if(1&e&&(r.Xb(0,"mat-option",14),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i),r.Db(1),r.Jc(i)}}function mh(e,t){if(1&e&&(r.Xb(0,"mat-option",14),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i),r.Db(1),r.Jc(i)}}function bh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div"),r.Xb(1,"div",8),r.Xb(2,"mat-form-field"),r.Xb(3,"mat-select",12),r.ec("ngModelChange",(function(e){return r.yc(i),r.ic(2).startYear=e}))("selectionChange",(function(e){return r.yc(i),r.ic(2).handleYearChange(e)})),r.jc(4,"translate"),r.Gc(5,fh,2,2,"mat-option",13),r.Wb(),r.Wb(),r.Wb(),r.Xb(6,"div",8),r.Xb(7,"mat-form-field"),r.Xb(8,"mat-select",12),r.ec("ngModelChange",(function(e){return r.yc(i),r.ic(2).endYear=e}))("selectionChange",(function(e){return r.yc(i),r.ic(2).handleYearChange(e)})),r.jc(9,"translate"),r.Gc(10,mh,2,2,"mat-option",13),r.Wb(),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=r.ic(2);r.Db(3),r.pc("placeholder",r.kc(4,6,"igo.geo.timeFilter.startDate")),r.oc("ngModel",o.startYear),r.Db(2),r.oc("ngForOf",o.startListYears),r.Db(3),r.pc("placeholder",r.kc(9,8,"igo.geo.timeFilter.endDate")),r.oc("ngModel",o.endYear),r.Db(2),r.oc("ngForOf",o.endListYears)}}function vh(e,t){if(1&e&&(r.Xb(0,"div"),r.Gc(1,gh,5,5,"div",2),r.Gc(2,bh,11,10,"div",0),r.Wb()),2&e){var i=r.ic();r.Db(1),r.oc("ngIf",!i.isRange),r.Db(1),r.oc("ngIf",i.isRange)}}function yh(e,t){if(1&e&&(r.Xb(0,"p",23),r.Ic(1),r.Wb()),2&e){var i=r.ic(2);r.Db(1),r.Jc(i.year)}}function kh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",15),r.Xb(1,"span"),r.Ic(2),r.Wb(),r.Xb(3,"mat-slider",16),r.ec("input",(function(e){return r.yc(i),r.ic().handleSliderYearChange(e)}))("change",(function(e){return r.yc(i),r.ic().handleSliderYearChange(e)})),r.Wb(),r.Xb(4,"span"),r.Ic(5),r.Wb(),r.Gc(6,yh,2,1,"p",17),r.Xb(7,"div",18,19),r.Xb(9,"mat-slide-toggle",20),r.ec("change",(function(){return r.yc(i),r.ic().toggleFilterState()})),r.jc(10,"translate"),r.Wb(),r.Xb(11,"button",21),r.ec("click",(function(e){return r.yc(i),r.ic().playYear(e)})),r.Sb(12,"mat-icon",22),r.Wb(),r.Xb(13,"button",21),r.ec("click",(function(e){return r.yc(i),r.ic().resetFilter(e)})),r.Sb(14,"mat-icon",22),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(2),r.Jc(o.startYear),r.Db(1),r.pc("step",o.step),r.oc("min",o.startYear)("max",o.endYear)("value",o.handleSliderValue())("color",o.color)("disabled",!o.options.enabled||!o.layer.visible),r.Db(2),r.Jc(o.endYear),r.Db(1),r.oc("ngIf",o.options.enabled),r.Db(3),r.oc("matTooltip",r.kc(10,17,"igo.geo.filter.toggleFilterState"))("color",o.color)("checked",o.options.enabled)("disabled",!o.layer.visible),r.Db(2),r.oc("disabled",!o.options.enabled||!o.layer.visible),r.Db(1),r.pc("svgIcon",o.playIcon),r.Db(1),r.oc("disabled",!o.options.enabled||!o.layer.visible),r.Db(1),r.pc("svgIcon",o.resetIcon)}}function Sh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",3),r.Xb(1,"mat-slider",24),r.ec("input",(function(e){return r.yc(i),r.ic().handleSliderDateChange(e)}))("selectionChange",(function(e){return r.yc(i),r.ic().handleSliderDateChange(e)})),r.Wb(),r.Xb(2,"p",23),r.Ic(3),r.Wb(),r.Xb(4,"button",25),r.ec("click",(function(e){return r.yc(i),r.ic().playFilter(e)})),r.Sb(5,"mat-icon",22),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(1),r.pc("step",o.step),r.oc("min",o.dateToNumber(o.min))("max",o.dateToNumber(o.max))("value",o.handleSliderValue()),r.Db(2),r.Jc(o.handleSliderTooltip()),r.Db(2),r.pc("svgIcon",o.playIcon)}}function Ch(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",10),r.ec("click",(function(){return r.yc(i),r.ic(2).setVisible()})),r.jc(1,"translate"),r.Sb(2,"mat-icon",11),r.Wb()}2&e&&r.oc("matTooltip",r.kc(1,1,"igo.geo.layer.showLayer"))}var wh=function(e){return{cursor:e}};function xh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-list-item"),r.Xb(1,"mat-icon",7),r.ec("click",(function(){return r.yc(i),r.ic().toggleFiltersCollapsed()})),r.Wb(),r.Xb(2,"h4",8),r.ec("click",(function(){return r.yc(i),r.ic().toggleLegendOnClick()})),r.Ic(3),r.Wb(),r.Gc(4,Ch,3,3,"button",9),r.Wb()}if(2&e){var o=r.ic(),n=r.vc(2);r.Db(1),r.oc("target",n)("collapsed",o.filtersCollapsed),r.Db(1),r.oc("ngStyle",r.rc(5,wh,o.filtersCollapsed?"default":"pointer")),r.Db(1),r.Jc(o.layer.title),r.Db(1),r.oc("ngIf",!o.layer.visible)}}function Oh(e,t){if(1&e&&r.Sb(0,"igo-layer-legend",12),2&e){var i=r.ic();r.oc("layer",i.layer)}}function Ih(e,t){if(1&e&&r.Sb(0,"igo-time-filter-item",2),2&e){var i=t.$implicit;r.oc("header",!0)("layer",i)}}function Lh(e,t){if(1&e&&(r.Xb(0,"mat-option",23),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i.alias)("id",i.name)("matTooltip",i.alias),r.Db(1),r.Kc(" ",i.alias," ")}}function Th(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",24),r.ec("click",(function(){return r.yc(i),r.ic(2).clearSelectedField()})),r.Sb(1,"mat-icon",25),r.Wb()}if(2&e){var o=r.ic(2);r.oc("disabled",!o.currentFilter.active)}}function Fh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-form-field",17),r.ec("mouseenter",(function(){return r.yc(i),r.ic().inputClearable="selectField"}))("mouseleave",(function(){return r.yc(i),r.ic().inputClearable=void 0})),r.Xb(1,"input",18),r.ec("input",(function(e){return r.yc(i),r.ic().updateFieldsList(e.target.value)})),r.jc(2,"translate"),r.jc(3,"async"),r.jc(4,"async"),r.jc(5,"async"),r.jc(6,"async"),r.jc(7,"translate"),r.Wb(),r.Xb(8,"mat-autocomplete",19,20),r.ec("optionSelected",(function(e){return r.yc(i),r.ic().changeField(e.option.id)})),r.Gc(10,Lh,2,4,"mat-option",21),r.jc(11,"async"),r.Wb(),r.Gc(12,Th,2,1,"button",22),r.Wb()}if(2&e){var o=r.vc(9),n=r.ic();r.oc("floatLabel",n.floatLabel),r.Db(1),r.oc("placeholder",r.kc(2,8,"igo.geo.sourceFields.selectField"))("disabled",!n.currentFilter.active)("matAutocomplete",o)("value",r.kc(3,10,n.selectedField$)?r.kc(4,12,n.selectedField$).alias:"")("matTooltip",r.kc(5,14,n.selectedField$)?r.kc(6,16,n.selectedField$).alias:r.kc(7,18,"igo.geo.sourceFields.selectField")),r.Db(9),r.oc("ngForOf",r.kc(11,20,n.filteredFields$)),r.Db(2),r.oc("ngIf",n.currentFilter.propertyName&&"selectField"===n.inputClearable&&n.currentFilter.active)}}function _h(e,t){if(1&e&&(r.Xb(0,"mat-option",3),r.jc(1,"translate"),r.Ic(2),r.jc(3,"translate"),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i.key)("matTooltip",r.kc(1,3,"igo.geo.operators.tooltip."+i.key)),r.Db(2),r.Kc(" ",r.kc(3,5,"igo.geo.operators."+i.key)," ")}}function Mh(e,t){if(1&e&&(r.Xb(0,"mat-option",29),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i.type),r.Db(1),r.Kc(" ",r.kc(2,2,"igo.geo.spatialSelector."+i.type)," ")}}function Dh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-form-field",26),r.Xb(1,"mat-select",27),r.ec("selectionChange",(function(e){return r.yc(i),r.ic().changeSpatialSelector(e.value)})),r.Gc(2,Mh,3,4,"mat-option",28),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(1),r.oc("disabled",!o.currentFilter.active)("value",o.currentFilter.igoSpatialSelector),r.Db(1),r.oc("ngForOf",o.igoSpatialSelectors)}}function Ph(e,t){if(1&e&&(r.Xb(0,"mat-option",33),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i)("matTooltip",i),r.Db(1),r.Kc(" ",i," ")}}function Ah(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",24),r.ec("click",(function(){return r.yc(i),r.ic(2).clearProperty()})),r.Sb(1,"mat-icon",25),r.Wb()}if(2&e){var o=r.ic(2);r.oc("disabled",!o.currentFilter.active)}}function jh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-form-field",30),r.ec("mouseenter",(function(){return r.yc(i),r.ic().inputClearable="selectProperty"}))("mouseleave",(function(){return r.yc(i),r.ic().inputClearable=void 0})),r.Xb(1,"input",18),r.ec("input",(function(e){return r.yc(i),r.ic().updateValuesList(e.target.value)})),r.jc(2,"translate"),r.Wb(),r.Xb(3,"mat-autocomplete",19,31),r.ec("optionSelected",(function(e){return r.yc(i),r.ic().changeProperty(e.option.value)})),r.Gc(5,Ph,2,3,"mat-option",32),r.jc(6,"async"),r.Wb(),r.Gc(7,Ah,2,1,"button",22),r.Wb()}if(2&e){var o=r.vc(4),n=r.ic();r.oc("floatLabel",n.floatLabel),r.Db(1),r.oc("placeholder",r.kc(2,8,"igo.geo.filter.placeholder"))("disabled",!n.currentFilter.active)("matAutocomplete",o)("value","expression"===n.detectProperty()?n.currentFilter.expression:n.currentFilter.pattern)("matTooltip","expression"===n.detectProperty()?n.currentFilter.expression||"":n.currentFilter.pattern||""),r.Db(4),r.oc("ngForOf",r.kc(6,10,n.filteredValues$)),r.Db(2),r.oc("ngIf",n.isClearable()&&"selectProperty"===n.inputClearable&&n.currentFilter.active)}}function Rh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",24),r.ec("click",(function(){return r.yc(i),r.ic(2).currentFilter.igoSNRC=""})),r.Sb(1,"mat-icon",25),r.Wb()}if(2&e){var o=r.ic(2);r.oc("disabled",!o.currentFilter.active&&"selectSNRC"===o.inputClearable&&o.currentFilter.active)}}function $h(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-form-field",34),r.ec("mouseenter",(function(){return r.yc(i),r.ic().inputClearable="selectSNRC"}))("mouseleave",(function(){return r.yc(i),r.ic().inputClearable=void 0})),r.Xb(1,"input",35),r.ec("input",(function(e){return r.yc(i),r.ic().changeSNRC(e.target.value)})),r.jc(2,"translate"),r.Wb(),r.Gc(3,Rh,2,1,"button",22),r.Wb()}if(2&e){var o=r.ic();r.oc("floatLabel",o.floatLabel),r.Db(1),r.oc("placeholder",r.kc(2,5,"igo.geo.filter.placeholderSnrc"))("value",o.currentFilter.igoSNRC)("matTooltip",o.currentFilter.igoSNRC?o.currentFilter.igoSNRC:""),r.Db(2),r.oc("ngIf",o.currentFilter.igoSNRC)}}function Eh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",37),r.ec("click",(function(){return r.yc(i),r.ic(2).changeMapExtentGeometry()})),r.jc(1,"translate"),r.Sb(2,"mat-icon",38),r.Wb()}if(2&e){var o=r.ic(2);r.oc("disabled",!o.currentFilter.active)("disabled",!o.currentFilter.active)("matTooltip",r.kc(1,3,"igo.geo.spatialSelector.btnSetExtent"))}}function Wh(e,t){if(1&e&&(r.Vb(0),r.Gc(1,Eh,3,5,"button",36),r.Ub()),2&e){var i=r.ic();r.Db(1),r.oc("ngIf","fixedExtent"===i.currentFilter.igoSpatialSelector)}}function Xh(e,t){if(1&e&&(r.Xb(0,"mat-option",33),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i)("matTooltip",i),r.Db(1),r.Kc(" ",i," ")}}function Gh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",24),r.ec("click",(function(){return r.yc(i),r.ic(2).clearProperty(1)})),r.Sb(1,"mat-icon",25),r.Wb()}if(2&e){var o=r.ic(2);r.oc("disabled",!o.currentFilter.active)}}function Bh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-form-field",39),r.ec("mouseenter",(function(){return r.yc(i),r.ic().inputClearable="selectProperty1"}))("mouseleave",(function(){return r.yc(i),r.ic().inputClearable=void 0})),r.Xb(1,"input",40),r.ec("input",(function(e){return r.yc(i),r.ic().updateValuesList(e.target.value,1)})),r.jc(2,"translate"),r.Wb(),r.Xb(3,"mat-autocomplete",19,41),r.ec("optionSelected",(function(e){return r.yc(i),r.ic().changeNumericProperty(e.option.value,1)})),r.Gc(5,Xh,2,3,"mat-option",32),r.jc(6,"async"),r.Wb(),r.Gc(7,Gh,2,1,"button",22),r.Wb()}if(2&e){var o=r.vc(4),n=r.ic();r.oc("floatLabel",n.floatLabel),r.Db(1),r.oc("placeholder",r.kc(2,7,"igo.geo.filter.placeholder"))("disabled",!n.currentFilter.active)("matAutocomplete",o)("value","lowerBoundary"===n.detectProperty(1)?n.currentFilter.lowerBoundary:n.currentFilter.begin),r.Db(4),r.oc("ngForOf",r.kc(6,9,n.filteredValues$)),r.Db(2),r.oc("ngIf",n.isClearable(1)&&"selectProperty1"===n.inputClearable&&n.currentFilter.active)}}function Vh(e,t){if(1&e&&(r.Xb(0,"mat-option",33),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i)("matTooltip",i),r.Db(1),r.Kc(" ",i," ")}}function Nh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",24),r.ec("click",(function(){return r.yc(i),r.ic(2).clearProperty(2)})),r.Sb(1,"mat-icon",25),r.Wb()}if(2&e){var o=r.ic(2);r.oc("disabled",!o.currentFilter.active)}}function zh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-form-field",39),r.ec("mouseenter",(function(){return r.yc(i),r.ic().inputClearable="selectProperty2"}))("mouseleave",(function(){return r.yc(i),r.ic().inputClearable=void 0})),r.Xb(1,"input",40),r.ec("input",(function(e){return r.yc(i),r.ic().updateValuesList(e.target.value,2)})),r.jc(2,"translate"),r.Wb(),r.Xb(3,"mat-autocomplete",19,42),r.ec("optionSelected",(function(e){return r.yc(i),r.ic().changeNumericProperty(e.option.value,2)})),r.Gc(5,Vh,2,3,"mat-option",32),r.jc(6,"async"),r.Wb(),r.Gc(7,Nh,2,1,"button",22),r.Wb()}if(2&e){var o=r.vc(4),n=r.ic();r.oc("floatLabel",n.floatLabel),r.Db(1),r.oc("placeholder",r.kc(2,7,"igo.geo.filter.placeholder"))("disabled",!n.currentFilter.active)("matAutocomplete",o)("value","upperBoundary"===n.detectProperty(2)?n.currentFilter.upperBoundary:n.currentFilter.end),r.Db(4),r.oc("ngForOf",r.kc(6,9,n.filteredValues$)),r.Db(2),r.oc("ngIf",n.isClearable(2)&&"selectProperty2"===n.inputClearable&&n.currentFilter.active)}}function qh(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-ogc-filter-time",43),r.ec("datasourceChange",(function(e){return r.yc(i),r.ic().datasource=e}))("currentFilterChange",(function(e){return r.yc(i),r.ic().currentFilter=e}))("changeProperty",(function(e){return r.yc(i),r.ic().changeProperty(e.value,e.pos)})),r.Wb()}if(2&e){var o=r.ic();r.oc("datasource",o.datasource)("currentFilter",o.currentFilter)}}var Hh=function(e,t){return{logical:e,logicalHidden:t}},Uh=function(e,t){return{operator:e,dualInput:t}},Yh=function(){return["expression","pattern"]},Kh=function(){return["lowerBoundary","begin"]},Zh=function(){return["upperBoundary","end"]};function Jh(e,t){if(1&e&&r.Sb(0,"igo-ogc-filter-toggle-button",2),2&e){var i=r.ic();r.oc("refreshFilters",i.refreshFunc)("datasource",i.datasource)("map",i.map)}}function Qh(e,t){if(1&e&&r.Sb(0,"igo-ogc-filter-form",4),2&e){var i=t.$implicit,o=r.ic(2);r.oc("currentFilter",i)("refreshFilters",o.refreshFunc)("datasource",o.datasource)("map",o.map)}}function ed(e,t){if(1&e&&r.Gc(0,Qh,1,4,"ng-template",3),2&e){var i=r.ic();r.oc("ngForOf",i.datasource.options.ogcFilters.interfaceOgcFilters)}}function td(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-icon",9),r.ec("click",(function(){return r.yc(i),r.ic().toggleFiltersCollapsed()})),r.Wb()}if(2&e){var o=r.ic(),n=r.vc(7);r.oc("target",n)("collapsed",o.filtersCollapsed)}}function id(e,t){if(1&e){var i=r.Yb();r.Xb(0,"h4",10),r.ec("click",(function(){return r.yc(i),r.ic().toggleLegendOnClick()})),r.Ic(1),r.Wb()}if(2&e){var o=r.ic();r.oc("ngStyle",r.rc(3,wh,o.filtersCollapsed?"default":"pointer"))("matTooltip",o.layer.title),r.Db(1),r.Jc(o.layer.title)}}function od(e,t){if(1&e){var i=r.Yb();r.Xb(0,"span"),r.Xb(1,"button",11),r.ec("click",(function(){return r.yc(i),r.ic().openDownload()})),r.jc(2,"translate"),r.Sb(3,"mat-icon",12),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(1),r.oc("matTooltip",r.kc(2,2,"igo.geo.download.action"))("color",o.color)}}function nd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",13),r.ec("click",(function(){return r.yc(i),r.ic().addFilterToSequence()})),r.jc(1,"translate"),r.Sb(2,"mat-icon",14),r.Wb()}if(2&e){var o=r.ic();r.oc("disabled",o.addFilterDisabled())("matTooltip",r.kc(1,3,"igo.geo.filter.addFilter"))("color",o.color)}}function rd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",15),r.ec("click",(function(){return r.yc(i),r.ic().setVisible()})),r.jc(1,"translate"),r.Sb(2,"mat-icon",16),r.Wb()}2&e&&r.oc("matTooltip",r.kc(1,1,"igo.geo.layer.showLayer"))}function ad(e,t){if(1&e&&r.Sb(0,"igo-layer-legend",20),2&e){var i=r.ic(2);r.oc("layer",i.layer)}}function sd(e,t){if(1&e&&(r.Xb(0,"div",17,18),r.Gc(2,ad,1,1,"igo-layer-legend",19),r.jc(3,"async"),r.Wb()),2&e){var i=r.ic();r.Db(2),r.oc("ngIf",r.kc(3,1,i.showLegend$))}}function cd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"section",21),r.Sb(1,"mat-divider"),r.Xb(2,"mat-checkbox",22),r.ec("change",(function(e){return r.yc(i),r.ic().changeOgcFilterType(e)}))("ngModelChange",(function(e){return r.yc(i),r.ic().datasource.options.ogcFilters.advancedOgcFilters=e})),r.Ic(3),r.jc(4,"translate"),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(2),r.oc("ngModel",o.datasource.options.ogcFilters.advancedOgcFilters),r.Db(1),r.Kc(" ",r.kc(4,2,"igo.geo.filter.advancedOgcFilters")," ")}}function ld(e,t){if(1&e&&r.Sb(0,"igo-ogc-filterable-item",2),2&e){var i=t.$implicit;r.oc("header",!0)("layer",i)("map",i.map)}}function ud(e,t){if(1&e&&(r.Xb(0,"button",2),r.jc(1,"translate"),r.Sb(2,"mat-icon",3),r.Wb()),2&e){var i=r.ic();r.oc("matTooltip",r.kc(1,3,"igo.geo.filter.filterBy"))("color",i.color),r.Db(2),r.oc("matBadge",i.badge)}}function hd(e,t){if(1&e&&r.Sb(0,"igo-ogc-filterable-item",7),2&e){var i=r.ic(2);r.oc("header",!1)("map",i.layer.map)("layer",i.layer)}}function dd(e,t){if(1&e&&(r.Xb(0,"div",4,5),r.Gc(2,hd,1,3,"igo-ogc-filterable-item",6),r.Wb()),2&e){var i=r.ic();r.Db(2),r.oc("ngIf",i.ogcFilterCollapse&&i.options.ogcFilters.enabled)}}function pd(e,t){if(1&e&&(r.Xb(0,"mat-option",7),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i),r.Db(1),r.Jc(i.title)}}function gd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",4),r.Xb(1,"mat-form-field"),r.Xb(2,"mat-select",5),r.ec("valueChange",(function(e){return r.yc(i),r.ic().currentPushButtonGroup=e})),r.jc(3,"translate"),r.Gc(4,pd,2,2,"mat-option",6),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(2),r.oc("matTooltip",r.kc(3,3,"igo.geo.layer.legend.selectStyle"))("value",o.currentPushButtonGroup),r.Db(2),r.oc("ngForOf",o.getPushButtonsGroups())}}function fd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-button-toggle",10),r.ec("change",(function(){r.yc(i);var e=t.$implicit;return r.ic(2).onButtonChange(e)})),r.Ic(1),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic(2);r.oc("ngStyle",n.getButtonColor(o))("checked",o.enabled)("matTooltip",n.getToolTip(o))("value",o),r.Db(1),r.Kc("",o.title," ")}}function md(e,t){if(1&e&&(r.Vb(0),r.Xb(1,"mat-button-toggle-group",8),r.Gc(2,fd,2,5,"mat-button-toggle",9),r.Wb(),r.Ub()),2&e){var i=t.$implicit,o=r.ic();r.Db(1),r.pc("vertical",o.bundleIsVertical(i)),r.Db(1),r.oc("ngForOf",i.buttons)}}function bd(e,t){if(1&e&&(r.Xb(0,"mat-option",10),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i),r.Db(1),r.Kc(" ",r.kc(2,2,"igo.geo.terrapi."+i)," ")}}function vd(e,t){if(1&e&&(r.Xb(0,"mat-option",6),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i),r.Db(1),r.Kc(" ",i.properties.nom," ")}}function yd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-slide-toggle",14),r.ec("change",(function(){return r.yc(i),r.ic().onDrawControlChange()})),r.Ic(1),r.jc(2,"translate"),r.Wb()}if(2&e){var o=r.ic();r.oc("checked",o.drawControlIsActive)("labelPosition","before"),r.Db(1),r.Kc(" ",r.kc(2,3,"igo.geo.spatialFilter.drawControl")," ")}}function kd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-slide-toggle",14),r.ec("change",(function(){return r.yc(i),r.ic().onfreehandControlChange()})),r.Ic(1),r.jc(2,"translate"),r.Wb()}if(2&e){var o=r.ic();r.oc("checked",o.freehandDrawIsActive)("labelPosition","before"),r.Db(1),r.Kc(" ",r.kc(2,3,"igo.geo.spatialFilter.freehandControl")," ")}}function Sd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",15),r.Xb(1,"form",16),r.Xb(2,"mat-form-field",17),r.Xb(3,"input",18),r.ec("input",(function(){return r.yc(i),r.ic().getRadius()})),r.jc(4,"translate"),r.Wb(),r.Xb(5,"label",19),r.Ic(6),r.jc(7,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(3),r.pc("placeholder",r.kc(4,5,"igo.geo.spatialFilter.radius")),r.oc("formControl",o.radiusFormControl)("value",1e3)("readonly",o.freehandDrawIsActive&&null===o.formControl.value),r.Db(3),r.Kc(" ",r.kc(7,7,"igo.geo.measure."+o.measureUnit)," ")}}function Cd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-radio-button",20),r.ec("change",(function(e){return r.yc(i),r.ic().onItemTypeChange(e)})),r.Ic(1),r.jc(2,"translate"),r.Wb()}if(2&e){var o=t.$implicit;r.oc("value",o),r.Db(1),r.Kc(" ",r.kc(2,2,"igo.geo.spatialFilter."+o)," ")}}function wd(e,t){1&e&&(r.Xb(0,"mat-header-cell",31),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e&&(r.Db(1),r.Jc(r.kc(2,1,"igo.geo.spatialFilter.Thematics")))}function xd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-header-cell",32),r.Xb(1,"mat-checkbox",33),r.ec("change",(function(e){r.yc(i);var t=r.ic(2);return e?t.masterToggle():null})),r.Wb(),r.Wb()}if(2&e){var o=r.ic(2);r.Db(1),r.oc("checked",o.isAllSelected())("indeterminate",o.selectedThematics.hasValue()&&!o.isAllSelected())}}function Od(e,t){1&e&&r.Sb(0,"mat-header-row")}function Id(e,t){1&e&&r.Sb(0,"mat-row")}function Ld(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-tree-node",34),r.Xb(1,"li",35),r.Sb(2,"button",36),r.Ic(3),r.Xb(4,"mat-checkbox",37),r.ec("click",(function(e){return r.yc(i),e.stopPropagation()}))("change",(function(e){r.yc(i);var o=t.$implicit,n=r.ic(2);return e?n.onToggleChange(o):null})),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic(2);r.Db(3),r.Kc(" ",o.name," "),r.Db(1),r.oc("checked",n.selectedThematics.isSelected(o))}}function Td(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-nested-tree-node"),r.Xb(1,"div",35),r.Xb(2,"button",38),r.ec("click",(function(){r.yc(i);var e=t.$implicit;return r.ic(2).onToggleClick(e)})),r.Sb(3,"mat-icon",39),r.Wb(),r.Ic(4),r.Xb(5,"mat-checkbox",40),r.ec("change",(function(e){r.yc(i);var o=t.$implicit,n=r.ic(2);return e?n.childrensToggle(o):null})),r.Wb(),r.Wb(),r.Xb(6,"ul",41),r.Tb(7,42),r.Wb(),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic(2);r.Db(3),r.oc("svgIcon",n.treeControl.isExpanded(o)?"chevron-down":"chevron-right"),r.Db(1),r.Kc(" ",o.name," "),r.Db(1),r.oc("checked",n.isAllSelected(o))("indeterminate",n.hasChildrenSelected(o)&&!n.isAllSelected(o)),r.Db(1),r.Ib("example-tree-invisible",!n.treeControl.isExpanded(o))}}function Fd(e,t){if(1&e&&(r.Xb(0,"div",21),r.Xb(1,"mat-table"),r.Vb(2,22),r.Gc(3,wd,3,3,"mat-header-cell",23),r.Ub(),r.Vb(4,24),r.Gc(5,xd,2,2,"mat-header-cell",25),r.Ub(),r.Gc(6,Od,1,0,"mat-header-row",26),r.Gc(7,Id,1,0,"mat-row",27),r.Wb(),r.Xb(8,"mat-tree",28),r.Gc(9,Ld,5,2,"mat-tree-node",29),r.Gc(10,Td,8,6,"mat-nested-tree-node",30),r.Wb(),r.Wb()),2&e){var i=r.ic();r.Db(6),r.oc("matHeaderRowDef",i.displayedColumns),r.Db(1),r.oc("matRowDefColumns",i.displayedColumns),r.Db(1),r.oc("dataSource",i.dataSource)("treeControl",i.treeControl),r.Db(2),r.oc("matTreeNodeDefWhen",i.hasChild)}}function _d(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",43),r.ec("click",(function(){return r.yc(i),r.ic().clearSearch()})),r.Ic(1),r.jc(2,"translate"),r.Wb()}if(2&e){var o=r.ic();r.oc("disabled",!o.queryType&&!o.zone),r.Db(1),r.Kc(" ",r.kc(2,2,"igo.geo.spatialFilter.clearSearch")," ")}}function Md(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",44),r.ec("click",(function(){return r.yc(i),r.ic().formControl.reset()})),r.Ic(1),r.jc(2,"translate"),r.Wb()}if(2&e){var o=r.ic();r.oc("disabled",null===o.formControl.value),r.Db(1),r.Kc(" ",r.kc(2,2,"igo.geo.spatialFilter.clearForm")," ")}}var Dd=["endDatepickerTime"],Pd=["beginDatepickerTime"],Ad=["beginTime"],jd=["endTime"];function Rd(e,t){if(1&e&&(r.Xb(0,"mat-option",16),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i),r.Db(1),r.Jc(i)}}function $d(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-form-field",13),r.Xb(1,"mat-label"),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Xb(4,"mat-select",14),r.ec("selectionChange",(function(){r.yc(i);var e=r.ic(),t=r.vc(5);return e.changeTemporalProperty(t.value,1)})),r.Gc(5,Rd,2,2,"mat-option",15),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(2),r.Jc(r.kc(3,4,"igo.geo.timeFilter.hour")),r.Db(2),r.oc("formControl",o.beginHourFormControl),r.Eb("disabled",!o.currentFilter.active),r.Db(1),r.oc("ngForOf",o.beginHours)}}function Ed(e,t){if(1&e&&(r.Xb(0,"mat-option",16),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i),r.Db(1),r.Jc(i)}}function Wd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-form-field",17),r.Xb(1,"mat-label"),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Xb(4,"mat-select",14),r.ec("selectionChange",(function(){r.yc(i);var e=r.ic(),t=r.vc(5);return e.changeTemporalProperty(t.value,1)})),r.Gc(5,Ed,2,2,"mat-option",15),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(2),r.Jc(r.kc(3,4,"igo.geo.timeFilter.minute")),r.Db(2),r.oc("formControl",o.beginMinuteFormControl),r.Eb("disabled",!o.currentFilter.active),r.Db(1),r.oc("ngForOf",o.beginMinutes)}}function Xd(e,t){if(1&e&&(r.Xb(0,"mat-option",16),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i),r.Db(1),r.Jc(i)}}function Gd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-form-field",13),r.Xb(1,"mat-label"),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Xb(4,"mat-select",14),r.ec("selectionChange",(function(){r.yc(i),r.ic();var e=r.vc(4);return r.ic().changeTemporalProperty(e.value,2)})),r.Gc(5,Xd,2,2,"mat-option",15),r.Wb(),r.Wb()}if(2&e){var o=r.ic(2);r.Db(2),r.Jc(r.kc(3,4,"igo.geo.timeFilter.hour")),r.Db(2),r.oc("formControl",o.endHourFormControl),r.Eb("disabled",!o.currentFilter.active),r.Db(1),r.oc("ngForOf",o.endHours)}}function Bd(e,t){if(1&e&&(r.Xb(0,"mat-option",16),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i),r.Db(1),r.Jc(i)}}function Vd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-form-field",17),r.Xb(1,"mat-label"),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Xb(4,"mat-select",14),r.ec("selectionChange",(function(){r.yc(i),r.ic();var e=r.vc(4);return r.ic().changeTemporalProperty(e.value,2)})),r.Gc(5,Bd,2,2,"mat-option",15),r.Wb(),r.Wb()}if(2&e){var o=r.ic(2);r.Db(2),r.Jc(r.kc(3,4,"igo.geo.timeFilter.minute")),r.Db(2),r.oc("formControl",o.endMinuteFormControl),r.Eb("disabled",!o.currentFilter.active),r.Db(1),r.oc("ngForOf",o.endMinutes)}}function Nd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",1),r.Xb(1,"mat-form-field",2),r.Sb(2,"mat-datepicker-toggle",3),r.Xb(3,"input",4,18),r.ec("dateChange",(function(){r.yc(i);var e=r.vc(4);return r.ic().changeTemporalProperty(e.value,2)})),r.jc(5,"translate"),r.Wb(),r.Sb(6,"span",6),r.Xb(7,"mat-datepicker",7,19),r.ec("yearSelected",(function(e){r.yc(i);var t=r.vc(8);return r.ic().yearSelected(e,t,"end")}))("monthSelected",(function(e){r.yc(i);var t=r.vc(8);return r.ic().monthSelected(e,t,"end")})),r.Wb(),r.Wb(),r.Xb(9,"div",9),r.Gc(10,Gd,6,6,"mat-form-field",10),r.Gc(11,Vd,6,6,"mat-form-field",11),r.Wb(),r.Wb()}if(2&e){var o=r.vc(8),n=r.ic();r.Db(2),r.oc("for",o),r.Db(1),r.oc("matDatepicker",o)("placeholder",r.kc(5,12,"igo.geo.timeFilter.endDate"))("matDatepickerFilter",n.dateFilter.bind(n,"end"))("value",n.endValue?n.endValue:n.handleDate(n.datasource.options.maxDate))("min",n.beginValue?n.beginValue:n.handleDate(n.datasource.options.minDate))("max",n.handleDate(n.datasource.options.maxDate)),r.Eb("disabled",!n.currentFilter.active),r.Db(4),r.oc("startView",n.calendarView())("startAt",n.endValue),r.Db(3),r.oc("ngIf","datetime"===n.calendarType()),r.Db(1),r.oc("ngIf","datetime"===n.calendarType())}}function zd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"form",6),r.Xb(1,"div",7),r.Xb(2,"mat-form-field"),r.Xb(3,"input",8),r.ec("ngModelChange",(function(e){return r.yc(i),r.ic().inputProj=e})),r.jc(4,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Xb(5,"div",9),r.Xb(6,"button",10),r.ec("click",(function(){return r.yc(i),r.vc(13).click()})),r.jc(7,"async"),r.Ic(8),r.jc(9,"translate"),r.Wb(),r.Sb(10,"igo-spinner",11),r.jc(11,"async"),r.Xb(12,"input",12,13),r.ec("click",(function(){return r.yc(i),r.vc(13).value=null}))("change",(function(e){return r.yc(i),r.ic().importFiles(e.target.files)})),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(3),r.pc("placeholder",r.kc(4,7,"igo.geo.importExportForm.importProjPlaceholder")),r.oc("ngModel",o.inputProj),r.Db(3),r.oc("disabled",r.kc(7,9,o.loading$)),r.Db(2),r.Kc(" ",r.kc(9,11,"igo.geo.importExportForm.importButton")," "),r.Db(2),r.oc("shown",r.kc(11,13,o.loading$)),r.Db(2),r.Fc("display","none")}}var qd=function(e){return{size:e}};function Hd(e,t){if(1&e&&(r.Xb(0,"section",14),r.Xb(1,"h4"),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Xb(4,"ul"),r.Xb(5,"li"),r.Ic(6),r.jc(7,"translate"),r.Wb(),r.Xb(8,"li"),r.Ic(9),r.jc(10,"translate"),r.Wb(),r.Xb(11,"li"),r.Ic(12),r.jc(13,"translate"),r.Wb(),r.Wb(),r.Wb()),2&e){var i=r.ic();r.Db(2),r.Jc(r.kc(3,4,"igo.geo.importExportForm.importClarifications")),r.Db(4),r.Jc(r.lc(7,6,"igo.geo.importExportForm.importSizeMax",r.rc(13,qd,i.fileSizeMb))),r.Db(3),r.Jc(r.kc(10,9,"igo.geo.importExportForm.importFormatAuthorized")),r.Db(3),r.Jc(r.kc(13,11,"igo.geo.importExportForm.importShpZip"))}}function Ud(e,t){1&e&&(r.Xb(0,"section",14),r.Xb(1,"h4"),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Wb()),2&e&&(r.Db(2),r.Jc(r.kc(3,1,"igo.geo.importExportForm.exportNoLayersExportable")))}function Yd(e,t){if(1&e&&(r.Xb(0,"span",24),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e){var i=r.ic(2);r.Db(1),r.Lc(" (+",i.layers.length-1," ",r.kc(2,2,2===(null==i.layers?null:i.layers.length)?"igo.geo.importExportForm.other":"igo.geo.importExportForm.others"),") ")}}function Kd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-slide-toggle",28),r.ec("click",(function(e){r.yc(i);var t=r.ic().$implicit;return r.ic(2).onlySelectedClick(e,t.id)}))("checked",(function(){r.yc(i);var e=r.ic().$implicit;return r.ic(2).inLayersIdToExportSelectionOnly(e)}))("change",(function(e){r.yc(i);var t=r.ic().$implicit;return r.ic(2).onlySelected(e,t.id)})),r.Xb(1,"small"),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Wb()}2&e&&(r.oc("labelPosition","after"),r.Db(2),r.Jc(r.kc(3,2,"igo.geo.importExportForm.exportSelectedFeature")))}var Zd=function(e){return{"igo-export-layer-mat-option":e}};function Jd(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-option",25),r.ec("click",(function(e){return r.yc(i),e.stopPropagation()})),r.Xb(1,"p",26),r.Ic(2),r.Wb(),r.Xb(3,"p",26),r.Gc(4,Kd,4,4,"mat-slide-toggle",27),r.Wb(),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic(2);r.oc("ngClass",r.rc(4,Zd,n.layerHasSelectedFeatures(o)))("value",o.id),r.Db(2),r.Jc(o.title),r.Db(2),r.oc("ngIf",n.layerHasSelectedFeatures(o))}}function Qd(e,t){if(1&e&&(r.Xb(0,"mat-option",2),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i.key),r.Db(1),r.Kc(" ",r.kc(2,2,"igo.geo.export.format."+i.value)," ")}}function ep(e,t){if(1&e&&(r.Vb(0),r.Gc(1,Qd,3,4,"mat-option",29),r.jc(2,"keyvalue"),r.jc(3,"async"),r.Ub()),2&e){var i=r.ic(2);r.Db(1),r.oc("ngForOf",r.kc(2,1,r.kc(3,3,i.formats$)))}}function tp(e,t){1&e&&(r.Xb(0,"mat-option",30),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e&&(r.Db(1),r.Kc(" ",r.kc(2,1,"igo.geo.export.noFormat.title")," "))}function ip(e,t){1&e&&(r.Xb(0,"div",7),r.Xb(1,"mat-form-field"),r.Sb(2,"input",31),r.jc(3,"translate"),r.Wb(),r.Wb()),2&e&&(r.Db(2),r.pc("placeholder",r.kc(3,1,"igo.geo.importExportForm.exportFileNamePlaceholder")))}function op(e,t){if(1&e&&(r.Xb(0,"mat-option",2),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i.key),r.Db(1),r.Kc(" ",r.kc(2,2,"igo.geo.export.encoding."+i.value)," ")}}function np(e,t){if(1&e&&(r.Vb(0),r.Gc(1,op,3,4,"mat-option",29),r.jc(2,"keyvalue"),r.jc(3,"async"),r.Ub()),2&e){var i=r.ic(3);r.Db(1),r.oc("ngForOf",r.kc(2,1,r.kc(3,3,i.encodings$)))}}function rp(e,t){if(1&e&&(r.Xb(0,"div",7),r.Xb(1,"mat-form-field"),r.Xb(2,"mat-label"),r.Ic(3),r.jc(4,"translate"),r.Wb(),r.Xb(5,"mat-select",32),r.Gc(6,np,4,5,"ng-container",20),r.jc(7,"async"),r.Wb(),r.Wb(),r.Wb()),2&e){var i=r.ic(2);r.Db(3),r.Jc(r.kc(4,2,"igo.geo.importExportForm.encodingPlaceholder")),r.Db(3),r.oc("ngIf",0!==r.kc(7,4,i.encodings$).length)}}function ap(e,t){1&e&&(r.Xb(0,"div",33),r.Xb(1,"mat-slide-toggle",34),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Wb()),2&e&&(r.Db(1),r.oc("labelPosition","before"),r.Db(1),r.Kc(" ",r.kc(3,2,"igo.geo.importExportForm.exportFeatureInExtent")," "))}function sp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"form",15),r.Xb(1,"div",7),r.Xb(2,"mat-form-field"),r.Xb(3,"mat-label"),r.Ic(4),r.jc(5,"translate"),r.Wb(),r.Xb(6,"mat-select",16),r.ec("valueChange",(function(e){return r.yc(i),r.ic().layers=e})),r.Xb(7,"mat-select-trigger"),r.Ic(8),r.Gc(9,Yd,3,4,"span",17),r.Wb(),r.Gc(10,Jd,5,6,"mat-option",18),r.jc(11,"async"),r.Wb(),r.Wb(),r.Wb(),r.Xb(12,"div",7),r.Xb(13,"mat-form-field"),r.Xb(14,"mat-label"),r.Ic(15),r.jc(16,"translate"),r.Wb(),r.Xb(17,"mat-select",19),r.Gc(18,ep,4,5,"ng-container",20),r.jc(19,"async"),r.Gc(20,tp,3,3,"mat-option",21),r.jc(21,"async"),r.Wb(),r.Wb(),r.Wb(),r.Gc(22,ip,4,3,"div",22),r.Gc(23,rp,8,6,"div",22),r.Gc(24,ap,4,4,"div",23),r.Xb(25,"div",9),r.Xb(26,"button",10),r.ec("click",(function(){r.yc(i);var e=r.ic();return e.handleExportFormSubmit(e.form.value)})),r.jc(27,"async"),r.Ic(28),r.jc(29,"translate"),r.jc(30,"translate"),r.jc(31,"translate"),r.Wb(),r.Sb(32,"igo-spinner",11),r.jc(33,"async"),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.oc("formGroup",o.form),r.Db(4),r.Jc(r.kc(5,15,"igo.geo.importExportForm.exportLayerPlaceholder")),r.Db(2),r.oc("value",o.layers),r.Db(2),r.Kc(" ",o.layers.length?o.getLayerTitleById(o.layers[0]):""," "),r.Db(1),r.oc("ngIf",o.layers.length>1),r.Db(1),r.oc("ngForOf",r.kc(11,17,o.exportableLayers$)),r.Db(5),r.Jc(r.kc(16,19,"igo.geo.importExportForm.exportFormatPlaceholder")),r.Db(3),r.oc("ngIf",0!==r.kc(19,21,o.formats$).length),r.Db(2),r.oc("ngIf",0===r.kc(21,23,o.formats$).length),r.Db(2),r.oc("ngIf",o.forceNaming&&"URL"!==o.form.value.format),r.Db(1),r.oc("ngIf","CSVcomma"===o.form.value.format||"CSVsemicolon"===o.form.value.format),r.Db(1),r.oc("ngIf","URL"!==o.form.value.format),r.Db(2),r.oc("disabled",!o.form.valid||r.kc(27,25,o.loading$)),r.Db(2),r.Kc(" ","URL"!==o.form.value.format?r.kc(29,27,"igo.geo.importExportForm.exportButton"):o.form.value.layers.length>1?r.kc(30,29,"igo.geo.importExportForm.exportButtonLinks"):r.kc(31,31,"igo.geo.importExportForm.exportButtonLink")," "),r.Db(4),r.oc("shown",r.kc(33,33,o.loading$))}}function cp(e,t){if(1&e&&(r.Xb(0,"mat-option",5),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i),r.Db(1),r.Kc(" ",r.kc(2,2,"igo.geo.measure."+i)," ")}}function lp(e,t){if(1&e&&(r.Xb(0,"mat-option",18),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i.key),r.Db(1),r.Kc(" ",i.value," ")}}function up(e,t){if(1&e&&(r.Xb(0,"mat-option",18),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i.key),r.Db(1),r.Kc(" ",r.kc(2,2,"igo.geo.printForm.paperFormats."+i.value)," ")}}function hp(e,t){if(1&e&&(r.Xb(0,"mat-option",18),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i.key),r.Db(1),r.Kc(" ",i.value," ")}}function dp(e,t){if(1&e&&(r.Xb(0,"mat-option",18),r.Ic(1),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i.key),r.Db(1),r.Kc(" ",i.value+" PPI"," ")}}function pp(e,t){if(1&e&&(r.Xb(0,"mat-option",18),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e){var i=t.$implicit;r.oc("value",i.key),r.Db(1),r.Kc(" ",r.kc(2,2,"igo.geo.printForm."+i.value)," ")}}function gp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",17),r.ec("click",(function(){r.yc(i);var e=r.ic().index;return r.ic().geolocateStop(e)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",18),r.Wb()}2&e&&r.oc("matTooltip",r.kc(1,1,"igo.geo.directionsForm.geolocate"))}function fp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",19),r.ec("click",(function(){r.yc(i);var e=r.ic().index;return r.ic().clearStop(e)})),r.Sb(1,"mat-icon",20),r.Wb()}}function mp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-option",23),r.ec("onSelectionChange",(function(){r.yc(i);var e=t.$implicit,o=r.ic(2).index;return r.ic().chooseProposal(e,o)})),r.Ic(1),r.Wb()}if(2&e){var o=t.$implicit;r.oc("value",o.meta?o.meta.title:"")("matTooltip",o.meta?o.meta.title:""),r.Db(1),r.Kc(" ",o.meta?o.meta.title:""," ")}}function bp(e,t){if(1&e&&(r.Xb(0,"mat-optgroup",21),r.Gc(1,mp,2,3,"mat-option",22),r.Wb()),2&e){var i=t.$implicit;r.oc("label",i.source.title)("disabled",!1===i.source.enabled),r.Db(1),r.oc("ngForOf",i.results)}}function vp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",24),r.ec("click",(function(){r.yc(i);var e=r.ic().index;return r.ic().removeStop(e)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",25),r.Wb()}2&e&&r.oc("matTooltip",r.kc(1,1,"igo.geo.directionsForm.removeStop"))}function yp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",8,9),r.Xb(2,"mat-list-item",10),r.Xb(3,"div",11),r.Gc(4,gp,3,3,"button",12),r.Xb(5,"mat-form-field"),r.Xb(6,"input",13),r.ec("focus",(function(){r.yc(i);var e=t.index;return r.ic().focus(e)}))("keyup",(function(e){r.yc(i);var o=t.index;return r.ic().keyup(o,e)}))("keydown.enter",(function(e){return r.yc(i),r.ic().prevent(e)})),r.jc(7,"translate"),r.Wb(),r.Gc(8,fp,2,0,"button",14),r.Xb(9,"mat-autocomplete",null,15),r.Gc(11,bp,2,3,"mat-optgroup",16),r.Wb(),r.Wb(),r.Gc(12,vp,3,3,"button",6),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=t.$implicit,n=t.index,a=r.vc(10),s=r.ic();r.Db(2),r.oc("formGroupName",n),r.Db(2),r.oc("ngIf",s.map.geolocationFeature),r.Db(2),r.pc("placeholder",r.kc(7,7,"igo.geo.directionsForm."+o.value.directionsText)),r.oc("matAutocomplete",a),r.Db(2),r.oc("ngIf",o.value&&(o.value.stopPoint.length>0||o.value.stopProposals.length>0)),r.Db(3),r.oc("ngForOf",o.value.stopProposals),r.Db(1),r.oc("ngIf",0!==n&&n!==s.stops.length-1)}}function kp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",3),r.ec("click",(function(){return r.yc(i),r.ic().zoomRoute()})),r.jc(1,"translate"),r.Sb(2,"mat-icon",26),r.Wb()}2&e&&r.oc("matTooltip",r.kc(1,1,"igo.geo.directionsForm.zoomRoute"))}function Sp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",24),r.ec("click",(function(){return r.yc(i),r.ic().resetForm(!0)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",27),r.Wb()}2&e&&r.oc("matTooltip",r.kc(1,1,"igo.geo.directionsForm.resetDirectionsBtn"))}function Cp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",3),r.ec("click",(function(){return r.yc(i),r.ic().copyDirectionsToClipboard()})),r.jc(1,"translate"),r.Sb(2,"mat-icon",28),r.Wb()}2&e&&r.oc("matTooltip",r.kc(1,1,"igo.geo.directionsForm.copy"))}function wp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",3),r.ec("click",(function(){return r.yc(i),r.ic().copyLinkToClipboard()})),r.jc(1,"translate"),r.Sb(2,"mat-icon",29),r.Wb()}2&e&&r.oc("matTooltip",r.kc(1,1,"igo.geo.directionsForm.link"))}function xp(e,t){if(1&e&&(r.Xb(0,"mat-option",36),r.Ic(1),r.Wb()),2&e){var i=t.$implicit,o=t.index,n=r.ic(3);r.oc("value",i),r.Db(1),r.Mc(" Option ",o+1," : ",n.formatDistance(i.distance)," (",n.formatDuration(i.duration),") ")}}function Op(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-form-field"),r.Xb(1,"mat-select",34),r.ec("selectionChange",(function(){return r.yc(i),r.ic(2).changeRoute()}))("ngModelChange",(function(e){return r.yc(i),r.ic(2).activeRoute=e})),r.jc(2,"translate"),r.Gc(3,xp,2,4,"mat-option",35),r.Wb(),r.Wb()}if(2&e){var o=r.ic(2);r.Db(1),r.pc("placeholder",r.kc(2,3,"igo.geo.directionsForm.drivingOptions")),r.oc("ngModel",o.activeRoute),r.Db(2),r.oc("ngForOf",o.routesResults)}}function Ip(e,t){1&e&&r.Sb(0,"mat-divider")}function Lp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-list-item",37),r.ec("mouseenter",(function(){r.yc(i);var e=t.$implicit;return r.ic(2).showSegment(e)}))("click",(function(){r.yc(i);var e=t.$implicit;return r.ic(2).showSegment(e,!0)})),r.Sb(1,"mat-icon",38),r.Xb(2,"h4",39),r.Ic(3),r.Wb(),r.Xb(4,"h4",40),r.Ic(5),r.Wb(),r.Wb()}if(2&e){var o=t.$implicit,n=t.index,a=r.ic(2);r.Db(1),r.pc("svgIcon",a.formatStep(o,n).image),r.oc("ngClass",a.formatStep(o,n).cssClass),r.Db(2),r.Lc("",n+1,". ",a.formatStep(o,n).instruction,""),r.Db(2),r.Jc(a.formatDistance(o.distance))}}function Tp(e,t){if(1&e&&(r.Xb(0,"div",11),r.Gc(1,Op,4,5,"mat-form-field",30),r.Gc(2,Ip,1,0,"mat-divider",30),r.Xb(3,"mat-list"),r.Xb(4,"h2",31),r.Ic(5),r.Wb(),r.Xb(6,"h2",32),r.Ic(7),r.Wb(),r.Gc(8,Lp,6,5,"mat-list-item",33),r.Sb(9,"mat-divider"),r.Wb(),r.Wb()),2&e){var i=r.ic();r.Db(1),r.oc("ngIf",i.routesResults&&i.routesResults.length>1),r.Db(1),r.oc("ngIf",i.routesResults&&0===i.routesResults.length),r.Db(3),r.Jc(i.activeRoute.title),r.Db(2),r.Lc("",i.formatDistance(i.activeRoute.distance),", ",i.formatDuration(i.activeRoute.duration),""),r.Db(1),r.oc("ngForOf",i.activeRoute.steps)}}function Fp(e,t){if(1&e&&(r.Xb(0,"mat-radio-button",7),r.Ic(1),r.jc(2,"translate"),r.Wb()),2&e){var i=t.$implicit,o=r.ic();r.oc("value",i),r.Db(1),r.Kc(" ",r.kc(2,2,o.getSearchTypeTitle(i))," ")}}function _p(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",8),r.Xb(1,"button",9),r.ec("click",(function(e){return r.yc(i),r.ic().checkUncheckAllSources(e)})),r.Ic(2),r.jc(3,"translate"),r.jc(4,"translate"),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(2),r.Jc(o.searchSourcesAllEnabled?r.kc(4,3,"igo.geo.search.searchSources.selectAll"):r.kc(3,1,"igo.geo.search.searchSources.unselectAll"))}}function Mp(e,t){if(1&e&&(r.Xb(0,"button",15),r.Ic(1),r.Wb()),2&e){var i=r.ic().$implicit,o=r.vc(6);r.oc("matMenuTriggerFor",o),r.Db(1),r.Kc("",i.title," ")}}function Dp(e,t){if(1&e&&(r.Xb(0,"button",16),r.Ic(1),r.Wb()),2&e){var i=r.ic().$implicit;r.Db(1),r.Kc(" ",i.title," ")}}function Pp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-radio-button",22),r.ec("click",(function(e){return r.yc(i),e.stopPropagation()}))("change",(function(e){r.yc(i);var o=t.$implicit,n=r.ic(2).$implicit,a=r.ic().$implicit;return r.ic().settingsValueCheckedRadioButton(e,a,n,o)})),r.Ic(1),r.jc(2,"translate"),r.Wb()}if(2&e){var o=t.$implicit;r.oc("value",o)("checked",o.enabled),r.Db(1),r.Kc(" ",r.kc(2,3,o.title)," ")}}function Ap(e,t){if(1&e&&(r.Xb(0,"span"),r.Xb(1,"mat-radio-group",20),r.Gc(2,Pp,3,5,"mat-radio-button",21),r.Wb(),r.Wb()),2&e){var i=r.ic().$implicit;r.Db(1),r.oc("value",i),r.Db(1),r.oc("ngForOf",i.values)}}function jp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",8),r.Xb(1,"button",9),r.ec("click",(function(e){r.yc(i);var t=r.ic(2).$implicit,o=r.ic().$implicit;return r.ic().checkUncheckAll(e,o,t)})),r.Ic(2),r.jc(3,"translate"),r.jc(4,"translate"),r.Wb(),r.Wb()}if(2&e){var o=r.ic(2).$implicit;r.Db(2),r.Jc(o.allEnabled||void 0===o.allEnabled?r.kc(3,1,"igo.geo.search.searchSources.settings.unselectAll"):r.kc(4,3,"igo.geo.search.searchSources.settings.selectAll"))}}function Rp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-checkbox",24),r.ec("click",(function(e){return r.yc(i),e.stopPropagation()}))("change",(function(e){r.yc(i);var o=t.$implicit,n=r.ic(2).$implicit,a=r.ic().$implicit;return r.ic().settingsValueCheckedCheckbox(e,a,n,o)})),r.Ic(1),r.jc(2,"translate"),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic(2).$implicit,a=r.ic(2);r.oc("checked",o.enabled)("value",n)("matTooltip",a.getAvailableHashtagsValues(o)),r.Db(1),r.Kc(" ",r.kc(2,4,o.title)," ")}}function $p(e,t){if(1&e&&(r.Xb(0,"span"),r.Gc(1,jp,5,5,"div",5),r.Gc(2,Rp,3,6,"mat-checkbox",23),r.Wb()),2&e){var i=r.ic().$implicit,o=r.ic(2);r.Db(1),r.oc("ngIf",i.values.length>3),r.Db(1),r.oc("ngForOf",o.getAvailableValues(i))}}function Ep(e,t){if(1&e&&(r.Vb(0),r.Xb(1,"button",15),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Xb(4,"mat-menu",17,18),r.Gc(6,Ap,3,2,"span",19),r.Gc(7,$p,3,2,"span",19),r.Wb(),r.Ub()),2&e){var i=t.$implicit,o=r.vc(5);r.Db(1),r.oc("matMenuTriggerFor",o),r.Db(1),r.Kc(" ",r.kc(3,5,"igo.geo.search.searchSources.settings."+i.title)," "),r.Db(2),r.oc("ngSwitch",i.type),r.Db(2),r.oc("ngSwitchCase","radiobutton"),r.Db(1),r.oc("ngSwitchCase","checkbox")}}function Wp(e,t){if(1&e){var i=r.Yb();r.Vb(0),r.Xb(1,"span",10),r.Xb(2,"mat-checkbox",11),r.ec("click",(function(e){return r.yc(i),e.stopPropagation()}))("change",(function(e){r.yc(i);var o=t.$implicit;return r.ic().onCheckSearchSource(e,o)})),r.Wb(),r.Gc(3,Mp,2,2,"button",12),r.Gc(4,Dp,2,1,"button",13),r.Wb(),r.Xb(5,"mat-menu",null,14),r.Gc(7,Ep,8,7,"ng-container",6),r.Wb(),r.Ub()}if(2&e){var o=t.$implicit;r.Db(2),r.oc("checked",o.enabled)("value",o),r.Db(1),r.oc("ngIf",o.settings.length>0),r.Db(1),r.oc("ngIf",0===o.settings.length),r.Db(3),r.oc("ngForOf",o.settings)}}function Xp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"span"),r.Sb(1,"mat-divider"),r.Xb(2,"span",25),r.Xb(3,"mat-slide-toggle",26),r.ec("change",(function(e){return r.yc(i),r.ic().changePointerReverseSearch(e)}))("click",(function(e){return r.yc(i),e.stopPropagation()})),r.jc(4,"translate"),r.Ic(5),r.jc(6,"translate"),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=r.ic();r.Db(3),r.oc("matTooltip",r.kc(4,4,"igo.geo.search.pointerSearchSummary.tooltip"))("checked",o.pointerSummaryEnabled)("labelPosition","after"),r.Db(2),r.Kc(" ",r.kc(6,6,"igo.geo.search.pointerSearchSummary.title")," ")}}var Gp=["input"];function Bp(e,t){if(1&e&&(r.Xb(0,"mat-label"),r.Ic(1),r.Wb()),2&e){var i=r.ic();r.Db(1),r.Jc(i.label)}}function Vp(e,t){if(1&e&&(r.Xb(0,"button",10),r.Sb(1,"mat-icon",11),r.Wb()),2&e){var i=r.ic();r.oc("color",i.color),r.Db(1),r.pc("svgIcon",i.searchIcon)}}function Np(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",12),r.ec("click",(function(){return r.yc(i),r.ic().onClearButtonClick()})),r.Sb(1,"mat-icon",13),r.Wb()}if(2&e){var o=r.ic();r.oc("color",o.color)}}function zp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-search-selector",14),r.ec("searchTypeChange",(function(e){return r.yc(i),r.ic().onSearchTypeChange(e)})),r.jc(1,"async"),r.Wb()}if(2&e){var o=r.ic();r.oc("searchTypes",o.searchTypes)("searchType",r.kc(1,2,o.searchType$))}}function qp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-search-settings",15),r.ec("pointerSummaryStatus",(function(e){return r.yc(i),r.ic().pointerSummaryStatus.emit(e)}))("searchSourceChange",(function(){return r.yc(i),r.ic().onSearchSettingsChange()})),r.Wb()}if(2&e){var o=r.ic();r.oc("pointerSummaryEnabled",o.pointerSummaryEnabled)}}var Hp=function(e){return{empty:e}},Up=function(e){return{hasSearchIcon:e}},Yp=["igoSearchItemToolbar"];function Kp(e,t){1&e&&r.Tb(0)}var Zp=function(e){return{results:e}};function Jp(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-collapsible",6),r.ec("toggle",(function(e){r.yc(i);var t=r.ic().$implicit;return r.ic().collapsed[t.source.title]=e})),r.Gc(1,Kp,1,0,"ng-container",7),r.Wb()}if(2&e){var o=r.ic().$implicit,n=r.vc(4),a=r.ic();r.Fb(o.source.getId()),r.oc("title",a.computeGroupTitle(o))("collapsed",a.collapsed[o.source.title]),r.Db(1),r.oc("ngTemplateOutlet",n)("ngTemplateOutletContext",r.rc(6,Zp,o.results))}}function Qp(e,t){1&e&&r.Tb(0)}function eg(e,t){if(1&e&&r.Gc(0,Qp,1,0,"ng-container",7),2&e){var i=r.ic().$implicit,o=r.vc(4);r.oc("ngTemplateOutlet",o)("ngTemplateOutletContext",r.rc(2,Zp,i.results))}}var tg=function(e){return{result:e}};function ig(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-search-results-item",9),r.ec("focus",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).resultFocus.emit(e)}))("unfocus",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).resultUnfocus.emit(e)}))("select",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).onResultSelect(e)}))("mouseenter",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).resultFocus.emit(e)}))("mouseleave",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).resultUnfocus.emit(e)})),r.Tb(1,10),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic(3);r.oc("map",n.map)("result",o)("showIcons",n.showIcons)("withZoomButton",n.withZoomButton)("focused",n.store.state.get(o).focused)("selected",n.store.state.get(o).selected),r.Db(1),r.oc("ngTemplateOutlet",n.templateSearchToolbar)("ngTemplateOutletContext",r.rc(8,tg,o))}}function og(e,t){if(1&e){var i=r.Yb();r.Xb(0,"span",11),r.ec("click",(function(){r.yc(i);var e=r.ic(2).$implicit;return r.ic().displayMoreResults(e)})),r.Xb(1,"u"),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Wb()}2&e&&(r.Db(2),r.Jc(r.kc(3,1,"igo.geo.search.displayMoreResults")))}function ng(e,t){if(1&e&&(r.Gc(0,ig,2,10,"ng-template",1),r.Gc(1,og,4,3,"span",8)),2&e){var i=t.results,o=r.ic().$implicit,n=r.ic();r.oc("ngForOf",i),r.Db(1),r.oc("ngIf",n.isMoreResults(o))}}function rg(e,t){if(1&e&&(r.Gc(0,Jp,2,8,"igo-collapsible",3),r.Gc(1,eg,1,4,"ng-template",null,4,r.Hc),r.Gc(3,ng,2,2,"ng-template",null,5,r.Hc)),2&e){var i=r.vc(2),o=r.ic();r.oc("ngIf",o.mode===o.searchResultMode.Grouped)("ngIfElse",i)}}function ag(e,t){if(1&e&&r.Sb(0,"mat-icon",4),2&e){var i=r.ic();r.pc("svgIcon",i.showIcons?i.icon:"blank")}}function sg(e,t){if(1&e&&r.Sb(0,"h4",5),2&e){var i=r.ic();r.oc("innerHtml",i.titleHtml,r.zc)("matTooltip",i.tooltipHtml)}}function cg(e,t){if(1&e&&(r.Xb(0,"h4",6),r.Ic(1),r.Wb()),2&e){var i=r.ic();r.oc("matTooltip",i.title),r.Db(1),r.Jc(i.title)}}function lg(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",7),r.ec("click",(function(){return r.yc(i),r.ic().onZoomHandler()})),r.Sb(1,"mat-icon",8),r.Wb()}}var ug=[[["","igoSearchItemToolbar",""]]],hg=["[igoSearchItemToolbar]"];function dg(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",1),r.ec("mouseenter",(function(e){return r.yc(i),r.ic().onMouseEvent(e)}))("mouseleave",(function(e){return r.yc(i),r.ic().onMouseEvent(e)}))("click",(function(e){return r.yc(i),r.ic().onToggleClick(e)})),r.jc(1,"translate"),r.jc(2,"async"),r.jc(3,"async"),r.Sb(4,"mat-icon",2),r.jc(5,"async"),r.jc(6,"async"),r.Wb()}if(2&e){var o=r.ic();r.oc("matTooltip",r.kc(1,4,r.kc(2,6,o.tooltip$)))("color",r.kc(3,8,o.isPreview$)?"":o.added?"warn":""),r.Db(4),r.oc("matBadgeHidden",r.kc(5,10,o.inRange$))("svgIcon",r.kc(6,12,o.isPreview$)?"plus":o.added?"delete":"plus")}}function pg(e,t,i,o){var n=e+(t=t||0)/60+(i=i||0)/3600;return"S"!==o&&"W"!==o||(n=-n),n}function gg(e){return(e=Math.round(e))<1e4?e+"":(e=Math.round(e/1e3))<1e3?e+"K":(e=Math.round(e/1e3))+"M"}function fg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:96;return e/(39.3701*t)}function mg(e){var t=e.originalEvent;return!t.altKey&&(Sc.d?t.metaKey:t.ctrlKey)&&!t.shiftKey}function bg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return[e[0].toFixed(t),e[1].toFixed(t)]}var vg,yg,kg,Sg=function(){function e(t,i){_classCallCheck(this,e),this.options=t,this.authInterceptor=i,this.legendCollapsed=!0,this.firstLoadComponent=!0,this.isInResolutionsRange$=new L.a(!1),this.visible$=new L.a(void 0),this.displayed$=Object(_.a)([this.isInResolutionsRange$,this.visible$]).pipe(Object(w.a)((function(e){return e[0]&&e[1]}))),this.dataSource=t.source,this.ol=this.createOlLayer(),void 0!==t.zIndex&&(this.zIndex=t.zIndex),t.baseLayer&&void 0===t.visible&&(t.visible=!1),this.maxResolution=t.maxResolution||fg(Number(t.maxScaleDenom)),this.minResolution=t.minResolution||fg(Number(t.minScaleDenom)),this.visible=void 0===t.visible||t.visible,this.opacity=void 0===t.opacity?1:t.opacity,t.legendOptions&&(t.legendOptions.url||t.legendOptions.html)&&(this.legend=this.dataSource.setLegend(t.legendOptions)),this.legendCollapsed=!t.legendOptions||!t.legendOptions.collapsed||t.legendOptions.collapsed,this.ol.set("_layer",this,!0)}return _createClass(e,[{key:"setMap",value:function(e){this.map=e,this.unobserveResolution(),void 0!==e&&this.observeResolution()}},{key:"observeResolution",value:function(){var e=this;this.resolution$$=this.map.viewController.resolution$.subscribe((function(){return e.updateInResolutionsRange()}))}},{key:"unobserveResolution",value:function(){void 0!==this.resolution$$&&(this.resolution$$.unsubscribe(),this.resolution$$=void 0)}},{key:"updateInResolutionsRange",value:function(){if(void 0!==this.map){var e=this.map.viewController.getResolution(),t=void 0===this.maxResolution?1/0:this.maxResolution;this.isInResolutionsRange=e>=this.minResolution&&e<=t}else this.isInResolutionsRange=!1}},{key:"id",get:function(){return this.options.id||this.dataSource.id}},{key:"alias",get:function(){return this.options.alias}},{key:"title",get:function(){return this.options.title},set:function(e){this.options.title=e}},{key:"zIndex",get:function(){return this.ol.getZIndex()},set:function(e){this.ol.setZIndex(e)}},{key:"baseLayer",get:function(){return this.options.baseLayer},set:function(e){this.options.baseLayer=e}},{key:"opacity",get:function(){return this.ol.get("opacity")},set:function(e){this.ol.setOpacity(e)}},{key:"isInResolutionsRange",set:function(e){this.isInResolutionsRange$.next(e)},get:function(){return this.isInResolutionsRange$.value}},{key:"maxResolution",set:function(e){this.ol.setMaxResolution(e||1/0),this.updateInResolutionsRange()},get:function(){return this.ol.getMaxResolution()}},{key:"minResolution",set:function(e){this.ol.setMinResolution(e||0),this.updateInResolutionsRange()},get:function(){return this.ol.getMinResolution()}},{key:"visible",set:function(e){this.ol.setVisible(e),this.visible$.next(e)},get:function(){return this.visible$.value}},{key:"displayed",get:function(){return this.visible&&this.isInResolutionsRange}},{key:"showInLayerList",get:function(){return!1!==this.options.showInLayerList}}]),e}(),Cg=((kg=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"open",value:function(e){e.extern&&window.open(e.url,"_blank")}}]),e}()).\u0275fac=function(e){return new(e||kg)},kg.\u0275prov=Object(r.Nb)({factory:function(){return new kg},token:kg,providedIn:"root"}),kg),wg=((yg=function(){function e(t){_classCallCheck(this,e),this.metadataService=t,this._color="primary"}return _createClass(e,[{key:"openMetadata",value:function(e){this.metadataService.open(e)}},{key:"layer",get:function(){return this._layer},set:function(e){this._layer=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"options",get:function(){if(this.layer)return this.layer.options}}]),e}()).\u0275fac=function(e){return new(e||yg)(r.Rb(Cg))},yg.\u0275cmp=r.Lb({type:yg,selectors:[["igo-metadata-button"]],inputs:{layer:"layer",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","information-outline"]],template:function(e,t){1&e&&r.Gc(0,zl,3,4,"button",0),2&e&&r.oc("ngIf",t.options&&t.options.metadata&&t.options.metadata.url)},directives:[m.l,l.a,g.a,u.a],pipes:[U.d],styles:[""],changeDetection:0}),yg),xg=((vg=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}()).\u0275mod=r.Pb({type:vg}),vg.\u0275inj=r.Ob({factory:function(e){return new(e||vg)},imports:[[m.c,u.b,l.b,g.b,Ce]]}),vg);function Og(e){return({wms:Ig,wmts:Lg,xyz:Tg,feature:Fg,arcgisrest:_g,osm:function(e){return"OSM"}}[e.type]||Mg)(e)}function Ig(e){var t=e.params.LAYERS,i="/"===e.url.charAt(0)?window.location.origin+e.url:e.url;return Os.Md5.hashStr("wms"+i+t)}function Lg(e){return Os.Md5.hashStr("wmts"+e.url+e.layer)}function Tg(e){return Os.Md5.hashStr("xyz"+e.url)}function Fg(e){return e.url?Os.Md5.hashStr("feature"+e.url):Mg()}function _g(e){var t=e.layer,i="/"===e.url.charAt(0)?window.location.origin+e.url:e.url;return Os.Md5.hashStr("arcgis"+i+t)}function Mg(e){return G()}var Dg=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;_classCallCheck(this,e),this.options=t,this.dataService=i,this.options=t,this.id=this.options.id||this.generateId(),this.ol=this.createOlSource()}return _createClass(e,[{key:"generateId",value:function(){return Og(this.options)}},{key:"getLegend",value:function(e,t){return this.legend?this.legend:[]}},{key:"setLegend",value:function(e){return this.legend=e.url?[{url:e.url}]:e.html?[{html:e.html}]:[],this.legend}}]),e}(),Pg=function(e){_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"createOlSource",value:function(){var e={format:this.getSourceFormatFromOptions(this.options)};return new wc.a(Object.assign(e,this.options))}},{key:"getSourceFormatFromOptions",value:function(e){if(e.format)return e.format;var t,i=e.formatType;if(i){if(void 0===(t=xc[i]))throw new Error("Invalid vector source format ${formatType}.")}else t=xc.GeoJSON;var o=e.formatOptions;return o?new t(o):new t}},{key:"onUnwatch",value:function(){}},{key:"queryTitle",get:function(){return this.options.queryTitle?this.options.queryTitle:"title"}}]),i}(Dg),Ag=function(e){_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"createOlSource",value:function(){return this.options.url="https://tile.openstreetmap.org/{z}/{x}/{y}.png",new Oc.a(this.options)}},{key:"onUnwatch",value:function(){}}]),i}(Dg),jg=function(e){_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"createOlSource",value:function(){return new Ic.a(this.options)}},{key:"onUnwatch",value:function(){}}]),i}(Dg),Rg=function(e){return e.BasicNumericOperator="basicnumericoperator",e.Basic="basic",e.BasicAndSpatial="basicandspatial",e.Spatial="spatial",e.All="all",e.Time="time",e}({}),$g=function(e){return e.BBOX="BBox",e.PropertyIsBetween="PropertyIsBetween",e.Contains="Contains",e.During="During",e.PropertyIsEqualTo="PropertyIsEqualTo",e.PropertyIsGreaterThan="PropertyIsGreaterThan",e.PropertyIsGreaterThanOrEqualTo="PropertyIsGreaterThanOrEqualTo",e.Intersects="Intersects",e.PropertyIsNull="PropertyIsNull",e.PropertyIsLessThan="PropertyIsLessThan",e.PropertyIsLessThanOrEqualTo="PropertyIsLessThanOrEqualTo",e.PropertyIsLike="PropertyIsLike",e.PropertyIsNotEqualTo="PropertyIsNotEqualTo",e.Within="Within",e.And="And",e.Or="Or",e.Not="Not",e}({}),Eg=Mc,Wg=function(){function e(){var t;_classCallCheck(this,e),this.filterSequence=[],this.operators=(_defineProperty(t={},$g.PropertyIsEqualTo,{spatial:!1,fieldRestrict:[]}),_defineProperty(t,$g.PropertyIsNotEqualTo,{spatial:!1,fieldRestrict:[]}),_defineProperty(t,$g.PropertyIsLike,{spatial:!1,fieldRestrict:["string"]}),_defineProperty(t,$g.PropertyIsGreaterThan,{spatial:!1,fieldRestrict:["number"]}),_defineProperty(t,$g.PropertyIsGreaterThanOrEqualTo,{spatial:!1,fieldRestrict:["number"]}),_defineProperty(t,$g.PropertyIsLessThan,{spatial:!1,fieldRestrict:["number"]}),_defineProperty(t,$g.PropertyIsLessThanOrEqualTo,{spatial:!1,fieldRestrict:["number"]}),_defineProperty(t,$g.PropertyIsBetween,{spatial:!1,fieldRestrict:["number"]}),_defineProperty(t,$g.During,{spatial:!1,fieldRestrict:[]}),_defineProperty(t,$g.PropertyIsNull,{spatial:!1,fieldRestrict:[]}),_defineProperty(t,$g.Intersects,{spatial:!0,fieldRestrict:[]}),_defineProperty(t,$g.Within,{spatial:!0,fieldRestrict:[]}),_defineProperty(t,$g.Contains,{spatial:!0,fieldRestrict:[]}),t)}return _createClass(e,[{key:"defineOgcFiltersDefaultOptions",value:function(e,t,i){var o=!0;return i&&"wms"===i&&(o=!1),(e=e||{}).enabled=void 0===e.enabled?o:e.enabled,e.editable=void 0===e.editable?o:e.editable,e.geometryName=t,e.advancedOgcFilters=!0,e.enabled&&e.pushButtons&&(e.advancedOgcFilters=!1),e}},{key:"buildFilter",value:function(e,t,i,o,n){var r,a;if(a=!/intersects|contains|within/gi.test(JSON.stringify(e)),e&&(o=void 0!==e.geometryName?e.geometryName:o),t&&e&&(r=Object(Tc.b)(o,t,i.getCode())),!e)return"bbox="+t.join(",")+","+i.getCode();e=this.checkIgoFiltersProperties(e,o,i);var s={srsName:"",featureNS:"",featurePrefix:"",featureTypes:["featureTypes"],filter:t&&a?Object(Tc.a)(r,this.bundleFilter(e,n)):this.bundleFilter(e,n),outputFormat:"",geometryName:o},c=(new _c.a).writeGetFeature(s);return"filter="+(new XMLSerializer).serializeToString(c).split(/typenames *=|typename *=\"featureTypes\" *>/gi)[1].split(/<\/Query><\/GetFeature>/gi)[0]}},{key:"bundleFilter",value:function(e,t){var i=this;if(e instanceof Array){var o=[];return e.forEach((function(e){o.push(i.bundleFilter(e,t))})),o}return e.hasOwnProperty("logical")?this.createFilter({operator:e.logical,logicalArray:this.bundleFilter(e.filters,t)},t):e.hasOwnProperty("operator")?this.createFilter(e,t):void 0}},{key:"createFilter",value:function(e,t){var i,o=e.operator,n=e.logicalArray,r=e.propertyName,a=e.pattern,s=!e.matchCase||e.matchCase,c=e.wildCard?e.wildCard:"*",l=e.singleChar?e.singleChar:".",u=e.escapeChar?e.escapeChar:"!",h=e.lowerBoundary,d=e.upperBoundary,p=e.geometryName,g=e.extent,f=e.wkt_geometry,m=e.srsName?e.srsName:"EPSG:3857",b=this.parseFilterOptionDate(e.begin,t?t.minDate:void 0),v=this.parseFilterOptionDate(e.end,t?t.maxDate:void 0),y=e.expression;switch(f&&(i=(new Fc.a).readGeometry(f,{dataProjection:m,featureProjection:m||"EPSG:3857"})),o.toLowerCase()){case $g.BBOX.toLowerCase():return Object(Tc.b)(p,g,m);case $g.PropertyIsBetween.toLowerCase():return Object(Tc.c)(r,h,d);case $g.Contains.toLowerCase():return Object(Tc.d)(p,i,m);case $g.During.toLowerCase():return Object(Tc.e)(r,b,v);case $g.PropertyIsEqualTo.toLowerCase():return Object(Tc.f)(r,y,s);case $g.PropertyIsGreaterThan.toLowerCase():return Object(Tc.g)(r,y);case $g.PropertyIsGreaterThanOrEqualTo.toLowerCase():return Object(Tc.h)(r,y);case $g.Intersects.toLowerCase():return Object(Tc.i)(p,i,m);case $g.PropertyIsNull.toLowerCase():return Object(Tc.j)(r);case $g.PropertyIsLessThan.toLowerCase():return Object(Tc.k)(r,y);case $g.PropertyIsLessThanOrEqualTo.toLowerCase():return Object(Tc.l)(r,y);case $g.PropertyIsLike.toLowerCase():return Object(Tc.m)(r,a.replace(/[()_]/gi,l),c,l,u,s);case $g.PropertyIsNotEqualTo.toLowerCase():return Object(Tc.o)(r,y,s);case $g.Within.toLowerCase():return Object(Tc.q)(p,i,m);case $g.And.toLowerCase():return Tc.a.apply(null,n);case $g.Or.toLowerCase():return Tc.p.apply(null,n);case $g.Not.toLowerCase():return Tc.n.apply(null,n);default:return}}},{key:"defineInterfaceFilterSequence",value:function(e,t){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;return e instanceof Array?e.forEach((function(e){i.filterSequence.concat(i.defineInterfaceFilterSequence(e,t,o,n))})):e.hasOwnProperty("logical")?this.filterSequence.concat(this.defineInterfaceFilterSequence(e.filters,t,e.logical,n+=1)):e.hasOwnProperty("operator")&&this.filterSequence.push(this.addInterfaceFilter(e,t,n,o)),this.filterSequence}},{key:"computeAllowedOperators",value:function(e,t,i){var o,n,r,a,s,c,l,u,h={};if(e&&t){var d=e.find((function(e){return e.name===t}));c=d&&d.allowedOperatorsType?d.allowedOperatorsType:i}switch(e&&e.map((function(e){if(e.allowedOperatorsType){var t=e.allowedOperatorsType.toLowerCase();t!==Rg.All.toLowerCase()&&t!==Rg.Spatial.toLowerCase()&&t!==Rg.BasicAndSpatial.toLowerCase()||(l=!0,t===Rg.All.toLowerCase()&&(u=!0))}})),(c=c||Rg.BasicAndSpatial).toLowerCase()){case Rg.All:h=this.operators;break;case Rg.Spatial:_defineProperty(o={},$g.Intersects,{spatial:!0,fieldRestrict:[]}),_defineProperty(o,$g.Within,{spatial:!0,fieldRestrict:[]}),h=o;break;case Rg.BasicAndSpatial:_defineProperty(n={},$g.PropertyIsEqualTo,{spatial:!1,fieldRestrict:[]}),_defineProperty(n,$g.PropertyIsNotEqualTo,{spatial:!1,fieldRestrict:[]}),_defineProperty(n,$g.Intersects,{spatial:!0,fieldRestrict:[]}),_defineProperty(n,$g.Within,{spatial:!0,fieldRestrict:[]}),h=n;break;case Rg.Basic:_defineProperty(r={},$g.PropertyIsEqualTo,{spatial:!1,fieldRestrict:[]}),_defineProperty(r,$g.PropertyIsNotEqualTo,{spatial:!1,fieldRestrict:[]}),h=r;break;case Rg.Time:h=_defineProperty({},$g.During,{spatial:!1,fieldRestrict:[]});break;case Rg.BasicNumericOperator:_defineProperty(a={},$g.PropertyIsEqualTo,{spatial:!1,fieldRestrict:[]}),_defineProperty(a,$g.PropertyIsNotEqualTo,{spatial:!1,fieldRestrict:[]}),_defineProperty(a,$g.PropertyIsGreaterThan,{spatial:!1,fieldRestrict:["number"]}),_defineProperty(a,$g.PropertyIsGreaterThanOrEqualTo,{spatial:!1,fieldRestrict:["number"]}),_defineProperty(a,$g.PropertyIsLessThan,{spatial:!1,fieldRestrict:["number"]}),_defineProperty(a,$g.PropertyIsLessThanOrEqualTo,{spatial:!1,fieldRestrict:["number"]}),h=a;break;default:_defineProperty(s={},$g.PropertyIsEqualTo,{spatial:!1,fieldRestrict:[]}),_defineProperty(s,$g.PropertyIsNotEqualTo,{spatial:!1,fieldRestrict:[]}),_defineProperty(s,$g.Intersects,{spatial:!0,fieldRestrict:[]}),_defineProperty(s,$g.Within,{spatial:!0,fieldRestrict:[]}),h=s}return l&&(h.Intersects={spatial:!0,fieldRestrict:[]},h.Within={spatial:!0,fieldRestrict:[]},u&&(h.Contains={spatial:!0,fieldRestrict:[]})),h}},{key:"addInterfaceFilter",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Or";e||(e={operator:"PropertyIsEqualTo"});var n={propertyName:"",operator:"",active:"",filterid:G(),begin:"",end:"",lowerBoundary:"",upperBoundary:"",expression:"",pattern:"",wildCard:"*",singleChar:".",escapeChar:"!",matchCase:!0,igoSpatialSelector:"",igoSNRC:"",geometryName:"",geometry:"",wkt_geometry:"",extent:"",srsName:"",parentLogical:"",level:0};return Object.assign(n,{parentLogical:o,level:i,geometryName:t},e)}},{key:"checkIgoFiltersProperties",value:function(e,t,i){var o=this,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=[];return e instanceof Array?(e.forEach((function(e){r.push(o.checkIgoFiltersProperties(e,t,i,n))})),r):e.hasOwnProperty("logical")?Object.assign({},{logical:e.logical,filters:this.checkIgoFiltersProperties(e.filters,t,i,n)}):e.hasOwnProperty("operator")?this.addFilterProperties(e,t,i,n):void 0}},{key:"addFilterProperties",value:function(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=e.hasOwnProperty("filterid")?e.filterid:G(),r=e.hasOwnProperty("active")?e.active:o,a=e.hasOwnProperty("srsName")?e.srsName:i?i.getCode():"EPSG:3857";return Object.assign({},{filterid:n,active:r,igoSpatialSelector:"fixedExtent",srsName:a},e,{geometryName:t})}},{key:"rebuiltIgoOgcFilterObjectFromSequence",value:function(e){if(e instanceof Array&&e.length>=1){var t,i,o=e[0].parentLogical,n=[];return e.forEach((function(r){var a=Object.assign({},r),s=e.indexOf(r);t=s>=0&&s<e.length-1?e[s+1]:a,delete a.active,delete a.filterid,delete a.parentLogical,n.push(a),1===e.length?i=a:o!==t.parentLogical&&(1===n.length?console.log("You must set at least two operator in a logical ("+o+")"):(i=Object.assign({},{logical:o,filters:n}),n=[i],o=t.parentLogical))})),i}}},{key:"computeIgoPushButton",value:function(e){if(e.groups.every((function(e){return void 0!==e.computedButtons})))return e;var t;if(e.groups&&e.bundles){if(!e.bundles.every((function(e){return void 0!==e.id})))throw new Error("You must set an id for each of your pushButtons bundles");(t=E.copyDeep(e)).groups.forEach((function(e){e.title=e.title?e.title:e.name,e.enabled=!!e.enabled&&e.enabled,e.computedButtons=E.copyDeep(t.bundles.filter((function(t){return e.ids.includes(t.id)})))}))}else!e.groups&&e.bundles?(t=E.copyDeep(e)).groups=[{title:"group1",name:"group1",computedButtons:E.copyDeep(t.bundles)}]:t={bundles:e,groups:[{title:"group1",name:"group1",computedButtons:E.copyDeep(e)}]};return t.groups.find((function(e){return e.enabled}))||(t.groups[0].enabled=!0),t}},{key:"handleOgcFiltersAppliedValue",value:function(e,t,i,o){var n=e.ogcFilters;if(n){var r="",a="";if(n.enabled&&n.pushButtons){n.pushButtons=this.computeIgoPushButton(n.pushButtons);var s=n.pushButtons.groups.find((function(e){return e.enabled})).computedButtons,c=[];s.map((function(e){var t=[];e.buttons.filter((function(e){return!0===e.enabled})).forEach((function(e){return t.push(e.filters)})),1===t.length?c.push(t[0]):t.length>1&&c.push({logical:e.logical,filters:t})})),c.length>=1&&(r=this.buildFilter(1===c.length?c[0]:{logical:"And",filters:c},i,o,n.geometryName))}n.enabled&&n.filters&&(n.geometryName=n.geometryName||t,a=this.buildFilter(n.filters,i,o,n.geometryName,e));var l=n.advancedOgcFilters?a:r;return"wms"===e.type&&(l=this.formatProcessedOgcFilter(l,e.params.LAYERS)),"wfs"===e.type&&(l=this.formatProcessedOgcFilter(l,e.params.featureTypes)),l}}},{key:"formatProcessedOgcFilter",value:function(e,t){var i="";return 0===e.length&&-1===t.indexOf(",")?i=e:t.split(",").forEach((function(t){i="".concat(i,"(").concat(e.replace("filter=",""),")")})),(i=i.replace(/\(\)/g,"")).length>0?i.replace("filter=",""):void 0}},{key:"parseFilterOptionDate",value:function(e,t){return e?Eg(e).isValid()?e:void 0:t}}]),e}(),Xg=new RegExp(/(.*)?gml(.*)?/gi);function Gg(e,t,i,o){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=e.urlWfs,s=e.paramsWFS,c=t||5e3,l="2.0.0"===s.version?"startIndex="+n:"",u=i||"EPSG:3857",h=s.outputFormat?"outputFormat="+s.outputFormat:"",d=s.version?"version="+s.version:"version=2.0.0",p="".concat("2.0.0"===s.version?"typenames":"typename","=").concat(s.featureTypes),g="2.0.0"===s.version?"count":"maxFeatures",f=t?"".concat(g,"=").concat(c):s.maxFeatures?"".concat(g,"=").concat(s.maxFeatures):"".concat(g,"=").concat(c);r&&(h="",d="version=1.1.0",f=f.replace("count","maxFeatures"));var m=i?"srsname="+u:s.srsName?"srsname="+s.srsName:"srsname="+u,b="",v="";o&&(b="propertyName="+o,v="valueReference="+o);var y=e.sourceFields;if(!b&&y&&y.length>0){var k=[];e.sourceFields.forEach((function(e){k.push(e.name)})),b="propertyName=".concat(k.join(","),",").concat(s.fieldNameGeometry)}var S="".concat(a,"?service=WFS&request=GetFeature&").concat(d,"&").concat(p,"&");S+="".concat(h,"&").concat(m,"&").concat(f,"&").concat(b,"&").concat(l);var C="".concat(a,"?service=WFS&request=GetPropertyValue&version=2.0.0&").concat(p,"&");return C+="&".concat(f,"&").concat(v),[{name:"outputformat",value:h},{name:"version",value:d},{name:"typename",value:p},{name:"count",value:f},{name:"srsname",value:m},{name:"propertyname",value:b},{name:"valuereference",value:v},{name:"getcapabilities",value:"".concat(a,"?service=WFS&request=GetCapabilities&").concat(d).replace(/&&/g,"&")},{name:"getfeature",value:S.replace(/&&/g,"&")},{name:"getpropertyvalue",value:C.replace(/&&/g,"&")}]}function Bg(e,t){t&&"wfs"===t&&(e.paramsWFS=e.params);var i,o=e.paramsWFS;return e.urlWfs=e.urlWfs||e.url,o.version=o.version||"2.0.0",o.fieldNameGeometry=o.fieldNameGeometry||"geometry",o.maxFeatures=o.maxFeatures||5e3,o.outputFormat&&(i=o.outputFormat),!Xg.test(i)&&i||(o.version="1.1.0"),Object.assign({},e)}function Vg(e){var t=e,i=xc.WFS,o=t.paramsWFS.outputFormat?t.paramsWFS.outputFormat:void 0;return o?xc[o]?new(i=xc[o])(t.formatOptions):o.toLowerCase().match("gml2")?new(i=xc.WFS)(Object.assign(Object.assign({},t.formatOptions),{gmlFormat:Dc.a})):o.toLowerCase().match("gml32")?new(i=xc.WFS)(Object.assign(Object.assign({},t.formatOptions),{gmlFormat:Ac.a})):o.toLowerCase().match("gml3")?new(i=xc.WFS)(Object.assign(Object.assign({},t.formatOptions),{gmlFormat:Pc.a})):o.toLowerCase().match("topojson")?new(i=xc.TopoJSON)(t.formatOptions):o.toLowerCase().match("geojson")?new(i=xc.GeoJSON)(t.formatOptions):o.toLowerCase().match("esrijson")?new(i=xc.EsriJSON)(t.formatOptions):o.toLowerCase().match("json")?new(i=xc.GeoJSON)(t.formatOptions):o.toLowerCase().match("gpx")?new(i=xc.GPX)(t.formatOptions):o.toLowerCase().match("WKT")?new(i=xc.WKT)(t.formatOptions):o.toLowerCase().match("osmxml")?new(i=jc.a)(t.formatOptions):o.toLowerCase().match("kml")?new(i=xc.KML)(t.formatOptions):new i:new i(t.formatOptions)}var Ng,zg=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o,n){var r;_classCallCheck(this,i),(r=t.call(this,Bg(e,"wfs"))).options=e,r.wfsService=o,r.authInterceptor=n;var a=r.options.ogcFilters,s=r.options.paramsWFS.fieldNameGeometry||"geometry",c=new Wg;return r.options.ogcFilters=c.defineOgcFiltersDefaultOptions(a,s),r.options.ogcFilters.enabled&&r.options.ogcFilters.editable&&r.wfsService.getSourceFieldsFromWFS(r.options),r}return _createClass(i,[{key:"createOlSource",value:function(){var e=this,t=new wc.a({format:Vg(this.options),loader:function(i,o,n){e.options.paramsWFS.srsName=e.options.paramsWFS.srsName||n.getCode();var r=e.buildUrl(i,n,e.options.ogcFilters),a=0;if("2.0.0"===e.options.paramsWFS.version&&e.options.paramsWFS.maxFeatures>5e3)for(;a<e.options.paramsWFS.maxFeatures;){var s=r.replace("count="+e.options.paramsWFS.maxFeatures,"count=1000");s=s.replace("startIndex=0","0"),(s+="&startIndex="+a).replace(/&&/g,"&"),e.getFeatures(t,i,s,1e3),a+=1e3}else e.getFeatures(t,i,r,e.options.paramsWFS.maxFeatures)},strategy:Lc.b});return t}},{key:"getFeatures",value:function(e,t,i,o){var n=new XMLHttpRequest;n.open("GET",i),this.authInterceptor.interceptXhr(n,i);var r=function(){return e.removeLoadedExtent(t)};n.onerror=r,n.onload=function(){if(200===n.status){var t=e.getFormat().readFeatures(n.responseText);e.addFeatures(t)}else r()},n.send()}},{key:"buildUrl",value:function(e,t,i){var o,n=this.options.paramsWFS,r=Gg(this.options,void 0,this.options.paramsWFS.srsName);i&&i.enabled&&(o=i.filters);var a=new Wg,s=a.buildFilter(o,e,t,i.geometryName,this.options),c=a.handleOgcFiltersAppliedValue(this.options,i.geometryName,e,t),l="filter";c||(l="bbox",c=e.join(",")+","+t.getCode()),n.xmlFilter=i.advancedOgcFilters?s:"".concat(l,"=").concat(c);var u=r.find((function(e){return"getfeature"===e.name})).value;return u=/(filter|bbox)=.*/gi.test(n.xmlFilter)?"".concat(u,"&").concat(n.xmlFilter):u,this.options.download=Object.assign({},this.options.download,{dynamicUrl:u}),u.replace(/&&/g,"&")}},{key:"onUnwatch",value:function(){}}]),i}(Dg),qg=((Ng=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this)).http=e,o}return _createClass(i,[{key:"getData",value:function(){return console.log("This is defining a data service."),"This is defining a data service."}},{key:"getSourceFieldsFromWFS",value:function(e){e.sourceFields&&0!==e.sourceFields.length?this.defineFieldAndValuefromWFS(e).subscribe((function(t){e.sourceFields.forEach((function(e){void 0===e.alias&&(e.alias=e.name),void 0!==e.values&&0!==e.values.length||(e.values=t.find((function(t){return t.name===e.name})).values)}))})):(e.sourceFields=[],this.defineFieldAndValuefromWFS(e).subscribe((function(t){e.sourceFields=t})))}},{key:"wfsGetFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"EPSG:3857",o=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=Gg(e,t,i,o,n,r).find((function(e){return"getfeature"===e.name})).value,s=e.paramsWFS.outputFormat;return r||Xg.test(s)||!s?this.http.get(a,{responseType:"text"}):this.http.get(a)}},{key:"defineFieldAndValuefromWFS",value:function(e){var t=this;return new Ve.a((function(i){var o,n,r,a,s,c,l=[];s=Vg(e);var u=JSON.parse(JSON.stringify(e));delete u.paramsWFS.outputFormat,delete u.formatOptions,c=Vg(u);var h=null===(o=e.sourceFields)||void 0===o?void 0:o.filter((function(e){return!e.values})).map((function(e){return e.name}));t.wfsGetFeature(e,1,void 0,void 0,0,!0).pipe(Object(fc.a)((function(e){return String(e).toLowerCase().includes("exception")?Object(F.a)(!1):Object(F.a)(!0)})),Object(fc.a)((function(i){return t.wfsGetFeature(e,1).pipe(Object(fc.a)((function(o){var l=s.readFeatures(o);n=l[0].getKeys(),(e.sourceFields||0===e.sourceFields.length)&&(h=n),r=n.filter((function(e){return h.includes(e)&&e!==l[0].getGeometryName()&&!e.match(/boundedby/gi)})),a=r.join(",");var u=[],d=0;if(!i&&"2.0.0"===e.paramsWFS.version&&e.paramsWFS.maxFeatures>5e3){for(;d<e.paramsWFS.maxFeatures;)u.push(t.wfsGetFeature(e,1e3,e.paramsWFS.srsName,a,d)),d+=1e3;c=s}else u.push(t.wfsGetFeature(e,e.paramsWFS.maxFeatures||5e3,e.paramsWFS.srsName,a,0,!0));return Object(_.a)(u)})))}))).subscribe((function(e){var o=[];e.map((function(e){var t=c.readFeatures(e);o=o.concat(t)})),t.built_properties_value(o).forEach((function(e){l.push(e)})),i.next(l),i.complete()}))}))}},{key:"built_properties_value",value:function(e){if(0===e.length)return[];var t=Object.assign({},e[0].getProperties());delete t[e[0].getGeometryName()],delete t.boundedBy;var i=[];for(var o in t)if(t.hasOwnProperty(o)){var n="object"==typeof e[0].get(o)?void 0:typeof e[0].get(o);i.push({name:o,alias:o,type:n,values:[t[o]]})}return e.every((function(e){var o=e.getProperties(),n=function(e){o.hasOwnProperty(e)&&e in t&&i.filter((function(t){return t.name===e})).forEach((function(t){-1===t.values.indexOf(o[e])&&t.values.push(o[e])}))};for(var r in o)n(r);return!0})),i}}]),i}(function(){return function e(){_classCallCheck(this,e)}}())).\u0275fac=function(e){return new(e||Ng)(r.bc(k.b))},Ng.\u0275prov=Object(r.Nb)({factory:function(){return new Ng(Object(r.bc)(k.b))},token:Ng,providedIn:"root"}),Ng),Hg=function(e){return e.GML2="gml2",e.GML3="gml3",e.JSON="json",e.GEOJSON="geojson",e.GEOJSON2="geojson2",e.ESRIJSON="esrijson",e.TEXT="text",e.HTML="html",e.HTMLGML2="htmlgml2",e}({}),Ug=function(e){return e.GML2="application/vnd.ogc.gml",e.GML3="application/vnd.ogc.gml/3.1.1",e.JSON="application/json",e.GEOJSON="application/geojson",e.GEOJSON2="geojson",e.ESRIJSON="application/json",e.TEXT="text/plain",e.HTML="text/html",e.HTMLGML2="text/html",e}({}),Yg=function(e){return e.IFRAME="iframe",e.BLANK="_blank",e}({}),Kg=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o){var n;_classCallCheck(this,i),(n=t.call(this,e)).options=e,n.wfsService=o;var r=e.params,a=r.DPI||96;r.DPI=a,r.MAP_RESOLUTION=a,r.FORMAT_OPTIONS="dpi:"+a,e.refreshIntervalSec&&e.refreshIntervalSec>0&&setInterval((function(){n.refresh()}),1e3*e.refreshIntervalSec);var s="geometry";if(e.paramsWFS){var c=Bg(e,"wms");E.mergeDeep(e.paramsWFS,c.paramsWFS),s=e.paramsWFS.fieldNameGeometry||s,e.download=Object.assign({},e.download,{dynamicUrl:n.buildDynamicDownloadUrlFromParamsWFS(e)})}e.sourceFields&&0!==e.sourceFields.length?e.sourceFields.forEach((function(e){e.alias=e.alias?e.alias:e.name})):e.sourceFields=[];var l=e.ogcFilters,u=new Wg;l?l.advancedOgcFilters=!l.pushButtons:e.ogcFilters=u.defineOgcFiltersDefaultOptions(l,s,"wms"),r.LAYERS.split(",").length>1&&l&&l.enabled&&(console.log("*******************************"),console.log("BE CAREFULL, YOUR WMS LAYERS ("+r.LAYERS+") MUST SHARE THE SAME FIELDS TO ALLOW ogcFilters TO WORK !! "),console.log("*******************************")),e.paramsWFS&&l&&l.enabled&&l.editable&&n.wfsService.getSourceFieldsFromWFS(e);var h=u.handleOgcFiltersAppliedValue(e,s);return r.FILTER=h,n}return _createClass(i,[{key:"refresh",value:function(){this.ol.updateParams({igoRefresh:Math.random()})}},{key:"buildDynamicDownloadUrlFromParamsWFS",value:function(e){return Gg(e).find((function(e){return"getfeature"===e.name})).value}},{key:"createOlSource",value:function(){return new Rc.a(this.options)}},{key:"getLegend",value:function(e,t){var o=_get(_getPrototypeOf(i.prototype),"getLegend",this).call(this);if(o.length>0&&void 0===e&&!t)return o;var n=this.params,r=[];void 0!==n.LAYERS&&(r=n.LAYERS.split(","));var a=this.options.url.replace(/\?$/,""),s=["REQUEST=GetLegendGraphic","SERVICE=WMS","FORMAT=image/png","SLD_VERSION=1.1.0","VERSION="+(n.VERSION||"1.3.0")];return void 0!==e&&s.push("STYLE="+e),void 0!==t&&s.push("SCALE="+t),o=r.map((function(t){var i=a.match(/\?/)?"&":"?";return{url:"".concat(a).concat(i).concat(s.join("&"),"&LAYER=").concat(t),title:r.length>1?t:void 0,currentStyle:void 0===e?void 0:e}}))}},{key:"onUnwatch",value:function(){}},{key:"params",get:function(){return this.options.params}},{key:"queryTitle",get:function(){return this.options.queryTitle?this.options.queryTitle:"title"}},{key:"mapLabel",get:function(){return this.options.mapLabel}},{key:"queryHtmlTarget",get:function(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:Yg.BLANK}}]),i}(Dg);function Zg(e){for(var t=(e?Object(kc.j)(e):Object(kc.j)("EPSG:3857")).getExtent(),i=Object(Wc.F)(t)/256,o=new Array(20),n=new Array(20),r=0;r<20;++r)o[r]=i/Math.pow(2,r),n[r]=r;return new Ec.b({origin:Object(Wc.D)(t),resolutions:o,matrixIds:n})}var Jg,Qg,ef,tf=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){return _classCallCheck(this,i),t.call(this,e)}return _createClass(i,[{key:"createOlSource",value:function(){var e=Object.assign({tileGrid:Zg(this.options.projection)},this.options);return new $c.a(e)}},{key:"onUnwatch",value:function(){}}]),i}(Dg),of=function(e){_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"createOlSource",value:function(){var e=Object.assign({crossOrigin:this.options.crossOrigin?this.options.crossOrigin:"anonymous"},this.options);return new Xc.a(e)}},{key:"getLegend",value:function(){var e=_get(_getPrototypeOf(i.prototype),"getLegend",this).call(this);if(e.length>0)return e;var t="<table>";if(null!=this.options.config.layers[0].legend)return this.options.config.layers[0].legend.items.forEach((function(e){!0===e.visible&&(t+='<tr><td><p><font size="5" color="'+e.value+'"> &#9679</font></p></td><td>'+e.name+"</td></tr>")})),[{html:t+="</table>"}];for(var o=this.options.config.layers[0].options,n=0,r=["polygon-fill:","marker-fill:","shield-fill:","building-fill:","line-color:"];n<r.length;n++){var a=r[n];if(o.cartocss.includes(a)){var s=o.cartocss.split(a).pop(),c=s.substr(0,s.indexOf(";"));if(c.includes("ramp")){for(var l=c.split(", (")[1].split(","),u=c.split(", (")[2].split(","),h=0;h<l.length;h++)l[h]=l[h].replace(/("|\))/g,""),u[h]=u[h].replace(/("|\))/g,""),"="===u[h].replace(/\s+/g,"")&&(u[h]="Autres"),t+='<tr><td><p><font size="5" color="'+l[h]+'"> &#9679</font></p></td><td>'+u[h]+"</td></tr>";break}t+='<tr><td><p><font size="5" color="'+c+'"> &#9679</font></p></td><td>'+(o.layer_name?o.layer_name:"")+"</td></tr>";break}}return[{html:t+="</table>"}]}},{key:"onUnwatch",value:function(){}},{key:"params",get:function(){return this.options.params}},{key:"queryTitle",get:function(){return this.options.queryTitle?this.options.queryTitle:"title"}},{key:"mapLabel",get:function(){return this.options.mapLabel}},{key:"queryHtmlTarget",get:function(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:Yg.BLANK}}]),i}(Dg),nf=function(e){_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"createOlSource",value:function(){var e=new Gc.a;return new wc.a({attributions:this.options.params.attributions,overlaps:!1,format:e,url:(function(e,t,i){var o=this.options.url+"/"+this.options.layer+"/query/",n=["f=json","geometry="+encodeURIComponent('{"xmin":'+e[0]+',"ymin":'+e[1]+',"xmax":'+e[2]+',"ymax":'+e[3]+',"spatialReference":{"wkid":102100}}'),"geometryType=esriGeometryEnvelope","inSR=102100","spatialRel=esriSpatialRelIntersects","outFields=*","returnGeometry=true","outSR=102100"];return this.options.params.timeFilter&&n.push("time="+this.options.params.timeExtent),this.options.params.customParams&&this.options.params.customParams.forEach((function(e){n.push(e)})),"".concat(o,"?").concat(n.join("&"))}).bind(this),strategy:Lc.b})}},{key:"getLegend",value:function(){var e=this.options.params.legendInfo,t=_get(_getPrototypeOf(i.prototype),"getLegend",this).call(this);if(void 0===e||t.length>0)return t;var o,n=parseInt(this.options.layer,10),r=e.layers[n],a="<table><tr><td>"+r.layerName+"</td></tr>",s=_createForOfIteratorHelper(r.legend);try{for(s.s();!(o=s.n()).done;){var c=o.value;a+="<tr><td align='left'><img src=\"".concat(this.options.url.replace("FeatureServer","MapServer"),"/").concat(r.layerId,"/images/").concat(c.url,"\" alt ='' /></td><td>")+c.label.replace("<Null>","Null")+"</td></tr>"}}catch(l){s.e(l)}finally{s.f()}return[{html:a+="</table>"}]}},{key:"onUnwatch",value:function(){}}]),i}(Dg),rf=function(e){_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"createOlSource",value:function(){return new Bc.a(this.options)}},{key:"getLegend",value:function(){var e=_get(_getPrototypeOf(i.prototype),"getLegend",this).call(this);if(void 0===this.options.legendInfo||e.length>0)return e;var t,o=parseInt(this.options.layer,10),n=this.options.legendInfo.layers[o],r="<table><tr><td>"+n.layerName+"</td></tr>",a=_createForOfIteratorHelper(n.legend);try{for(a.s();!(t=a.n()).done;){var s=t.value;r+="<tr><td align='left'><img src=\"".concat(this.options.url,"/").concat(n.layerId,"/images/").concat(s.url,"\" alt ='' /></td><td>")+s.label.replace("<Null>","Null")+"</td></tr>"}}catch(c){a.e(c)}finally{a.f()}return[{html:r+="</table>"}]}},{key:"onUnwatch",value:function(){}},{key:"params",get:function(){return this.options.params}},{key:"queryTitle",get:function(){return this.options.queryTitle?this.options.queryTitle:"title"}},{key:"mapLabel",get:function(){return this.options.mapLabel}},{key:"queryHtmlTarget",get:function(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:Yg.BLANK}}]),i}(Dg),af=function(e){_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"createOlSource",value:function(){return this.createWebSocket(),this.options.format=this.getSourceFormatFromOptions(this.options),_get(_getPrototypeOf(i.prototype),"createOlSource",this).call(this)}},{key:"createWebSocket",value:function(){this.ws=new WebSocket(this.options.url),this.ws.onmessage=this.onMessage.bind(this),this.options.onclose&&(this.ws.onclose=this.onClose.bind(this)),this.options.onerror&&(this.ws.onerror=this.onError.bind(this)),this.options.onopen&&(this.ws.onopen=this.onOpen.bind(this))}},{key:"onMessage",value:function(e){var t=this.options.format.readFeature(e.data);switch(this.options.onmessage){case"update":var i=this.ol.getFeatureById(t.getId());i&&this.ol.removeFeature(i),this.ol.addFeature(t);break;case"delete":this.ol.clear(!0),this.ol.addFeature(t);break;case"add":default:this.ol.addFeature(t)}}},{key:"onClose",value:function(e){}},{key:"onError",value:function(e){}},{key:"onOpen",value:function(e){}},{key:"onUnwatch",value:function(){this.ws.close()}}]),i}(Pg),sf=function(e){_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"createOlSource",value:function(){var e;return"feature"===this.options.featureClass?e=new zc.a({featureClass:Vc.a}):void 0===this.options.featureClass&&(e=new zc.a),this.options.format=e,new Nc.a(this.options)}},{key:"generateId",value:function(){return this.options.url?Os.Md5.hashStr("mvt"+this.options.url):G()}},{key:"onUnwatch",value:function(){}}]),i}(Dg),cf=function(e){_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"createOlSource",value:function(){return this.options.format=this.getSourceFormatFromOptions(this.options),this.options.source=_get(_getPrototypeOf(i.prototype),"createOlSource",this).call(this),new qc.a(this.options)}},{key:"generateId",value:function(){return G()}},{key:"onUnwatch",value:function(){}}]),i}(Pg),lf=function(){function e(){_classCallCheck(this,e),this._converters={},this._converters.esriPMS=e._convertEsriPMS,this._converters.esriSFS=e._convertEsriSFS,this._converters.esriSLS=e._convertEsriSLS,this._converters.esriSMS=e._convertEsriSMS,this._converters.esriTS=e._convertEsriTS,this._renderers={},this._renderers.uniqueValue=this._renderUniqueValue,this._renderers.simple=this._renderSimple,this._renderers.classBreaks=this._renderClassBreaks}return _createClass(e,[{key:"_convertLabelingInfo",value:function(t,i){for(var o=[],n=0,r=t.length;n<r;++n){var a=t[n].labelExpression,s=a.substr(a.indexOf("[")+1,a.indexOf("]")-1),c=t[n].symbol,l=t[n].maxScale,u=t[n].minScale,h=null;0!==l&&(h=e._getResolutionForScale(l,i));var d=null;0!==u&&(d=e._getResolutionForScale(u,i));var p=this._converters[c.type].call(this,c);o.push((function(e,t){var i=!0;if(null!==this.minResolution&&null!==this.maxResolution?i=t<this.maxResolution&&t>=this.minResolution:null!==this.minResolution?i=t>=this.minResolution:null!==this.maxResolution&&(i=t<this.maxResolution),i){var o=e.get(this.field);return this.style.getText().setText(o),[this.style]}}).bind({minResolution:h,maxResolution:d,field:s,style:p}))}return o}},{key:"_renderSimple",value:function(e){var t=this._converters[e.symbol.type].call(this,e.symbol);return function(){return[t]}}},{key:"_renderClassBreaks",value:function(e){for(var t=e.defaultSymbol,i=this._converters[t.type].call(this,t),o=e.field,n=[],r=0,a=e.classBreakInfos.length;r<a;++r){var s,c=e.classBreakInfos[r];s=null==c.classMinValue?0===r?e.minValue:e.classBreakInfos[r-1].classMaxValue:c.classMinValue;var l=c.classMaxValue,u=c.symbol,h=this._converters[u.type].call(this,u);n.push({min:s,max:l,style:h})}return function(e){for(var t=e.get(o),r=0,a=n.length;r<a;++r){if(0===r?t>=n[r].min&&t<=n[r].max:t>n[r].min&&t<=n[r].max)return[n[r].style]}return[i]}}},{key:"_renderUniqueValue",value:function(e){var t=e.defaultSymbol,i=[];t&&(i=[this._converters[t.type].call(this,t)]);var o=e.field1,n=e.uniqueValueInfos,r=this;return function(){for(var e={},t=0,a=n.length;t<a;++t){var s=n[t],c=s.symbol;e[s.value]=[r._converters[c.type].call(r,c)]}return function(t){return e[t.get(o)]||i}}()}},{key:"generateStyle",value:function(e,t){var i=e.drawingInfo,o=[],n=this._renderers[i.renderer.type].call(this,i.renderer);if(void 0!==n&&o.push(n),e.labelingInfo){var r=this._convertLabelingInfo(e.labelingInfo,t);o=o.concat(r)}return 1===o.length?o[0]:function(e,t){for(var i=[],n=0,r=o.length;n<r;++n){var a=o[n].call(null,e,t);a&&(i=i.concat(a))}return i}}}],[{key:"_convertPointToPixel",value:function(e){return e/.75}},{key:"_transformColor",value:function(e){return[e[0],e[1],e[2],e[3]/255]}},{key:"_getResolutionForScale",value:function(e,t){var i=kc.a[t];return parseFloat(e)/(39.3701*i*96)}},{key:"_convertEsriTS",value:function(t){var i=e._transformAngle(t.angle),o=void 0!==t.text?t.text:void 0;return new Uc.Style({text:new Uc.Text({fill:new Uc.Fill({color:e._transformColor(t.color)}),font:t.font.style+" "+t.font.weight+" "+t.font.size+" px "+t.font.family,textBaseline:t.verticalAlignment,textAlign:t.horizontalAlignment,offsetX:e._convertPointToPixel(t.xoffset),offsetY:e._convertPointToPixel(t.yoffset),rotation:i,text:o})})}},{key:"_convertEsriPMS",value:function(t){var i="data:"+t.contentType+";base64, "+t.imageData,o=e._transformAngle(t.angle);return new Uc.Style({image:new Uc.Icon({src:i,rotation:o})})}},{key:"_convertEsriSFS",value:function(t){var i=new Uc.Fill({color:e._transformColor(t.color)}),o=t.outline?e._convertOutline(t.outline):void 0;return new Uc.Style({fill:i,stroke:o})}},{key:"_convertOutline",value:function(t){var i,o=e._transformColor(t.color);return"esriSLSDash"===t.style?i=[5]:"esriSLSDashDot"===t.style?i=[5,5,1,2]:"esriSLSDashDotDot"===t.style?i=[5,5,1,2,1,2]:"esriSLSDot"===t.style?i=[1,2]:"esriSLSNull"===t.style&&(o[3]=0),new Uc.Stroke({color:o,lineDash:i,width:e._convertPointToPixel(t.width)})}},{key:"_convertEsriSLS",value:function(t){return new Uc.Style({stroke:e._convertOutline(t)})}},{key:"_transformAngle",value:function(e){if(0!==e&&void 0!==e){var t=-e*Math.PI/180+Math.PI/2;return t<0?2*Math.PI+t:t}}},{key:"_convertEsriSMS",value:function(t){var i=new Uc.Fill({color:e._transformColor(t.color)}),o=t.outline?e._convertOutline(t.outline):void 0,n=e._convertPointToPixel(t.size)/2,r=e._transformAngle(t.angle);return"esriSMSCircle"===t.style?new Uc.Style({image:new Uc.Circle({radius:n,fill:i,stroke:o})}):"esriSMSCross"===t.style?new Uc.Style({image:new Uc.RegularShape({fill:i,stroke:o,points:4,radius:n,radius2:0,angle:0,rotation:r})}):"esriSMSDiamond"===t.style?new Uc.Style({image:new Uc.RegularShape({fill:i,stroke:o,points:4,radius:n,rotation:r})}):"esriSMSSquare"===t.style?new Uc.Style({image:new Uc.RegularShape({fill:i,stroke:o,points:4,radius:n,angle:Math.PI/4,rotation:r})}):"esriSMSX"===t.style?new Uc.Style({image:new Uc.RegularShape({fill:i,stroke:o,points:4,radius:n,radius2:0,angle:Math.PI/4,rotation:r})}):"esriSMSTriangle"===t.style?new Uc.Style({image:new Uc.RegularShape({fill:i,stroke:o,points:3,radius:n,angle:0,rotation:r})}):void 0}}]),e}(),uf=function(e){return e.DATE="date",e.TIME="time",e.DATETIME="datetime",e.YEAR="year",e}({}),hf=function(e){return e.CALENDAR="calendar",e.SLIDER="slider",e}({}),df=function(e){return e.wms="wms",e.wmts="wmts",e.arcgisrest="esriJSON",e}({}),pf=((Jg=function(){function e(t){_classCallCheck(this,e),this.http=t,this.parsers={wms:new xc.WMSCapabilities,wmts:new xc.WMTSCapabilities,esriJSON:new xc.EsriJSON}}return _createClass(e,[{key:"getWMSOptions",value:function(e){var t=this;return this.getCapabilities("wms",e.url,e.params.VERSION).pipe(Object(w.a)((function(i){return i?t.parseWMSOptions(e,i):void 0})))}},{key:"getWMTSOptions",value:function(e){var t=this;return this.getCapabilities("wmts",e.url,e.version).pipe(Object(w.a)((function(i){return i?t.parseWMTSOptions(e,i):void 0})))}},{key:"getCartoOptions",value:function(e){var t=this;return this.http.jsonp("https://"+e.account+".carto.com/api/v2/viz/"+e.mapId+"/viz.json","callback").pipe(Object(w.a)((function(i){return t.parseCartoOptions(e,i)})))}},{key:"getArcgisOptions",value:function(e){var t=this,i=e.url+"/"+e.layer+"?f=json",o=e.url.replace("FeatureServer","MapServer")+"/legend?f=json",n=this.http.get(i),r=this.http.get(o).pipe(Object(w.a)((function(e){return e})),Object(C.a)((function(e){return console.log("No legend associated with this Feature Service"),Object(F.a)(e)})));return Object(hc.a)([n,r]).pipe(Object(w.a)((function(i){return t.parseArcgisOptions(e,i[0],i[1])})))}},{key:"getTileArcgisOptions",value:function(e){var t=this,i=e.url+"/legend?f=json",o=this.http.get(e.url+"/"+e.layer+"?f=json"),n=this.http.get(i);return Object(hc.a)([o,n]).pipe(Object(w.a)((function(i){return t.parseTileArcgisOptions(e,i[0],i[1])})))}},{key:"getCapabilities",value:function(e,t,i){var o=this,n=new k.g({fromObject:{request:"GetCapabilities",service:e.toUpperCase(),version:i||"1.3.0",_i:"true"}});return("esriJSON"===e?this.http.get(t+"?f=json"):this.http.get(t,{params:n,responseType:"text"})).pipe(Object(w.a)((function(t){if("esriJSON"===e)return t;if(String(t).toLowerCase().includes("serviceexception")&&String(t).toLowerCase().includes("access denied"))throw{error:{message:"Service error getCapabilities: Access is denied"}};return o.parsers[e].read(t)})),Object(C.a)((function(e){throw void 0!==e.error&&(e.error.caught=!0),e})))}},{key:"parseWMSOptions",value:function(e,t){var i=this.findDataSourceInCapabilities(t.Capability.Layer,e.params.LAYERS);if(!i)throw{error:{message:"Layer not found"}};for(var o,n=i.DataURL?i.DataURL[0]:void 0,r=i.Abstract?i.Abstract:void 0,a=i.KeywordList?i.KeywordList:void 0,s=i.queryable,c=this.getTimeFilter(i),l=c&&Object.keys(c).length>0,u=i.Style?this.getStyle(i.Style):void 0,h=[Ug.GEOJSON,Ug.GEOJSON2,Ug.GML3,Ug.GML2,Ug.JSON,Ug.HTML],d=function(){var e=g[p];if(-1!==t.Capability.Request.GetFeatureInfo.Format.indexOf(e)){var i=Object.keys(Ug).find((function(t){return Ug[t]===e}));return o=Hg[i],"break"}},p=0,g=h;p<g.length&&"break"!==d();p++);o||(s=!1);var f=E.removeUndefined({_layerOptionsFromSource:{title:i.Title,maxResolution:fg(i.MaxScaleDenominator),minResolution:fg(i.MinScaleDenominator),metadata:{url:n?n.OnlineResource:void 0,extern:!!n||void 0,abstract:r,keywordList:a},legendOptions:u},queryable:s,queryFormat:o,timeFilterable:!!l||void 0,minDate:l?c.min:void 0,maxDate:l?c.max:void 0,stepDate:l?c.step:void 0});return E.mergeDeep(f,e)}},{key:"parseWMTSOptions",value:function(e,t){var i=t.Contents.Layer.find((function(t){return t.Identifier===e.layer})),o=Object($c.b)(t,e),n=Object.assign(o,e),r=E.removeUndefined({_layerOptionsFromSource:{title:i.Title}});return E.mergeDeep(r,n)}},{key:"parseCartoOptions",value:function(e,t){var i=[],o=t.layers[1].options.layer_definition;o.layers.forEach((function(e){i.push({type:e.type.toLowerCase(),options:e.options,legend:e.legend})}));var n=E.removeUndefined({config:{version:o.version,layers:i}});return E.mergeDeep(n,e)}},{key:"parseArcgisOptions",value:function(e,t,i){var o,n,r=t.name,a=i.layers?i:void 0,s=(new lf).generateStyle(t,"esriMeters"===t.units?"m":"degrees"),c=new Hc.a({html:t.copyrightText});if(t.timeInfo){var l=t.timeInfo.timeExtent;o=l[0]+","+l[1];var u=new Date;u.setTime(l[0]);var h=new Date;h.setTime(l[1]),n={min:u.toUTCString(),max:h.toUTCString(),range:!0,type:uf.DATETIME,style:hf.CALENDAR}}var d=Object.assign({},{legendInfo:a,style:s,timeFilter:n,timeExtent:o,attributions:c}),p=E.removeUndefined({params:d,_layerOptionsFromSource:{title:r}});return E.mergeDeep(p,e)}},{key:"parseTileArcgisOptions",value:function(e,t,i){var o,n,r=i.layers?i:void 0,a=new Hc.a({html:t.copyrightText});if(t.timeInfo){var s=t.timeInfo.timeExtent;o=s[0]+","+s[1];var c=new Date;c.setTime(s[0]);var l=new Date;l.setTime(s[1]),n={min:c.toUTCString(),max:l.toUTCString(),range:!0,type:uf.DATETIME,style:hf.CALENDAR}}var u=Object.assign({},{layers:"show:"+e.layer,time:o}),h=E.removeUndefined({params:u,legendInfo:r,timeFilter:n,attributions:a});return E.mergeDeep(h,e)}},{key:"findDataSourceInCapabilities",value:function(e,t){var i,o=this;return Array.isArray(e)?(e.find((function(e){return void 0!==(i=o.findDataSourceInCapabilities(e,t))}),this),i):e.Layer?this.findDataSourceInCapabilities(e.Layer,t):e.Name&&e.Name===t?e:void 0}},{key:"getTimeFilter",value:function(e){var t;if(e.Dimension){var i={};if((t=e.Dimension[0]).values){var o=t.values.split("/");i.min=void 0!==o[0]?o[0]:void 0,i.max=void 0!==o[1]?o[1]:void 0,i.step=void 0!==o[2]?o[2]:void 0}return t.default&&(i.value=t.default),i}}},{key:"getStyle",value:function(e){return{stylesAvailable:e.map((function(e){return{name:e.Name,title:e.Title}})).filter((function(e,t,i){return i.findIndex((function(t){return t.name===e.name}))===t}))}}}]),e}()).\u0275fac=function(e){return new(e||Jg)(r.bc(k.b))},Jg.\u0275prov=Object(r.Nb)({factory:function(){return new Jg(Object(r.bc)(k.b))},token:Jg,providedIn:"root"}),Object(nt.b)([Object(Cs.a)({maxCacheCount:20}),Object(nt.c)("design:type",Function),Object(nt.c)("design:paramtypes",[String,String,String]),Object(nt.c)("design:returntype",Ve.a)],Jg.prototype,"getCapabilities",null),Jg),gf=function e(){_classCallCheck(this,e)},ff=((ef=function(){function e(t){var i=this;_classCallCheck(this,e),this.config=t,(this.config.getConfig("projections")||[]).forEach((function(e){e.alias=e.alias?e.alias:e.code,i.registerProjection(e)}));for(var o=1;o<61;o++)this.registerProjection({code:o<10?"EPSG:3260"+o:"EPSG:326"+o,def:"+proj=utm +zone=".concat(o," +datum=WGS84 +units=m +no_defs"),extent:void 0});for(var n=1;n<11;n++){var r,a=n<10?"EPSG:3218"+n:"EPSG:321"+(80+n);r=Number(n)<=2?-50-3*Number(n):Number(n)>=12?-81-3*(Number(n)-12):-49.5-3*Number(n),this.registerProjection({code:a,def:"+proj=tmerc +lat_0=0 +lon_0=".concat(r,' +k=0.9999 +x_0=304800 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"'),extent:void 0})}}return _createClass(e,[{key:"registerProjection",value:function(e){Yc.a.defs(e.code,e.def),Object(Kc.a)(Yc.a),e.extent&&Object(kc.j)(e.code).setExtent(e.extent)}}]),e}()).\u0275fac=function(e){return new(e||ef)(r.bc(ie))},ef.\u0275prov=Object(r.Nb)({factory:function(){return new ef(Object(r.bc)(ie))},token:ef,providedIn:"root"}),ef),mf=((Qg=function(){function e(t,i,o,n,r,a,s){_classCallCheck(this,e),this.capabilitiesService=t,this.optionsService=i,this.wfsDataSourceService=o,this.languageService=n,this.messageService=r,this.projectionService=a,this.authInterceptor=s,this.datasources$=new L.a([])}return _createClass(e,[{key:"createAsyncDataSource",value:function(e){if(!e.type)throw console.error(e),new Error("Datasource needs a type");var t;switch(e.type.toLowerCase()){case"osm":t=this.createOSMDataSource(e);break;case"vector":t=this.createFeatureDataSource(e);break;case"wfs":t=this.createWFSDataSource(e);break;case"wms":var i=e;E.removeDuplicateCaseInsensitive(i.params),t=this.createWMSDataSource(i);break;case"wmts":t=this.createWMTSDataSource(e);break;case"xyz":t=this.createXYZDataSource(e);break;case"carto":t=this.createCartoDataSource(e);break;case"arcgisrest":t=this.createArcGISRestDataSource(e);break;case"websocket":t=this.createWebSocketDataSource(e);break;case"mvt":t=this.createMVTDataSource(e);break;case"tilearcgisrest":t=this.createTileArcGISRestDataSource(e);break;case"cluster":t=this.createClusterDataSource(e);break;default:throw console.error(e),new Error("Invalid datasource type")}return this.datasources$.next(this.datasources$.value.concat([t])),t}},{key:"createOSMDataSource",value:function(e){return new Ve.a((function(t){return t.next(new Ag(e))}))}},{key:"createFeatureDataSource",value:function(e){return new Ve.a((function(t){return t.next(new Pg(e))}))}},{key:"createWebSocketDataSource",value:function(e){return new Ve.a((function(t){return t.next(new af(e))}))}},{key:"createWFSDataSource",value:function(e){var t=this;return new Ve.a((function(i){return i.next(new zg(e,t.wfsDataSourceService,t.authInterceptor))}))}},{key:"createWMSDataSource",value:function(e){var t=this,i=[];return e.optionsFromCapabilities&&i.push(this.capabilitiesService.getWMSOptions(e).pipe(Object(C.a)((function(i){var o=t.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),n=t.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.params.LAYERS});throw t.messageService.error(n,o),i})))),this.optionsService&&!0===e.optionsFromApi&&i.push(this.optionsService.getWMSOptions(e).pipe(Object(C.a)((function(e){return e.error.toDisplay=!0,e.error.title=t.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=t.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),Object(F.a)({})})))),i.push(Object(F.a)(e)),Object(hc.a)(i).pipe(Object(w.a)((function(e){var i=e.reduce((function(e,t){return E.mergeDeep(e,t)}));return new Kg(i,t.wfsDataSourceService)})),Object(C.a)((function(){return Object(F.a)(void 0)})))}},{key:"createWMTSDataSource",value:function(e){var t=this;return e.optionsFromCapabilities?this.capabilitiesService.getWMTSOptions(e).pipe(Object(w.a)((function(e){return e?new tf(e):void 0})),Object(C.a)((function(){var i=t.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),o=t.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.layer});return t.messageService.error(o,i),Object(F.a)(void 0)}))):new Ve.a((function(t){return t.next(new tf(e))}))}},{key:"createXYZDataSource",value:function(e){return new Ve.a((function(t){return t.next(new jg(e))}))}},{key:"createCartoDataSource",value:function(e){return e.mapId?this.capabilitiesService.getCartoOptions(e).pipe(Object(w.a)((function(e){return new of(e)}))):new Ve.a((function(t){return t.next(new of(e))}))}},{key:"createArcGISRestDataSource",value:function(e){return this.capabilitiesService.getArcgisOptions(e).pipe(Object(w.a)((function(e){return new nf(e)})))}},{key:"createTileArcGISRestDataSource",value:function(e){return this.capabilitiesService.getTileArcgisOptions(e).pipe(Object(w.a)((function(e){return new rf(e)})))}},{key:"createMVTDataSource",value:function(e){return new Ve.a((function(t){return t.next(new sf(e))}))}},{key:"createClusterDataSource",value:function(e){return new Ve.a((function(t){return t.next(new cf(e))}))}}]),e}()).\u0275fac=function(e){return new(e||Qg)(r.bc(pf),r.bc(gf,8),r.bc(qg),r.bc(Le),r.bc(Ie),r.bc(ff),r.bc(Js))},Qg.\u0275prov=Object(r.Nb)({factory:function(){return new Qg(Object(r.bc)(pf),Object(r.bc)(gf,8),Object(r.bc)(qg),Object(r.bc)(Le),Object(r.bc)(Ie),Object(r.bc)(ff),Object(r.bc)(Js))},token:Qg,providedIn:"root"}),Qg),bf=function(e){return e.TITLE="title",e.ABSTRACT="abstract",e.CUSTOM="custom",e}({}),vf=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this)).loaded=0,o.loading=0,o.source=e.options.source.ol,o.id=G(),o}return _createClass(i,[{key:"watch",value:function(){var e=this;this.source.on("imageloadstart",(function(t){return e.handleLoadStart(t)})),this.source.on("imageloadend",(function(t){return e.handleLoadEnd(t)})),this.source.on("imageloaderror",(function(t){return e.handleLoadEnd(t)}))}},{key:"unwatch",value:function(){var e=this;this.source.un("imageloadstart",(function(t){return e.handleLoadStart(t)})),this.source.un("imageloadend",(function(t){return e.handleLoadEnd(t)})),this.source.un("imageloaderror",(function(t){return e.handleLoadEnd(t)}))}},{key:"handleLoadStart",value:function(e){e.image.__watchers__||(e.image.__watchers__=[]),e.image.__watchers__.push(this.id),this.loading+=1,this.status=q.Working}},{key:"handleLoadEnd",value:function(e){if(e.image.__watchers__){var t=e.image.__watchers__.indexOf(this.id);if(!(t<0)){e.image.__watchers__.splice(t,1),this.loaded+=1;var i=this.loading;this.loaded>=i&&i===this.loading&&(this.status=q.Done,this.loaded=this.loading=0)}}}}]),i}(H),yf=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this)).loaded=0,o.loading=0,o.source=e.options.source.ol,o.id=G(),o}return _createClass(i,[{key:"watch",value:function(){var e=this;this.source.on("tileloadstart",(function(t){return e.handleLoadStart(t)})),this.source.on("tileloadend",(function(t){return e.handleLoadEnd(t)})),this.source.on("tileloaderror",(function(t){return e.handleLoadEnd(t)}))}},{key:"unwatch",value:function(){var e=this;this.source.un("tileloadstart",(function(t){return e.handleLoadStart(t)})),this.source.un("tileloadend",(function(t){return e.handleLoadEnd(t)})),this.source.un("tileloaderror",(function(t){return e.handleLoadEnd(t)}))}},{key:"handleLoadStart",value:function(e){e.tile.__watchers__||(e.tile.__watchers__=[]),e.tile.__watchers__.push(this.id),this.loading+=1,this.status=q.Working}},{key:"handleLoadEnd",value:function(e){if(e.tile.__watchers__){var t=e.tile.__watchers__.indexOf(this.id);if(!(t<0)){e.tile.__watchers__.splice(t,1),this.loaded+=1;var i=this.loading;this.loaded>=i&&i===this.loading&&(this.status=q.Done,this.loaded=this.loading=0)}}}}]),i}(H),kf=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this)).loaded=0,o.loading=0,o.layer=e,o.id=G(),o}return _createClass(i,[{key:"watch",value:function(){}},{key:"unwatch",value:function(){this.layer.onUnwatch()}}]),i}(H),Sf=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o){var n;return _classCallCheck(this,i),(n=t.call(this,e,o)).authInterceptor=o,n.watcher=new vf(_assertThisInitialized(n)),n.status$=n.watcher.status$,n}return _createClass(i,[{key:"createOlLayer",value:function(){var e=this,t=Object.assign({},this.options,{source:this.options.source.ol}),i=new Zc.a(t);return this.authInterceptor&&i.getSource().setImageLoadFunction((function(t,i){e.customLoader(t,i,e.authInterceptor)})),i}},{key:"setMap",value:function(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe((function(){})),_get(_getPrototypeOf(i.prototype),"setMap",this).call(this,e)}},{key:"customLoader",value:function(e,t,i){var o=new XMLHttpRequest;if(o.open("GET",t),!i.interceptXhr(o,t))return o.abort(),void(e.getImage().src=t);o.responseType="arraybuffer",o.onload=function(){var t=new Uint8Array(this.response),i=new Blob([t],{type:"image/png"}),o=window.URL.createObjectURL(i);e.getImage().src=o},o.send()}}]),i}(Sg),Cf=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this,e)).watcher=new yf(_assertThisInitialized(o)),o.status$=o.watcher.status$,o}return _createClass(i,[{key:"createOlLayer",value:function(){var e=Object.assign({},this.options,{source:this.options.source.ol});return new Jc.a(e)}},{key:"setMap",value:function(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe((function(){})),_get(_getPrototypeOf(i.prototype),"setMap",this).call(this,e)}}]),i}(Sg),wf=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o){var n;return _classCallCheck(this,i),(n=t.call(this,e,o)).authInterceptor=o,n.watcher=new kf(_assertThisInitialized(n)),n.status$=n.watcher.status$,n}return _createClass(i,[{key:"createOlLayer",value:function(){var e=this,t=Object.assign({},this.options,{source:this.options.source.ol});this.options.animation&&this.dataSource.ol.on("addfeature",(function(e){this.flash(e.feature)}).bind(this)),this.options.trackFeature&&this.enableTrackFeature(this.options.trackFeature);var i=new Qc.a(t),o=i.getSource(),n=o.getUrl();if(n&&this.authInterceptor){var r=function(t,i,r){e.customLoader(o,n,e.authInterceptor,t,i,r)};r&&o.setLoader(r)}return i}},{key:"flash",value:function(e){var t=(new Date).getTime(),i=this.ol.on("postrender",(function(o){var n=Object(ol.a)(o),r=o.frameState,a=e.getGeometry().clone(),s=r.time-t,c=s/this.options.animation.duration,l=Object(tl.b)(1-c),u=Object(il.a)(this.options.animation.color||"red");u[3]=l;var h=this.ol.getStyleFunction().call(this,e).find((function(e){return e.getImage()}));h||(h=this.ol.getStyleFunction().call(this,e)[0]);var d=h.clone();switch(e.getGeometry().getType()){case"Point":var p=Object(tl.b)(c)*(3*d.getImage().getRadius());d.getImage().setRadius(p),d.getImage().setOpacity(l);break;case"LineString":d.getImage()&&(d.getImage().getStroke().setColor(u),d.getImage().getStroke().setWidth(Object(tl.b)(c)*(3*d.getImage().getStroke().getWidth()))),d.getStroke()&&(d.getStroke().setColor(u),d.getStroke().setWidth(Object(tl.b)(c)*(3*d.getStroke().getWidth())));break;case"Polygon":d.getImage()&&d.getImage().getFill().setColor(u),d.getFill()&&d.getFill().setColor(u)}if(d.setText(""),n.setStyle(d),n.drawGeometry(a),s>this.options.animation.duration)return Object(el.b)(i),void this.map.ol.render();this.map.ol.render()}).bind(this))}},{key:"setMap",value:function(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe((function(){})),_get(_getPrototypeOf(i.prototype),"setMap",this).call(this,e)}},{key:"onUnwatch",value:function(){this.dataSource.onUnwatch(),this.stopAnimation()}},{key:"stopAnimation",value:function(){this.dataSource.ol.un("addfeature",(function(e){this.visible&&this.flash(e.feature)}).bind(this))}},{key:"enableTrackFeature",value:function(e){this.trackFeatureListenerId=this.dataSource.ol.on("addfeature",this.trackFeature.bind(this,e))}},{key:"centerMapOnFeature",value:function(e){var t=this.dataSource.ol.getFeatureById(e);t&&this.map.ol.getView().setCenter(t.getGeometry().getCoordinates())}},{key:"trackFeature",value:function(e,t){t.feature.getId()===e&&this.visible&&this.centerMapOnFeature(e)}},{key:"disableTrackFeature",value:function(e){Object(el.b)(this.trackFeatureListenerId)}},{key:"customLoader",value:function(e,t,i,o,n,r){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(o,n,r):t),i.interceptXhr(a);var s=function(){return e.removeLoadedExtent(o)};a.onerror=s,a.onload=function(){200===a.status?e.addFeatures(e.getFormat().readFeatures(a.responseText)):s()},a.send()}},{key:"browsable",get:function(){return!1!==this.options.browsable}},{key:"exportable",get:function(){return!1!==this.options.exportable}}]),i}(Sg),xf=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o){var n;return _classCallCheck(this,i),(n=t.call(this,e,o)).authInterceptor=o,n.watcher=new yf(_assertThisInitialized(n)),n.status$=n.watcher.status$,n}return _createClass(i,[{key:"createOlLayer",value:function(){var e=this,t=Object.assign({},this.options,{source:this.options.source.ol}),i=new nl.a(t),o=i.getSource();return this.authInterceptor&&o.setTileLoadFunction((function(t,i){var o=e.customLoader(i,t.getFormat(),e.authInterceptor,t.onLoad.bind(t));o&&t.setLoader(o)})),i}},{key:"customLoader",value:function(e,t,i,o,n){var r=this;return function(a,s,c){var l=new XMLHttpRequest;l.open("GET","function"==typeof e?e(a,s,c):e),i.interceptXhr(l),"arraybuffer"===t.getType()&&(l.responseType="arraybuffer"),l.onload=function(e){if(!l.status||l.status>=200&&l.status<300){var i,s=t.getType();"json"===s||"text"===s?i=l.responseText:"xml"===s?(i=l.responseXML)||(i=(new DOMParser).parseFromString(l.responseText,"application/xml")):"arraybuffer"===s&&(i=l.response),i?o.call(r,t.readFeatures(i,{extent:a,featureProjection:c}),t.readProjection(i)):n.call(r)}else n.call(r)},l.onerror=function(){n.call(r)},l.send()}}}]),i}(Sg);function Of(){var e,t,i,o,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.text,a=n.opacity,s=void 0===a?1:a,c=n.color,l=void 0===c?"blue":c,u=n.outlineColor,h=/msie\s|trident\/|edge\//i.test(window.navigator.userAgent);switch(l){case"blue":t='"rgb(0,161,222)"',e=l;break;case"red":t='"rgb(246,65,57)"',e=l;break;case"yellow":t='"rgb(255,215,0)"',e=l;break;case"green":t='"rgb(0,128,0)"',e=l;break;default:t='"rgb(0,161,222)"',e="blue"}if(u){switch(u instanceof Array&&(i="rgb("+u[0]+","+u[1]+","+u[2]+")"),u){case"blue":i="rgb(0,161,222)";break;case"red":i="rgb(246,65,57)";break;case"yellow":i="rgb(255,215,0)";break;case"green":i="rgb(0,128,0)"}o='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" height="36" width="36" viewBox="0 0 36 36"><path fill='+t+' stroke="'+i+'" stroke-width="2" d="M 17.692635,32.565644 C 15.71852,30.330584 13.290925,27.058065 11.6766,24.455732 9.3398623,20.688851 7.8905694,17.205334 7.6297492,14.728733 7.5616025,14.081649 7.5739557,12.528552 7.6513363,12.014724 8.1013861,9.0262716 9.8047068,6.3655569 12.310675,4.7364878 c 1.113691,-0.7239832 2.508083,-1.2834131 3.776687,-1.5152052 0.242945,-0.044389 0.451656,-0.09393 0.463804,-0.1100911 0.01215,-0.016161 0.638282,-0.025502 1.391411,-0.02076 1.088235,0.00685 1.450932,0.024316 1.766871,0.085071 2.650763,0.5097353 4.947142,1.8701891 6.498786,3.8501033 0.628018,0.8013587 1.297046,2.0200608 1.640967,2.9891872 0.191065,0.538399 0.427644,1.447408 0.477391,1.834287 0.0164,0.127546 0.0434,0.231902 0.06,0.231902 0.0166,0 0.03122,0.626135 0.03249,1.391411 0.0013,0.765276 -0.011,1.391411 -0.02726,1.391411 -0.01626,0 -0.05449,0.154049 -0.08495,0.342331 -0.08815,0.544879 -0.387235,1.721449 -0.604837,2.379406 -1.209421,3.656888 -4.014463,8.349762 -7.849521,13.132357 -0.790496,0.985807 -1.795217,2.167992 -1.842543,2.167992 -0.01896,0 -0.161766,-0.144111 -0.317336,-0.320246 z m 1.066937,-15.36525 c 0.133519,-0.02121 0.248766,-0.05657 0.256105,-0.07859 0.0073,-0.02202 0.04918,-0.03066 0.09298,-0.0192 0.0438,0.01145 0.107628,-0.0072 0.141834,-0.04137 0.03421,-0.03421 0.08456,-0.05474 0.111888,-0.04563 0.02733,0.0091 0.07703,-0.01077 0.110429,-0.04417 0.03341,-0.03341 0.08416,-0.05293 0.112796,-0.04338 0.02863,0.0095 0.08974,-0.01867 0.135802,-0.06271 0.04606,-0.04403 0.111902,-0.08625 0.146319,-0.09381 0.204084,-0.04483 0.762371,-0.519108 1.079463,-0.917027 0.26749,-0.335672 0.570987,-0.878795 0.529019,-0.946701 -0.01496,-0.0242 -0.0067,-0.044 0.01835,-0.044 0.05645,0 0.196809,-0.467982 0.158801,-0.529481 -0.01521,-0.02461 -0.0043,-0.04475 0.02427,-0.04475 0.03157,0 0.04365,-0.04329 0.03082,-0.11043 -0.01161,-0.06074 -0.0066,-0.110429 0.01124,-0.110429 0.01779,0 0.03235,-0.258405 0.03235,-0.574233 0,-0.315829 -0.01545,-0.574234 -0.03434,-0.574234 -0.01889,0 -0.02437,-0.03811 -0.01219,-0.08469 0.04412,-0.168712 -0.336329,-1.152668 -0.481536,-1.245401 -0.02327,-0.01486 -0.04022,-0.03992 -0.03765,-0.05568 0.01222,-0.07498 -0.156557,-0.318365 -0.406379,-0.586027 -0.295921,-0.317054 -0.773059,-0.690104 -0.83427,-0.652274 -0.0206,0.01273 -0.03745,0.0024 -0.03745,-0.02289 0,-0.06107 -0.433076,-0.2789369 -0.487546,-0.245273 -0.02338,0.01445 -0.04251,0.0068 -0.04251,-0.01695 0,-0.056281 -0.393995,-0.1865457 -0.613804,-0.2029397 -0.0943,-0.00703 -0.188579,-0.023183 -0.209503,-0.035888 -0.02092,-0.012705 -0.276571,-0.023337 -0.568105,-0.023627 -0.534044,-5.301e-4 -1.12638,0.091025 -1.12638,0.1741017 0,0.023781 -0.01713,0.032648 -0.03808,0.019705 -0.05054,-0.031232 -0.403641,0.1088602 -0.403641,0.1601422 0,0.02204 -0.01988,0.02779 -0.04417,0.01278 -0.0243,-0.01501 -0.04417,-0.0051 -0.04417,0.02209 0,0.02716 -0.01988,0.0371 -0.04417,0.02209 -0.0243,-0.01501 -0.04417,-0.0051 -0.04417,0.02209 0,0.02716 -0.01915,0.03755 -0.04256,0.02308 -0.02341,-0.01447 -0.08138,0.01252 -0.128834,0.05997 -0.04745,0.04745 -0.0974,0.07515 -0.111001,0.06155 -0.0136,-0.0136 -0.03722,0.0078 -0.05248,0.0476 -0.01526,0.03978 -0.0411,0.06408 -0.0574,0.054 -0.03277,-0.02025 -0.462299,0.323995 -0.491977,0.394291 -0.01026,0.02429 -0.07454,0.0912 -0.142856,0.148686 -0.248033,0.208705 -0.730279,0.974169 -0.672565,1.067553 0.0145,0.02346 0.0059,0.04266 -0.01914,0.04266 -0.05907,0 -0.241471,0.599428 -0.208527,0.685278 0.01385,0.0361 0.0044,0.06564 -0.02098,0.06564 -0.02539,0 -0.04169,0.0646 -0.03622,0.143558 0.0055,0.07896 -0.0042,0.213129 -0.02144,0.29816 -0.04741,0.233576 0.0511,1.055502 0.167516,1.397721 0.126048,0.370516 0.310099,0.740163 0.426484,0.856548 0.04776,0.04776 0.07554,0.08684 0.06174,0.08684 -0.0138,0 0.01516,0.05653 0.06436,0.125632 0.131301,0.184396 0.499365,0.587266 0.518785,0.567846 0.0092,-0.0092 0.09821,0.06081 0.197812,0.155562 0.09961,0.09475 0.190589,0.162786 0.202187,0.151188 0.0116,-0.0116 0.05991,0.01774 0.107361,0.06519 0.04745,0.04745 0.105426,0.07444 0.128834,0.05997 0.02341,-0.01447 0.04256,-0.0057 0.04256,0.01958 0,0.06106 0.344664,0.23496 0.399061,0.201341 0.02346,-0.0145 0.04266,-0.0059 0.04266,0.01914 0,0.05907 0.599429,0.241471 0.685279,0.208527 0.0361,-0.01385 0.06564,-0.0065 0.06564,0.01645 0,0.05196 1.079115,0.04833 1.413314,-0.0048 z"></path></svg>'}return new Uc.Style(h?{image:new Uc.Icon({src:"./assets/igo2/geo/icons/place_"+e+"_36px.svg",opacity:s,imgSize:[36,36],anchor:[.5,.92]}),text:new Uc.Text({text:r,font:"12px Calibri,sans-serif",fill:new Uc.Fill({color:"#000"}),stroke:new Uc.Stroke({color:"#fff",width:3}),overflow:!0})}:{image:new Uc.Icon({src:o?"data:image/svg+xml;utf8,"+o:"./assets/igo2/geo/icons/place_"+e+"_36px.svg",opacity:s,imgSize:[36,36],anchor:[.5,.92]}),text:new Uc.Text({text:r,font:"12px Calibri,sans-serif",fill:new Uc.Fill({color:"#000"}),stroke:new Uc.Stroke({color:"#fff",width:3}),overflow:!0})})}var If,Lf,Tf=((Lf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"createStyle",value:function(e){return e?"function"==typeof e||e instanceof Uc.Style?e:this.parseStyle("style",e):Of()}},{key:"parseStyle",value:function(e,t){var i=this,o={},n=this.getOlCls(e);return n&&t instanceof Object?(Object.keys(t).forEach((function(e){var n=i.getOlKey(e);o[n]=i.parseStyle(e,t[e])})),new n(o)):t}},{key:"getOlKey",value:function(e){var t;switch(e.toLowerCase()){case"circle":case"regularshape":case"icon":t="image"}return t||e}},{key:"getOlCls",value:function(e){var t=Uc[e.charAt(0).toUpperCase()+e.slice(1)];return"regularshape"===e&&(t=Uc.RegularShape),"backgroundFill"===e&&(t=Uc.Fill),"backgroundStroke"===e&&(t=Uc.Stroke),t}},{key:"createStyleByAttribute",value:function(e,t){var i=t.type,o=t.attribute,n=t.data,r=t.stroke,a=t.width,s=t.fill,c=t.radius,l=t.icon,u=t.scale,h=n.length,d=t.label.attribute||t.label,p=this.parseStyle("text",t.label.style)||new Uc.Text;p.setText(this.getLabel(e,d));var g=t.baseStyle;if("circle"===i){for(var f=0;f<h;f++){var m=void 0!==e.get(o)?e.get(o):"";if(m===n[f]||m.toString().match(n[f]))return l?[new Uc.Style({image:new Uc.Icon({src:l[f],scale:u?u[f]:1})})]:[new Uc.Style({image:new Uc.Circle({radius:c?c[f]:4,stroke:new Uc.Stroke({color:r?r[f]:"black",width:a?a[f]:1}),fill:new Uc.Fill({color:s?s[f]:"black"})}),text:p})]}if(!e.getStyle())return[new Uc.Style({image:new Uc.Circle({radius:4,stroke:new Uc.Stroke({color:"black"}),fill:new Uc.Fill({color:"#bbbbf2"})})})]}else if("regular"===i){for(var b=0;b<h;b++){var v=void 0!==e.get(o)?e.get(o):"";if(v===n[b]||v.toString().match(n[b]))return[new Uc.Style({stroke:new Uc.Stroke({color:r?r[b]:"black",width:a?a[b]:1}),fill:new Uc.Fill({color:s?s[b]:"rgba(255,255,255,0.4)"}),text:p})]}if(e instanceof Vc.a&&!e.getStyle())return g?this.createStyle(g):[new Uc.Style({stroke:new Uc.Stroke({color:"black"}),fill:new Uc.Fill({color:"#bbbbf2"})})]}}},{key:"createClusterStyle",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0,n=e.get("features").length;if(1!==n){if(i.clusterRanges){var r,a=_createForOfIteratorHelper(i.clusterRanges);try{for(a.s();!(r=a.n()).done;){var s=r.value;if((!s.minRadius||s.minRadius<=n)&&(!s.maxRadius||s.maxRadius>=n)){if(t=this.createStyle(s.style),s.showRange){var c=new Uc.Text({text:n.toString(),fill:new Uc.Fill({color:"#fff"})});t.setText(c)}if(s.dynamicRadius){var l=void 0,u=t.image_.getRadius();(l=5*Math.log(n))<u&&(l=u),t.image_.setRadius(l)}break}}}catch(p){a.e(p)}finally{a.f()}}if(!t){var h;if(i.radiusCalc)h=i.radiusCalc(n);else{var d=6;(h=5*Math.log(n))<d&&(h=d)}t=[new Uc.Style({image:new Uc.Circle({radius:h,opacity:.4,stroke:new Uc.Stroke({color:"black"}),fill:new Uc.Fill({color:"rgba(24, 134, 45, 0.5)"})}),text:new Uc.Text({text:n.toString(),fill:new Uc.Fill({color:"#fff"})})})]}}else t=this.createStyle(o);return t}},{key:"getLabel",value:function(e,t){var i=t,o=Array.from(t.matchAll(/\$\{([^\{\}]+)\}/g));return o.forEach((function(t){i=i.replace(t[0],e.get(t[1]))})),0===o.length&&i===t&&(i=e.get(t)||t),i}}]),e}()).\u0275fac=function(e){return new(e||Lf)},Lf.\u0275prov=Object(r.Nb)({factory:function(){return new Lf},token:Lf,providedIn:"root"}),Lf),Ff=((If=function(){function e(t,i,o,n){_classCallCheck(this,e),this.http=t,this.styleService=i,this.dataSourceService=o,this.authInterceptor=n}return _createClass(e,[{key:"createLayer",value:function(e){if(e.source){var t;switch(e.source.options&&e.source.options._layerOptionsFromSource&&(e=E.mergeDeep(e.source.options._layerOptionsFromSource,e||{})),e.source.constructor){case Ag:case tf:case jg:case of:case rf:t=this.createTileLayer(e);break;case Pg:case zg:case nf:case af:case cf:t=this.createVectorLayer(e);break;case Kg:t=this.createImageLayer(e);break;case sf:t=this.createVectorTileLayer(e)}return t}}},{key:"createAsyncLayer",value:function(e){var t=this;return e.source?new Ve.a((function(i){return i.next(t.createLayer(e))})):this.dataSourceService.createAsyncDataSource(e.sourceOptions).pipe(Object(w.a)((function(i){if(void 0!==i)return t.createLayer(Object.assign(e,{source:i}))})))}},{key:"createImageLayer",value:function(e){return new Sf(e,this.authInterceptor)}},{key:"createTileLayer",value:function(e){return new Cf(e)}},{key:"createVectorLayer",value:function(e){var t,i;if(void 0!==e.style&&(t=this.styleService.createStyle(e.style)),e.source instanceof nf)t=e.source.options.params.style;else if(e.styleByAttribute){var o=this.styleService;e.style=function(t){return o.createStyleByAttribute(t,e.styleByAttribute)},i=new wf(e,this.authInterceptor)}if(e.source instanceof cf){var n=this.styleService,r=e.clusterBaseStyle;e.style=function(t){return n.createClusterStyle(t,e.clusterParam,r)},i=new wf(e,this.authInterceptor)}var a=Object.assign({},e,{style:t});return i||(i=new wf(a,this.authInterceptor)),this.applyMapboxStyle(i,a),i}},{key:"createVectorTileLayer",value:function(e){var t,i;if(void 0!==e.style&&(t=this.styleService.createStyle(e.style)),e.styleByAttribute){var o=this.styleService;e.style=function(t){return o.createStyleByAttribute(t,e.styleByAttribute)},i=new xf(e,this.authInterceptor)}var n=Object.assign({},e,{style:t});return i||(i=new xf(n,this.authInterceptor)),this.applyMapboxStyle(i,n),i}},{key:"applyMapboxStyle",value:function(e,t){t.mapboxStyle&&this.getMapboxGlStyle(t.mapboxStyle.url).subscribe((function(i){Object(Cc.a)(e.ol,i,t.mapboxStyle.source)}))}},{key:"getMapboxGlStyle",value:function(e){return this.http.get(e).pipe(Object(w.a)((function(e){return e})),Object(C.a)((function(e){return console.log("No style was found"),Object(F.a)(e)})))}}]),e}()).\u0275fac=function(e){return new(e||If)(r.bc(k.b),r.bc(Tf),r.bc(mf),r.bc(Js,8))},If.\u0275prov=Object(r.Nb)({factory:function(){return new If(Object(r.bc)(k.b),Object(r.bc)(Tf),Object(r.bc)(mf),Object(r.bc)(Js,8))},token:If,providedIn:"root"}),If),_f="Feature",Mf=function(e){return e[e.None=0]="None",e[e.Move=1]="Move",e[e.Zoom=2]="Zoom",e[e.Default=3]="Default",e}({});function Df(e,t,i){i=i||Ki;var o=(new fl.a).readFeature(e,{dataProjection:e.projection,featureProjection:t});o.setId(i(e));var n=Zi(e);void 0!==n&&o.set("_title",n,!0),void 0!==e.extent&&o.set("_extent",e.extent,!0),void 0!==e.projection&&o.set("_projection",e.projection,!0);var r=Yi(e,"meta.mapTitle");void 0!==r&&o.set("_mapTitle",r,!0),o.set("_entityRevision",(e.meta||{}).revision||0,!0);var a=Ji(e);return void 0!==a&&o.set("_icon",a,!0),e.meta&&e.meta.style&&o.set("_style",e.meta.style,!0),e.sourceId&&o.set("_sourceId",e.sourceId,!0),o}function Pf(e,t,i){var o,n,r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"EPSG:4326",s=new fl.a,c=e.getKeys().filter((function(e){return!e.startsWith("_")&&"geometry"!==e})).reduce((function(t,i){return t[i]=e.get(i),t}),{}),l=s.writeGeometryObject(e.getGeometry(),{dataProjection:a,featureProjection:t});i?(o=i.get("title"),i.get("sourceOptions")&&(n=i.get("sourceOptions").excludeAttribute,r=i.get("sourceOptions").excludeAttributeOffline)):o=e.get("_title");var u=e.get("_mapTitle"),h=e.getId()?e.getId():G();return{type:_f,projection:a,extent:e.get("_extent"),meta:{id:h,title:o||u||h,mapTitle:u,revision:e.getRevision(),style:e.get("_style"),excludeAttribute:n,excludeAttributeOffline:r},properties:c,geometry:l,ol:e}}function Af(e,t){var i=_slicedToArray(Object(Wc.C)(e),2),o=i[0],n=i[1];return[t[3]?e[0]-o*t[3]:e[0],t[2]?e[1]-n*t[2]:e[1],t[1]?e[2]+o*t[1]:e[2],t[0]?e[3]+n*t[0]:e[3]]}function jf(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Mf.Default,o=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,r=function(e,t){var i=Object(Wc.j)();return t.forEach((function(t){var o=function(e,t){var i=Object(Wc.j)(),o=t.get("_extent"),n=t.get("_projection");if(void 0!==o&&void 0!==n)i=Object(kc.s)(o,n,e.projection);else{var r=t.getGeometry();null!==r&&(i=r.getExtent())}return i}(e,t);Object(Wc.q)(i,o)})),i}(e,t),a=r;void 0!==o&&(a=Af(a,o)),i===Mf.Zoom?e.viewController.zoomToExtent(a):i===Mf.Move?e.viewController.moveToExtent(a):i===Mf.Default&&(function(e,t){var i=Af(e.viewController.getExtent(),[-1,-1,-1,-1].map((function(e){return.05*e})));return!Object(Wc.g)(i,t)}(e,r)||function(e,t,i){i=i||.004;var o=e.viewController.getExtent(),n=Object(Wc.u)(o),r=Object(Wc.u)(t);return!(0===r&&e.viewController.getZoom()>13)&&r/n<i}(e,r,n))&&e.viewController.zoomToExtent(a)}function Rf(e,t){void 0===e.layer?(t=t||new wf({source:new Pg}),e.bindLayer(t),void 0===e.layer.map&&e.map.addLayer(e.layer)):void 0===e.layer.map&&e.map.addLayer(e.layer)}var $f=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o){var n;return _classCallCheck(this,i),(n=t.call(this,e,o)).map=o.map,n}return _createClass(i,[{key:"bindLayer",value:function(e){return this.layer=e,this}},{key:"setLayerFeatures",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mf.Default,o=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;r=r||Ki,this.checkLayer();var a=e.map((function(e){return Df(e,t.map.projection,r)}));this.setLayerOlFeatures(a,i,o,n)}},{key:"setStoreOlFeatures",value:function(e){var t=this;this.checkLayer();var i=e.map((function(e){return e.set("_featureStore",t,!0),Pf(e,t.layer.map.projection)}));this.load(i)}},{key:"clearLayer",value:function(){this.checkLayer(),this.source.ol.clear()}},{key:"checkLayer",value:function(){if(void 0===this.layer)throw new Error("This FeatureStore is not bound to a layer.")}},{key:"setLayerOlFeatures",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mf.Default,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,n=function(e,t){var i=new Map;t.forEach((function(e){i.set(e.getId(),e)}));var o=[];e.forEach((function(e){var t=i.get(e.getId());void 0===t||t.get("_entityRevision")!==e.get("_entityRevision")?o.push(e):i.delete(t.getId())}));var n=Array.from(i.keys());return{add:t.filter((function(e){return n.indexOf(e.getId())>=0})),remove:o}}(this.layer.ol.getSource().getFeatures(),e);n.remove.length>0&&this.removeOlFeaturesFromLayer(n.remove),n.add.length>0&&this.addOlFeaturesToLayer(n.add),n.add.length>0?jf(this.map,n.add,t,i,o):n.remove.length>0&&jf(this.map,e,t,i,o)}},{key:"addOlFeaturesToLayer",value:function(e){var t=this;e.forEach((function(e){e.set("_featureStore",t,!0)})),this.source.ol.addFeatures(e)}},{key:"removeOlFeaturesFromLayer",value:function(e){var t=this;e.forEach((function(e){t.source.ol.removeFeature(e)}))}},{key:"source",get:function(){return this.layer?this.layer.dataSource:void 0}}]),i}(hn),Ef=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this,e)).options=e,o.stores$$=new Map,o.states$$=[],o}return _createClass(i,[{key:"bindStore",value:function(e){var t=this;_get(_getPrototypeOf(i.prototype),"bindStore",this).call(this,e),!0===this.active&&this.watchStore(e),this.empty$$=e.empty$.pipe(Object(mc.a)((function(e){return!e}))).subscribe((function(){return t.updateEntitiesInExtent(e)}))}},{key:"unbindStore",value:function(e){_get(_getPrototypeOf(i.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.unwatchStore(e)}},{key:"doActivate",value:function(){var e=this;this.stores.forEach((function(t){return e.watchStore(t)}))}},{key:"doDeactivate",value:function(){this.unwatchAll()}},{key:"watchStore",value:function(e){var t=this;this.stores$$.has(e)||(this.updateEntitiesInExtent(e),this.states$$.push(e.layer.map.viewController.state$.subscribe((function(){t.updateEntitiesInExtent(e)}))))}},{key:"updateEntitiesInExtent",value:function(e){e.state.updateAll({inMapExtent:!1});var t=e.layer.map.viewController.getExtent(),i=e.entities$.value.filter((function(e){return Object(Wc.G)(e.ol.getGeometry().getExtent(),t)}));i.length>0&&e.state.updateMany(i,{inMapExtent:!0},!0)}},{key:"unwatchStore",value:function(e){var t=this.stores$$.get(e);void 0!==t&&(Object(el.b)(t),this.stores$$.delete(e))}},{key:"unwatchAll",value:function(){Array.from(this.stores$$.entries()).forEach((function(e){Object(el.b)(e[1])})),this.stores$$.clear(),this.states$$.map((function(e){return e.unsubscribe()})),this.empty$$&&this.empty$$.unsubscribe()}}]),i}(pn),Wf=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this,e)).options=e,o.stores$$=new Map,o.setMotion(e.motion),o}return _createClass(i,[{key:"bindStore",value:function(e){_get(_getPrototypeOf(i.prototype),"bindStore",this).call(this,e),!0===this.active&&this.watchStore(e)}},{key:"unbindStore",value:function(e){_get(_getPrototypeOf(i.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.unwatchStore(e)}},{key:"setMotion",value:function(e){this.motion=e}},{key:"doActivate",value:function(){var e=this;this.stores.forEach((function(t){return e.watchStore(t)}))}},{key:"doDeactivate",value:function(){this.unwatchAll()}},{key:"watchStore",value:function(e){var t=this;if(!this.stores$$.has(e)){var i=e.view.all$().subscribe((function(i){return t.onFeaturesChange(i,e)}));this.stores$$.set(e,i)}}},{key:"unwatchStore",value:function(e){var t=this.stores$$.get(e);void 0!==t&&(t.unsubscribe(),this.stores$$.delete(e))}},{key:"unwatchAll",value:function(){Array.from(this.stores$$.entries()).forEach((function(e){e[1].unsubscribe()})),this.stores$$.clear()}},{key:"onFeaturesChange",value:function(e,t){0===e.length?t.clearLayer():t.setLayerFeatures(e,this.selectMotion(t),this.options.viewScale,this.options.areaRatio,this.options.getFeatureId)}},{key:"selectMotion",value:function(e){return void 0!==this.motion?this.motion:!0===e.pristine||e.count>e.view.count?Mf.Default:Mf.None}}]),i}(pn),Xf=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this,e)).options=e,o.stores$$=new Map,o}return _createClass(i,[{key:"bindStore",value:function(e){_get(_getPrototypeOf(i.prototype),"bindStore",this).call(this,e),!0===this.active&&this.watchStore(e)}},{key:"unbindStore",value:function(e){_get(_getPrototypeOf(i.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.unwatchStore(e)}},{key:"doActivate",value:function(){var e=this;this.stores.forEach((function(t){return e.watchStore(t)}))}},{key:"doDeactivate",value:function(){this.unwatchAll()}},{key:"watchStore",value:function(e){var t=this;this.stores$$.has(e)||(this.onSourceChanges(e),e.layer.ol.getSource().on("change",(function(i){t.onSourceChanges(e)})))}},{key:"unwatchStore",value:function(e){var t=this.stores$$.get(e);void 0!==t&&(Object(el.b)(t),this.stores$$.delete(e))}},{key:"unwatchAll",value:function(){Array.from(this.stores$$.entries()).forEach((function(e){Object(el.b)(e[1])})),this.stores$$.clear()}},{key:"onSourceChanges",value:function(e){var t=e.layer.ol.getSource().getFeatures();e.layer.dataSource instanceof cf&&(t=t.flatMap((function(e){return e.get("features")}))),0===t.length?e.clear():e.setStoreOlFeatures(t)}}]),i}(pn),Gf=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){return _classCallCheck(this,i),t.call(this,e)}return i}(ml.a),Bf=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this,e)).options=e,o.setMotion(e.motion),o._overlayStore=o.createOverlayStore(),o}return _createClass(i,[{key:"bindStore",value:function(e){_get(_getPrototypeOf(i.prototype),"bindStore",this).call(this,e),!0===this.active&&this.activate()}},{key:"unbindStore",value:function(e){_get(_getPrototypeOf(i.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.activate()}},{key:"setMotion",value:function(e){this.motion=e}},{key:"unselectAll",value:function(){this.stores.forEach((function(e){e.state.updateAll({selected:!1})}))}},{key:"clear",value:function(){this.overlayStore.source.ol.clear(),this.overlayStore.clear()}},{key:"deactivateSelection",value:function(){this.unlistenToMapClick(),this.removeDragBoxInteraction(),this.unwatchAll()}},{key:"doActivate",value:function(){this.addOverlayLayer(),this.listenToMapClick(),!0===this.options.dragBox&&this.addDragBoxInteraction(),this.watchAll()}},{key:"doDeactivate",value:function(){this.deactivateSelection(),this.removeOverlayLayer()}},{key:"watchAll",value:function(){var e=this;this.unwatchAll();var t=this.stores.map((function(e){return e.stateView.manyBy$((function(e){return!0===e.state.selected})).pipe(Object(w.a)((function(e){return e.map((function(e){return e.entity}))})))}));this.stores$$=Object(_.a)(t).pipe(Object(O.a)(5),Object(ze.a)(1),Object(w.a)((function(e){return e.reduce((function(e,t){return e.concat(t)}))}))).subscribe((function(t){return e.onSelectFromStore(t)}))}},{key:"unwatchAll",value:function(){void 0!==this.stores$$&&this.stores$$.unsubscribe()}},{key:"listenToMapClick",value:function(){var e=this;this.mapClickListener=this.map.ol.on("singleclick",(function(t){e.onMapClick(t)}))}},{key:"unlistenToMapClick",value:function(){void 0!==this.mapClickListener&&this.map.ol.un(this.mapClickListener.type,this.mapClickListener.listener)}},{key:"onMapClick",value:function(e){var t=this,i=!mg(e),o=!i,n=e.map.getFeaturesAtPixel(e.pixel,{hitTolerance:this.options.hitTolerance||0,layerFilter:function(e){return void 0!==t.stores.find((function(t){return t.layer.ol===e}))}});this.onSelectFromMap(n,i,o)}},{key:"addDragBoxInteraction",value:function(){var e,t,i=this,o=_createForOfIteratorHelper(this.map.ol.getInteractions().getArray());try{for(o.s();!(t=o.n()).done;){var n=t.value;if(n instanceof Gf){e=n;break}}}catch(r){o.e(r)}finally{o.f()}void 0===e&&(e=new Gf({condition:mg}),this.map.ol.addInteraction(e),this.olDragSelectInteraction=e),this.olDragSelectInteractionEndKey=e.on("boxend",(function(e){return i.onDragBoxEnd(e)}))}},{key:"removeDragBoxInteraction",value:function(){void 0!==this.olDragSelectInteractionEndKey&&Object(el.b)(this.olDragSelectInteractionEndKey),void 0!==this.olDragSelectInteraction&&this.map.ol.removeInteraction(this.olDragSelectInteraction),this.olDragSelectInteraction=void 0}},{key:"onDragBoxEnd",value:function(e){var t=!mg(e.mapBrowserEvent),i=e.target.getGeometry().getExtent(),o=this.stores.reduce((function(e,t){var o=t.layer.ol.getSource();return e.push.apply(e,_toConsumableArray(o.getFeaturesInExtent(i))),e}),[]);this.onSelectFromMap(o,t,!1)}},{key:"onSelectFromStore",value:function(e){var t,i=this.motion,o=this.overlayStore.layer.ol.getSource().getFeatures().map((function(e){return e.getId()})),n=e.map(this.overlayStore.getKey);t=0!==e.length&&(o.length!==n.length||!o.every((function(e){return n.indexOf(e)>=0}))),this.overlayStore.setLayerFeatures(e,t?i:Mf.None,this.options.viewScale,this.options.areaRatio,this.options.getFeatureId)}},{key:"onSelectFromMap",value:function(e,t,i){var o=this,n=this.groupFeaturesByStore(e);this.stores.forEach((function(e){var r=n.get(e);void 0===r&&!0===t?o.unselectAllFeaturesFromStore(e):void 0===r&&!1===t||o.selectFeaturesFromStore(e,r,t,i)}))}},{key:"selectFeaturesFromStore",value:function(e,t,i,o){!0===o?e.state.reverseMany(t,["selected"]):e.state.updateMany(t,{selected:!0},i)}},{key:"unselectAllFeaturesFromStore",value:function(e){e.state.updateAll({selected:!1})}},{key:"groupFeaturesByStore",value:function(e){var t=new Map;return null==e||e.forEach((function(e){var i=e.get("_featureStore");if(void 0!==i){var o=t.get(i);void 0===o&&(o=[],t.set(i,o));var n=i.get(e.getId());void 0!==n&&o.push(n)}})),t}},{key:"createOverlayStore",value:function(){var e=this.options.layer?this.options.layer:this.createOverlayLayer();return new $f([],{map:this.map}).bindLayer(e)}},{key:"createOverlayLayer",value:function(){return new wf({zIndex:300,source:new Pg,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1})}},{key:"addOverlayLayer",value:function(){void 0===this.overlayStore.layer.map&&this.map.addLayer(this.overlayStore.layer)}},{key:"removeOverlayLayer",value:function(){this.overlayStore.source.ol.clear(),this.map.removeLayer(this.overlayStore.layer)}},{key:"map",get:function(){return this.options.map}},{key:"overlayStore",get:function(){return this._overlayStore}}]),i}(pn);function Vf(e,t){void 0===e.getStrategyOfType(Wf)?(t=t||new Wf({}),e.addStrategy(t),t.activate()):e.activateStrategyOfType(Wf)}var Nf,zf,qf,Hf,Uf,Yf,Kf,Zf=function(){function e(t){var i,o,n,r;_classCallCheck(this,e),this.layer=(r=new Pg,new wf({title:"Overlay",zIndex:300,source:r,style:(o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.text,i=e.fillOpacity,o=e.strokeWidth,n=void 0===o?2:o,r=e.strokeOpacity,a=e.color,s=void 0===a?[0,161,222,.3]:a,c=e.strokeColor,l=s.slice(0),u=s.slice(0);u[3]=1,i&&(l[3]=i),r&&(u[3]=r),c&&(u[0]=c[0],u[1]=c[1],u[2]=c[2]);var h=new Uc.Stroke({width:n,color:u}),d=new Uc.Fill({color:l});return new Uc.Style({stroke:h,fill:d,image:new Uc.Circle({radius:5,stroke:h,fill:d}),text:new Uc.Text({text:t,font:"12px Calibri,sans-serif",fill:new Uc.Fill({color:"#000"}),stroke:new Uc.Stroke({color:"#fff",width:3}),overflow:!0})})}(),n=Of(),function(e){if("bufferFeature"===e.getId())return i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,161,222,1],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,161,222,.15],o=arguments.length>3?arguments[3]:void 0,n=new Uc.Stroke({width:t,color:e}),r=new Uc.Stroke({color:i});return new Uc.Style({stroke:n,fill:r,image:new Uc.Circle({radius:5,stroke:n,fill:r}),text:new Uc.Text({font:"12px Calibri,sans-serif",text:o,fill:new Uc.Fill({color:"#000"}),stroke:new Uc.Stroke({color:"#fff",width:3}),overflow:!0})})}(e.get("bufferStroke"),2,e.get("bufferFill"),e.get("bufferText"));var t=e.get("_style");if(t)return(new Tf).createStyle(t);var r=e.getGeometry().getType();return(i="Point"===r?n:o).getText().setText(e.get("_mapTitle")),i})})),this.setMap(t)}return _createClass(e,[{key:"setMap",value:function(e){void 0===e?void 0!==this.map&&this.map.ol.removeLayer(this.layer.ol):e.ol.addLayer(this.layer.ol),this.map=e}},{key:"setFeatures",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mf.Default,i=arguments.length>2?arguments[2]:void 0;if(i){var o,n=_createForOfIteratorHelper(this.dataSource.ol.getFeatures());try{for(n.s();!(o=n.n()).done;){var r=o.value;r.get("_sourceId")===i&&this.removeOlFeature(r)}}catch(a){n.e(a)}finally{n.f()}}else this.clear();this.addFeatures(e,t)}},{key:"addFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mf.Default;this.addFeatures([e],t)}},{key:"addFeatures",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mf.Default,o=[];e.forEach((function(e){var i=Df(e,t.map.projection);null!==i.getGeometry()&&o.push(i)})),this.addOlFeatures(o,i)}},{key:"addOlFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mf.Default;this.addOlFeatures([e],t)}},{key:"addOlFeatures",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mf.Default;this.dataSource.ol.addFeatures(e),jf(this.map,e,t)}},{key:"removeFeature",value:function(e){this.removeFeatures([e])}},{key:"removeFeatures",value:function(e){var t=this;e.forEach((function(e){e.meta&&t.dataSource.ol.getFeatureById(e.meta.id)&&t.removeOlFeature(t.dataSource.ol.getFeatureById(e.meta.id))}))}},{key:"removeOlFeature",value:function(e){this.dataSource.ol.removeFeature(e)}},{key:"clear",value:function(){this.dataSource.ol.clear()}},{key:"dataSource",get:function(){return this.layer.dataSource}}]),e}(),Jf=function(e){_inherits(i,e);var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),(e=t.call(this)).loaded=0,e.loading=0,e.layers=[],e.subscriptions=[],e}return _createClass(i,[{key:"watch",value:function(){}},{key:"unwatch",value:function(){var e=this;this.layers.forEach((function(t){return e.unwatchLayer(t)}),this)}},{key:"watchLayer",value:function(e){var t=this;if(void 0!==e.status$){this.layers.push(e);var i=e.status$.pipe(Object(A.a)()).subscribe((function(e){e===q.Working?t.loading+=1:e===q.Done&&(t.loaded+=1),t.loaded>=t.loading?(t.loading=t.loaded=0,t.status=q.Done):t.loading>0&&(t.status=q.Working)}));this.subscriptions.push(i)}}},{key:"unwatchLayer",value:function(e){e.status$.next(q.Done);var t=this.layers.indexOf(e);t>=0&&(-1!==[q.Working,q.Waiting].indexOf(e.watcher.status)&&(this.loaded+=1),this.subscriptions[t].unsubscribe(),this.subscriptions.splice(t,1),this.layers.splice(t,1),e.watcher.unwatch())}}]),i}(H),Qf=function(e){return e[e.Move=0]="Move",e[e.Zoom=1]="Zoom",e}({}),em=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this)).options=e,o.resolution$=new L.a(void 0),o.state$=new L.a(void 0),o.padding=[0,0,0,0],o.maxZoomOnExtent=19,o.extent$=new P.a,o.states=[],o.stateIndex=0,o}return _createClass(i,[{key:"setOlMap",value:function(e){_get(_getPrototypeOf(i.prototype),"setOlMap",this).call(this,e),this.setupObservers()}},{key:"setupObservers",value:function(){var e=this;!0===this.stateHistory&&this.observerKeys.push(this.olMap.on("moveend",(function(t){return e.onMoveEnd(t)}))),this.extent$$=this.extent$.pipe(Object(O.a)(25)).subscribe((function(t){e.setExtent(t.extent,t.action)}))}},{key:"teardownObservers",value:function(){_get(_getPrototypeOf(i.prototype),"teardownObservers",this).call(this),void 0!==this.extent$$&&(this.extent$$.unsubscribe(),this.extent$$=void 0)}},{key:"getOlProjection",value:function(){return this.olView.getProjection()}},{key:"getCenter",value:function(e){var t=this.olView.getCenter();return e&&t&&(t=Object(kc.r)(t,this.getOlProjection(),e)),t}},{key:"getExtent",value:function(e){var t=this.olView.calculateExtent(this.olMap.getSize());return e&&t&&(t=Object(kc.s)(t,this.getOlProjection(),e)),t}},{key:"getScale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:96;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:96;return e*kc.a[t]*39.3701*i}(this.getResolution(),this.getOlProjection().getUnits(),e)}},{key:"getResolution",value:function(){return this.olView.getResolution()}},{key:"getZoom",value:function(){return Math.round(this.olView.getZoom())}},{key:"zoomIn",value:function(){this.zoomTo(this.olView.getZoom()+1)}},{key:"zoomOut",value:function(){this.zoomTo(this.olView.getZoom()-1)}},{key:"zoomTo",value:function(e){this.olView.cancelAnimations(),this.olView.animate({zoom:e,duration:250,easing:tl.b})}},{key:"moveToExtent",value:function(e){this.extent$.next({extent:e,action:Qf.Move})}},{key:"zoomToExtent",value:function(e){this.extent$.next({extent:e,action:Qf.Zoom})}},{key:"getRotation",value:function(){return this.olView.getRotation()}},{key:"resetRotation",value:function(){this.olView.animate({rotation:0})}},{key:"hasPreviousState",value:function(){return this.states.length>1&&this.stateIndex>0}},{key:"hasNextState",value:function(){return this.states.length>1&&this.stateIndex<this.states.length-1}},{key:"previousState",value:function(){this.hasPreviousState()&&this.setStateIndex(this.stateIndex-1)}},{key:"nextState",value:function(){this.hasNextState()&&this.setStateIndex(this.stateIndex+1)}},{key:"clearStateHistory",value:function(){this.states=[],this.stateIndex=0}},{key:"setInitialState",value:function(){this.states.length>0&&this.setStateIndex(0)}},{key:"setExtent",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.olView;o.cancelAnimations();var n=i?500:0,r=o.getZoom(),a=o.getCenter(),s=[e[0]+(e[2]-e[0])/2,e[1]+(e[3]-e[1])/2],c=Math.sqrt(Math.pow(a[0]-s[0],2)+Math.pow(a[1]-s[1],2)),l=o.calculateExtent(),u=Math.sqrt(Math.pow(l[2]-l[0],2)+Math.pow(l[3]-l[1],2)),h=c/((Math.sqrt(Math.pow(e[2]-e[0],2)+Math.pow(e[3]-e[1],2))+u)/2),d=t===Qf.Move||r>this.maxZoomOnExtent?r:this.maxZoomOnExtent;o.fit(e,{size:this.olMap.getSize(),maxZoom:d,padding:this.padding,duration:h>4?0:n})}},{key:"setStateIndex",value:function(e){this.stateIndex=e,this.setState(this.states[e])}},{key:"setState",value:function(e){this.olView.animate({resolution:e.resolution,center:e.center,duration:0})}},{key:"onMoveEnd",value:function(e){var t=this.getResolution();this.resolution$.value!==t&&this.resolution$.next(t);var i,o,n={resolution:t,center:this.getCenter(),zoom:this.getZoom()};if(!0===this.stateHistory){var r=this.stateIndex;o=0===this.states.length?void 0:this.states[r],(void 0===(i=n)||void 0===o||i.zoom!==o.zoom||Math.trunc(i.center[0]/1e-4)!==Math.trunc(o.center[0]/1e-4)||Math.trunc(i.center[1]/1e-4)!==Math.trunc(o.center[1]/1e-4))&&(this.states=this.states.slice(0,r+1).concat([n]),this.stateIndex=this.states.length-1)}this.state$.next(n)}},{key:"stateHistory",get:function(){return!!this.options&&!0===this.options.stateHistory}},{key:"olView",get:function(){return this.olMap.getView()}}]),i}(function(){function e(){_classCallCheck(this,e),this.observerKeys=[]}return _createClass(e,[{key:"getOlMap",value:function(){return this.olMap}},{key:"setOlMap",value:function(e){if(void 0!==e&&void 0!==this.getOlMap())throw new Error("This controller is already bound to a map.");if(void 0===e)return this.teardownObservers(),void(this.olMap=e);this.olMap=e}},{key:"teardownObservers",value:function(){this.observerKeys.forEach((function(e){return Object(el.b)(e)})),this.observerKeys=[]}}]),e}()),tm=function(){function e(t){_classCallCheck(this,e),this.offlineButtonToggle$=new L.a(!1),this.layers$=new L.a([]),this.positionFollower=!0,this.geolocation$=new L.a(void 0),this.defaultOptions={controls:{attribution:!1}},this.options=Object.assign({},this.defaultOptions,t),this.layerWatcher=new Jf,this.status$=this.layerWatcher.status$,Object(Kc.a)(Yc.a),this.init()}return _createClass(e,[{key:"init",value:function(){var e=[];this.options.controls&&(this.options.controls.attribution&&e.push(new Hc.a(!0===this.options.controls.attribution?{}:this.options.controls.attribution)),this.options.controls.scaleLine&&e.push(new cl.a(!0===this.options.controls.scaleLine?{}:this.options.controls.scaleLine)));var t={};!1===this.options.interactions&&(t={altShiftDragRotate:!1,doubleClickZoom:!1,keyboard:!1,mouseWheelZoom:!1,shiftDragZoom:!1,dragPan:!1,pinchRotate:!1,pinchZoom:!1}),this.ol=new rl.a({interactions:Object(ll.c)(t),controls:e}),this.setView(this.options.view||{}),this.viewController=new em({stateHistory:!0}),this.viewController.setOlMap(this.ol),this.overlay=new Zf(this),this.buffer=new Zf(this)}},{key:"setTarget",value:function(e){this.ol.setTarget(e),void 0!==e?this.layerWatcher.subscribe((function(){}),null):this.layerWatcher.unsubscribe()}},{key:"updateView",value:function(e){var t=this.ol.getView(),i=Object.assign({zoom:t.getZoom()},t.getProperties());this.setView(Object.assign(i,e)),e.maxZoomOnExtent&&(this.viewController.maxZoomOnExtent=e.maxZoomOnExtent)}},{key:"setView",value:function(e){void 0!==this.viewController&&this.viewController.clearStateHistory(),e=Object.assign({constrainResolution:!0},e);var t=new al.a(e);if(this.ol.setView(t),this.unsubscribeGeolocate(),e){if(e.center){var i=t.getProjection().getCode(),o=Object(kc.g)(e.center,i);t.setCenter(o)}e.geolocate&&this.geolocate(!0),e.alwaysTracking&&(this.alwaysTracking=!0)}}},{key:"getCenter",value:function(e){return this.viewController.getCenter(e)}},{key:"getExtent",value:function(e){return this.viewController.getExtent(e)}},{key:"getZoom",value:function(){return this.viewController.getZoom()}},{key:"changeBaseLayer",value:function(e){if(e){var t,i=_createForOfIteratorHelper(this.getBaseLayers());try{for(i.s();!(t=i.n()).done;){t.value.visible=!1}}catch(o){i.e(o)}finally{i.f()}e.visible=!0,this.viewController.olView.setMinZoom(e.dataSource.options.minZoom||(this.options.view||{}).minZoom),this.viewController.olView.setMaxZoom(e.dataSource.options.maxZoom||(this.options.view||{}).maxZoom)}}},{key:"getBaseLayers",value:function(){return this.layers.filter((function(e){return!0===e.baseLayer}))}},{key:"getLayerById",value:function(e){return this.layers.find((function(t){return t.id&&t.id===e}))}},{key:"getLayerByAlias",value:function(e){return this.layers.find((function(t){return t.alias&&t.alias===e}))}},{key:"addLayer",value:function(e){this.addLayers([e])}},{key:"addLayers",value:function(e){var t=this,i=0,o=0,n=e.map((function(e){var n=e.zIndex?0:e.baseLayer?o++:i++;return t.doAddLayer(e,n)})).filter((function(e){return void 0!==e}));this.setLayers([].concat(this.layers,n))}},{key:"removeLayer",value:function(e){this.removeLayers([e])}},{key:"removeLayers",value:function(e){var t=this,i=this.layers$.value.slice(0),o=[];e.forEach((function(e){var t=i.indexOf(e);t>=0&&(o.push(e),i.splice(t,1))})),o.forEach((function(e){return t.doRemoveLayer(e)})),this.setLayers(i)}},{key:"removeAllLayers",value:function(){var e=this;this.layers.forEach((function(t){return e.doRemoveLayer(t)})),this.layers$.next([])}},{key:"raiseLayer",value:function(e){var t=this.getLayerIndex(e);t>1&&this.moveLayer(e,t,t-1)}},{key:"raiseLayers",value:function(e){var t,i=_createForOfIteratorHelper(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;this.raiseLayer(o)}}catch(n){i.e(n)}finally{i.f()}}},{key:"lowerLayer",value:function(e){var t=this.getLayerIndex(e);t<this.layers.length-1&&this.moveLayer(e,t,t+1)}},{key:"lowerLayers",value:function(e){var t,i=_createForOfIteratorHelper(e.reverse());try{for(i.s();!(t=i.n()).done;){var o=t.value;this.lowerLayer(o)}}catch(n){i.e(n)}finally{i.f()}}},{key:"moveLayer",value:function(e,t,i){var o=this.layers[i],n=e.zIndex;o.baseLayer||e.baseLayer||(e.zIndex=o.zIndex,o.zIndex=n,this.layers[i]=e,this.layers[t]=o,this.layers$.next(this.layers.slice(0)))}},{key:"doAddLayer",value:function(e,t){e.baseLayer&&e.visible&&this.changeBaseLayer(e);var i=this.getLayerById(e.id);if(void 0===i){if(!e.baseLayer&&e.zIndex&&(e.zIndex+=10),void 0===e.zIndex||0===e.zIndex){var o=Math.max.apply(Math,[e.baseLayer?0:10].concat(_toConsumableArray(this.layers.filter((function(t){return t.baseLayer===e.baseLayer&&t.zIndex<200})).map((function(e){return e.zIndex})))));e.zIndex=o+1+t}return e.baseLayer&&e.zIndex>9&&(e.zIndex=10),e.setMap(this),this.layerWatcher.watchLayer(e),this.ol.addLayer(e.ol),e}i.visible=!0}},{key:"doRemoveLayer",value:function(e){this.layerWatcher.unwatchLayer(e),this.ol.removeLayer(e.ol),e.setMap(void 0)}},{key:"setLayers",value:function(e){this.layers$.next(this.sortLayersByZIndex(e).slice(0))}},{key:"sortLayersByZIndex",value:function(e){return e.sort((function(e,t){return t.zIndex-e.zIndex}))}},{key:"getLayerIndex",value:function(e){return this.layers.findIndex((function(t){return t===e}))}},{key:"geolocate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=!0;this.geolocation$$&&(t=this.geolocation.getTracking(),this.unsubscribeGeolocate()),this.startGeolocation(),this.geolocation$$=this.geolocation$.subscribe((function(o){if(o){if(o.getAccuracy()<1e4){var n=o.getAccuracyGeometry(),r=n.getExtent();if(e.geolocationFeature&&e.overlay.dataSource.ol.getFeatureById(e.geolocationFeature.getId())&&e.overlay.dataSource.ol.removeFeature(e.geolocationFeature),e.bufferFeature&&e.buffer.dataSource.ol.removeFeature(e.bufferFeature),e.geolocationFeature=new Vc.a({geometry:n}),e.geolocationFeature.setId("geolocationFeature"),e.alwaysTracking?e.overlay.addOlFeature(e.geolocationFeature,e.positionFollower?Mf.Move:Mf.None):e.overlay.addOlFeature(e.geolocationFeature),e.ol.getView().options_.buffer){var a=e.ol.getView().options_.buffer.bufferRadius,s=o.getPosition();e.bufferGeom=new ul.a(s,a);var c,l=e.ol.getView().options_.buffer.bufferStroke,u=e.ol.getView().options_.buffer.bufferFill;c=e.ol.getView().options_.buffer.showBufferRadius?a.toString()+"m":"",e.bufferFeature=new Vc.a(e.bufferGeom),e.bufferFeature.setId("bufferFeature"),e.bufferFeature.set("bufferStroke",l),e.bufferFeature.set("bufferFill",u),e.bufferFeature.set("bufferText",c),e.buffer.addOlFeature(e.bufferFeature,Mf.None)}i&&(e.viewController.zoomToExtent(r),e.positionFollower=!e.positionFollower)}else if(i){var h=e.ol.getView(),d=o.getPosition();h.setCenter(d),h.setZoom(14)}!0!==t&&!0!==e.alwaysTracking&&e.unsubscribeGeolocate(),i=!1}}))}},{key:"unsubscribeGeolocate",value:function(){this.stopGeolocation(),this.geolocation$$&&(this.geolocation$$.unsubscribe(),this.geolocation$$=void 0)}},{key:"startGeolocation",value:function(){var e=this;this.geolocation?this.geolocation.setTracking(!0):(this.geolocation=new sl.a({trackingOptions:{enableHighAccuracy:!0},projection:this.projection,tracking:!0}),this.geolocation.on("change",(function(t){e.geolocation$.next(e.geolocation)})))}},{key:"stopGeolocation",value:function(){this.geolocation&&this.geolocation.setTracking(!1)}},{key:"onOfflineToggle",value:function(e){this.offlineButtonToggle$.next(e)}},{key:"layers",get:function(){return this.layers$.value}},{key:"projection",get:function(){return this.viewController.getOlProjection().getCode()}}]),e}(),im=((Yf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getMap",value:function(){return this.map}},{key:"setMap",value:function(e){this.map=e}}]),e}()).\u0275fac=function(e){return new(e||Yf)},Yf.\u0275prov=Object(r.Nb)({factory:function(){return new Yf},token:Yf,providedIn:"root"}),Yf),om=((Uf=function(){function e(t){_classCallCheck(this,e),this.activityService=t,this.id="igo-map-target-"+(new Date).getTime()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.status$$=this.map.status$.subscribe((function(t){return e.handleStatusChange(t)}))}},{key:"ngAfterViewInit",value:function(){this.map.setTarget(this.id)}},{key:"ngOnDestroy",value:function(){this.map.setTarget(void 0),this.activityService.unregister(this.activityId),this.status$$.unsubscribe()}},{key:"handleStatusChange",value:function(e){e===q.Working&&void 0===this.activityId?this.activityId=this.activityService.register():e===q.Done&&void 0!==this.activityId&&(this.activityService.unregister(this.activityId),this.activityId=void 0)}},{key:"view",get:function(){return this._view},set:function(e){this._view=e,void 0!==this.map&&this.map.updateView(e)}}]),e}()).\u0275fac=function(e){return new(e||Uf)(r.Rb(J))},Uf.\u0275cmp=r.Lb({type:Uf,selectors:[["igo-map-browser"]],inputs:{view:"view",map:"map"},ngContentSelectors:ql,decls:2,vars:1,consts:[[1,"igo-map-browser-target",3,"id"]],template:function(e,t){1&e&&(r.nc(),r.Sb(0,"div",0),r.mc(1)),2&e&&r.oc("id",t.id)},styles:["[_nghost-%COMP%]{display:block;position:relative}.igo-map-browser-target[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]     igo-zoom-button{bottom:5px;position:absolute;right:5px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     igo-zoom-button{display:none}}[_nghost-%COMP%]     igo-offline-button{bottom:15px;position:absolute;right:5px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     igo-offline-button{bottom:5px}}[_nghost-%COMP%]     igo-geolocate-button{bottom:5px;position:absolute;right:5px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     igo-geolocate-button{bottom:5px}}[_nghost-%COMP%]     igo-rotation-button{position:absolute;right:5px;top:50px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     igo-rotation-button{top:50px}}[_nghost-%COMP%]     igo-user-button{bottom:5px;position:absolute;right:55px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     igo-user-button{right:95px}}[_nghost-%COMP%]     igo-baselayers-switcher{bottom:5px;left:5px;position:absolute}[_nghost-%COMP%]     .ol-attribution{background-color:hsla(0,0%,100%,0);bottom:5px;left:5px;margin-right:90px;padding:0;text-align:left;width:calc(100% - 100px)}[_nghost-%COMP%]     .ol-attribution.ol-logo-only{height:inherit}[_nghost-%COMP%]     .ol-attribution.ol-collapsed{background:none}[_nghost-%COMP%]     .ol-attribution.ol-collapsed button{transform:none}[_nghost-%COMP%]     .ol-attribution button{background-color:#fff;cursor:pointer;outline:none;transform:rotate(180deg)}[_nghost-%COMP%]     .ol-scale-line-inner{border-color:#000;box-shadow:0 1px 0 1px hsla(0,0%,100%,.6);color:#000;text-shadow:#fff -1px -1px 3px,#fff 1px -1px 3px,#fff -1px 1px 3px,#fff 1px 1px 4px}[_nghost-%COMP%]     .ol-scale-line{background-color:hsla(0,0%,100%,0);bottom:4px;left:50%;transform:translate(-50%)}[_nghost-%COMP%]     canvas{display:block}"]}),Uf),nm=((Hf=function(){function e(t,i){_classCallCheck(this,e),this.component=t,this.mediaService=i,this.pointerPositionDelay=1e3,this.pointerPositionCoord=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){this.listenToMapPointerMove(),this.listenToMapClick()}},{key:"ngOnDestroy",value:function(){this.unlistenToMapPointerMove(),this.unlistenToMapClick()}},{key:"listenToMapPointerMove",value:function(){var e=this;this.pointerMoveListener=this.map.ol.on("pointermove",(function(t){return e.onPointerEvent(t,e.pointerPositionDelay)}))}},{key:"listenToMapClick",value:function(){var e=this;this.mapClickListener=this.map.ol.on("singleclick",(function(t){return e.onPointerEvent(t,0)}))}},{key:"unlistenToMapPointerMove",value:function(){this.map.ol.un(this.pointerMoveListener.type,this.pointerMoveListener.listener),this.pointerMoveListener=void 0}},{key:"unlistenToMapClick",value:function(){this.map.ol.un(this.mapClickListener.type,this.mapClickListener.listener),this.mapClickListener=void 0}},{key:"onPointerEvent",value:function(e,t){var i=this;if(!e.dragging&&!this.mediaService.isTouchScreen()){void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest);var o=Object(kc.r)(e.coordinate,this.mapProjection,"EPSG:4326");this.lastTimeoutRequest=setTimeout((function(){i.pointerPositionCoord.emit(o)}),t)}}},{key:"map",get:function(){return this.component.map}},{key:"mapProjection",get:function(){return this.component.map.projection}}]),e}()).\u0275fac=function(e){return new(e||Hf)(r.Rb(om,2),r.Rb(Ae))},Hf.\u0275dir=r.Mb({type:Hf,selectors:[["","igoPointerPosition",""]],inputs:{pointerPositionDelay:"pointerPositionDelay"},outputs:{pointerPositionCoord:"pointerPositionCoord"}}),Hf),rm=((qf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"zoom",get:function(){return this.map.viewController.getZoom()}},{key:"minZoom",get:function(){return this.map.viewController.olView.getMinZoom()||1}},{key:"maxZoom",get:function(){return this.map.viewController.olView.getMaxZoom()}}]),e}()).\u0275fac=function(e){return new(e||qf)},qf.\u0275cmp=r.Lb({type:qf,selectors:[["igo-zoom-button"]],inputs:{map:"map",color:"color"},decls:7,vars:16,consts:[[1,"igo-zoom-button-container"],["mat-icon-button","","matTooltipPosition","left",3,"matTooltip","color","disabled","click"],["svgIcon","plus"],["svgIcon","minus"]],template:function(e,t){1&e&&(r.Xb(0,"div",0),r.Xb(1,"button",1),r.ec("click",(function(){return t.map.viewController.zoomIn()})),r.jc(2,"translate"),r.Sb(3,"mat-icon",2),r.Wb(),r.Xb(4,"button",1),r.ec("click",(function(){return t.map.viewController.zoomOut()})),r.jc(5,"translate"),r.Sb(6,"mat-icon",3),r.Wb(),r.Wb()),2&e&&(r.Db(1),r.oc("matTooltip",r.lc(2,6,"igo.geo.mapButtons.zoomIn",r.rc(12,Hl,t.zoom+1)))("color",t.color)("disabled",t.zoom>=t.maxZoom),r.Db(3),r.oc("matTooltip",r.lc(5,9,"igo.geo.mapButtons.zoomOut",r.rc(14,Hl,t.zoom-1)))("color",t.color)("disabled",t.zoom<=t.minZoom))},directives:[l.a,g.a,u.a],pipes:[U.d],styles:[".igo-zoom-button-container[_ngcontent-%COMP%]{width:40px}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#fff}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#efefef}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-bottom:2px}[_nghost-%COMP%]     button .mat-button-ripple-round, button[_ngcontent-%COMP%]{border-radius:0}"]}),qf),am=((zf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"map",get:function(){return this._map},set:function(e){this._map=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}}]),e}()).\u0275fac=function(e){return new(e||zf)},zf.\u0275cmp=r.Lb({type:zf,selectors:[["igo-geolocate-button"]],inputs:{map:"map",color:"color"},decls:4,vars:4,consts:[[1,"igo-geolocate-button-container"],["mat-icon-button","","matTooltipPosition","left",3,"matTooltip","color","click"],["svgIcon","crosshairs-gps"]],template:function(e,t){1&e&&(r.Xb(0,"div",0),r.Xb(1,"button",1),r.ec("click",(function(){return t.map.geolocate()})),r.jc(2,"translate"),r.Sb(3,"mat-icon",2),r.Wb(),r.Wb()),2&e&&(r.Db(1),r.oc("matTooltip",r.kc(2,2,"igo.geo.mapButtons.geolocate"))("color",t.color))},directives:[l.a,g.a,u.a],pipes:[U.d],styles:[".igo-geolocate-button-container[_ngcontent-%COMP%]{background-color:#fff;width:40px}.igo-geolocate-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}[_nghost-%COMP%]     button .mat-button-ripple-round, button[_ngcontent-%COMP%]{border-radius:0}"]}),zf),sm=((Nf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"rotationStyle",value:function(e){return{transform:"rotate("+e+"rad)"}}},{key:"map",get:function(){return this._map},set:function(e){this._map=e}},{key:"showIfNoRotation",get:function(){return this._showIfNoRotation},set:function(e){this._showIfNoRotation=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"rotated",get:function(){return 0!==this.map.viewController.getRotation()}}]),e}()).\u0275fac=function(e){return new(e||Nf)},Nf.\u0275cmp=r.Lb({type:Nf,selectors:[["igo-rotation-button"]],inputs:{map:"map",showIfNoRotation:"showIfNoRotation",color:"color"},decls:2,vars:2,consts:[["class","igo-rotation-button-container","matTooltipPosition","left",3,"matTooltip",4,"ngIf"],["matTooltipPosition","left",1,"igo-rotation-button-container",3,"matTooltip"],["mat-icon-button","","matTooltipPosition","left",3,"color","disabled","click"],["svgIcon","navigation",3,"ngStyle"]],template:function(e,t){1&e&&(r.Gc(0,Ul,5,8,"div",0),r.Gc(1,Yl,5,8,"div",0)),2&e&&(r.oc("ngIf",t.rotated&&!t.showIfNoRotation),r.Db(1),r.oc("ngIf",t.showIfNoRotation))},directives:[m.l,g.a,l.a,u.a,m.m],pipes:[U.d],styles:[".igo-rotation-button-container[_ngcontent-%COMP%]{background-color:#fff;width:40px}.igo-rotation-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}[_nghost-%COMP%]     button .mat-button-ripple-round, button[_ngcontent-%COMP%]{border-radius:0}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     button .mat-button-ripple-round:disabled, button[_ngcontent-%COMP%]:disabled{display:none}}"]}),Nf),cm=function(e){return e.Layer="layer",e.Group="group",e}({}),lm=function(e){return e[e.wms=0]="wms",e[e.wmts=1]="wmts",e[e.baselayers=2]="baselayers",e[e.arcgisrest=3]="arcgisrest",e[e.composite=4]="composite",e}({}),um=function e(t,i){_classCallCheck(this,e),Object.assign(this,t),this.catalogService=i},hm=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o){var n;return _classCallCheck(this,i),(n=t.call(this,e,o)).type=lm[lm[lm.wms]],n}return _createClass(i,[{key:"collectCatalogItems",value:function(){return this.catalogService.loadCatalogWMSLayerItems(this)}}]),i}(um),dm=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o){var n;return _classCallCheck(this,i),(n=t.call(this,e,o)).type=lm[lm[lm.wmts]],n}return _createClass(i,[{key:"collectCatalogItems",value:function(){return this.catalogService.loadCatalogWMTSLayerItems(this)}}]),i}(um),pm=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o){var n;return _classCallCheck(this,i),(n=t.call(this,e,o)).type=lm[lm[lm.baselayers]],n}return _createClass(i,[{key:"collectCatalogItems",value:function(){return this.catalogService.loadCatalogBaseLayerItems(this)}}]),i}(um),gm=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o){var n;return _classCallCheck(this,i),(n=t.call(this,e,o)).type=lm[lm[lm.arcgisrest]],n}return _createClass(i,[{key:"collectCatalogItems",value:function(){return this.catalogService.loadCatalogArcGISRestItems(this)}}]),i}(um),fm=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o){var n;return _classCallCheck(this,i),(n=t.call(this,e,o)).type=lm[lm[lm.composite]],n.url=null,n}return _createClass(i,[{key:"collectCatalogItems",value:function(){return this.catalogService.loadCatalogCompositeLayerItems(this)}}]),i}(um),mm=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"createInstanceCatalog",value:function(e,t){return e.hasOwnProperty("composite")?new fm(e,t):e.type===lm[lm.baselayers]?new pm(e,t):e.type===lm[lm.arcgisrest]?new gm(e,t):e.type===lm[lm.wmts]?new dm(e,t):new hm(e,t)}}]),e}(),bm=((Kf=function(){function e(t){_classCallCheck(this,e),this.http=t,this.queryEnabled=!0}return _createClass(e,[{key:"query",value:function(e,t){var i=this;return e.filter((function(e){return e.visible&&e.isInResolutionsRange})).map((function(e){return i.queryLayer(e,t)}))}},{key:"queryLayer",value:function(e,t){var i=this,o=this.getQueryUrl(e.dataSource,t);if(!o)return Object(F.a)([]);if(e.dataSource.options.queryFormat===Hg.HTMLGML2){var n=this.getQueryUrl(e.dataSource,t,!0);return this.http.get(n,{responseType:"text"}).pipe(Object(bc.a)((function(n){var r=i.mergeGML(n,o);return i.http.get(o,{responseType:"text"}).pipe(Object(w.a)((function(n){return i.extractData(n,e,t,o,r)})))})))}return this.http.get(o,{responseType:"text"}).pipe(Object(w.a)((function(n){return i.extractData(n,e,t,o)})))}},{key:"mergeGML",value:function(e,t){var i=new Dc.a,o=i.readFeatures(e);0===o.length&&(o=(i=new xc.WMSGetFeatureInfo).readFeatures(e));var n,r,a,s=new bl.b([]),c=[],l=new bl.c([]),u=o.length,h=this.getQueryParams(t.toLowerCase()).bbox.split(","),d=Object(Wc.j)();switch(Object(Wc.q)(d,h),o.map((function(e){var t=e.getGeometry().getCoordinates(),i=e.getGeometry().getType();switch(r||(r=i),i){case"Point":1===u?n=new bl.d(t,"XY"):c.push(t);break;case"LineString":s.appendLineString(new bl.a(t,"XY"));break;case"Polygon":l.appendPolygon(new bl.e(t,"XY"));break;case"MultiPolygon":l=new bl.c(t,"XY");break;default:return}})),a=0===c.length&&n?{type:n.getType(),coordinates:n.getCoordinates()}:{type:"Polygon",coordinates:[this.convexHull(c)]},r){case"LineString":return{type:s.getType(),coordinates:s.getCoordinates()};case"Point":return a;case"Polygon":case"MultiPolygon":return{type:l.getType(),coordinates:l.getCoordinates()};default:return}}},{key:"cross",value:function(e,t,i){return(e[0]-i[0])*(t[1]-i[1])-(e[1]-i[1])*(t[0]-i[0])}},{key:"convexHull",value:function(e){e.sort((function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]}));var t,i=[],o=_createForOfIteratorHelper(e);try{for(o.s();!(t=o.n()).done;){for(var n=t.value;i.length>=2&&this.cross(i[i.length-2],i[i.length-1],n)<=0;)i.pop();i.push(n)}}catch(s){o.e(s)}finally{o.f()}for(var r=[],a=e.length-1;a>=0;a--){for(;r.length>=2&&this.cross(r[r.length-2],r[r.length-1],e[a])<=0;)r.pop();r.push(e[a])}return r.pop(),i.pop(),i.concat(r)}},{key:"extractData",value:function(e,t,i,o,n){var r=this,a=t.dataSource,s=this.getAllowedFieldsAndAlias(t),c=[];switch(a.options.queryFormat){case Hg.GML3:c=this.extractGML3Data(e,t.zIndex,s);break;case Hg.JSON:case Hg.GEOJSON:case Hg.GEOJSON2:c=this.extractGeoJSONData(e);break;case Hg.ESRIJSON:c=this.extractEsriJSONData(e,t.zIndex);break;case Hg.TEXT:c=this.extractTextData(e);break;case Hg.HTML:c=this.extractHtmlData(e,a.queryHtmlTarget,o);break;case Hg.HTMLGML2:c=this.extractHtmlData(e,a.queryHtmlTarget,o,n);break;case Hg.GML2:default:c=this.extractGML2Data(e,t,s)}if(c.length>0&&null==c[0].geometry){var l,u=this.createGeometryFromUrlClick(o),h=_createForOfIteratorHelper(c);try{for(h.s();!(l=h.n()).done;)l.value.geometry=u}catch(d){h.e(d)}finally{h.f()}}return c.map((function(e,o){var n,s=e.properties[a.mapLabel];if("wms"===t.options.sourceOptions.type){var l=t.options.sourceOptions;n=l?l.excludeAttribute:void 0}var u=r.getQueryTitle(e,t);!u&&c.length>1?u="".concat(t.title," (").concat(o+1,")"):u||(u=t.title);var h=Object.assign({},e.meta||{},{id:G(),title:u,mapTitle:s,sourceTitle:t.title,order:1e3-t.zIndex,excludeAttribute:n});return Object.assign(e,{meta:h,projection:"carto"===a.options.type?"EPSG:4326":i.projection})}))}},{key:"createGeometryFromUrlClick",value:function(e){var t=this.getQueryParams(e.toLowerCase()),i=t.bbox,o=parseInt(t.width,10),n=parseInt(t.height,10),r=parseInt(t.i||t.x,10),a=parseInt(t.j||t.y,10),s=i.split(","),c=.05*(Math.abs(parseFloat(s[0]))-Math.abs(parseFloat(s[2])));Math.abs(parseFloat(s[0]))<180&&(c=.045);var l=parseFloat(s[0])+Math.abs(parseFloat(s[0])-parseFloat(s[2]))*r/o-c,u=parseFloat(s[1])+Math.abs(parseFloat(s[1])-parseFloat(s[3]))*a/n-c,h=l+2*c,d=u+2*c,p="POLYGON(("+l+" "+u+", "+l+" "+d+", "+h+" "+d+", "+h+" "+u+", "+l+" "+u+"))",g=(new xc.WKT).readFeature(p).getGeometry();return{type:g.getType(),coordinates:g.getCoordinates()}}},{key:"extractGML2Data",value:function(e,t,i){var o=this,n=new Dc.a,r=n.readFeatures(e);if(0===r.length){n=new xc.WMSGetFeatureInfo;try{r=n.readFeatures(e)}catch(a){console.warn("query.service: Multipolygons are badly managed in mapserver in GML2. Use another format.")}}return r.map((function(e){return o.featureToResult(e,t,i)}))}},{key:"extractGML3Data",value:function(e,t,i){var o=this,n=new Pc.a,r=[];try{r=n.readFeatures(e)}catch(a){console.warn("query.service: GML3 is not well supported")}return r.map((function(e){return o.featureToResult(e,t,i)}))}},{key:"extractGeoJSONData",value:function(e){var t=[];try{t=JSON.parse(e).features}catch(i){console.warn("query.service: Unable to parse geojson","\n",e)}return t}},{key:"extractEsriJSONData",value:function(e,t){var i=this;return(new Gc.a).readFeatures(e).map((function(e){return i.featureToResult(e,t)}))}},{key:"extractTextData",value:function(e){return[]}},{key:"extractHtmlData",value:function(e,t,i,o){var n=this.getQueryParams(i.toLowerCase()),r=n.crs||n.srs||"EPSG:3857",a=this.createGeometryFromUrlClick(i);t!==Yg.BLANK&&t!==Yg.IFRAME&&(t=Yg.IFRAME);var s=e.toLowerCase().indexOf("<body>"),c=e.toLowerCase().lastIndexOf("</body>")+7;return"<body></body>"===e.slice(s,c).replace(/(\r|\n|\s)/g,"")||""===e?[]:[{type:_f,projection:r,properties:{target:t,body:e,url:i},geometry:o||a}]}},{key:"getQueryParams",value:function(e){var t=e.split("?");if(t[1]){var i=t[1].split("&"),o={};return i.forEach((function(e){e=e.split("="),o[e[0]]=decodeURIComponent(e[1]||"")})),o}}},{key:"featureToResult",value:function(e,t,i){var o,n=e.getGeometry(),r=Object.assign({},e.getProperties());return delete r.geometry,delete r.boundedBy,delete r.shape,delete r.SHAPE,delete r.the_geom,delete r.geom,void 0!==n&&(o={type:n.getType(),coordinates:n.getCoordinates()}),{type:_f,projection:void 0,properties:r,geometry:o,meta:{id:G(),order:1e3-t,alias:i}}}},{key:"getQueryUrl",value:function(e,t){var i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(e.constructor){case Kg:var n=e,r={INFO_FORMAT:n.params.INFO_FORMAT||this.getMimeInfoFormat(e.options.queryFormat),QUERY_LAYERS:n.params.LAYERS,FEATURE_COUNT:n.params.FEATURE_COUNT||"5"};o&&(r.INFO_FORMAT=this.getMimeInfoFormat(Hg.GML2)),i=n.ol.getFeatureInfoUrl(t.coordinates,t.resolution,t.projection,r);break;case of:var a=e;i="".concat("https://"+a.options.account+".carto.com/api/v2/sql?","format=GeoJSON").concat("&q="+a.options.config.layers[0].options.sql," WHERE ST_Intersects(the_geom_webmercator,ST_BUFFER(ST_SetSRID(ST_POINT(").concat(t.coordinates[0]+","+t.coordinates[1]+"),3857),"+(a.options.queryPrecision?a.options.queryPrecision:"1000")+"))");break;case rf:var s=e,c=Object(Wc.b)([t.coordinates]);s.options.queryPrecision&&(c=Object(Wc.c)(c,s.options.queryPrecision)),i="".concat(s.options.url+"/"+s.options.layer+"/query/","?").concat(["f=json","geometry="+encodeURIComponent('{"xmin":'+c[0]+',"ymin":'+c[1]+',"xmax":'+c[2]+',"ymax":'+c[3]+',"spatialReference":{"wkid":102100}}'),"geometryType=esriGeometryEnvelope","inSR=102100","spatialRel=esriSpatialRelIntersects","outFields=*","returnGeometry=true","outSR=102100"].join("&"))}return i}},{key:"getMimeInfoFormat",value:function(e){var t="application/vnd.ogc.gml",i=Object.keys(Hg).find((function(t){return Hg[t]===e}));return i&&(t=Ug[i]),t}},{key:"getAllowedFieldsAndAlias",value:function(e){var t;return e.options&&e.options.source&&e.options.source.options&&e.options.source.options.sourceFields&&e.options.source.options.sourceFields.length>=1&&(t={},e.options.source.options.sourceFields.forEach((function(e){t[e.name]=e.alias?e.alias:e.name}))),t}},{key:"getQueryTitle",value:function(e,t){var i;if(t.options&&t.options.source&&t.options.source.options){var o=t.options.source.options;o.queryTitle&&(i=this.getLabelMatch(e,o.queryTitle))}return i}},{key:"getLabelMatch",value:function(e,t){var i=t,o=Array.from(t.matchAll(/\$\{([^\{\}]+)\}/g));return o.forEach((function(t){i=i.replace(t[0],e.properties[t[1]])})),0===o.length&&i===t&&(i=e.properties[t]||t),i}}]),e}()).\u0275fac=function(e){return new(e||Kf)(r.bc(k.b))},Kf.\u0275prov=Object(r.Nb)({factory:function(){return new Kf(Object(r.bc)(k.b))},token:Kf,providedIn:"root"}),Kf);function vm(e){return!0===e.dataSource.options.queryable}function ym(e){var t=e.get("_layer");return void 0!==t&&vm(t)}var km,Sm,Cm,wm,xm,Om,Im,Lm,Tm,Fm,_m,Mm,Dm,Pm,Am,jm,Rm,$m,Em,Wm,Xm,Gm,Bm,Vm,Nm,zm,qm,Hm,Um,Ym,Km,Zm,Jm=((Sm=function(){function e(t,i){_classCallCheck(this,e),this.component=t,this.queryService=i,this.queries$$=[],this.queryFeatures=!1,this.queryFeaturesHitTolerance=0,this.waitForAllQueries=!0,this.query=new r.o}return _createClass(e,[{key:"ngAfterViewInit",value:function(){this.listenToMapClick(),this.addDragBoxInteraction()}},{key:"ngOnDestroy",value:function(){this.cancelOngoingQueries(),this.unlistenToMapClick(),this.removeDragBoxInteraction()}},{key:"listenToMapClick",value:function(){var e=this;this.mapClickListener=this.map.ol.on("singleclick",(function(t){return e.onMapEvent(t)}))}},{key:"unlistenToMapClick",value:function(){this.map.ol.un(this.mapClickListener.type,this.mapClickListener.listener),this.mapClickListener=void 0}},{key:"onMapEvent",value:function(e){var t=this;if(this.cancelOngoingQueries(),this.queryService.queryEnabled){var i=[];this.queryFeatures&&i.push(this.doQueryFeatures(e));var o=this.map.ol.getView().getResolution(),n=this.map.layers.filter(vm);i.push.apply(i,_toConsumableArray(this.queryService.query(n,{coordinates:e.coordinate,projection:this.map.projection,resolution:o}))),0!==i.length&&(this.waitForAllQueries?this.queries$$.push(Object(dc.a).apply(void 0,i).subscribe((function(i){var o,n=(o=[]).concat.apply(o,_toConsumableArray(i));t.query.emit({features:n,event:e})}))):this.queries$$=i.map((function(i){return i.subscribe((function(i){t.query.emit({features:i,event:e})}))})))}}},{key:"doQueryFeatures",value:function(e){var t=this,i=[];if("singleclick"===e.type)this.map.ol.forEachFeatureAtPixel(e.pixel,(function(e,o){var n=t.map.getLayerById(o.values_._layer.id);if(e)if(e.get("features")){var r,a=_createForOfIteratorHelper(e.get("features"));try{for(a.s();!(r=a.n()).done;){var s=r.value,c=Pf(s,t.map.projection);c.meta={title:s.values_.nom,id:o.values_._layer.id+"."+s.id_,icon:s.values_._icon,sourceTitle:o.values_.title,alias:t.queryService.getAllowedFieldsAndAlias(n)},i.push(c)}}catch(h){a.e(h)}finally{a.f()}}else if(e instanceof vl.a){var l=function(e,t,i){var o,n,r,a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"EPSG:4326";i?(n=i.get("title"),i.get("sourceOptions")&&(r=i.get("sourceOptions").excludeAttribute,a=i.get("sourceOptions").excludeAttributeOffline)):n=e.get("_title");var c=new fl.a,l=e.getProperties(),u=e.getType();"Polygon"===u?o=new dl.b(e.flatCoordinates_,hl.a.XY,e.ends_):"Point"===u?o=new pl.a(e.flatCoordinates_,hl.a.XY):"LineString"===u&&(o=new gl.a(e.flatCoordinates_,hl.a.XY));var h=c.writeGeometryObject(o,{dataProjection:s,featureProjection:t}),d=e.getId()?e.getId():G(),p=e.get("_mapTitle");return{type:_f,projection:s,extent:e.getExtent(),meta:{id:d,title:n||p||d,mapTitle:p,excludeAttribute:r,excludeAttributeOffline:a},properties:l,geometry:h,ol:e}}(e,t.map.projection,o);l.meta={id:o.values_._layer.id+"."+l.meta.id,sourceTitle:o.values_.title,alias:t.queryService.getAllowedFieldsAndAlias(n),title:t.queryService.getQueryTitle(l,n)||l.meta.title},i.push(l)}else{var u=Pf(e,t.map.projection,o);u.meta={id:o.values_._layer.id+"."+u.meta.id,sourceTitle:o.values_.title,alias:t.queryService.getAllowedFieldsAndAlias(n),title:t.queryService.getQueryTitle(u,n)||u.meta.title},i.push(u)}}),{hitTolerance:this.queryFeaturesHitTolerance||0,layerFilter:this.queryFeaturesCondition?this.queryFeaturesCondition:ym});else if("boxend"===e.type){var o=e.target.getGeometry().getExtent();this.map.layers.filter(vm).filter((function(e){return e instanceof wf&&e.visible})).map((function(e){e.dataSource.ol.forEachFeatureIntersectingExtent(o,(function(o){var n=Pf(o,t.map.projection,e.ol);n.meta={id:e.id+"."+o.id_,icon:o.values_._icon,sourceTitle:e.title,alias:t.queryService.getAllowedFieldsAndAlias(e),title:t.queryService.getQueryTitle(n,e)||n.meta.title},i.push(n)}))}))}return Object(F.a)(i)}},{key:"cancelOngoingQueries",value:function(){this.queries$$.forEach((function(e){return e.unsubscribe()})),this.queries$$=[]}},{key:"addDragBoxInteraction",value:function(){var e,t,i=this,o=_createForOfIteratorHelper(this.map.ol.getInteractions().getArray());try{for(o.s();!(t=o.n()).done;){var n=t.value;if(n instanceof Gf){e=n;break}}}catch(r){o.e(r)}finally{o.f()}void 0===e&&(e=new Gf({condition:mg}),this.map.ol.addInteraction(e),this.olDragSelectInteraction=e),this.olDragSelectInteractionEndKey=e.on("boxend",(function(e){return i.onMapEvent(e)}))}},{key:"removeDragBoxInteraction",value:function(){void 0!==this.olDragSelectInteractionEndKey&&Object(el.b)(this.olDragSelectInteractionEndKey),void 0!==this.olDragSelectInteraction&&this.map.ol.removeInteraction(this.olDragSelectInteraction),this.olDragSelectInteraction=void 0}},{key:"map",get:function(){return this.component.map}}]),e}()).\u0275fac=function(e){return new(e||Sm)(r.Rb(om,2),r.Rb(bm))},Sm.\u0275dir=r.Mb({type:Sm,selectors:[["","igoQuery",""]],inputs:{queryFeatures:"queryFeatures",queryFeaturesHitTolerance:"queryFeaturesHitTolerance",waitForAllQueries:"waitForAllQueries",queryFeaturesCondition:"queryFeaturesCondition"},outputs:{query:"query"}}),Sm),Qm=function(){var e=function(){function e(t){var i=this;_classCallCheck(this,e),this.options=t,this.options=Object.assign({},this.getDefaultOptions(),t),this.settings.forEach((function(e){i.setParamFromSetting(e)}))}return _createClass(e,[{key:"getId",value:function(){throw new Error('You have to implement the method "getId".')}},{key:"getType",value:function(){throw new Error('You have to implement the method "getType".')}},{key:"getDefaultOptions",value:function(){throw new Error('You have to implement the method "getDefaultOptions".')}},{key:"setParamFromSetting",value:function(e){var t=this;switch(e.type){case"radiobutton":e.values.forEach((function(i){i.enabled&&(t.options.params=Object.assign(t.options.params||{},_defineProperty({},e.name,i.value)))}));break;case"checkbox":var i="";e.values.filter((function(e){return!1!==e.available})).forEach((function(e){e.enabled&&(i+=e.value+",")})),i=i.slice(0,-1),this.options.params=Object.assign(this.options.params||{},_defineProperty({},e.name,i))}}},{key:"getHashtagsValid",value:function(e,t){var i=e.match(/(#[^\s]+)/g);if(i){var o=this.getSettingsValues(t),n=[];return i.forEach((function(e){o.values.forEach((function(t){var i=e.substring(1);if("string"==typeof t.value){var o=t.value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").split(","),r=o.indexOf(i.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""));-1!==r&&n.push(o[r])}t.hashtags&&-1!==t.hashtags.indexOf(i)&&n.push(t.value)}))})),n.filter((function(e,t){return n.indexOf(e)===t}))}}},{key:"getSettingsValues",value:function(e){return this.getDefaultOptions().settings.find((function(t){return t.name===e}))}},{key:"title",get:function(){return this.options.title}},{key:"available",get:function(){return!1!==this.options.available}},{key:"enabled",set:function(e){this.options.enabled=e},get:function(){return this.available&&!1!==this.options.enabled}},{key:"showInPointerSummary",get:function(){return this.options.showInPointerSummary||!1}},{key:"showInSettings",get:function(){var e=this.options.showInSettings;return void 0===e||e}},{key:"searchUrl",get:function(){return this.options.searchUrl}},{key:"params",get:function(){return void 0===this.options.params?{}:this.options.params}},{key:"settings",get:function(){return void 0===this.options.settings?[]:this.options.settings}},{key:"displayOrder",get:function(){return void 0===this.options.order?99:this.options.order}}]),e}();return e.id="",e.type="",e}(),eb=((km=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){return _classCallCheck(this,i),t.call(this,e)}return _createClass(i,[{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){return{title:"Carte"}}}]),i}(Qm)).\u0275fac=function(e){return new(e||km)(r.bc("options"))},km.\u0275prov=r.Nb({token:km,factory:km.\u0275fac}),km.id="map",km.type=_f,km),tb=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getGoogleMapsCoordLink",value:function(e,t){return"https://www.google.com/maps?q="+t+","+e}},{key:"getGoogleStreetViewLink",value:function(e,t){return"https://www.google.com/maps?q=&layer=c&cbll="+t+","+e}},{key:"getGoogleMapsNameLink",value:function(e){return"https://www.google.com/maps?q="+encodeURI(e)}}]),e}(),ib=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getOpenStreetMapLink",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:17;return"https://www.openstreetmap.org/?mlat=".concat(t,"&mlon=").concat(e,"#map=").concat(i,"/").concat(t,"/").concat(e)}},{key:"getOpenStreetCamLink",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:17;return"https://openstreetcam.org/map/@".concat(t,",").concat(e,",").concat(i,"z")}}]),e}(),ob=((Tm=function(){function e(t,i,o,n,r){_classCallCheck(this,e),this.http=t,this.config=i,this.languageService=o,this.messageService=n,this.capabilitiesService=r}return _createClass(e,[{key:"loadCatalogs",value:function(){var e=this.config.getConfig("context")||{},t=this.config.getConfig("catalog")||{},i=t.url||e.url,o=t.sources||[],n=[];if(i){if(t.baseLayers){var r=[{id:"catalog.baselayers",title:this.languageService.translate.instant("igo.geo.catalog.baseLayers"),url:i+"/baselayers",type:"baselayers"}];n.push(Object(F.a)(r))}var a=this.http.get(i+"/catalogs").pipe(Object(w.a)((function(e){return e.map((function(e){return Object.assign(e,e.options)}))})),Object(C.a)((function(e){return pc.a})));n.push(a)}return o.length>0&&n.push(Object(F.a)(o).pipe(Object(w.a)((function(e){return e.map((function(e){return e.id||(e.id=G()),e}))})))),Object(dc.a).apply(void 0,n).pipe(Object(w.a)((function(e){return[].concat.apply([],e)})))}},{key:"loadCatalogItems",value:function(e){return mm.createInstanceCatalog(e,this).collectCatalogItems()}},{key:"loadCatalogBaseLayerItems",value:function(e){return this.getCatalogBaseLayersOptions(e).pipe(Object(w.a)((function(t){var i=t.map((function(e){return{id:Og(e.sourceOptions),title:e.title,type:cm.Layer,options:e}}));return[{id:"catalog.group.baselayers",type:cm.Group,title:e.title,items:i}]})))}},{key:"getCatalogBaseLayersOptions",value:function(e){return this.http.get(e.url)}},{key:"loadCatalogWMSLayerItems",value:function(e){var t=this;return this.getCatalogCapabilities(e).pipe(Object(w.a)((function(i){var o=[];return t.includeRecursiveItems(e,i.Capability.Layer,o),o})))}},{key:"loadCatalogWMTSLayerItems",value:function(e){var t=this;return this.getCatalogCapabilities(e).pipe(Object(w.a)((function(i){return t.getWMTSItems(e,i)})))}},{key:"loadCatalogArcGISRestItems",value:function(e){var t=this;return this.getCatalogCapabilities(e).pipe(Object(w.a)((function(i){return t.getArcGISRESTItems(e,i)})))}},{key:"loadCatalogCompositeLayerItems",value:function(e){var t=this,i=e.composite,o=[];i.map((function(e){return o.push(mm.createInstanceCatalog(e,t))}));var n=[];o.map((function(e){return n.push(e.collectCatalogItems())}));var r=[];r=Object.keys(i).find((function(e){return i[e].groupImpose}))?n.map((function(e,t){return e.pipe(Object(w.a)((function(e){return i[t].groupImpose?function(e,t){var i=o[t],n=Object.assign({},i.groupImpose);n.address=i.id,n.type=cm.Group,n.items=[];var r=function e(t){return t.reduce((function(t,i){return t.concat(i.type===cm.Group?e(i.items):i)}),[])}(e);return r.map((function(e){return e.address="".concat(n.address,".").concat(n.id)})),n.items=r,n}(e,t):e})))})):n;var a=Object(dc.a).apply(void 0,_toConsumableArray(r)).pipe(Object(w.a)((function(e){var t;return(t=[]).concat.apply(t,_toConsumableArray(e))})));return a.pipe(Object(w.a)((function(e){return t=function(e){return e.id},e.reduce((function(e,i){var o=t(i),n=e.find((function(e){return e.id===o}));if(n){var r,a=e.indexOf(n);-1===e[a].address.split("|").indexOf(i.address)&&(e[a].address="".concat(e[a].address,"|").concat(i.address)),(r=e[a].items).push.apply(r,_toConsumableArray(i.items))}else e[e.length]=i;return e}),[]);var t})),Object(w.a)((function(e){var t;return(t=[]).concat.apply(t,_toConsumableArray(e))})),Object(w.a)((function(e){return function e(t,i){return t.reduce((function(t,o,n,r){var a=i(o),s=Object.assign({},o);if(o.type===cm.Layer){var c=[];if(r.filter((function(e,t){var i=!1;return e.title===a&&e.type===cm.Layer&&(t!==n&&e.address!==o.address&&(i=!0),c.push(t)),i})).length>0){var l=c.findIndex((function(e){return e===n}))+1;s.title="".concat(o.title," (").concat(l,")")}t.find((function(e){return e.title===s.title&&e.type===cm.Layer}))||(t[t.length]=s)}else o.type===cm.Group&&(s.items=e(o.items,(function(e){return e.title})),t[t.length]=s);return t}),[])}(e,(function(e){return e.title}))})))}},{key:"getCatalogCapabilities",value:function(e){var t=this;return this.capabilitiesService.getCapabilities(df[lm[e.type]],e.url,e.version).pipe(Object(C.a)((function(i){var o=t.languageService.translate.instant("igo.geo.catalog.unavailableTitle"),n=t.languageService.translate.instant("igo.geo.catalog.unavailable",{value:e.title});throw t.messageService.error(n,o),i})))}},{key:"prepareCatalogItemLayer",value:function(e,t,i,o){var n=this.retriveLayerInfoFormat(e.Name,i),r=e.DataURL?e.DataURL[0]:void 0,a=o.showLegend&&e.Style?this.capabilitiesService.getStyle(e.Style):void 0,s=Object.assign({},o.queryParams,{LAYERS:e.Name,VERSION:o.version}),c=Object.assign({},{type:"wms",url:o.url,crossOrigin:o.setCrossOriginAnonymous?"anonymous":void 0,queryFormat:n,queryHtmlTarget:n===Hg.HTML||n===Hg.HTMLGML2?"iframe":void 0,optionsFromCapabilities:!0},o.sourceOptions,{params:s}),l={id:Og(c),type:cm.Layer,title:e.Title,address:t,options:{maxResolution:fg(e.MaxScaleDenominator),minResolution:fg(e.MinScaleDenominator),metadata:{url:r?r.OnlineResource:void 0,extern:!!r||void 0,abstract:e.Abstract},legendOptions:a,tooltip:{type:o.tooltipType},sourceOptions:c}};return E.removeUndefined(l)}},{key:"prepareCatalogItemGroup",value:function(e,t,i,o,n){var r=this;return{id:i,type:cm.Group,title:e.Title,address:n.id,items:e.Layer.reduce((function(e,a){if(void 0!==a.Layer){var s=r.prepareCatalogItemGroup(a,t,i+".group."+(a.Name||a.Layer[0].Name),o,n);e.push(s)}else{if(!1===r.testLayerRegexes(a.Name,t))return e;var c=r.prepareCatalogItemLayer(a,i,o,n);e.push(c)}return e}),[])}}},{key:"includeRecursiveItems",value:function(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=(e.regFilters||[]).map((function(e){return new RegExp(e)}));if(t.Layer){var r,a=_createForOfIteratorHelper(t.Layer);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(void 0===s.Layer){var c=this.findCatalogInfoFormat(e);if(0!==o){var l=this.prepareCatalogItemGroup(t,n,"catalog.group."+(t.Name||s.Name),c,e);0!==l.items.length&&i.push(l);break}if(!1!==this.testLayerRegexes(s.Name,n)){var u=this.prepareCatalogItemLayer(s,e.id,c,e);i.push(u)}}else this.includeRecursiveItems(e,s,i,o+1)}}catch(h){a.e(h)}finally{a.f()}}}},{key:"getWMTSItems",value:function(e,t){var i=this,o=t.Contents.Layer,n=(e.regFilters||[]).map((function(e){return new RegExp(e)}));return o.map((function(t){if(!1!==i.testLayerRegexes(t.Identifier,n)){var o=Object.assign({},e.queryParams,{version:"1.0.0"}),r=Object.assign({},{type:"wmts",url:e.url,crossOrigin:e.setCrossOriginAnonymous?"anonymous":void 0,layer:t.Identifier,matrixSet:e.matrixSet,optionsFromCapabilities:!0,requestEncoding:e.requestEncoding||"KVP",style:"default"},e.sourceOptions,{params:o});return E.removeUndefined({id:Og(r),type:cm.Layer,title:t.Title,address:e.id,options:{sourceOptions:r}})}})).filter((function(e){return void 0!==e}))}},{key:"getArcGISRESTItems",value:function(e,t){var i=this,o=t.layers,n=(e.regFilters||[]).map((function(e){return new RegExp(e)}));return o.map((function(t){if(!1!==i.testLayerRegexes(t.id,n)){var o=Object.assign({},{type:"arcgisrest",url:e.url,crossOrigin:e.setCrossOriginAnonymous?"anonymous":void 0,layer:t.id,matrixSet:e.matrixSet,optionsFromCapabilities:!0,style:"default"},e.sourceOptions);return E.removeUndefined({id:Og(o),type:cm.Layer,title:t.name,address:e.id,options:{sourceOptions:o}})}})).filter((function(e){return void 0!==e}))}},{key:"testLayerRegexes",value:function(e,t){return 0===t.length||void 0!==t.find((function(t){return t.test(e)}))}},{key:"retriveLayerInfoFormat",value:function(e,t){var i,o=t.find((function(t){return t.layer===e})),n=t.find((function(e){return"*"===e.layer}));return o?i=o.queryFormat:n&&(i=n.queryFormat),i}},{key:"findCatalogInfoFormat",value:function(e){var t=[];return e.queryFormat?(Object.keys(e.queryFormat).forEach((function(i){e.queryFormat[i]instanceof Array?e.queryFormat[i].forEach((function(e){t.find((function(t){return t.layer===e}))||t.push({layer:e,queryFormat:i})})):t.find((function(t){return t.layer===e.queryFormat[i]}))||t.push({layer:e.queryFormat[i],queryFormat:i})})),t):t}}]),e}()).\u0275fac=function(e){return new(e||Tm)(r.bc(k.b),r.bc(ie),r.bc(Le),r.bc(Ie),r.bc(pf))},Tm.\u0275prov=Object(r.Nb)({factory:function(){return new Tm(Object(r.bc)(k.b),Object(r.bc)(ie),Object(r.bc)(Le),Object(r.bc)(Ie),Object(r.bc)(pf))},token:Tm,providedIn:"root"}),Tm),nb=((Lm=function(){function e(t,i){_classCallCheck(this,e),this.layerService=t,this.cdRef=i,this.catalogAllowLegend=!1,this.toggleCollapsedGroup=!0}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this.map.layers.map((function(e){return{id:e.options.source.id,title:e.title,type:cm.Layer}}));this.store.state.updateMany(e,{added:!0},!0),this.catalog&&void 0!==this.catalog.sortDirection&&this.store.view.sort({direction:this.catalog.sortDirection,valueAccessor:function(e){return e.title}}),this.catalogAllowLegend=!!this.catalog&&this.catalog.showLegend||this.catalogAllowLegend,this.watcher=new dn(this.store,this.cdRef)}},{key:"ngOnDestroy",value:function(){this.watcher.destroy()}},{key:"isGroup",value:function(e){return e.type===cm.Group}},{key:"isLayer",value:function(e){return e.type===cm.Layer}},{key:"onLayerAddedChange",value:function(e){var t=e.layer;this.store.state.update(t,{added:e.added},!1),e.added?this.addLayerToMap(t):this.removeLayerFromMap(t)}},{key:"onGroupAddedChange",value:function(e){var t=e.group;this.store.state.update(t,{added:e.added},!1),e.added?this.addGroupToMap(t):this.removeGroupFromMap(t)}},{key:"addLayerToMap",value:function(e){this.addLayersToMap([e])}},{key:"removeLayerFromMap",value:function(e){this.removeLayersFromMap([e])}},{key:"addLayersToMap",value:function(e){var t=this,i=e.map((function(e){return void 0===e.options.sourceOptions.optionsFromApi&&(e.options.sourceOptions.optionsFromApi=!0),t.layerService.createAsyncLayer(e.options)}));Object(dc.a).apply(void 0,_toConsumableArray(i)).subscribe((function(i){t.store.state.updateMany(e,{added:!0}),t.map.addLayers(i)}))}},{key:"removeLayersFromMap",value:function(e){var t=this;e.forEach((function(e){if(t.store.state.update(e,{added:!1}),!0===e.options.baseLayer){var i=t.map.getLayerById(e.options.id);void 0!==i&&t.map.removeLayer(i)}else{var o=t.map.getLayerById(e.id);void 0!==o&&t.map.removeLayer(o)}}))}},{key:"sortCatalogItemsByTitle",value:function(e,t){var i=e.sort((function(e,t){var i=e.title.normalize("NFD").replace(/[\u0300-\u036f]/g,""),o=t.title.normalize("NFD").replace(/[\u0300-\u036f]/g,"");return i<o?-1:i>o?1:0}));switch(t){case"asc":return i;case"desc":return i.reverse();default:return e}}},{key:"addGroupToMap",value:function(e){var t=this,i=e.items.filter((function(e){var i=t.store.state.get(e).added||!1;return t.isLayer(e)&&!1===i}));this.catalog&&void 0!==this.catalog.sortDirection&&(i=this.sortCatalogItemsByTitle(i,this.catalog.sortDirection)),this.addLayersToMap(i.reverse())}},{key:"removeGroupFromMap",value:function(e){var t=this,i=e.items.filter((function(e){var i=t.store.state.get(e).added||!1;return t.isLayer(e)&&!0===i}));this.removeLayersFromMap(i)}},{key:"resolution$",get:function(){return this.map.viewController.resolution$}}]),e}()).\u0275fac=function(e){return new(e||Lm)(r.Rb(Ff),r.Rb(r.h))},Lm.\u0275cmp=r.Lb({type:Lm,selectors:[["igo-catalog-browser"]],inputs:{catalogAllowLegend:"catalogAllowLegend",toggleCollapsedGroup:"toggleCollapsedGroup",catalog:"catalog",store:"store",map:"map"},decls:3,vars:5,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],[4,"ngIf"],[3,"catalog","group","state","resolution","catalogAllowLegend","toggleCollapsed","addedChange","layerAddedChange"],["igoListItem","",3,"layer","resolution","catalogAllowLegend","added","addedChange"]],template:function(e,t){1&e&&(r.Xb(0,"igo-list",0),r.Gc(1,Jl,2,2,"ng-template",1),r.jc(2,"async"),r.Wb()),2&e&&(r.oc("navigation",!1)("selection",!1),r.Db(1),r.oc("ngForOf",r.kc(2,3,t.store.view.all$())))},directives:function(){return[yr,m.k,m.l,ab,rb,vr]},pipes:function(){return[m.b]},encapsulation:2,changeDetection:0}),Lm),rb=((Im=function(){function e(t){_classCallCheck(this,e),this.layerService=t,this.inRange$=new L.a(!0),this.isPreview$=new L.a(!1),this.layerLegendShown$=new L.a(!1),this.igoLayer$=new L.a(void 0),this.mouseInsideAdd=!1,this.catalogAllowLegend=!1,this.added=!1,this.addedChange=new r.o,this.addedLayerIsPreview=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.isInResolutionsRange(),this.isPreview$.subscribe((function(t){return e.addedLayerIsPreview.emit(t)}))}},{key:"computeTitleTooltip",value:function(){var e=this.layer.options;if(!e.tooltip)return Zi(this.layer);var t=e.tooltip,i=e.metadata;switch(e.tooltip.type){case bf.TITLE:return this.layer.title;case bf.ABSTRACT:return i&&i.abstract?i.abstract:this.layer.title;case bf.CUSTOM:return t&&t.text?t.text:this.layer.title;default:return this.layer.title}}},{key:"onMouseEvent",value:function(e){this.onToggleClick(e)}},{key:"askForLegend",value:function(e){var t=this;this.layerLegendShown$.next(!this.layerLegendShown$.value),this.layerService.createAsyncLayer(this.layer.options).pipe(Object(vc.a)()).subscribe((function(e){return t.igoLayer$.next(e)}))}},{key:"onToggleClick",value:function(e){var t=this;if(void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),"mouseenter"!==e.type||!this.mouseInsideAdd)switch(e.type){case"click":this.isPreview$.value||(this.added?this.remove():this.add()),this.isPreview$.next(!1);break;case"mouseenter":this.isPreview$.value||this.added||(this.lastTimeoutRequest=setTimeout((function(){t.add(),t.isPreview$.next(!0)}),500)),this.mouseInsideAdd=!0;break;case"mouseleave":this.isPreview$.value&&(this.remove(),this.isPreview$.next(!1)),this.mouseInsideAdd=!1}}},{key:"add",value:function(){this.added||(this.added=!0,this.addedChange.emit({added:!0,layer:this.layer}))}},{key:"remove",value:function(){this.added&&(this.added=!1,this.addedChange.emit({added:!1,layer:this.layer}))}},{key:"haveGroup",value:function(){return!(!this.layer.address||1===this.layer.address.split(".").length)}},{key:"isInResolutionsRange",value:function(){return this.inRange$.next(this.resolution>=(this.layer.options.minResolution||0)&&this.resolution<=(this.layer.options.maxResolution||1/0)),this.inRange$.value}},{key:"computeTooltip",value:function(){return this.added?this.isPreview$.value?"igo.geo.catalog.layer.addToMap":this.inRange$.value?"igo.geo.catalog.layer.removeFromMap":"igo.geo.catalog.layer.removeFromMapOutRange":this.inRange$.value?"igo.geo.catalog.layer.addToMap":"igo.geo.catalog.layer.addToMapOutRange"}},{key:"title",get:function(){return Zi(this.layer)}},{key:"icon",get:function(){return Ji(this.layer)||"layers"}}]),e}()).\u0275fac=function(e){return new(e||Im)(r.Rb(Ff))},Im.\u0275cmp=r.Lb({type:Im,selectors:[["igo-catalog-browser-layer"]],inputs:{catalogAllowLegend:"catalogAllowLegend",added:"added",resolution:"resolution",layer:"layer"},outputs:{addedChange:"addedChange",addedLayerIsPreview:"addedLayerIsPreview"},decls:15,vars:20,consts:[["mat-list-avatar","","svgIcon","blank",4,"ngIf"],["mat-line","","matTooltipShowDelay","500",3,"ngClass","matTooltip","click"],[3,"layer"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click"],["matBadge","","igoMatBadgeIcon","eye-off","igoMatBadgeInverseColor","true","matBadgeDisabled","true","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","svgIcon"],[1,"igo-cataloglayer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],["mat-list-avatar","","svgIcon","blank"]],template:function(e,t){1&e&&(r.Xb(0,"mat-list-item"),r.Gc(1,Ql,1,0,"mat-icon",0),r.Xb(2,"h4",1),r.ec("click",(function(e){return t.askForLegend(e)})),r.Ic(3),r.Wb(),r.Sb(4,"igo-metadata-button",2),r.Xb(5,"button",3),r.ec("mouseenter",(function(e){return t.onMouseEvent(e)}))("mouseleave",(function(e){return t.onMouseEvent(e)}))("click",(function(e){return t.onToggleClick(e)})),r.jc(6,"translate"),r.jc(7,"async"),r.Sb(8,"mat-icon",4),r.jc(9,"async"),r.Wb(),r.Wb(),r.Xb(10,"div",5,6),r.Gc(12,eu,2,3,"igo-layer-legend",7),r.jc(13,"async"),r.jc(14,"async"),r.Wb()),2&e&&(r.Db(1),r.oc("ngIf",t.haveGroup()),r.Db(1),r.oc("ngClass",t.catalogAllowLegend?"igo-cataloglayer-title":"")("matTooltip",t.computeTitleTooltip()),r.Db(1),r.Jc(t.title),r.Db(1),r.oc("layer",t.layer),r.Db(1),r.oc("matTooltip",r.kc(6,10,t.computeTooltip()))("color",r.kc(7,12,t.isPreview$)?"":t.added?"warn":""),r.Db(3),r.oc("matBadgeHidden",t.isInResolutionsRange())("svgIcon",r.kc(9,14,t.isPreview$)?"plus":t.added?"delete":"plus"),r.Db(4),r.oc("ngIf",r.kc(13,16,t.layerLegendShown$)&&r.kc(14,18,t.igoLayer$)&&t.catalogAllowLegend))},directives:function(){return[h.d,m.l,dt.k,m.j,g.a,wg,l.a,u.a,Ze.a,On,h.b,lb]},pipes:function(){return[U.d,m.b]},styles:[".igo-cataloglayer-title[_ngcontent-%COMP%]{cursor:pointer}.igo-cataloglayer-legend-container[_ngcontent-%COMP%]{margin-left:40px;padding-left:18px;width:calc(100% - 18px)}"],changeDetection:0}),Im),ab=((Om=function(){function e(){_classCallCheck(this,e),this.store=new hn([]),this.added$=new L.a(!1),this.preview$=new L.a(!1),this.disabled$=new L.a(!1),this.collapsed=!0,this.catalogAllowLegend=!1,this.toggleCollapsed=!0,this.addedChange=new r.o,this.layerAddedChange=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){this.store.load(this.group.items),this.evaluateAdded(),this.evaluateDisabled(this.collapsed),this.catalog&&void 0!==this.catalog.sortDirection&&this.store.view.sort({direction:this.catalog.sortDirection,valueAccessor:function(e){return e.title}})}},{key:"ngOnDestroy",value:function(){this.store.destroy()}},{key:"isGroup",value:function(e){return e.type===cm.Group}},{key:"isLayer",value:function(e){return e.type===cm.Layer}},{key:"onToggleClick",value:function(){this.added$.value?this.remove():this.add()}},{key:"onToggleCollapsed",value:function(e){this.evaluateDisabled(e)}},{key:"onLayerAddedChange",value:function(e){this.layerAddedChange.emit(e),this.tryToggleGroup(e)}},{key:"add",value:function(){this.added$.next(!0),this.addedChange.emit({added:!0,group:this.group})}},{key:"remove",value:function(){this.added$.next(!1),this.addedChange.emit({added:!1,group:this.group})}},{key:"onLayerPreview",value:function(e){this.preview$.next(e)}},{key:"tryToggleGroup",value:function(e){var t=this,i=e.added,o=e.layer;this.store.view.all().filter((function(e){return e.id!==o.id})).map((function(e){return t.state.get(e).added||!1})).every((function(e){return e===i}))?i?this.add():this.remove():!0===this.added$.value&&this.added$.next(!1)}},{key:"evaluateAdded",value:function(){var e=this,t=this.store.all().every((function(t){return!0===(e.state.get(t).added||!1)}));this.added$.next(t)}},{key:"evaluateDisabled",value:function(e){var t=!1;!1===this.toggleCollapsed&&(t=e),this.disabled$.next(t)}},{key:"onTitleClick",value:function(){this.collapsed=!this.collapsed}},{key:"title",get:function(){return this.group.title}}]),e}()).\u0275fac=function(e){return new(e||Om)},Om.\u0275cmp=r.Lb({type:Om,selectors:[["igo-catalog-browser-group"]],inputs:{collapsed:"collapsed",catalogAllowLegend:"catalogAllowLegend",toggleCollapsed:"toggleCollapsed",catalog:"catalog",group:"group",resolution:"resolution",state:"state"},outputs:{addedChange:"addedChange",layerAddedChange:"layerAddedChange"},decls:13,vars:13,consts:[["mat-list-avatar","","svgIcon","chevron-up","igoCollapse","",1,"igo-chevron",3,"target","collapsed","toggle"],["id","catalog-group-title","mat-line","","matTooltipShowDelay","500",1,"igo-catalog-group-title",3,"matTooltip","click"],[4,"ngIf","ngIfElse"],["notadded",""],["items",""],["ngFor","",3,"ngForOf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","disabled","click"],["svgIcon","delete"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","click"],["svgIcon","plus"],[4,"ngIf"],["igoListItem","",3,"layer","resolution","catalogAllowLegend","added","addedLayerIsPreview","addedChange"]],template:function(e,t){if(1&e&&(r.Xb(0,"mat-list-item"),r.Xb(1,"mat-icon",0),r.ec("toggle",(function(e){return t.onToggleCollapsed(e)})),r.Wb(),r.Xb(2,"h4",1),r.ec("click",(function(){return t.onTitleClick()})),r.Ic(3),r.Wb(),r.Gc(4,tu,5,6,"ng-container",2),r.jc(5,"async"),r.jc(6,"async"),r.Gc(7,iu,4,6,"ng-template",null,3,r.Hc),r.Wb(),r.Xb(9,"div",null,4),r.Gc(11,ru,2,2,"ng-template",5),r.jc(12,"async"),r.Wb()),2&e){var i=r.vc(8),o=r.vc(10);r.Db(1),r.oc("target",o)("collapsed",t.collapsed),r.Db(1),r.oc("matTooltip",t.title),r.Db(1),r.Jc(t.title),r.Db(1),r.oc("ngIf",r.kc(5,7,t.added$)&&!r.kc(6,9,t.preview$))("ngIfElse",i),r.Db(7),r.oc("ngForOf",r.kc(12,11,t.store.view.all$()))}},directives:[h.d,u.a,h.b,Fn,dt.k,g.a,m.l,m.k,l.a,rb,vr],pipes:[m.b,U.d],styles:[".igo-catalog-group-title[_ngcontent-%COMP%]{cursor:pointer;opacity:.9}#catalog-group-title[_ngcontent-%COMP%]{font-weight:700}"],changeDetection:0}),Om),sb=((xm=function e(){_classCallCheck(this,e),this.sortAlpha=!1,this.onlyVisible=!1,this.onlyInRange=!1,this.keywordInitialized=!1,this.sortedAlphaInitialized=!1,this.onlyVisibleInitialized=!1,this.onlyInRangeInitialized=!1}).\u0275fac=function(e){return new(e||xm)},xm.\u0275prov=Object(r.Nb)({factory:function(){return new xm},token:xm,providedIn:"root"}),xm),cb=((wm=function(){function e(t,i,o,n){_classCallCheck(this,e),this.networkService=t,this.renderer=i,this.elRef=o,this.cdRef=n,this.focusedCls="igo-layer-item-focused",this.layerTool$=new L.a(!1),this.showLegend$=new L.a(!0),this.inResolutionRange$=new L.a(!0),this.queryBadgeHidden$=new L.a(!0),this._selectAll=!1,this.layers$=new L.a(void 0),this.toggleLegendOnVisibilityChange=!1,this.expandLegendIfVisible=!1,this.updateLegendOnResolutionChange=!1,this.orderable=!0,this.lowerDisabled=!1,this.raiseDisabled=!1,this.queryBadge=!1,this.action=new r.o(void 0),this.checkbox=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.layer.visible&&this.expandLegendIfVisible&&!0===this.layer.firstLoadComponent&&(this.layer.firstLoadComponent=!1,this.layer.legendCollapsed=!1),this.toggleLegend(this.layer.legendCollapsed),this.updateQueryBadge(),this.resolution$$=this.layer.map.viewController.resolution$.subscribe((function(){e.onResolutionChange()})),this.tooltipText=this.computeTooltip(),this.networkService.currentState().subscribe((function(t){e.state=t,e.onResolutionChange()})),this.layers$.subscribe((function(){e.layer&&e.layer.options.active&&(e.layerTool$.next(!0),e.renderer.addClass(e.elRef.nativeElement,e.focusedCls))})),this.changeDetection&&this.changeDetection.subscribe((function(){return e.cdRef.detectChanges()}))}},{key:"ngOnDestroy",value:function(){this.resolution$$.unsubscribe()}},{key:"toggleLegend",value:function(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}},{key:"toggleLegendOnClick",value:function(){this.toggleLegend(this.showLegend$.value)}},{key:"toggleVisibility",value:function(){this.layer.visible=!this.layer.visible,this.toggleLegendOnVisibilityChange&&this.toggleLegend(!this.layer.visible),this.updateQueryBadge()}},{key:"computeTooltip",value:function(){var e=this.layer.options;if(!e.tooltip)return this.layer.title;var t=e.tooltip,i=e.metadata;switch(e.tooltip.type){case bf.TITLE:return this.layer.title;case bf.ABSTRACT:return i&&i.abstract?i.abstract:this.layer.title;case bf.CUSTOM:return t&&t.text?t.text:this.layer.title;default:return this.layer.title}}},{key:"onResolutionChange",value:function(){var e=this.layer.isInResolutionsRange;!1===e&&!0===this.updateLegendOnResolutionChange&&this.toggleLegend(!0),this.inResolutionRange$.next(e)}},{key:"updateQueryBadge",value:function(){var e=!1===this.queryBadge||!1===this.layer.visible||!vm(this.layer);this.queryBadgeHidden$.next(e)}},{key:"toggleLayerTool",value:function(){this.layerTool$.next(!this.layerTool$.getValue()),!0===this.layerTool$.getValue()?this.renderer.addClass(this.elRef.nativeElement,this.focusedCls):this.renderer.removeClass(this.elRef.nativeElement,this.focusedCls),this.action.emit(this.layer)}},{key:"check",value:function(){this.layerCheck=!this.layerCheck,this.checkbox.emit({layer:this.layer,check:this.layerCheck})}},{key:"activeLayer",get:function(){return this._activeLayer},set:function(e){e&&this.layer&&e.id===this.layer.id&&!this.selectionMode?(this.layerTool$.next(!0),this.renderer.addClass(this.elRef.nativeElement,this.focusedCls)):this.renderer.removeClass(this.elRef.nativeElement,this.focusedCls)}},{key:"selectAll",get:function(){return this._selectAll},set:function(e){this._selectAll=e,!0===e&&(this.layerCheck=!0)}},{key:"layer",get:function(){return this._layer},set:function(e){this._layer=e,this.layers$.next(e)}},{key:"removable",get:function(){return!1!==this.layer.options.removable}},{key:"opacity",get:function(){return 100*this.layer.opacity},set:function(e){this.layer.opacity=e/100}}]),e}()).\u0275fac=function(e){return new(e||wm)(r.Rb(Ee),r.Rb(r.I),r.Rb(r.l),r.Rb(r.h))},wm.\u0275cmp=r.Lb({type:wm,selectors:[["igo-layer-item"]],inputs:{toggleLegendOnVisibilityChange:"toggleLegendOnVisibilityChange",expandLegendIfVisible:"expandLegendIfVisible",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",orderable:"orderable",lowerDisabled:"lowerDisabled",raiseDisabled:"raiseDisabled",queryBadge:"queryBadge",activeLayer:"activeLayer",selectAll:"selectAll",layerCheck:"layerCheck",layer:"layer",selectionMode:"selectionMode",changeDetection:"changeDetection"},outputs:{action:"action",checkbox:"checkbox"},decls:11,vars:9,consts:[[1,"igo-layer-list-item"],["class","layerCheck","mat-list-icon","",3,"checked","change",4,"ngIf"],["matLine","","matTooltipShowDelay","500",1,"igo-layer-title",3,"matTooltip","click"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","selection-eye","mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","mat-icon-button","","color","primary",3,"matTooltip","click",4,"ngIf"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer","updateLegendOnResolutionChange",4,"ngIf"],["mat-list-icon","",1,"layerCheck",3,"checked","change"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click"],["matBadge","?","matBadgeColor","accent","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","ngClass","svgIcon"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",1,"selection-eye",3,"color","matTooltip","click"],["tooltip-position","below","matTooltipShowDelay","500","mat-icon-button","","color","primary",3,"matTooltip","click"],["svgIcon","dots-horizontal"],[3,"layer","updateLegendOnResolutionChange"]],template:function(e,t){1&e&&(r.Xb(0,"mat-list-item",0),r.Gc(1,au,1,1,"mat-checkbox",1),r.Xb(2,"h4",2),r.ec("click",(function(){return t.toggleLegendOnClick()})),r.Ic(3),r.Wb(),r.Gc(4,cu,6,15,"button",3),r.Gc(5,lu,6,15,"button",4),r.Gc(6,uu,3,3,"button",5),r.Wb(),r.Xb(7,"div",6,7),r.Gc(9,hu,1,2,"igo-layer-legend",8),r.jc(10,"async"),r.Wb()),2&e&&(r.Db(1),r.oc("ngIf",t.selectionMode),r.Db(1),r.oc("matTooltip",t.tooltipText),r.Db(1),r.Jc(t.layer.title),r.Db(1),r.oc("ngIf",!t.selectionMode),r.Db(1),r.oc("ngIf",t.selectionMode),r.Db(1),r.oc("ngIf",!t.selectionMode),r.Db(3),r.oc("ngIf",r.kc(10,7,t.showLegend$)))},directives:function(){return[h.d,m.l,dt.k,g.a,v.a,h.c,l.a,u.a,Ze.a,m.j,lb]},pipes:function(){return[m.b,U.d]},styles:["[_nghost-%COMP%]{overflow:hidden}mat-list-item[_ngcontent-%COMP%]     .mat-list-item-content .layerCheck{align-self:baseline;padding-right:0;width:16px}.igo-layer-list-item[_ngcontent-%COMP%]{clear:both;height:46px}.igo-layer-title[_ngcontent-%COMP%]{cursor:pointer}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:18px;width:calc(100% - 18px)}mat-icon.disabled[_ngcontent-%COMP%]{color:rgba(0,0,0,.38)}mat-icon[matBadge][_ngcontent-%COMP%]     .mat-badge-content{font-size:12px}.selection-eye[_ngcontent-%COMP%]{padding-right:45px}"],changeDetection:0}),wm),lb=((Cm=function(){function e(t,i){_classCallCheck(this,e),this.capabilitiesService=t,this.languageService=i,this.updateLegendOnResolutionChange=!1,this.legendItems$=new L.a([]),this.scale=void 0,this.imagesHeight={}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this,t=this.layer.legend;this.styles=this.listStyles();var i=this.layer.options.source.options;i&&i.params&&i.params.STYLES?this.currentStyle=this.styles.find((function(e){return e.name===i.params.STYLES})).name:this.layer.legend?this.styles&&this.styles.length>1&&(this.currentStyle=t[0].currentStyle):this.styles&&this.styles.length>1&&(this.currentStyle=this.styles[0].name),t=void 0!==this.layer.options.legendOptions&&!1===this.layer.options.legendOptions.display?[]:this.layer.dataSource.getLegend(this.currentStyle,this.scale),!0===this.updateLegendOnResolutionChange?this.resolution$$=this.layer.map.viewController.resolution$.subscribe((function(t){return e.onResolutionChange(t)})):0!==t.length&&this.legendItems$.next(t)}},{key:"ngOnDestroy",value:function(){void 0!==this.resolution$$&&this.resolution$$.unsubscribe()}},{key:"toggleLegendItem",value:function(e,t){t.collapsed=e}},{key:"transfertToggleLegendItem",value:function(e){for(var t=e,i=this.layer.legend,o=0;o<i.length;o++)t[o].collapsed=i[o].collapsed;return t}},{key:"computeItemTitle",value:function(e){var t=this.layer.dataSource.options;if("wms"!==t.type)return Object(F.a)(e.title);var i=t.params.LAYERS.split(","),o=JSON.parse(JSON.stringify(t));return o.params.LAYERS=i.find((function(t){return t===e.title})),this.capabilitiesService.getWMSOptions(o).pipe(Object(w.a)((function(e){return e._layerOptionsFromSource.title})))}},{key:"onResolutionChange",value:function(e){this.scale=this.layer.map.viewController.getScale(),this.updateLegend()}},{key:"updateLegend",value:function(){var e=this.layer.dataSource.getLegend(this.currentStyle,this.scale);this.layer.legend&&this.layer.legend.length>1&&(e=this.transfertToggleLegendItem(e)),this.layer.legend=e,0===e.length&&0===this.legendItems$.value.length||this.legendItems$.next(e)}},{key:"listStyles",value:function(){var e=this.layer.options;if(e&&e.legendOptions){var t=[{name:"",title:this.languageService.translate.instant("igo.geo.layer.legend.default")}];return e.legendOptions.stylesAvailable&&(t=t.concat(e.legendOptions.stylesAvailable.filter((function(e){return"default"!==e.name.normalize("NFD").replace(/[\u0300-\u036f]/gi,"")&&"defaut"!==e.name.normalize("NFD").replace(/[\u0300-\u036f]/gi,"")})))),t.map((function(e){return e.title=e.title.charAt(0).toUpperCase()+e.title.slice(1).replace(/_/g," ")})),t}}},{key:"onChangeStyle",value:function(){var e=this;this.updateLegend();var t="";this.layer.dataSource.ol.getParams().LAYERS.split(",").map((function(i){return t+=e.currentStyle+","})),t=t.slice(0,-1),this.layer.dataSource.ol.updateParams({STYLES:t})}},{key:"onLoadImage",value:function(e){var t;t=1===this.renderedLegends.length?this.renderedLegends.first.nativeElement:this.renderedLegends.find((function(t){return t.nativeElement.id===e})).nativeElement,this.imagesHeight[e]=t.height}}]),e}()).\u0275fac=function(e){return new(e||Cm)(r.Rb(pf),r.Rb(Le))},Cm.\u0275cmp=r.Lb({type:Cm,selectors:[["igo-layer-legend"]],viewQuery:function(e,t){var i;1&e&&r.Oc(du,!0),2&e&&r.uc(i=r.fc())&&(t.renderedLegends=i)},inputs:{updateLegendOnResolutionChange:"updateLegendOnResolutionChange",layer:"layer"},decls:2,vars:3,consts:[[4,"ngIf"],[4,"ngIf","ngIfElse"],["noItems",""],[4,"ngFor","ngForOf"],["renderedLegends",""],[1,"igo-layer-legend",3,"ngClass"],["legend",""],["id","legend-toggle","mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","toggle"],["matLine",""],["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"ngStyle","innerHTML",4,"ngIf"],[3,"id","src","alt","load"],["renderedLegend",""],[3,"ngStyle","innerHTML"]],template:function(e,t){1&e&&(r.Gc(0,xu,4,2,"ng-container",0),r.jc(1,"async")),2&e&&r.oc("ngIf",r.kc(1,1,t.legendItems$))},directives:[m.l,m.k,m.j,h.d,u.a,h.b,Fn,dt.k,it.c,ot.a,g.a,tt.p,tt.s,dt.o,m.m],pipes:[m.b,U.d,cr],styles:['.igo-layer-legend.with-title[_ngcontent-%COMP%]{padding-left:18px}img[_ngcontent-%COMP%]:after{-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite;background-color:#fff;border:3px solid #f3f3f3;border-radius:50%;content:" ";float:left;height:17px;position:relative;right:19px;top:-3px;width:17px}@-moz-document url-prefix(){img:after{margin-left:19px}}@-webkit-keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}'],changeDetection:0}),Cm),ub=function(e){return e.always="always",e.never="never",e.default="default",e}({}),hb=function(e){return e.ALL_VISIBLE="ALL_VISIBLE",e.ALL_HIDDEN="ALL_HIDDEN",e.MIXED="MIXED",e.NULL="NULL",e}({}),db=((Vm=function(){function e(t){_classCallCheck(this,e),this.elRef=t,this.orderable=!0,this.thresholdToFilterAndSort=5,this.layers$=new L.a([]),this.change$=new Ge.a(1),this.showToolbar$=new L.a(!1),this.hideSelectedLayers=!0,this.activeLayer$=new L.a(void 0),this.layersChecked=[],this.layerItemChangeDetection$=new L.a(void 0),this.layersAreAllVisible=!0,this.ogcButton=!0,this.timeButton=!0,this.floatLabel="auto",this.layerFilterAndSortOptions={},this.excludeBaseLayers=!1,this.toggleLegendOnVisibilityChange=!1,this.expandLegendOfVisibleLayers=!1,this.updateLegendOnResolutionChange=!1,this.queryBadge=!1,this.appliedFilterAndSort=new r.o,this._keyword=void 0,this._onlyVisible=!1,this._sortedAlpha=!1,this.toggleOpacity=!1,this.selectAllCheck$=new L.a(void 0)}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.change$$=this.change$.pipe(Object(yc.a)((function(){return 0===e.layers.length?pc.a:Object(gc.a)(50)}))).subscribe((function(){e.showToolbar$.next(e.computeShowToolbar()),e.layers$.next(e.computeLayers(e.layers.slice(0))),e.appliedFilterAndSort.emit({keyword:e.keyword,sortAlpha:e.sortAlpha,onlyVisible:e.onlyVisible})})),this.selectAllCheck$.subscribe((function(t){e.selectAllCheck=t})),this.layers$.subscribe((function(){if(e.layers){var t,i=0,o=_createForOfIteratorHelper(e.layers);try{for(o.s();!(t=o.n()).done;){var n=t.value;n.options.active&&(e.activeLayer=n,e.layerTool=!0),n.options.check&&(i+=1)}}catch(r){o.e(r)}finally{o.f()}e.selectAllCheck=e.excludeBaseLayers?i===e.layers.filter((function(e){return!0!==e.baseLayer&&e.showInLayerList})).length:i===e.layers.filter((function(e){return e.showInLayerList})).length}}))}},{key:"ngOnDestroy",value:function(){this.change$$.unsubscribe()}},{key:"clearKeyword",value:function(){this.keyword=void 0}},{key:"getLowerLayer",value:function(){return this.layers.filter((function(e){return!e.baseLayer})).reduce((function(e,t){return e.zIndex<t.zIndex?e:t}),{zIndex:void 0,id:void 0})}},{key:"isLowerBaselayer",value:function(e){var t=this.layers.findIndex((function(t){return e.id===t.id}));return!(!this.layers||!this.layers[t+1]||!0!==this.layers[t+1].baseLayer)}},{key:"getUpperLayer",value:function(){return this.layers.filter((function(e){return!e.baseLayer})).reduce((function(e,t){return e.zIndex>t.zIndex?e:t}),{zIndex:void 0,id:void 0})}},{key:"isUpperBaselayer",value:function(e){var t=this.layers.findIndex((function(t){return e.id===t.id}));return!(!this.layers||!this.layers[t-1]||!0!==this.layers[t-1].baseLayer)}},{key:"raisableLayers",value:function(e){var t,i=this,o=!1,n=0,r=_createForOfIteratorHelper(e);try{var a=function(){var r=t.value,a=i.layers.findIndex((function(e){return r.id===e.id})),s=i.layers[a];s.baseLayer&&(n+=1);var c=i.layers[a-1];c&&!0!==c.baseLayer&&!e.find((function(e){return c.id===e.id}))&&!0!==s.baseLayer&&(o=!0)};for(r.s();!(t=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}return(1===this.layersChecked.length&&this.layersChecked[0].baseLayer||n===this.layersChecked.length)&&(o=!1),o}},{key:"raisableLayer",value:function(e){return!(e<1)&&(!this.layers[e-1].options.check||this.raisableLayer(e-1))}},{key:"raiseLayers",value:function(e){var t,i=this,o=[],n=_createForOfIteratorHelper(e);try{var r=function(){var e=t.value,n=i.layers.findIndex((function(t){return t.id===e.id}));i.raisableLayer(n)&&o.push(e)};for(n.s();!(t=n.n()).done;)r()}catch(a){n.e(a)}finally{n.f()}this.map.raiseLayers(o),setTimeout((function(){var e=i.computeElementRef();i.isScrolledIntoView(e[0],e[1].offsetParent)||(e[0].scrollTop=e[1].offsetParent.offsetTop)}),100)}},{key:"lowerableLayers",value:function(e){var t,i=this,o=!1,n=0,r=_createForOfIteratorHelper(e);try{var a=function(){var r=t.value,a=i.layers.findIndex((function(e){return r.id===e.id}));i.layers[a].baseLayer&&(n+=1);var s=i.layers[a+1];s&&!0!==s.baseLayer&&!e.find((function(e){return s.id===e.id}))&&(o=!0)};for(r.s();!(t=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}return(1===this.layersChecked.length&&this.layersChecked[0].baseLayer||n===this.layersChecked.length)&&(o=!1),o}},{key:"lowerableLayer",value:function(e){return!(e>this.layers.filter((function(e){return!0!==e.baseLayer})).length-2)&&(!this.layers[e+1].options.check||this.lowerableLayer(e+1))}},{key:"lowerLayers",value:function(e){var t,i=this,o=[],n=_createForOfIteratorHelper(e);try{var r=function(){var e=t.value,n=i.layers.findIndex((function(t){return t.id===e.id}));i.lowerableLayer(n)&&o.push(e)};for(n.s();!(t=n.n()).done;)r()}catch(a){n.e(a)}finally{n.f()}this.map.lowerLayers(o),setTimeout((function(){var e=i.computeElementRef("lower");i.isScrolledIntoView(e[0],e[1].offsetParent)||(e[0].scrollTop=e[1].offsetParent.offsetTop+e[1].offsetParent.offsetHeight-e[0].clientHeight)}),100)}},{key:"next",value:function(){this.change$.next()}},{key:"computeLayers",value:function(e){var t=this.filterLayers(e);return t=this.sortAlpha?this.sortLayersByTitle(t):this.sortLayersByZindex(t)}},{key:"onKeywordChange",value:function(e){this.keyword=e}},{key:"onAppliedFilterAndSortChange",value:function(e){this.keyword=e.keyword,this.onlyVisible=e.onlyVisible,this.sortAlpha=e.sortAlpha}},{key:"filterLayers",value:function(e){var t=this;if(this.layerFilterAndSortOptions.showToolbar===ub.never)return e;if(!this.keyword&&!this.onlyVisible)return e;var i=e.map((function(e){return e.id}));return e.forEach((function(e){var o=e.dataSource.options||{},n=(((e.options||{}).metadata||{}).keywordList||[]).map((function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}));if(t.keyword&&e.title){var r=t.keyword.normalize("NFD").replace(/[\u0300-\u036f]/g,""),a=e.title.normalize("NFD").replace(/[\u0300-\u036f]/g,""),s=o.type||"",c=new RegExp(r,"gi"),l=void 0!==n.find((function(e){return c.test(e)}));if(!c.test(a)&&t.keyword.toLowerCase()!==s.toLowerCase()&&!l){var u=i.indexOf(e.id);u>-1&&i.splice(u,1)}}if(t.onlyVisible&&!1===e.visible){var h=i.indexOf(e.id);h>-1&&i.splice(h,1)}})),e.filter((function(e){return-1!==i.indexOf(e.id)}))}},{key:"sortLayersByZindex",value:function(e){return e.sort((function(e,t){return t.zIndex-e.zIndex}))}},{key:"sortLayersByTitle",value:function(e){var t=this;return e.sort((function(e,i){return t.normalize(e.title)<t.normalize(i.title)?-1:t.normalize(e.title)>t.normalize(i.title)?1:0}))}},{key:"normalize",value:function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}},{key:"computeShowToolbar",value:function(){switch(this.layerFilterAndSortOptions.showToolbar){case ub.always:return!0;case ub.never:return!1;default:return!!(this.layers.length>=this.thresholdToFilterAndSort||this.keyword||this.onlyVisible)}}},{key:"toggleLayerTool",value:function(e){this.toggleOpacity=!1,this.layerTool=!this.layerTool||e!==this.activeLayer;var t,i=_createForOfIteratorHelper(this.layers);try{for(i.s();!(t=i.n()).done;)t.value.options.active=!1}catch(o){i.e(o)}finally{i.f()}e.options.active=!0,this.activeLayer=e}},{key:"removeLayers",value:function(e){if(e&&e.length>0){var t,i=_createForOfIteratorHelper(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.map.removeLayer(o)}}catch(n){i.e(n)}finally{i.f()}this.layersChecked=[]}else e||(this.activeLayer.map.removeLayer(this.activeLayer),this.layerTool=!1)}},{key:"toggleVisibility",value:function(e){if(e&&e.length>0){var t,i=_createForOfIteratorHelper(e);try{for(i.s();!(t=i.n()).done;)t.value.visible=this.hideSelectedLayers}catch(o){i.e(o)}finally{i.f()}}this.layerItemChangeDetection$.next(!0)}},{key:"layersCheck",value:function(e){var t=this;if(e.layer.options.check=e.check,!0===e.check){var i,o=this.layers.findIndex((function(t){return e.layer.id===t.id})),n=_createForOfIteratorHelper(this.layersChecked);try{var r=function(){var n=i.value;if(o<t.layers.findIndex((function(e){return n.id===e.id})))return{v:(t.layersChecked.splice(t.layersChecked.findIndex((function(e){return n.id===e.id})),0,e.layer),void(t.excludeBaseLayers?t.selectAllCheck=t.layersChecked.length===t.layers.filter((function(e){return!0!==e.baseLayer&&e.showInLayerList})).length:t.excludeBaseLayers||(t.selectAllCheck=t.layersChecked.length===t.layers.filter((function(e){return e.showInLayerList})).length)))}};for(n.s();!(i=n.n()).done;){var a=r();if("object"==typeof a)return a.v}}catch(c){n.e(c)}finally{n.f()}this.layersChecked.push(e.layer)}else{var s=this.layersChecked.findIndex((function(t){return e.layer.id===t.id}));this.layersChecked.splice(s,1)}this.excludeBaseLayers?this.selectAllCheck=this.layersChecked.length===this.layers.filter((function(e){return!0!==e.baseLayer&&e.showInLayerList})).length:this.excludeBaseLayers||(this.selectAllCheck=this.layersChecked.length===this.layers.filter((function(e){return e.showInLayerList})).length)}},{key:"toggleSelectionMode",value:function(e){if(this.selection=e,this.activeLayer=void 0,!0===e){this.layerTool=!1;var t,i=_createForOfIteratorHelper(this.layers);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.options.check&&this.layersChecked.push(o)}}catch(n){i.e(n)}finally{i.f()}}}},{key:"layersCheckedOpacity",value:function(){if(this.layersChecked.length>1)return 1;var e,t=[],i=_createForOfIteratorHelper(this.layersChecked);try{for(i.s();!(e=i.n()).done;){var o=e.value;t.push(o.opacity)}}catch(n){i.e(n)}finally{i.f()}return t}},{key:"selectAll",value:function(){if(this.selectAllCheck){var e,t=_createForOfIteratorHelper(this.layers);try{for(t.s();!(e=t.n()).done;)e.value.options.check=!1}catch(r){t.e(r)}finally{t.f()}this.layersChecked=[],this.selectAllCheck$.next(!1)}else{var i,o=_createForOfIteratorHelper(this.layers);try{for(o.s();!(i=o.n()).done;){var n=i.value;(this.excludeBaseLayers&&!0!==n.baseLayer&&n.showInLayerList||!this.excludeBaseLayers&&n.showInLayerList)&&(n.options.check=!0,this.layersChecked.push(n))}}catch(r){o.e(r)}finally{o.f()}this.selectAllCheck$.next(!0)}}},{key:"isScrolledIntoView",value:function(e,t){var i=e.scrollTop,o=t.offsetTop;return o+t.clientHeight<=i+e.clientHeight&&o>=i}},{key:"computeElementRef",value:function(e){var t=this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked"),i="lower"===e?this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked")[t.length-1]:this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked")[0];return[this.elRef.nativeElement.getElementsByTagName("igo-list")[0],i]}},{key:"map",get:function(){return this._map},set:function(e){this._map=e}},{key:"layers",set:function(e){this._layers=e,this.next()},get:function(){return this._layers}},{key:"activeLayer",set:function(e){this._activeLayer=e,this.activeLayer$.next(e)},get:function(){return this._activeLayer}},{key:"keyword",get:function(){return this._keyword},set:function(e){this._keyword=e,this.next()}},{key:"onlyVisible",get:function(){return this._onlyVisible},set:function(e){this._onlyVisible=e,this.next()}},{key:"sortAlpha",get:function(){return this._sortedAlpha},set:function(e){this._sortedAlpha=e,this.next()}},{key:"opacity",get:function(){return Math.round(100*this.activeLayer$.getValue().opacity)},set:function(e){this.activeLayer$.getValue().opacity=e/100}},{key:"badgeOpacity",get:function(){if(100!==this.opacity)return this.opacity}},{key:"raiseDisabled",get:function(){return!(this.orderable&&!this.activeLayer.baseLayer&&this.getUpperLayer().id!==this.activeLayer.id&&!this.isUpperBaselayer(this.activeLayer))}},{key:"lowerDisabled",get:function(){return!(this.orderable&&!this.activeLayer.baseLayer&&this.getLowerLayer().id!==this.activeLayer.id&&!this.isLowerBaselayer(this.activeLayer))}},{key:"raiseDisabledSelection",get:function(){return 0===this.layersChecked.length||!this.orderable||!this.raisableLayers(this.layersChecked)||!0===this.selectAllCheck}},{key:"lowerDisabledSelection",get:function(){return 0===this.layersChecked.length||!this.orderable||!this.lowerableLayers(this.layersChecked)||!0===this.selectAllCheck}},{key:"checkOpacity",get:function(){return 100*this.layersCheckedOpacity()},set:function(e){var t,i=_createForOfIteratorHelper(this.layersChecked);try{for(i.s();!(t=i.n()).done;)t.value.opacity=e/100}catch(o){i.e(o)}finally{i.f()}}},{key:"statusSelectedLayersCheck",get:function(){var e=hb.NULL,t=!1,i=!1;if(0===this.layersChecked.length)e=hb.NULL;else{e=hb.MIXED,this.hideSelectedLayers=!1;var o,n=_createForOfIteratorHelper(this.layersChecked);try{for(n.s();!(o=n.n()).done;){var r=o.value;!0===r.visible&&(t=!0),!1===r.visible&&(i=!0)}}catch(a){n.e(a)}finally{n.f()}!0===t&&!1===i&&(e=hb.ALL_VISIBLE),!1===t&&!0===i&&(e=hb.ALL_HIDDEN,this.hideSelectedLayers=!0)}return e}}]),e}()).\u0275fac=function(e){return new(e||Vm)(r.Rb(r.l))},Vm.\u0275cmp=r.Lb({type:Vm,selectors:[["igo-layer-list"]],contentQueries:function(e,t,i){var o;1&e&&r.Kb(i,Ou,!0),2&e&&r.uc(o=r.fc())&&(t.templateLayerToolbar=o.first)},inputs:{layersAreAllVisible:"layersAreAllVisible",ogcButton:"ogcButton",timeButton:"timeButton",floatLabel:"floatLabel",layerFilterAndSortOptions:"layerFilterAndSortOptions",excludeBaseLayers:"excludeBaseLayers",toggleLegendOnVisibilityChange:"toggleLegendOnVisibilityChange",expandLegendOfVisibleLayers:"expandLegendOfVisibleLayers",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",queryBadge:"queryBadge",map:"map",layers:"layers"},outputs:{appliedFilterAndSort:"appliedFilterAndSort"},ngContentSelectors:Au,decls:8,vars:11,consts:[[3,"ngClass","navigation","selection"],["igoList",""],["floatLabel","auto",3,"layersAreAllVisible","term","onlyVisible","sortAlpha","appliedFilterAndSort","selection",4,"ngIf"],["ngFor","",3,"ngForOf"],["class","igo-layer-actions-container",3,"title",4,"ngIf"],["floatLabel","auto",3,"layersAreAllVisible","term","onlyVisible","sortAlpha","appliedFilterAndSort","selection"],["igoListItem","",3,"layer","activeLayer","orderable","lowerDisabled","raiseDisabled","queryBadge","expandLegendIfVisible","updateLegendOnResolutionChange","toggleLegendOnVisibilityChange","selectionMode","selectAll","layerCheck","changeDetection","action","checkbox",4,"ngIf"],["igoListItem","",3,"layer","activeLayer","orderable","lowerDisabled","raiseDisabled","queryBadge","expandLegendIfVisible","updateLegendOnResolutionChange","toggleLegendOnVisibilityChange","selectionMode","selectAll","layerCheck","changeDetection","action","checkbox"],[1,"igo-layer-actions-container",3,"title"],[1,"igo-layer-button-group"],["igoLayerItemToolbar","",3,"ngTemplateOutlet","ngTemplateOutletContext"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matMenuTriggerFor","matTooltip"],["matBadgeColor","primary","matBadgeSize","medium","svgIcon","opacity",3,"matBadge"],[1,"mat-menu-opacity-slider"],["opacityMenu","matMenu"],["id","opacity-menu"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","ngModel","matTooltip","ngModelChange","click"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","arrow-up",3,"matBadge","matBadgeHidden"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","arrow-down",3,"matBadge","matBadgeHidden"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click"],["svgIcon","delete"],["mat-stroked-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","click"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matMenuTriggerFor","matTooltip"],["svgIcon","opacity"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","ngModel","matTooltip","ngModelChange","click",4,"ngIf"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","click"],[3,"svgIcon"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","click"]],template:function(e,t){1&e&&(r.nc(Pu),r.Xb(0,"igo-list",0,1),r.Gc(2,Iu,1,4,"igo-layer-list-tool",2),r.jc(3,"async"),r.Gc(4,Tu,1,1,"ng-template",3),r.jc(5,"async"),r.Wb(),r.Gc(6,_u,23,35,"igo-panel",4),r.Gc(7,Du,31,47,"igo-panel",4)),2&e&&(r.oc("ngClass",t.layerTool||t.selection?"igo-list-min-height":"igo-list-max-height")("navigation",!1)("selection",!1),r.Db(2),r.oc("ngIf",r.kc(3,7,t.showToolbar$)),r.Db(2),r.oc("ngForOf",r.kc(5,9,t.layers$)),r.Db(2),r.oc("ngIf",!t.selection&&t.layerTool&&t.activeLayer),r.Db(1),r.oc("ngIf",t.selection&&t.layers.length>0))},directives:function(){return[yr,m.j,m.l,m.k,pb,cb,vr,Sr,m.q,l.a,y.c,g.a,u.a,Ze.a,y.d,Sl.a,tt.p,tt.s]},pipes:function(){return[m.b,U.d]},styles:["[_nghost-%COMP%]   .igo-list-min-height[_ngcontent-%COMP%]{height:calc(100% - 91px);padding-top:8px}[_nghost-%COMP%]   .igo-list-max-height[_ngcontent-%COMP%]{padding-top:8px}mat-form-field.inputFilter[_ngcontent-%COMP%]{max-width:200px;width:calc(100% - 100px)}.igo-layer-actions-container[_ngcontent-%COMP%]{padding-left:5px;width:calc(100% - 5px)}.igo-layer-actions-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{text-align:center}#opacity-slider[_ngcontent-%COMP%]{float:left;left:10px;min-width:unset;top:10px;width:110px}.igo-layer-button-group[_ngcontent-%COMP%]{display:flex;float:right;padding-top:5px}[_nghost-%COMP%]   igo-panel[_ngcontent-%COMP%]{height:unset}#opacity-menu[_ngcontent-%COMP%]{height:50px;max-width:unset;width:132px}#opacity-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%]:not(:empty){padding-top:20px}"],changeDetection:0}),Vm),pb=((Bm=function(){function e(){_classCallCheck(this,e),this.onlyVisible$=new L.a(!1),this.sortAlpha$=new L.a(!1),this.term$=new L.a(void 0),this.layersAreAllVisible=!0,this.floatLabel="auto",this.selectionMode=!1,this.appliedFilterAndSort=new r.o,this.selection=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.term$$=this.term$.subscribe((function(t){e.appliedFilterAndSort.emit({keyword:t,onlyVisible:e.onlyVisible,sortAlpha:e.sortAlpha})})),this.onlyVisible$$=this.onlyVisible$.subscribe((function(t){e.appliedFilterAndSort.emit({keyword:e.term,onlyVisible:t,sortAlpha:e.sortAlpha})})),this.sortAlpha$$=this.sortAlpha$.subscribe((function(t){e.appliedFilterAndSort.emit({keyword:e.term,onlyVisible:e.onlyVisible,sortAlpha:t})}))}},{key:"ngOnDestroy",value:function(){this.onlyVisible$$.unsubscribe(),this.sortAlpha$$.unsubscribe(),this.term$$.unsubscribe()}},{key:"clearTerm",value:function(){this.term=void 0}},{key:"toggleSortAlpha",value:function(){this.sortAlpha=!this.sortAlpha}},{key:"toggleOnlyVisible",value:function(){this.onlyVisible=!this.onlyVisible}},{key:"toggleSelectionMode",value:function(){this.selectionMode=!this.selectionMode,this.selection.emit(this.selectionMode)}},{key:"onlyVisible",set:function(e){this.onlyVisible$.next(e)},get:function(){return this.onlyVisible$.value}},{key:"sortAlpha",set:function(e){this.sortAlpha$.next(e)},get:function(){return this.sortAlpha$.value}},{key:"term",set:function(e){this.term$.next(e)},get:function(){return this.term$.value}}]),e}()).\u0275fac=function(e){return new(e||Bm)},Bm.\u0275cmp=r.Lb({type:Bm,selectors:[["igo-layer-list-tool"]],inputs:{layersAreAllVisible:"layersAreAllVisible",floatLabel:"floatLabel",onlyVisible:"onlyVisible",sortAlpha:"sortAlpha",term:"term"},outputs:{appliedFilterAndSort:"appliedFilterAndSort",selection:"selection"},decls:21,vars:30,consts:[[1,"inputFilter",3,"floatLabel"],["matInput","","matTooltipShowDelay","500","type","text",3,"placeholder","matTooltip","ngModel","ngModelChange"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear","color","warn",3,"click",4,"ngIf"],["matTooltipShowDelay","500",3,"matTooltip"],["mat-icon-button","",3,"color","click"],[3,"svgIcon"],["mat-icon-button","",3,"disabled","color","click"],["matBadge","","igoMatBadgeIcon","eye","igoMatBadgeInverseColor","true","igoMatBadgeInheritColor","true",3,"svgIcon"],["mat-icon-button","","color","primary",3,"click"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear","color","warn",3,"click"],["svgIcon","close"]],template:function(e,t){1&e&&(r.Xb(0,"mat-list-item"),r.Xb(1,"mat-form-field",0),r.Xb(2,"input",1),r.ec("ngModelChange",(function(e){return t.term=e})),r.jc(3,"translate"),r.jc(4,"translate"),r.Wb(),r.Gc(5,ju,2,0,"button",2),r.Wb(),r.Xb(6,"div",3),r.jc(7,"translate"),r.jc(8,"translate"),r.Xb(9,"button",4),r.ec("click",(function(){return t.toggleSortAlpha()})),r.Sb(10,"mat-icon",5),r.Wb(),r.Wb(),r.Xb(11,"div",3),r.jc(12,"translate"),r.jc(13,"translate"),r.Xb(14,"button",6),r.ec("click",(function(){return t.toggleOnlyVisible()})),r.Sb(15,"mat-icon",7),r.Wb(),r.Wb(),r.Xb(16,"div",3),r.jc(17,"translate"),r.jc(18,"translate"),r.Xb(19,"button",8),r.ec("click",(function(){return t.toggleSelectionMode()})),r.Sb(20,"mat-icon",5),r.Wb(),r.Wb(),r.Wb()),2&e&&(r.Db(1),r.oc("floatLabel",t.floatLabel),r.Db(1),r.oc("placeholder",r.kc(3,14,"igo.geo.layer.filterPlaceholder"))("matTooltip",r.kc(4,16,"igo.geo.layer.subsetLayersListKeyword"))("ngModel",t.term),r.Db(3),r.oc("ngIf",t.term),r.Db(1),r.oc("matTooltip",t.sortAlpha?r.kc(7,18,"igo.geo.layer.sortMapOrder"):r.kc(8,20,"igo.geo.layer.sortAlphabetically")),r.Db(3),r.oc("color",t.sortAlpha?"warn":"primary"),r.Db(1),r.oc("svgIcon",t.sortAlpha?"sort-ascending":"sort-alphabetical-ascending"),r.Db(1),r.oc("matTooltip",t.onlyVisible?r.kc(12,22,"igo.geo.layer.resetLayersList"):r.kc(13,24,"igo.geo.layer.subsetLayersListOnlyVisible")),r.Db(3),r.oc("disabled",t.layersAreAllVisible&&!t.onlyVisible)("color",t.onlyVisible?"warn":"primary"),r.Db(1),r.oc("svgIcon",t.onlyVisible?"filter-remove":"filter"),r.Db(1),r.oc("matTooltip",t.selectionMode?r.kc(17,26,"igo.geo.layer.deactivateSelectionMode"):r.kc(18,28,"igo.geo.layer.activateSelectionMode")),r.Db(4),r.oc("svgIcon",t.selectionMode?"checkbox-multiple-marked-outline":"checkbox-multiple-blank-outline"))},directives:[h.d,it.c,et.b,tt.c,g.a,tt.p,tt.s,m.l,l.a,u.a,Ze.a,On,it.h],pipes:[U.d],styles:["mat-form-field.inputFilter[_ngcontent-%COMP%]{max-width:200px;width:calc(100% - 100px)}"],changeDetection:0}),Bm),gb=((Gm=function(){function e(t,i,o){_classCallCheck(this,e),this.mapService=i,this.route=o,this.component=t}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.layersOrResolutionChange$$=Object(_.a)([this.mapService.getMap().layers$,this.mapService.getMap().viewController.resolution$]).pipe(Object(O.a)(10)).subscribe((function(t){var i=t[0].filter((function(e){return!0===e.showInLayerList}));e.component.layers=i,e.setLayersVisibilityStatus(i,e.component.excludeBaseLayers)}))}},{key:"setLayersVisibilityStatus",value:function(e,t){var i=this;void 0!==this.layersVisibility$$&&(this.layersVisibility$$.unsubscribe(),this.layersVisibility$$=void 0),this.layersVisibility$$=Object(_.a)(e.filter((function(e){return e.baseLayer!==t})).map((function(e){return e.visible$}))).pipe(Object(w.a)((function(e){return e.every(Boolean)}))).subscribe((function(e){return i.component.layersAreAllVisible=e}))}},{key:"ngOnDestroy",value:function(){this.layersOrResolutionChange$$.unsubscribe(),void 0!==this.layersVisibility$$&&(this.layersVisibility$$.unsubscribe(),this.layersVisibility$$=void 0)}}]),e}()).\u0275fac=function(e){return new(e||Gm)(r.Rb(db,2),r.Rb(im),r.Rb(Me,8))},Gm.\u0275dir=r.Mb({type:Gm,selectors:[["","igoLayerListBinding",""]]}),Gm),fb=((Xm=function(){function e(){_classCallCheck(this,e),this.orderable=!0,this.hasVisibleOrInRangeLayers$=new L.a(!0),this.hasVisibleAndNotInRangeLayers$=new L.a(!0),this.layersInUi$=new L.a([]),this.layers$=new L.a([]),this.showAllLegend=!1,this.change$=new Ge.a(1),this.excludeBaseLayers=!1,this.updateLegendOnResolutionChange=!1,this.allowShowAllLegends=!1,this.showAllLegendsValue=!1,this.allLegendsShown=new r.o(!1)}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.change$$=this.change$.pipe(Object(yc.a)((function(){return 0===e.layers.length?pc.a:Object(gc.a)(50)}))).subscribe((function(){var t=e.computeShownLayers(e.layers.slice(0));e.layers$.next(t),e.hasVisibleOrInRangeLayers$.next(e.layers.slice(0).filter((function(e){return!0!==e.baseLayer})).filter((function(e){return e.visible$.value&&e.isInResolutionsRange$.value})).length>0),e.hasVisibleAndNotInRangeLayers$.next(e.layers.slice(0).filter((function(e){return!0!==e.baseLayer})).filter((function(e){return e.visible$.value&&!e.isInResolutionsRange$.value})).length>0),e.layersInUi$.next(e.layers.slice(0).filter((function(t){return!(!1===t.showInLayerList||e.excludeBaseLayers&&t.baseLayer)})))}))}},{key:"ngOnDestroy",value:function(){this.change$$.unsubscribe()}},{key:"next",value:function(){this.change$.next()}},{key:"computeShownLayers",value:function(e){var t=e.filter((function(e){return e.visible&&e.isInResolutionsRange}));return this.showAllLegendsValue&&(t=e),this.sortLayersByZindex(t)}},{key:"sortLayersByZindex",value:function(e){return e.sort((function(e,t){return t.zIndex-e.zIndex}))}},{key:"toggleShowAllLegends",value:function(e){this.showAllLegendsValue=e,this.next(),this.allLegendsShown.emit(e)}},{key:"layers",set:function(e){this._layers=e,this.next()},get:function(){return this._layers}}]),e}()).\u0275fac=function(e){return new(e||Xm)},Xm.\u0275cmp=r.Lb({type:Xm,selectors:[["igo-layer-legend-list"]],inputs:{excludeBaseLayers:"excludeBaseLayers",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",allowShowAllLegends:"allowShowAllLegends",showAllLegendsValue:"showAllLegendsValue",layers:"layers"},outputs:{allLegendsShown:"allLegendsShown"},decls:23,vars:39,consts:[["tooltip-position","above","matTooltipShowDelay","500","class","mat-typography",3,"matTooltip","checked","labelPosition","change",4,"ngIf"],[4,"ngIf"],[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["class","layers-empty mat-typography",4,"ngIf"],["tooltip-position","above","matTooltipShowDelay","500",1,"mat-typography",3,"matTooltip","checked","labelPosition","change"],["igoListItem","",3,"layer","updateLegendOnResolutionChange",4,"ngIf"],["igoListItem","",3,"layer","updateLegendOnResolutionChange"],[1,"layers-empty","mat-typography"]],template:function(e,t){1&e&&(r.Gc(0,Ru,4,8,"mat-slide-toggle",0),r.jc(1,"async"),r.Gc(2,$u,1,0,"mat-divider",1),r.jc(3,"async"),r.Xb(4,"igo-list",2),r.Gc(5,Wu,1,1,"ng-template",3),r.jc(6,"async"),r.Wb(),r.Gc(7,Xu,3,3,"p",4),r.jc(8,"async"),r.jc(9,"async"),r.jc(10,"async"),r.Gc(11,Gu,3,3,"p",4),r.jc(12,"async"),r.jc(13,"async"),r.jc(14,"async"),r.Gc(15,Bu,3,3,"p",4),r.jc(16,"async"),r.jc(17,"async"),r.jc(18,"async"),r.Gc(19,Vu,3,3,"p",4),r.jc(20,"async"),r.jc(21,"async"),r.jc(22,"async")),2&e&&(r.oc("ngIf",r.kc(1,9,t.layersInUi$).length&&t.allowShowAllLegends),r.Db(2),r.oc("ngIf",r.kc(3,11,t.layersInUi$).length&&t.allowShowAllLegends),r.Db(2),r.oc("navigation",!1)("selection",!1),r.Db(1),r.oc("ngForOf",r.kc(6,13,t.layers$)),r.Db(2),r.oc("ngIf",r.kc(8,15,t.layersInUi$).length&&!r.kc(9,17,t.hasVisibleOrInRangeLayers$)&&!r.kc(10,19,t.hasVisibleAndNotInRangeLayers$)&&t.allowShowAllLegends),r.Db(4),r.oc("ngIf",r.kc(12,21,t.layersInUi$).length&&!r.kc(13,23,t.hasVisibleOrInRangeLayers$)&&r.kc(14,25,t.hasVisibleAndNotInRangeLayers$)&&t.allowShowAllLegends),r.Db(4),r.oc("ngIf",r.kc(16,27,t.layersInUi$).length&&!r.kc(17,29,t.hasVisibleOrInRangeLayers$)&&!r.kc(18,31,t.hasVisibleAndNotInRangeLayers$)&&!t.allowShowAllLegends),r.Db(4),r.oc("ngIf",r.kc(20,33,t.layersInUi$).length&&!r.kc(21,35,t.hasVisibleOrInRangeLayers$)&&r.kc(22,37,t.hasVisibleAndNotInRangeLayers$)&&!t.allowShowAllLegends))},directives:function(){return[m.l,yr,m.k,kl.a,g.a,yl.a,bb,vr]},pipes:function(){return[m.b,U.d]},styles:["mat-slide-toggle[_ngcontent-%COMP%]{margin:10px;width:100%}mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}igo-list[_ngcontent-%COMP%]{display:contents}.layers-empty[_ngcontent-%COMP%]{margin:10px;text-align:justify}"],changeDetection:0}),Xm),mb=((Wm=function(){function e(){_classCallCheck(this,e),this.trackFeature=!1,this.color="primary"}return _createClass(e,[{key:"ngOnInit",value:function(){this.color=this.trackFeature?"primary":"basic"}},{key:"toggleTrackFeature",value:function(){this.trackFeature?(this.layer.disableTrackFeature(this.layer.options.trackFeature),this.color="basic"):(this.layer.enableTrackFeature(this.layer.options.trackFeature),this.color="primary"),this.trackFeature=!this.trackFeature}},{key:"options",get:function(){if(this.layer)return this.layer.options}}]),e}()).\u0275fac=function(e){return new(e||Wm)},Wm.\u0275cmp=r.Lb({type:Wm,selectors:[["igo-track-feature-button"]],inputs:{trackFeature:"trackFeature",layer:"layer"},decls:1,vars:1,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","crosshairs-gps"]],template:function(e,t){1&e&&r.Gc(0,Nu,3,4,"button",0),2&e&&r.oc("ngIf",t.options.trackFeature)},directives:[m.l,l.a,g.a,u.a],pipes:[U.d],styles:[""],changeDetection:0}),Wm),bb=((Em=function(){function e(t){_classCallCheck(this,e),this.networkService=t,this.inResolutionRange$=new L.a(!0),this.updateLegendOnResolutionChange=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.resolution$$=this.layer.map.viewController.resolution$.subscribe((function(){e.onResolutionChange()})),this.tooltipText=this.computeTooltip(),this.networkService.currentState().subscribe((function(t){e.state=t,e.onResolutionChange()}))}},{key:"ngOnDestroy",value:function(){this.resolution$$.unsubscribe()}},{key:"computeTooltip",value:function(){var e=this.layer.options;if(!e.tooltip)return this.layer.title;var t=e.tooltip,i=e.metadata;switch(e.tooltip.type){case bf.TITLE:return this.layer.title;case bf.ABSTRACT:return i&&i.abstract?i.abstract:this.layer.title;case bf.CUSTOM:return t&&t.text?t.text:this.layer.title;default:return this.layer.title}}},{key:"onResolutionChange",value:function(){this.inResolutionRange$.next(this.layer.isInResolutionsRange)}}]),e}()).\u0275fac=function(e){return new(e||Em)(r.Rb(Ee))},Em.\u0275cmp=r.Lb({type:Em,selectors:[["igo-layer-legend-item"]],inputs:{updateLegendOnResolutionChange:"updateLegendOnResolutionChange",layer:"layer"},decls:6,vars:4,consts:[[1,"igo-layer-list-item"],["matLine","","matTooltipShowDelay","500",1,"igo-layer-title",3,"matTooltip"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer","updateLegendOnResolutionChange"]],template:function(e,t){1&e&&(r.Xb(0,"mat-list-item",0),r.Xb(1,"h4",1),r.Ic(2),r.Wb(),r.Wb(),r.Xb(3,"div",2,3),r.Sb(5,"igo-layer-legend",4),r.Wb()),2&e&&(r.Db(1),r.oc("matTooltip",t.tooltipText),r.Db(1),r.Jc(t.layer.title),r.Db(3),r.oc("layer",t.layer)("updateLegendOnResolutionChange",t.updateLegendOnResolutionChange))},directives:[h.d,dt.k,g.a,lb],styles:["[_nghost-%COMP%]{overflow:hidden}.igo-layer-list-item[_ngcontent-%COMP%]{clear:both;height:46px}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:18px;width:calc(100% - 18px)}"],changeDetection:0}),Em),vb=(($m=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[Ff,Tf,sb]}}}]),e}()).\u0275mod=r.Pb({type:$m}),$m.\u0275inj=r.Ob({factory:function(e){return new(e||$m)},imports:[[et.c,it.e,m.c,tt.k,yl.b,y.b,u.b,l.b,kl.b,ot.b,g.b,h.e,Sl.b,Ze.b,v.b,Ce,kr,Mn,lr,Cr,In]]}),$m),yb=((Rm=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Rm}),Rm.\u0275inj=r.Ob({factory:function(e){return new(e||Rm)},imports:[[m.c,Ze.b,l.b,u.b,h.e,g.b,In,Ce,kr,Mn,xg,vb]]}),Rm),kb=((jm=function(){function e(){_classCallCheck(this,e),this.catalogSelectChange=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){this.store.state.clear()}},{key:"onCatalogSelect",value:function(e){this.store.state.update(e,{selected:!0,focused:!0},!0),this.catalogSelectChange.emit({selected:!0,catalog:e})}}]),e}()).\u0275fac=function(e){return new(e||jm)},jm.\u0275cmp=r.Lb({type:jm,selectors:[["igo-catalog-library"]],inputs:{store:"store",map:"map"},outputs:{catalogSelectChange:"catalogSelectChange"},decls:3,vars:4,consts:[[3,"navigation"],["ngFor","",3,"ngForOf"],["igoListItem","","color","accent",3,"map","catalog","select"]],template:function(e,t){1&e&&(r.Xb(0,"igo-list",0),r.Gc(1,zu,1,2,"ng-template",1),r.jc(2,"async"),r.Wb()),2&e&&(r.oc("navigation",!1),r.Db(1),r.oc("ngForOf",r.kc(2,2,t.store.view.all$())))},directives:function(){return[yr,m.k,Sb,vr]},pipes:function(){return[m.b]},encapsulation:2,changeDetection:0}),jm),Sb=((Am=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"title",get:function(){return Zi(this.catalog)}}]),e}()).\u0275fac=function(e){return new(e||Am)},Am.\u0275cmp=r.Lb({type:Am,selectors:[["igo-catalog-library-item"]],inputs:{catalog:"catalog",map:"map"},decls:3,vars:1,consts:[["mat-line",""]],template:function(e,t){1&e&&(r.Xb(0,"mat-list-item"),r.Xb(1,"h4",0),r.Ic(2),r.Wb(),r.Wb()),2&e&&(r.Db(2),r.Jc(t.title))},directives:[h.d,dt.k],encapsulation:2,changeDetection:0}),Am),Cb=((Pm=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Pm}),Pm.\u0275inj=r.Ob({factory:function(e){return new(e||Pm)},imports:[[m.c,u.b,h.e,g.b,kr]]}),Pm),wb=((Dm=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Dm}),Dm.\u0275inj=r.Ob({factory:function(e){return new(e||Dm)},imports:[[m.c,Ze.b,u.b,h.e,g.b,In,kr,Mn],yb,Cb]}),Dm),xb=((Mm=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e,t){var i,o=this;return"time"===t&&(i=e.filter((function(e){var t=e.dataSource;return o.isTimeFilterable(t)&&void 0!==t.options.timeFilter&&Object.keys(t.options.timeFilter).length}))),"ogc"===t&&(i=e.filter((function(e){return o.isOgcFilterable(e.dataSource)}))),i}},{key:"isTimeFilterable",value:function(e){return"wms"===e.options.type&&e.options.timeFilterable}},{key:"isOgcFilterable",value:function(e){var t=!1;return e.options.ogcFilters&&e.options.ogcFilters.enabled&&e.options.ogcFilters.editable&&(t=!0),e.options.ogcFilters&&e.options.ogcFilters.enabled&&e.options.ogcFilters.pushButtons&&(t=!0),t}}]),e}()).\u0275fac=function(e){return new(e||Mm)},Mm.\u0275pipe=r.Qb({name:"filterableDataSource",type:Mm,pure:!0}),Mm),Ob=((_m=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"filterByDate",value:function(e,t){var i,o,n;if(Array.isArray(t)){var r=[];t[0]&&(o=this.reformatDateTime(t[0]),r.push(t[0])),t[1]&&(n=this.reformatDateTime(t[1]),r.push(t[1])),2===r.length&&o!==n&&(i=e instanceof rf?o+","+n:o+"/"+n),o===n&&(i=o)}else t&&(i=this.reformatDateTime(t));e.ol.updateParams({TIME:i})}},{key:"filterByYear",value:function(e,t){var i,o,n;if(Array.isArray(t)){var r=[];t[0]&&(o=t[0],r.push(t[0])),t[1]&&(n=t[1],r.push(t[1])),2===r.length&&o!==n&&(i=e instanceof rf?o+","+n:o+"/"+n),o===n&&(i=o)}else i=t;e.ol.updateParams({TIME:i})}},{key:"reformatDateTime",value:function(e){var t=e.getFullYear(),i=e.getMonth()+1,o=e.getUTCDate(),n=e.getUTCHours(),r=e.getUTCMinutes();return Number(i)<10&&(i="0"+i),Number(o)<10&&(o="0"+o),Number(n)<10&&(n="0"+n),Number(r)<10&&(r="0"+r),t+"-"+i+"-"+o+"T"+n+":"+r+":00Z"}}]),e}()).\u0275fac=function(e){return new(e||_m)},_m.\u0275prov=r.Nb({token:_m,factory:_m.\u0275fac}),_m),Ib=((Fm=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"filterByOgc",value:function(e,t){var i=(new Wg).formatProcessedOgcFilter(t,e.options.params.LAYERS);e.ol.updateParams({FILTER:i})}},{key:"setOgcWFSFiltersOptions",value:function(e){var t=e.options,i=new Wg;t.ogcFilters.enabled&&t.ogcFilters.filters&&(t.ogcFilters.filters=i.checkIgoFiltersProperties(t.ogcFilters.filters,t.paramsWFS.fieldNameGeometry,new Cl.a({code:t.paramsWFS.srsName}),!0),t.ogcFilters.interfaceOgcFilters||(t.ogcFilters.interfaceOgcFilters=i.defineInterfaceFilterSequence(t.ogcFilters.filters,t.paramsWFS.fieldNameGeometry)))}},{key:"setOgcWMSFiltersOptions",value:function(e){var t=e.options,i=new Wg;t.ogcFilters.enabled&&t.ogcFilters.filters?(t.ogcFilters.filters=i.checkIgoFiltersProperties(t.ogcFilters.filters,t.fieldNameGeometry,void 0,!0),t.ogcFilters.interfaceOgcFilters||(t.ogcFilters.interfaceOgcFilters=i.defineInterfaceFilterSequence(t.ogcFilters.filters,t.fieldNameGeometry)),this.filterByOgc(e,i.buildFilter(t.ogcFilters.filters,void 0,void 0,void 0,e.options)),t.filtered=!0):(t.ogcFilters.filters=void 0,t.ogcFilters.interfaceOgcFilters=[],t.filtered=!1)}}]),e}()).\u0275fac=function(e){return new(e||Fm)},Fm.\u0275prov=r.Nb({token:Fm,factory:Fm.\u0275fac}),Fm),Lb=function(e){return e.Predefined="Predefined",e.Polygon="Polygon",e.Point="Point",e}({}),Tb=function(e){return e.Address="Address",e.Thematics="Thematics",e}({}),Fb=((Zm=function(){function e(t,i,o){_classCallCheck(this,e),this.http=t,this.languageService=i,this.configService=o,this.baseUrl="https://geoegl.msp.gouv.qc.ca/apis/terrapi/",this.urlFilterList={AdmRegion:"regadmin",Arrond:"arrondissements",CircFed:"circ-fed",CircProv:"circ-prov",DirReg:"dir-reg",MRC:"mrc",Mun:"municipalites",RegTour:"tourisme",bornes:"bornes-sumi",hydro:"hydro",routes:"routes"},this.baseUrl=this.configService.getConfig("spatialFilter.url")||this.baseUrl}return _createClass(e,[{key:"getKeyByValue",value:function(e,t){return Object.keys(e).find((function(i){return e[i]===t}))}},{key:"loadFilterList",value:function(e){if(e)return this.http.get(this.baseUrl+this.urlFilterList[e]).pipe(Object(w.a)((function(e){return e.features.map((function(e){return e.meta={id:e.properties.code},e}))})))}},{key:"loadThematicsList",value:function(){var e=this,t=[];return this.http.get(this.baseUrl+"types").pipe(Object(w.a)((function(i){return i.forEach((function(i){if(i.startsWith("lieux")){var o={name:void 0,source:i},n=i.substring(6,i.length),r=n;if(n.includes(".")){var a=n.indexOf(".");r=n.substring(a+1,n.length),n=n.substring(0,a)}try{o.name=e.languageService.translate.instant("igo.geo.terrapi."+r)}catch(l){o.name=r.substring(0,1).toUpperCase()+r.substring(1,r.length-1)}try{o.group=e.languageService.translate.instant("igo.geo.spatialFilter.group."+n)}catch(l){o.group=n.substring(0,1).toUpperCase()+n.substring(1,r.length-1)}t.push(o)}else if(e.getKeyByValue(e.urlFilterList,i)){var s={name:void 0,source:i},c=e.getKeyByValue(e.urlFilterList,i);try{s.name=e.languageService.translate.instant("igo.geo.terrapi."+c)}catch(l){s.name=c.substring(0,1).toUpperCase()+c.substring(1,c.length-1)}s.source=i,t.push(s)}})),t})))}},{key:"loadFilterItem",value:function(e,t,i,o,n){var r=this;if(i){var a=this.baseUrl+this.urlFilterList[i],s="";return t===Tb.Address?(s="adresses",this.http.get(a+"/"+e.properties.code+"/"+s,{params:{geometry:"true",icon:"true"}}).pipe(Object(w.a)((function(e){return e.features.map((function(e){return e.meta={id:e.properties.code,title:r.languageService.translate.instant("igo.geo.spatialFilter.Address"),icon:e.icon},e}))})))):(s=o.source,this.http.get(a+"/"+e.properties.code+"/"+s,{params:{geometry:"true",icon:"true"}}).pipe(Object(w.a)((function(e){return e.features.map((function(e){return e.meta={id:e.properties.code,title:o.name,icon:e.icon},e}))}))))}var c=this.baseUrl+"locate";return t===Tb.Address?this.http.post(c+"?type=adresses",{geometry:"true",icon:"true",buffer:n,loc:JSON.stringify(e)}).pipe(Object(w.a)((function(e){return e.features.map((function(e){return e.meta={id:e.properties.code,title:r.languageService.translate.instant("igo.geo.spatialFilter.Address"),icon:e.icon},e}))}))):this.http.post(c+"?type="+o.source,{geometry:"true",icon:"true",buffer:n,loc:JSON.stringify(e)}).pipe(Object(w.a)((function(e){return e.features.map((function(e){return e.meta={id:e.properties.code,title:o.name,icon:e.icon},e}))})))}},{key:"loadItemById",value:function(e,t){var i=this.urlFilterList[t],o="/"+e.properties.code;if(i&&o)return this.http.get(this.baseUrl+i+o,{params:{geometry:"true"}}).pipe(Object(w.a)((function(e){return e.meta={id:e.properties.code,alias:e.properties.nom,title:e.properties.nom},e})))}}]),e}()).\u0275fac=function(e){return new(e||Zm)(r.bc(k.b),r.bc(Le),r.bc(ie))},Zm.\u0275prov=Object(r.Nb)({factory:function(){return new Zm(Object(r.bc)(k.b),Object(r.bc)(Le),Object(r.bc)(ie))},token:Zm,providedIn:"root"}),Zm),_b=((Km=function(){function e(t,i){_classCallCheck(this,e),this.messageService=t,this.languageService=i}return _createClass(e,[{key:"open",value:function(e){var t=this.languageService.translate,i=t.instant("igo.geo.download.title");this.messageService.success(t.instant("igo.geo.download.start"),i);var o=e.dataSource.options;if(Object.keys(o.download).length>0)if(o.download.dynamicUrl&&void 0===o.download.url){var n,r,a=void 0===(n=e.dataSource.options.paramsWFS&&Object.keys(e.dataSource.options.paramsWFS).length>0?e.dataSource.options.paramsWFS:e.dataSource.options.params).outputFormatDownload?"outputformat="+n.outputFormat:"outputformat="+n.outputFormatDownload,s=o.download.dynamicUrl.replace(/&?outputformat=[^&]*/gi,"").replace(/&?filter=[^&]*/gi,"").replace(/&?bbox=[^&]*/gi,""),c=e.dataSource.options.ogcFilters;r=(r=(new Wg).handleOgcFiltersAppliedValue(e.dataSource.options,c.geometryName,e.map.viewController.getExtent(),new Cl.a({code:e.map.projection})))?"filter="+encodeURIComponent(r):(new Wg).buildFilter(void 0,e.map.viewController.getExtent(),new Cl.a({code:e.map.projection}),c.geometryName),window.open("".concat(s,"&").concat(r,"&").concat(a),"_blank")}else o.download&&window.open(o.download.url,"_blank")}}]),e}()).\u0275fac=function(e){return new(e||Km)(r.bc(Ie),r.bc(Le))},Km.\u0275prov=Object(r.Nb)({factory:function(){return new Km(Object(r.bc)(Ie),Object(r.bc)(Le))},token:Km,providedIn:"root"}),Km),Mb=((Ym=function(){function e(t){_classCallCheck(this,e),this.downloadService=t,this._color="primary"}return _createClass(e,[{key:"openDownload",value:function(e){this.downloadService.open(e)}},{key:"layer",get:function(){return this._layer},set:function(e){this._layer=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"options",get:function(){if(this.layer)return this.layer.dataSource.options}}]),e}()).\u0275fac=function(e){return new(e||Ym)(r.Rb(_b))},Ym.\u0275cmp=r.Lb({type:Ym,selectors:[["igo-download-button"]],inputs:{layer:"layer",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","download"]],template:function(e,t){1&e&&r.Gc(0,qu,3,4,"button",0),2&e&&r.oc("ngIf",t.options&&t.options.download&&(t.options.download.dynamicUrl||t.options.download.url))},directives:[m.l,l.a,g.a,u.a],pipes:[U.d],styles:[""],changeDetection:0}),Ym),Db=((Um=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}()).\u0275mod=r.Pb({type:Um}),Um.\u0275inj=r.Ob({factory:function(e){return new(e||Um)},imports:[[m.c,u.b,l.b,g.b,Ce]]}),Um),Pb=((Hm=function(){function e(t,i,o){var n=this;_classCallCheck(this,e),this.cdRef=t,this.sanitizer=i,this.networkService=o,this.ready=!1,this.routeEvent=new r.o,this.selectFeature=new r.o,this.networkService.currentState().subscribe((function(e){n.state=e}))}return _createClass(e,[{key:"ngOnInit",value:function(){this.ready=!0}},{key:"htmlSanitizer",value:function(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}},{key:"isObject",value:function(e){return"object"==typeof e}},{key:"isUrl",value:function(e){return"string"==typeof e&&("https://"===e.slice(0,8)||"http://"===e.slice(0,7))}},{key:"isImg",value:function(e){return!!this.isUrl(e)&&["jpg","png","gif"].includes(e.split(".").pop().toLowerCase())}},{key:"filterFeatureProperties",value:function(e){var t,i=e.meta?e.meta.alias:void 0,o={};return this.map&&this.map.offlineButtonToggle$.subscribe((function(e){t=e})),e.properties&&e.properties.Route&&this.toolbox&&!this.toolbox.getTool("directions")&&delete e.properties.Route,i?(Object.keys(i).forEach((function(t){o[i[t]]=e.properties[t]})),o):(void 0!==t&&t?e.meta&&e.meta.excludeAttributeOffline&&e.meta.excludeAttributeOffline.forEach((function(t){delete e.properties[t]})):this.state.connection&&e.meta&&e.meta.excludeAttribute?e.meta.excludeAttribute.forEach((function(t){delete e.properties[t]})):!this.state.connection&&e.meta&&e.meta.excludeAttributeOffline&&e.meta.excludeAttributeOffline.forEach((function(t){delete e.properties[t]})),e.properties)}},{key:"source",get:function(){return this._source},set:function(e){this._source=e,this.cdRef.detectChanges()}},{key:"feature",get:function(){return this._feature},set:function(e){this._feature=e,this.cdRef.detectChanges(),this.selectFeature.emit()}},{key:"title",get:function(){return Zi(this.feature)}},{key:"icon",get:function(){return Ji(this.feature)||"link"}}]),e}()).\u0275fac=function(e){return new(e||Hm)(r.Rb(r.h),r.Rb(s.b),r.Rb(Ee))},Hm.\u0275cmp=r.Lb({type:Hm,selectors:[["igo-feature-details"]],inputs:{source:"source",feature:"feature",map:"map",toolbox:"toolbox"},outputs:{routeEvent:"routeEvent",selectFeature:"selectFeature"},decls:2,vars:2,consts:[["class","igo-striped mat-typography",4,"ngIf"],[3,"src",4,"ngIf"],[1,"igo-striped","mat-typography"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","keyValue",4,"ngIf"],[3,"innerHTML",4,"ngIf"],["mat-list-avatar","",3,"svgIcon"],["target","_blank",3,"href"],["id","keyValue"],[3,"innerHTML"],["width","225","heigth","auto",3,"src",4,"ngIf","ngIfElse"],["notImg",""],["width","225","heigth","auto",3,"src"],[3,"src"]],template:function(e,t){1&e&&(r.Gc(0,ih,4,3,"table",0),r.Gc(1,oh,1,1,"iframe",1)),2&e&&(r.oc("ngIf",t.ready&&t.feature&&t.isObject(t.feature.properties)&&"iframe"!==t.feature.properties.target),r.Db(1),r.oc("ngIf",t.feature&&t.isObject(t.feature.properties)&&"iframe"===t.feature.properties.target))},directives:[m.l,m.k,u.a],pipes:[mr,U.d,m.b,cr,m.f],styles:["table[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px}#keyValue[_ngcontent-%COMP%]{width:30%}table[_ngcontent-%COMP%]     .routing{cursor:pointer}iframe[_ngcontent-%COMP%]{border:0;height:calc(100% - 4px);width:100%}"],changeDetection:0}),Hm),Ab=((qm=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:qm}),qm.\u0275inj=r.Ob({factory:function(e){return new(e||qm)},imports:[[m.c,u.b,Ce,br,lr]]}),qm),jb=((zm=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:zm}),zm.\u0275inj=r.Ob({factory:function(e){return new(e||zm)},imports:[[m.c,er],er]}),zm),Rb=((Nm=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Nm}),Nm.\u0275inj=r.Ob({factory:function(e){return new(e||Nm)},providers:[],imports:[[m.c],Ab,jb]}),Nm),$b=function(e){return e.Length="length",e.Area="area",e}({}),Eb=function(e){return e.Meters="meters",e.Kilometers="kilometers",e.Miles="miles",e.Feet="feet",e}({}),Wb=(_defineProperty(o={},Eb.Meters,"m"),_defineProperty(o,Eb.Kilometers,"km"),_defineProperty(o,Eb.Miles,"mi"),_defineProperty(o,Eb.Feet,"ft"),o),Xb=function(e){return e.SquareMeters="squareMeters",e.SquareKilometers="squareKilometers",e.SquareMiles="squareMiles",e.SquareFeet="squareFeet",e.Hectares="hectares",e.Acres="acres",e}({}),Gb=(_defineProperty(n={},Xb.SquareMeters,"m\xb2"),_defineProperty(n,Xb.SquareKilometers,"km\xb2"),_defineProperty(n,Xb.SquareMiles,"mi\xb2"),_defineProperty(n,Xb.SquareFeet,"ft\xb2"),_defineProperty(n,Xb.Hectares,"ha"),_defineProperty(n,Xb.Acres,"ac"),n);function Bb(e){return.001*e}function Vb(e){return 3.2808*e}function Nb(e){return 621e-6*e}function zb(e){return 1e-6*e}function qb(e){return 3.861e-7*e}function Hb(e){return 10.764*e}function Ub(e){return 1e-4*e}function Yb(e){return 24711e-8*e}function Kb(e,t){var i=new Map([[Eb.Meters,function(e){return e}],[Eb.Kilometers,Bb],[Eb.Miles,Nb],[Eb.Feet,Vb]]).get(t);return i?i(e):void 0}function Zb(e,t){var i=new Map([[Xb.SquareMeters,function(e){return e}],[Xb.SquareKilometers,zb],[Xb.SquareMiles,qb],[Xb.SquareFeet,Hb],[Xb.Hectares,Ub],[Xb.Acres,Yb]]).get(t);return i?i(e):void 0}function Jb(e,t,i){var o=t.decimal;(void 0===o||o<0)&&(o=1);var n=[];return n.push(void 0!==t.locale?e.toLocaleString(t.locale,{minimumFractionDigits:o,maximumFractionDigits:o}):e.toFixed(o).toString()),void 0!==t.unit&&!0===t.unitAbbr&&n.push(i?i.translate.instant(Wb[t.unit]?"igo.geo.measure."+Wb[t.unit]:"igo.geo.measure."+Gb[t.unit]):Wb[t.unit]||Gb[t.unit]),n.filter((function(e){return void 0!==e})).join(" ")}function Qb(){return new Uc.Style({stroke:new Uc.Stroke({color:"#ffcc33",lineDash:[10,10],width:2}),fill:new Uc.Fill({color:"rgba(255, 255, 255, 0.2)"}),image:new Uc.Circle({radius:5,stroke:new Uc.Stroke({color:"#ffcc33"}),fill:new Uc.Fill({color:"rgba(255, 255, 255, 0.2)"})})})}function ev(e,t){if(!(e instanceof pl.a)&&0!==e.getFlatCoordinates().length)return Object(Dl.c)(e,{projection:t})}function tv(e,t){for(var i=ev(e,t),o=function(e,t){if(!(e instanceof pl.a||e instanceof gl.a)&&0!==e.getFlatCoordinates().length)return Object(Dl.a)(e,{projection:t})}(e,t),n=[],r=e.flatCoordinates,a=r.length,s=0;s<=a-4;s+=2){var c=new gl.a([[r[s],r[s+1]],[r[s+2],r[s+3]]]);n.push(ev(c,t))}return{area:o,length:i,lengths:n}}function iv(e){for(var t=ov(e),i=e.flatCoordinates,o=t.length,n=0;n<o;n++){var r=2*n,a=new gl.a([[i[r],i[r+1]],[i[r+2],i[r+3]]]).getCoordinateAt(.5),s=t[n];void 0!==s?s.setCoordinates(a):t[n]=new pl.a(a)}return t}function ov(e){var t,i=Math.max(e.flatCoordinates.length/2-1,0),o=e.get("_midpoints");if(void 0===o)return o=new Array(i),e.set("_midpoints",o,!0),o;if(i===o.length)return o;if(i>o.length)return(t=o).push.apply(t,_toConsumableArray(new Array(i-o.length))),o;for(var n=i;n<o.length;n++){var r=o[i];void 0!==r&&nv(r)}return o.splice(i),o}function nv(e){var t=e.get("_tooltip");if(void 0!==t){var i=t.getMap();void 0!==i&&i.removeOverlay(t)}}function rv(e){var t=[].concat(function(e){return ov(e).map((function(e){return e?e.get("_tooltip"):void 0}))}(e)||[]),i=function(e){var t=e.get("_center");return t?t.get("_tooltip"):void 0}(e);return void 0!==i&&t.push(i),t}function av(e){var t=new Ml.a({element:document.createElement("div"),offset:[-30,-10],className:["igo-map-tooltip","igo-map-tooltip-measure"].join(" "),stopEvent:!1});return t.setPosition(e.flatCoordinates),e.set("_tooltip",t),t}function sv(e){return new Uc.Style({stroke:new Uc.Stroke({color:(e=e||[0,153,255]).concat([1]),width:2}),fill:new Uc.Fill({color:e.concat([.2])}),image:new Uc.Circle({radius:8,stroke:new Uc.Stroke({color:e.concat([1])}),fill:new Uc.Fill({color:e.concat([.2])})})})}function cv(){return new Uc.Style({stroke:new Uc.Stroke({color:[0,153,255,1],width:2})})}function lv(e){var t=e.target;return t instanceof dl.b?t.flatCoordinates.slice(-4,-2):t.flatCoordinates.slice(-2)}Error;var uv,hv,dv,pv,gv,fv,mv,bv,vv,yv,kv,Sv,Cv,wv,xv,Ov,Iv,Lv,Tv,Fv,_v,Mv,Dv,Pv=function(){function e(t){_classCallCheck(this,e),this.options=t,this.start$=new P.a,this.end$=new P.a,this.changes$=new P.a,this.freehand$=new L.a(!1),this.olOverlayLayer=void 0!==t.layer?t.layer:this.createOlInnerOverlayLayer()}return _createClass(e,[{key:"setOlMap",value:function(e){if(void 0===e)return this.clearOlInnerOverlaySource(),this.removeOlInnerOverlayLayer(),this.removeOlDrawInteraction(),void(this.olMap=e);this.olMap=e,this.addOlInnerOverlayLayer(),this.addOlDrawInteraction()}},{key:"getSource",value:function(){return this.olOverlaySource}},{key:"createOlInnerOverlayLayer",value:function(){return new Qc.a({source:this.options.source?this.options.source:new wc.a,style:this.options.layerStyle,zIndex:500})}},{key:"removeOlInnerOverlayLayer",value:function(){void 0===this.options.layer&&void 0!==this.olMap&&this.olMap.removeLayer(this.olOverlayLayer)}},{key:"addOlInnerOverlayLayer",value:function(){void 0===this.options.layer&&this.olMap.addLayer(this.olOverlayLayer)}},{key:"clearOlInnerOverlaySource",value:function(){void 0===this.options.layer&&void 0===this.options.source&&this.olOverlaySource.clear(!0)}},{key:"addOlDrawInteraction",value:function(){var e,t=this;e=!1===this.freehand$.getValue()?new Al.a({type:this.geometryType,source:this.getSource(),stopClick:!0,style:this.options.drawStyle,maxPoints:this.options.maxPoints,freehand:!1,freehandCondition:function(){return!1}}):new Al.a("Point"===this.geometryType?{type:"Circle",source:this.getSource(),maxPoints:this.options.maxPoints,freehand:!0}:{type:this.geometryType,source:this.getSource(),maxPoints:this.options.maxPoints,freehand:!0}),this.onDrawStartKey=e.on("drawstart",(function(e){return t.onDrawStart(e)})),this.onDrawEndKey=e.on("drawend",(function(e){return t.onDrawEnd(e)})),this.olMap.addInteraction(e),this.olDrawInteraction=e}},{key:"removeOlDrawInteraction",value:function(){void 0!==this.olDrawInteraction&&(this.unsubscribeToKeyDown(),Object(el.b)([this.onDrawStartKey,this.onDrawEndKey,this.onDrawKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olDrawInteraction),this.olDrawInteraction=void 0)}},{key:"onDrawStart",value:function(e){var t=this,i=e.feature.getGeometry();this.start$.next(i),this.clearOlInnerOverlaySource(),this.onDrawKey=i.on("change",(function(e){t.mousePosition=lv(e),t.changes$.next(e.target)})),this.subscribeToKeyDown()}},{key:"onDrawEnd",value:function(e){this.unsubscribeToKeyDown(),Object(el.b)(this.onDrawKey),this.end$.next(e.feature.getGeometry())}},{key:"subscribeToKeyDown",value:function(){var e=this;this.unsubscribeToKeyDown(),this.keyDown$$=Object(M.a)(document,"keydown").subscribe((function(t){"Escape"!==t.key?" "!==t.key||e.olMap.getView().animate({center:e.mousePosition,duration:0}):e.olDrawInteraction.removeLastPoint()}))}},{key:"unsubscribeToKeyDown",value:function(){void 0!==this.keyDown$$&&(this.keyDown$$.unsubscribe(),this.keyDown$$=void 0)}},{key:"active",get:function(){return void 0!==this.olMap}},{key:"geometryType",get:function(){return this.options.geometryType}},{key:"olOverlaySource",get:function(){return this.olOverlayLayer.getSource()}}]),e}(),Av=function(){function e(t){_classCallCheck(this,e),this.options=t,this.start$=new P.a,this.end$=new P.a,this.changes$=new P.a,this.olModifyInteractionIsActive=!1,this.olTranslateInteractionIsActive=!1,this.olDrawInteractionIsActive=!1,this.removedOlInteractions=[],this.modify=!0,this.translate=!0,void 0!==t.modify&&(this.modify=t.modify),void 0!==t.translate&&(this.translate=t.translate),this.olOverlayLayer=void 0!==t.layer?t.layer:this.createOlInnerOverlayLayer(),this.olLinearRingsLayer=this.createOlLinearRingsLayer()}return _createClass(e,[{key:"setOlMap",value:function(e){if(void 0===e)return this.clearOlInnerOverlaySource(),this.removeOlInnerOverlayLayer(),this.removeOlModifyInteraction(),this.removeOlTranslateInteraction(),this.removeOlDrawInteraction(),void(this.olMap=e);this.olMap=e,this.addOlInnerOverlayLayer(),!0===this.modify&&this.addOlDrawInteraction(),!0===this.translate&&(this.addOlTranslateInteraction(),this.activateTranslateInteraction()),!0===this.modify&&(this.addOlModifyInteraction(),this.activateModifyInteraction())}},{key:"getSource",value:function(){return this.olOverlaySource}},{key:"setOlGeometry",value:function(e){var t=new Vc.a({geometry:e});this.olOverlaySource.clear(),this.olOverlaySource.addFeature(t)}},{key:"createOlInnerOverlayLayer",value:function(){return new Qc.a({source:this.options.source?this.options.source:new wc.a,style:this.options.layerStyle,zIndex:500})}},{key:"addOlInnerOverlayLayer",value:function(){void 0===this.options.layer&&this.olMap.addLayer(this.olOverlayLayer)}},{key:"removeOlInnerOverlayLayer",value:function(){void 0===this.options.layer&&void 0!==this.olMap&&this.olMap.removeLayer(this.olOverlayLayer)}},{key:"clearOlInnerOverlaySource",value:function(){void 0===this.options.layer&&void 0===this.options.source&&this.olOverlaySource.clear(!0)}},{key:"createOlLinearRingsLayer",value:function(){return new Qc.a({source:new wc.a,style:cv(),zIndex:500})}},{key:"addOlLinearRingsLayer",value:function(){this.olMap.addLayer(this.olLinearRingsLayer)}},{key:"removeOlLinearRingsLayer",value:function(){this.olMap.removeLayer(this.olLinearRingsLayer)}},{key:"clearOlLinearRingsSource",value:function(){this.olLinearRingsSource.clear(!0)}},{key:"addOlModifyInteraction",value:function(){var e=new jl.a({source:this.olOverlaySource,style:this.options.drawStyle});this.olModifyInteraction=e}},{key:"removeOlModifyInteraction",value:function(){void 0!==this.olModifyInteraction&&(this.deactivateModifyInteraction(),this.olModifyInteraction=void 0)}},{key:"activateModifyInteraction",value:function(){var e=this;!0!==this.olModifyInteractionIsActive&&(this.olModifyInteractionIsActive=!0,this.onModifyStartKey=this.olModifyInteraction.on("modifystart",(function(t){return e.onModifyStart(t)})),this.onModifyEndKey=this.olModifyInteraction.on("modifyend",(function(t){return e.onModifyEnd(t)})),this.olMap.addInteraction(this.olModifyInteraction))}},{key:"deactivateModifyInteraction",value:function(){!1!==this.olModifyInteractionIsActive&&(this.olModifyInteractionIsActive=!1,Object(el.b)([this.onModifyStartKey,this.onModifyEndKey,this.onModifyKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olModifyInteraction))}},{key:"onModifyStart",value:function(e){var t=this,i=e.features.item(0).getGeometry();this.start$.next(i),this.onModifyKey=i.on("change",(function(e){t.mousePosition=lv(e),t.changes$.next(e.target)})),this.subscribeToKeyDown()}},{key:"onModifyEnd",value:function(e){Object(el.b)(this.onModifyKey),this.end$.next(e.features.item(0).getGeometry()),this.unsubscribeToKeyDown()}},{key:"subscribeToKeyDown",value:function(){var e=this;this.keyDown$$=Object(M.a)(document,"keydown").subscribe((function(t){" "!==t.key||e.olMap.getView().animate({center:e.mousePosition,duration:0})}))}},{key:"unsubscribeToKeyDown",value:function(){void 0!==this.keyDown$$&&this.keyDown$$.unsubscribe()}},{key:"addOlTranslateInteraction",value:function(){var e=new Rl.a({layers:[this.olOverlayLayer]});this.olTranslateInteraction=e}},{key:"removeOlTranslateInteraction",value:function(){void 0!==this.olTranslateInteraction&&(this.deactivateTranslateInteraction(),this.olTranslateInteraction=void 0)}},{key:"activateTranslateInteraction",value:function(){var e=this;!0!==this.olTranslateInteractionIsActive&&(this.olTranslateInteractionIsActive=!0,this.onTranslateStartKey=this.olTranslateInteraction.on("translatestart",(function(t){return e.onTranslateStart(t)})),this.onTranslateEndKey=this.olTranslateInteraction.on("translateend",(function(t){return e.onTranslateEnd(t)})),this.olMap.addInteraction(this.olTranslateInteraction))}},{key:"deactivateTranslateInteraction",value:function(){!1!==this.olTranslateInteractionIsActive&&(this.olTranslateInteractionIsActive=!1,Object(el.b)([this.onTranslateStartKey,this.onTranslateEndKey,this.onTranslateKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olTranslateInteraction))}},{key:"onTranslateStart",value:function(e){var t=this,i=e.features.item(0).getGeometry();this.start$.next(i),this.onTranslateKey=i.on("change",(function(e){t.changes$.next(e.target)}))}},{key:"onTranslateEnd",value:function(e){Object(el.b)(this.onTranslateKey),this.end$.next(e.features.item(0).getGeometry())}},{key:"addOlDrawInteraction",value:function(){var e=this,t=new Al.a({type:"Polygon",source:this.olLinearRingsSource,stopClick:!0,style:cv(),condition:function(t){return(e.olOuterGeometry||e.getOlGeometry()).intersectsCoordinate(t.coordinate)}});this.olDrawInteraction=t,this.subscribeToDrawKeyDown()}},{key:"subscribeToDrawKeyDown",value:function(){var e=this;this.drawKeyDown$$=Object(M.a)(document,"keydown").subscribe((function(t){if("Control"===t.key){e.unsubscribeToDrawKeyDown();var i=e.getOlGeometry();i&&i instanceof dl.b&&(e.subscribeToDrawKeyUp(),e.deactivateModifyInteraction(),e.deactivateTranslateInteraction(),e.activateDrawInteraction())}}))}},{key:"subscribeToDrawKeyUp",value:function(){var e=this;this.drawKeyUp$$=Object(M.a)(document,"keyup").subscribe((function(t){"Control"===t.key&&(e.unsubscribeToDrawKeyUp(),e.unsubscribeToKeyDown(),e.deactivateDrawInteraction(),e.activateModifyInteraction(),!0===e.translate&&e.activateTranslateInteraction(),e.subscribeToDrawKeyDown(),e.olOuterGeometry=void 0,e.clearOlLinearRingsSource(),e.end$.next(e.getOlGeometry()))}))}},{key:"unsubscribeToDrawKeyDown",value:function(){void 0!==this.drawKeyDown$$&&this.drawKeyDown$$.unsubscribe()}},{key:"unsubscribeToDrawKeyUp",value:function(){void 0!==this.drawKeyUp$$&&this.drawKeyUp$$.unsubscribe()}},{key:"removeOlDrawInteraction",value:function(){void 0!==this.olDrawInteraction&&(this.unsubscribeToKeyDown(),this.unsubscribeToDrawKeyUp(),this.unsubscribeToDrawKeyDown(),this.deactivateDrawInteraction(),this.clearOlLinearRingsSource(),this.olDrawInteraction=void 0)}},{key:"activateDrawInteraction",value:function(){var e=this;!0!==this.olDrawInteractionIsActive&&(this.clearOlLinearRingsSource(),this.addOlLinearRingsLayer(),this.olMap.getInteractions().forEach((function(t){t instanceof ml.a&&(e.olMap.removeInteraction(t),e.removedOlInteractions.push(t))})),this.olDrawInteractionIsActive=!0,this.onDrawStartKey=this.olDrawInteraction.on("drawstart",(function(t){return e.onDrawStart(t)})),this.onDrawEndKey=this.olDrawInteraction.on("drawend",(function(t){return e.onDrawEnd(t)})),this.olMap.addInteraction(this.olDrawInteraction))}},{key:"deactivateDrawInteraction",value:function(){var e=this;!1!==this.olDrawInteractionIsActive&&(this.removeOlLinearRingsLayer(),this.removedOlInteractions.forEach((function(t){e.olMap.addInteraction(t)})),this.removedOlInteractions=[],this.olDrawInteractionIsActive=!1,Object(el.b)([this.onDrawStartKey,this.onDrawEndKey,this.onDrawKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olDrawInteraction))}},{key:"onDrawStart",value:function(e){var t=this,i=e.feature.getGeometry();this.olOuterGeometry=this.getOlGeometry().clone();var o=i.getLinearRing().getCoordinates();this.addLinearRingToOlGeometry(o),this.start$.next(this.getOlGeometry()),this.onDrawKey=i.on("change",(function(e){t.mousePosition=lv(e);var i=e.target.getLinearRing().getCoordinates();t.updateLinearRingOfOlGeometry(i),t.changes$.next(t.getOlGeometry())})),this.subscribeToKeyDown()}},{key:"onDrawEnd",value:function(e){Object(el.b)(this.onDrawKey),this.olOuterGeometry=void 0;var t=e.feature.getGeometry().getLinearRing().getCoordinates();this.updateLinearRingOfOlGeometry(t),this.clearOlLinearRingsSource(),this.end$.next(this.getOlGeometry()),this.unsubscribeToKeyDown()}},{key:"addLinearRingToOlGeometry",value:function(e){var t,i;t=this.getOlGeometry(),i=new $l.a(e),t.appendLinearRing(i)}},{key:"updateLinearRingOfOlGeometry",value:function(e){var t=this.getOlGeometry(),i=t.getLinearRings().slice(0,-1).map((function(e){return e.getCoordinates()}));i.push(e),t.setCoordinates(i)}},{key:"getOlGeometry",value:function(){var e=this.olOverlaySource.getFeatures();return e.length>0?e[0].getGeometry():void 0}},{key:"active",get:function(){return void 0!==this.olMap}},{key:"olOverlaySource",get:function(){return this.olOverlayLayer.getSource()}},{key:"olLinearRingsSource",get:function(){return this.olLinearRingsLayer.getSource()}}]),e}(),jv=((Fv=function(){function e(t,i){_classCallCheck(this,e),this.dialogRef=t,this.data=i,this.measureAreaUnit=Xb,this.measureLengthUnit=Eb}return _createClass(e,[{key:"onNoClick",value:function(){this.dialogRef.close()}}]),e}()).\u0275fac=function(e){return new(e||Fv)(r.Rb(Je.f),r.Rb(Je.a))},Fv.\u0275cmp=r.Lb({type:Fv,selectors:[["igo-measurer-dialog"]],decls:88,vars:79,consts:[["mat-dialog-content",""],["colspan","2"]],template:function(e,t){1&e&&(r.Xb(0,"div",0),r.Xb(1,"h3"),r.Ic(2),r.jc(3,"translate"),r.Wb(),r.Xb(4,"table"),r.Xb(5,"thead"),r.Xb(6,"tr"),r.Xb(7,"th",1),r.Ic(8),r.jc(9,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Xb(10,"tbody"),r.Xb(11,"tr"),r.Xb(12,"td"),r.Ic(13),r.jc(14,"translate"),r.Wb(),r.Xb(15,"td"),r.Ic(16),r.jc(17,"measureFormat"),r.Wb(),r.Wb(),r.Xb(18,"tr"),r.Xb(19,"td"),r.Ic(20),r.jc(21,"translate"),r.Wb(),r.Xb(22,"td"),r.Ic(23),r.jc(24,"measureFormat"),r.Wb(),r.Wb(),r.Xb(25,"tr"),r.Xb(26,"td"),r.Ic(27),r.jc(28,"translate"),r.Wb(),r.Xb(29,"td"),r.Ic(30),r.jc(31,"measureFormat"),r.Wb(),r.Wb(),r.Xb(32,"tr"),r.Xb(33,"td"),r.Ic(34),r.jc(35,"translate"),r.Wb(),r.Xb(36,"td"),r.Ic(37),r.jc(38,"measureFormat"),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Xb(39,"table"),r.Xb(40,"thead"),r.Xb(41,"tr"),r.Xb(42,"th",1),r.Ic(43),r.jc(44,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Xb(45,"tbody"),r.Xb(46,"tr"),r.Xb(47,"td"),r.Ic(48),r.jc(49,"translate"),r.Wb(),r.Xb(50,"td"),r.Ic(51),r.jc(52,"measureFormat"),r.Wb(),r.Wb(),r.Xb(53,"tr"),r.Xb(54,"td"),r.Ic(55),r.jc(56,"translate"),r.Wb(),r.Xb(57,"td"),r.Ic(58),r.jc(59,"measureFormat"),r.Wb(),r.Wb(),r.Xb(60,"tr"),r.Xb(61,"td"),r.Ic(62),r.jc(63,"translate"),r.Wb(),r.Xb(64,"td"),r.Ic(65),r.jc(66,"measureFormat"),r.Wb(),r.Wb(),r.Xb(67,"tr"),r.Xb(68,"td"),r.Ic(69),r.jc(70,"translate"),r.Wb(),r.Xb(71,"td"),r.Ic(72),r.jc(73,"measureFormat"),r.Wb(),r.Wb(),r.Xb(74,"tr"),r.Xb(75,"td"),r.Ic(76),r.jc(77,"translate"),r.Wb(),r.Xb(78,"td"),r.Ic(79),r.jc(80,"measureFormat"),r.Wb(),r.Wb(),r.Xb(81,"tr"),r.Xb(82,"td"),r.Ic(83),r.jc(84,"translate"),r.Wb(),r.Xb(85,"td"),r.Ic(86),r.jc(87,"measureFormat"),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Wb()),2&e&&(r.Db(2),r.Jc(r.kc(3,23,"igo.geo.measure.dialog.title")),r.Db(6),r.Jc(r.kc(9,25,"igo.geo.measure.dialog.length.title")),r.Db(5),r.Jc(r.kc(14,27,"igo.geo.measure.dialog.lengthInMeters")),r.Db(3),r.Jc(r.lc(17,29,t.data.length,t.measureLengthUnit.Meters)),r.Db(4),r.Jc(r.kc(21,32,"igo.geo.measure.dialog.lengthInKilometers")),r.Db(3),r.Jc(r.lc(24,34,t.data.length,t.measureLengthUnit.Kilometers)),r.Db(4),r.Jc(r.kc(28,37,"igo.geo.measure.dialog.lengthInMiles")),r.Db(3),r.Jc(r.lc(31,39,t.data.length,t.measureLengthUnit.Miles)),r.Db(4),r.Jc(r.kc(35,42,"igo.geo.measure.dialog.lengthInFeet")),r.Db(3),r.Jc(r.lc(38,44,t.data.length,t.measureLengthUnit.Feet)),r.Db(6),r.Jc(r.kc(44,47,"igo.geo.measure.dialog.area.title")),r.Db(5),r.Jc(r.kc(49,49,"igo.geo.measure.dialog.areaInSquareMeters")),r.Db(3),r.Jc(r.lc(52,51,t.data.area,t.measureAreaUnit.SquareMeters)),r.Db(4),r.Jc(r.kc(56,54,"igo.geo.measure.dialog.areaInSquareKilometers")),r.Db(3),r.Jc(r.lc(59,56,t.data.area,t.measureAreaUnit.SquareKilometers)),r.Db(4),r.Jc(r.kc(63,59,"igo.geo.measure.dialog.areaInSquareMiles")),r.Db(3),r.Jc(r.lc(66,61,t.data.area,t.measureAreaUnit.SquareMiles)),r.Db(4),r.Jc(r.kc(70,64,"igo.geo.measure.dialog.areaInAcres")),r.Db(3),r.Jc(r.lc(73,66,t.data.area,t.measureAreaUnit.Acres)),r.Db(4),r.Jc(r.kc(77,69,"igo.geo.measure.dialog.areaInHectares")),r.Db(3),r.Jc(r.lc(80,71,t.data.area,t.measureAreaUnit.Hectares)),r.Db(4),r.Jc(r.kc(84,74,"igo.geo.measure.dialog.perimeterInMeters")),r.Db(3),r.Jc(r.lc(87,76,t.data.perimeter,t.measureLengthUnit.Meters)))},pipes:function(){return[U.d,$v]},styles:["[_nghost-%COMP%]{font-family:Roboto,Helvetica Neue,sans-serif}h3[_ngcontent-%COMP%]{margin:0;text-align:center}table[_ngcontent-%COMP%]{padding:10px;width:100%}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{padding-left:10px}"]}),Fv),Rv=((Tv=function(){function e(t,i){var o=this;_classCallCheck(this,e),this.languageService=t,this.dialog=i,this.tableTemplate={selection:!0,selectMany:!0,selectionCheckbox:!0,sort:!0,columns:[{name:"length",title:this.languageService.translate.instant("igo.geo.measure.lengthHeader"),valueAccessor:function(e){var t=o.activeLengthUnit;return Jb(Kb(e.properties.measure.length,t),{decimal:1,unit:t,unitAbbr:!1,locale:"fr"})}},{name:"area",title:this.languageService.translate.instant("igo.geo.measure.areaHeader"),valueAccessor:function(e){var t=o.activeAreaUnit,i=Zb(e.properties.measure.area,t);return i?Jb(i,{decimal:1,unit:t,unitAbbr:!1,locale:"fr"}):""}}]},this.measureType=$b,this.measureAreaUnit=Xb,this.measureLengthUnit=Eb,this.measureUnitsAuto=!1,this.measure$=new L.a({}),this.selectedFeatures$=new L.a([]),this.showTooltips=!0,this.activeLengthUnit=Eb.Meters,this.activeAreaUnit=Xb.SquareMeters,this.olDrawSource=new wc.a,this._activeMeasureType=$b.Length,this.minSegmentLength=10}return _createClass(e,[{key:"ngOnInit",value:function(){this.initStore(),this.createDrawLineControl(),this.createDrawPolygonControl(),this.createModifyControl(),this.toggleDrawControl(),this.onToggleTooltips(this.showTooltips),this.updateTooltipsOfOlSource(this.store.source.ol)}},{key:"ngOnDestroy",value:function(){this.setActiveMeasureType(void 0),this.deactivateModifyControl(),this.freezeStore()}},{key:"onMeasureTypeChange",value:function(e){this.activeMeasureType=e}},{key:"onToggleDrawControl",value:function(e){!0===e?this.toggleDrawControl():this.deactivateDrawControl()}},{key:"onToggleTooltips",value:function(e){this.showTooltips=e,!0===e?this.showTooltipsOfOlSource(this.store.source.ol):this.clearTooltipsOfOlSource(this.store.source.ol)}},{key:"onToggleMeasureUnitsAuto",value:function(e){this.measureUnitsAuto=e}},{key:"onLengthUnitChange",value:function(e){this.activeLengthUnit=e,this.table.refresh(),this.updateTooltipsOfOlSource(this.store.source.ol),void 0!==this.activeOlGeometry&&this.updateTooltipsOfOlGeometry(this.activeOlGeometry)}},{key:"onAreaUnitChange",value:function(e){this.activeAreaUnit=e,this.table.refresh(),this.updateTooltipsOfOlSource(this.store.source.ol),void 0!==this.activeOlGeometry&&this.updateTooltipsOfOlGeometry(this.activeOlGeometry)}},{key:"onCalculateClick",value:function(){var e=this.selectedFeatures$.value,t=e.reduce((function(e,t){return e+t.properties.measure.area||0}),0),i=e.reduce((function(e,t){return"Polygon"===t.geometry.type?e:e+t.properties.measure.length||0}),0),o=e.reduce((function(e,t){return"LineString"===t.geometry.type?e:e+t.properties.measure.length||0}),0);this.openDialog({area:t,length:i,perimeter:o})}},{key:"onDeleteClick",value:function(){this.store.deleteMany(this.selectedFeatures$.value)}},{key:"onModifyClick",value:function(){if(1===this.selectedFeatures$.value.length)if(!0===this.modifyControl.active)this.deactivateModifyControl(),this.toggleDrawControl();else{var e=this.selectedFeatures$.value[0],t=this.store.layer.ol.getSource().getFeatures().find((function(t){return t.get("id")===e.properties.id}));if(void 0!==t){this.deactivateDrawControl(),this.activateModifyControl();var i=t.getGeometry();this.clearTooltipsOfOlGeometry(i),this.modifyControl.setOlGeometry(i)}}}},{key:"openDialog",value:function(e){this.dialog.open(jv,{data:e})}},{key:"initStore",value:function(){var e=this,t=this.store;Rf(t,new wf({title:"Measures",zIndex:200,source:new Pg,style:new Uc.Style({stroke:new Uc.Stroke({color:"#ffcc33",width:2}),fill:new Uc.Fill({color:"rgba(255, 255, 255, 0.2)"})}),showInLayerList:!1,exportable:!1,browsable:!1})),Vf(t),function(e,t){void 0===e.getStrategyOfType(Bf)?(t=t||new Bf({map:e.map}),e.addStrategy(t),t.activate()):e.activateStrategyOfType(Bf)}(t,new Bf({map:this.map,many:!0})),this.onFeatureAddedKey=t.source.ol.on("addfeature",(function(t){var i=t.feature,o=i.getGeometry();e.updateMeasureOfOlGeometry(o,i.get("measure"))})),this.onFeatureRemovedKey=t.source.ol.on("removefeature",(function(t){var i=t.feature.getGeometry();e.clearTooltipsOfOlGeometry(i)})),this.selectedFeatures$$=t.stateView.manyBy$((function(e){return!0===e.state.selected})).pipe(Object(ze.a)(1)).subscribe((function(t){!0===e.modifyControl.active&&e.deactivateModifyControl(),e.selectedFeatures$.next(t.map((function(e){return e.entity})))}))}},{key:"freezeStore",value:function(){var e=this.store;this.selectedFeatures$$.unsubscribe(),Object(el.b)(this.onFeatureAddedKey),Object(el.b)(this.onFeatureRemovedKey),this.clearTooltipsOfOlSource(e.source.ol),this.map.removeLayer(e.layer),e.deactivateStrategyOfType(Wf),e.deactivateStrategyOfType(Bf)}},{key:"createDrawLineControl",value:function(){this.drawLineControl=new Pv({geometryType:"LineString",source:this.olDrawSource,drawStyle:Qb(),layerStyle:new Pl.c({})})}},{key:"createDrawPolygonControl",value:function(){this.drawPolygonControl=new Pv({geometryType:"Polygon",source:this.olDrawSource,drawStyle:Qb(),layerStyle:new Pl.c({})})}},{key:"createModifyControl",value:function(){this.modifyControl=new Av({source:this.olDrawSource,drawStyle:Qb(),layerStyle:new Pl.c({})})}},{key:"toggleDrawControl",value:function(){this.deactivateDrawControl(),this.activeMeasureType===$b.Length?this.activateDrawControl(this.drawLineControl):this.activeMeasureType===$b.Area&&this.activateDrawControl(this.drawPolygonControl)}},{key:"activateDrawControl",value:function(e){var t=this;this.activeDrawControl=e,this.drawStart$$=e.start$.subscribe((function(e){return t.onDrawStart(e)})),this.drawEnd$$=e.end$.subscribe((function(e){return t.onDrawEnd(e)})),this.drawChanges$$=e.changes$.subscribe((function(e){return t.onDrawChanges(e)})),e.setOlMap(this.map.ol)}},{key:"deactivateDrawControl",value:function(){void 0!==this.activeDrawControl&&(this.olDrawSource.clear(),void 0!==this.drawStart$$&&this.drawStart$$.unsubscribe(),void 0!==this.drawEnd$$&&this.drawEnd$$.unsubscribe(),void 0!==this.drawChanges$$&&this.drawChanges$$.unsubscribe(),this.clearTooltipsOfOlSource(this.olDrawSource),void 0!==this.activeOlGeometry&&this.clearTooltipsOfOlGeometry(this.activeOlGeometry),this.activeDrawControl.setOlMap(void 0),this.activeDrawControl=void 0,this.activeOlGeometry=void 0)}},{key:"setActiveMeasureType",value:function(e){this._activeMeasureType=e,this.clearMeasures(),this.toggleDrawControl()}},{key:"onDrawStart",value:function(e){this.activeOlGeometry=e}},{key:"onDrawEnd",value:function(e){this.activeOlGeometry=void 0,this.finalizeMeasureOfOlGeometry(e),this.addFeatureToStore(e),this.clearTooltipsOfOlGeometry(e),this.olDrawSource.clear(!0)}},{key:"onDrawChanges",value:function(e){var t=tv(e,this.projection);this.updateMeasureOfOlGeometry(e,Object.assign({},t,{area:void 0})),this.measure$.next(t)}},{key:"activateModifyControl",value:function(){var e=this,t=this.store.getStrategyOfType(Bf);t.deactivate(),t.clear(),this.modifyStart$$=this.modifyControl.start$.subscribe((function(t){return e.onModifyStart(t)})),this.modifyEnd$$=this.modifyControl.end$.subscribe((function(t){return e.onModifyEnd(t)})),this.modifyChanges$$=this.modifyControl.changes$.subscribe((function(t){return e.onModifyChanges(t)})),this.modifyControl.setOlMap(this.map.ol)}},{key:"deactivateModifyControl",value:function(){void 0!==this.modifyStart$$&&this.modifyStart$$.unsubscribe(),void 0!==this.modifyEnd$$&&this.modifyEnd$$.unsubscribe(),void 0!==this.modifyChanges$$&&this.modifyChanges$$.unsubscribe(),void 0!==this.activeOlGeometry&&(1===this.selectedFeatures$.value.length&&this.addFeatureToStore(this.activeOlGeometry,this.selectedFeatures$.value[0]),this.finalizeMeasureOfOlGeometry(this.activeOlGeometry)),this.olDrawSource.clear(),this.store.activateStrategyOfType(Bf),this.activeOlGeometry=void 0,this.modifyControl.setOlMap(void 0)}},{key:"onModifyStart",value:function(e){this.onDrawStart(e)}},{key:"onModifyChanges",value:function(e){this.onDrawChanges(e)}},{key:"onModifyEnd",value:function(e){this.finalizeMeasureOfOlGeometry(e)}},{key:"finalizeMeasureOfOlGeometry",value:function(e){var t=tv(e,this.projection);e instanceof dl.b&&(t=Object.assign({},t,{lengths:[]})),this.updateMeasureOfOlGeometry(e,t)}},{key:"updateMeasureOfOlGeometry",value:function(e,t){e.setProperties({_measure:t},!0),this.updateTooltipsOfOlGeometry(e)}},{key:"clearMeasures",value:function(){this.measure$.next({})}},{key:"addFeatureToStore",value:function(e,t){var i=t?t.properties.id:G(),o=this.map.ol.getView().getProjection(),n=(new fl.a).writeGeometryObject(e,{featureProjection:o,dataProjection:o});this.store.update({type:_f,geometry:n,projection:o.getCode(),properties:{id:i,measure:e.get("_measure")},meta:{id:i}})}},{key:"updateTooltipsOfOlGeometry",value:function(e){var t=e.get("_measure"),i=t.lengths,o=t.area,n=function(e){return iv(e).map((function(e){var t=e.get("_tooltip");return void 0===t?t=av(e):t.setPosition(e.flatCoordinates),t}))}(e);if(i.length===n.length)for(var r=0;r<n.length;r++){var a=i[r];void 0!==a&&this.updateOlTooltip(n[r],Kb(a,this.activeLengthUnit),this.activeLengthUnit,$b.Length)}void 0!==o&&this.updateOlTooltip(function(e){var t=function(e){var t=e.get("_center"),i=Object(Wc.x)(e.getExtent());return void 0!==t?t.setCoordinates(i):(t=new pl.a(i),e.set("_center",t)),t}(e),i=t.get("_tooltip");return void 0===i?i=av(t):i.setPosition(t.flatCoordinates),i}(e),Zb(o,this.activeAreaUnit),this.activeAreaUnit,$b.Area)}},{key:"showTooltipsOfOlGeometry",value:function(e){var t=this;rv(e).forEach((function(e){t.shouldShowTooltip(e)&&t.map.ol.addOverlay(e)}))}},{key:"clearTooltipsOfOlGeometry",value:function(e){var t=this;rv(e).forEach((function(e){void 0!==e&&void 0!==e.getMap()&&t.map.ol.removeOverlay(e)}))}},{key:"updateTooltipsOfOlSource",value:function(e){var t=this;e.forEachFeature((function(e){t.updateTooltipsOfOlGeometry(e.getGeometry())}))}},{key:"showTooltipsOfOlSource",value:function(e){var t=this;e.forEachFeature((function(e){t.showTooltipsOfOlGeometry(e.getGeometry())}))}},{key:"clearTooltipsOfOlSource",value:function(e){var t=this;e.forEachFeature((function(e){void 0!==e.getGeometry()&&t.clearTooltipsOfOlGeometry(e.getGeometry())}))}},{key:"updateOlTooltip",value:function(e,t,i,o){e.setProperties({_measure:t,_unit:i,_type:o},!0),e.getElement().innerHTML=this.computeTooltipInnerHTML(e),this.shouldShowTooltip(e)&&this.map.ol.addOverlay(e)}},{key:"computeTooltipInnerHTML",value:function(e){var t=e.getProperties();return Jb(t._measure,{decimal:1,unit:t._unit,unitAbbr:!0,locale:"fr"},this.languageService)}},{key:"shouldShowTooltip",value:function(e){if(!1===this.showTooltips)return!1;var t=e.getProperties(),i=t._measure;if(void 0===i)return!1;if(t._unit===$b.Length){var o=Kb(this.minSegmentLength,t._unit)||0;return i>Math.max(o,0)}return!0}},{key:"activeMeasureType",set:function(e){this.setActiveMeasureType(e)},get:function(){return this._activeMeasureType}},{key:"drawControlIsActive",get:function(){return void 0!==this.activeDrawControl}},{key:"projection",get:function(){return this.map.ol.getView().getProjection()}}]),e}()).\u0275fac=function(e){return new(e||Tv)(r.Rb(Le),r.Rb(Je.b))},Tv.\u0275cmp=r.Lb({type:Tv,selectors:[["igo-measurer"]],viewQuery:function(e,t){var i;1&e&&r.Ec(nh,!0),2&e&&r.uc(i=r.fc())&&(t.table=i.first)},inputs:{minSegmentLength:"minSegmentLength",activeMeasureType:"activeMeasureType",map:"map",store:"store"},decls:32,vars:41,consts:[[1,"measure-type-toggle","mat-typography"],[3,"value","change"],[3,"value"],[1,"measure-options","mat-typography"],[3,"checked","labelPosition","change"],[4,"ngIf"],[1,"measure-store-buttons"],["mat-icon-button","",3,"matTooltip","disabled","click"],["svgIcon","calculator"],["svgIcon","delete"],[1,"table-compact",3,"store","template"],["table",""],[3,"measureType","measureUnit","measure","auto","placeholder","measureUnitChange"]],template:function(e,t){1&e&&(r.Xb(0,"div"),r.Xb(1,"div",0),r.Xb(2,"mat-button-toggle-group",1),r.ec("change",(function(e){return t.onMeasureTypeChange(e.value)})),r.Xb(3,"mat-button-toggle",2),r.Ic(4),r.jc(5,"translate"),r.Wb(),r.Xb(6,"mat-button-toggle",2),r.Ic(7),r.jc(8,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Xb(9,"div",3),r.Xb(10,"mat-slide-toggle",4),r.ec("change",(function(e){return t.onToggleDrawControl(e.checked)})),r.Ic(11),r.jc(12,"translate"),r.Wb(),r.Xb(13,"mat-slide-toggle",4),r.ec("change",(function(e){return t.onToggleTooltips(e.checked)})),r.Ic(14),r.jc(15,"translate"),r.Wb(),r.Xb(16,"mat-slide-toggle",4),r.ec("change",(function(e){return t.onToggleMeasureUnitsAuto(e.checked)})),r.Ic(17),r.jc(18,"translate"),r.Wb(),r.Wb(),r.Gc(19,rh,5,14,"ng-container",5),r.jc(20,"async"),r.Xb(21,"div",6),r.Xb(22,"button",7),r.ec("click",(function(){return t.onCalculateClick()})),r.jc(23,"translate"),r.jc(24,"async"),r.Sb(25,"mat-icon",8),r.Wb(),r.Xb(26,"button",7),r.ec("click",(function(){return t.onDeleteClick()})),r.jc(27,"translate"),r.jc(28,"async"),r.Sb(29,"mat-icon",9),r.Wb(),r.Wb(),r.Sb(30,"igo-entity-table",10,11),r.Wb()),2&e&&(r.Db(2),r.oc("value",t.activeMeasureType),r.Db(1),r.oc("value",t.measureType.Length),r.Db(1),r.Kc(" ",r.kc(5,21,"igo.geo.measure."+t.measureType.Length)," "),r.Db(2),r.oc("value",t.measureType.Area),r.Db(1),r.Kc(" ",r.kc(8,23,"igo.geo.measure."+t.measureType.Area)," "),r.Db(3),r.oc("checked",t.drawControlIsActive)("labelPosition","before"),r.Db(1),r.Kc(" ",r.kc(12,25,"igo.geo.measure.toggleActive")," "),r.Db(2),r.oc("checked",t.showTooltips)("labelPosition","before"),r.Db(1),r.Kc(" ",r.kc(15,27,"igo.geo.measure.toggleMapTooltips")," "),r.Db(2),r.oc("checked",t.measureUnitsAuto)("labelPosition","before"),r.Db(1),r.Kc(" ",r.kc(18,29,"igo.geo.measure.toggleAutoUnits")," "),r.Db(2),r.oc("ngIf",r.kc(20,31,t.measure$)),r.Db(3),r.oc("matTooltip",r.kc(23,33,"igo.geo.measure.actionbar.calculate.tooltip"))("disabled",0===r.kc(24,35,t.selectedFeatures$).length),r.Db(4),r.oc("matTooltip",r.kc(27,37,"igo.geo.measure.actionbar.delete.tooltip"))("disabled",0===r.kc(28,39,t.selectedFeatures$).length),r.Db(4),r.oc("store",t.store)("template",t.tableTemplate))},directives:function(){return[Ol.b,Ol.a,kl.a,m.l,l.a,g.a,u.a,bn,Uy]},pipes:function(){return[U.d,m.b]},styles:[".measure-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.measure-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.measure-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}.measure-options[_ngcontent-%COMP%]{overflow-x:hidden}.measure-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:10px;width:100%}.measure-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.measure-store-buttons[_ngcontent-%COMP%]{border-bottom:1px solid #ddd;border-top:1px solid #ddd;width:100%}.measure-store-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-of-type{margin-left:14px}.table-compact[_ngcontent-%COMP%]     .mat-header-cell.mat-column-selectionCheckbox{width:52px}"],changeDetection:0}),Tv),$v=((Lv=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e,t){var i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object.values(Xb).indexOf(t)>=0?i=Zb(e,t):Object.values(Eb).indexOf(t)>=0&&(i=Kb(e,t)),i?Jb(i,{decimal:1,unit:t,unitAbbr:o,locale:"fr"}):i}}]),e}()).\u0275fac=function(e){return new(e||Lv)},Lv.\u0275pipe=r.Qb({name:"measureFormat",type:Lv,pure:!0}),Lv),Ev=((Iv=function(){function e(t,i){_classCallCheck(this,e),this.cdRef=t,this.ngControl=i,this.olGeoJSON=new fl.a,this.ready=!1,this.olTooltip=Ml.a,this.drawGuide=null,this.measure=!1,this._drawControlIsActive=!0,this.controlOptions={},this.onChange=function(){},this.onTouched=function(){},void 0!==this.ngControl&&(this.ngControl.valueAccessor=this)}return _createClass(e,[{key:"ngOnInit",value:function(){void 0===this.drawStyle&&(this.drawStyle=sv()),void 0===this.overlayStyle&&(this.overlayStyle=this.drawStyle),this.addOlOverlayLayer(),this.createMeasureTooltip(),this.createDrawControl(),this.createModifyControl(),this.value&&this.addGeoJSONToOverlay(this.value),this.toggleControl(),this.ready=!0}},{key:"ngOnDestroy",value:function(){this.ready=!1,this.deactivateControl(),this.olOverlaySource.clear(),this.map.ol.removeLayer(this.olOverlayLayer)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"writeValue",value:function(e){this.value=e}},{key:"addOlOverlayLayer",value:function(){this.olOverlayLayer=new Qc.a({source:new wc.a,zIndex:500,style:null}),this.map.ol.addLayer(this.olOverlayLayer)}},{key:"createDrawControl",value:function(){var e=this,t=Object.assign({},this.controlOptions,{geometryType:this.geometryType||"Point",layer:this.olOverlayLayer,drawStyle:"function"==typeof this.drawStyle?this.drawStyle:function(t,i){var o=e.drawStyle;return e.updateDrawStyleWithDrawGuide(o,i),o}});this.drawControl=new Pv(t)}},{key:"createModifyControl",value:function(){var e=this,t=Object.assign({},this.controlOptions,{layer:this.olOverlayLayer,drawStyle:"function"==typeof this.drawStyle?this.drawStyle:function(t,i){var o=e.drawStyle;return e.updateDrawStyleWithDrawGuide(o,i),o}});this.modifyControl=new Av(t)}},{key:"toggleControl",value:function(){var e;(e=!this.value&&this.geometryType?this.drawControl:this.modifyControl)!==this.activeControl&&(this.deactivateControl(),this.activateControl(e))}},{key:"activateControl",value:function(e){var t=this;this.activeControl=e,this.olGeometryEnds$$=e.end$.subscribe((function(e){return t.onOlGeometryEnds(e)})),!0===this.measure&&e===this.drawControl&&(this.olGeometryChanges$$=e.changes$.subscribe((function(e){return t.onOlGeometryChanges(e)}))),e.setOlMap(this.map.ol)}},{key:"deactivateControl",value:function(){this.removeMeasureTooltip(),void 0!==this.activeControl&&this.activeControl.setOlMap(void 0),void 0!==this.olGeometryEnds$$&&this.olGeometryEnds$$.unsubscribe(),void 0!==this.olGeometryChanges$$&&this.olGeometryChanges$$.unsubscribe(),this.activeControl=void 0}},{key:"onOlGeometryEnds",value:function(e){this.removeMeasureTooltip(),this.setOlGeometry(e)}},{key:"onOlGeometryChanges",value:function(e){"Point"!==e.getType()&&this.updateMeasureTooltip(e)}},{key:"setOlGeometry",value:function(e){var t;void 0!==e&&("Circle"===e.getType()&&(e=this.circleToPoint(e)),t=this.olGeoJSON.writeGeometryObject(e,{featureProjection:this.map.projection,dataProjection:"EPSG:4326"}),e.get("radius")&&(t.radius=e.get("radius"),e._radius=t.radius),this.writeValue(t))}},{key:"circleToPoint",value:function(e){var t=e.getCenter(),i=Object(kc.r)(t,this.map.projection,"EPSG:4326"),o=Math.round(e.getRadius()*Math.cos(Math.PI/180*i[1]));return(e=new pl.a(t)).set("radius",o,!0),e}},{key:"addGeoJSONToOverlay",value:function(e){var t=this.olGeoJSON.readGeometry(e,{dataProjection:"EPSG:4326",featureProjection:this.map.projection}),i=new Vc.a({geometry:t});i.setStyle(this.overlayStyle),this.olOverlaySource.clear(),this.olOverlaySource.addFeature(i)}},{key:"createMeasureTooltip",value:function(){this.olTooltip=new Ml.a({element:document.createElement("div"),offset:[-30,-10],className:["igo-map-tooltip","igo-map-tooltip-measure"].join(" "),stopEvent:!1})}},{key:"updateMeasureTooltip",value:function(e){var t=tv(e,this.map.projection).lengths,i="Polygon"===e.getType()?t.length-2:t.length-1,o=t[i],n=iv(e),r=n[i];if(0!==n.length&&void 0!==r){this.olTooltip.setPosition(r.flatCoordinates);var a=Jb(o,{decimal:1,unit:Eb.Meters,unitAbbr:!0,locale:"fr"});this.olTooltip.getElement().innerHTML=a,void 0===this.olTooltip.getMap()&&this.map.ol.addOverlay(this.olTooltip)}else this.removeMeasureTooltip()}},{key:"removeMeasureTooltip",value:function(){this.olTooltip.getMap&&void 0!==this.olTooltip.getMap()&&(this.map.ol.removeOverlay(this.olTooltip),this.olTooltip.setMap(void 0))}},{key:"updateDrawStyleWithDrawGuide",value:function(e,t){var i=this.getGuideStyleFromDrawStyle(e);if(void 0!==i){var o,n=this.drawGuide;o=!n||n<0?this.defaultDrawStyleRadius:n>0?n/t:n,i.getImage().setRadius(o)}}},{key:"isStyleWithRadius",value:function(e){return"function"!=typeof e&&e.getImage&&e.getImage().setRadius}},{key:"getGuideStyleFromDrawStyle",value:function(e){if(Array.isArray(e)&&(e=e[0]),this.isStyleWithRadius(e))return e}},{key:"geometryType",set:function(e){this._geometryType=e,!1!==this.ready&&(this.deactivateControl(),this.createDrawControl(),this.drawControl.freehand$.next(this.freehandDrawIsActive),this.toggleControl())},get:function(){return this._geometryType}},{key:"drawControlIsActive",get:function(){return this._drawControlIsActive},set:function(e){this._drawControlIsActive=e,!1!==this.ready&&(this.deactivateControl(),this._drawControlIsActive&&this.toggleControl())}},{key:"freehandDrawIsActive",get:function(){return this._freehandDrawIsActive},set:function(e){this._freehandDrawIsActive=e,this.deactivateControl(),this.createDrawControl(),this.createModifyControl(),this.drawControl.freehand$.next(this.freehandDrawIsActive),!1!==this.ready&&this.drawControlIsActive&&this.toggleControl()}},{key:"drawStyle",set:function(e){void 0===e&&(e=sv()),this._drawStyle=e;var t=this.getGuideStyleFromDrawStyle(e);this.defaultDrawStyleRadius=void 0!==t?t.getImage().getRadius():null,this.deactivateControl(),this.createDrawControl(),this.createModifyControl(),this.drawControl.freehand$.next(this.freehandDrawIsActive),this.toggleControl()},get:function(){return this._drawStyle}},{key:"overlayStyle",set:function(e){this._overlayStyle=e},get:function(){return this._overlayStyle}},{key:"value",set:function(e){this._value=e,!1!==this.ready&&(e?this.addGeoJSONToOverlay(e):this.olOverlaySource.clear(!0),this.onChange(e),this.toggleControl(),this.cdRef.detectChanges())},get:function(){return this._value}},{key:"olOverlaySource",get:function(){return this.olOverlayLayer.getSource()}},{key:"radius",set:function(e){var t,i=this;!1!==this.ready&&(this.modifyControl.getSource()&&this.modifyControl.getSource().refresh(),this.freehandDrawIsActive)&&setTimeout((function(){(t=i.modifyControl.olModifyInteraction)&&t.features_&&(t.features_.clear(),i.addGeoJSONToOverlay(i.value))}),0)}}]),e}()).\u0275fac=function(e){return new(e||Iv)(r.Rb(r.h),r.Rb(tt.o,10))},Iv.\u0275cmp=r.Lb({type:Iv,selectors:[["igo-geometry-form-field-input"]],inputs:{drawGuide:"drawGuide",measure:"measure",controlOptions:"controlOptions",geometryType:"geometryType",drawControlIsActive:"drawControlIsActive",freehandDrawIsActive:"freehandDrawIsActive",drawStyle:"drawStyle",overlayStyle:"overlayStyle",value:"value",radius:"radius",map:"map"},decls:1,vars:0,template:function(e,t){1&e&&r.Gc(0,ah,0,0,"ng-template")},encapsulation:2,changeDetection:0}),Iv),Wv=((Ov=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Ov}),Ov.\u0275inj=r.Ob({factory:function(e){return new(e||Ov)},imports:[[m.c,tt.k,tt.u,u.b,it.e,et.c,l.b,Ol.c,Ce]]}),Ov),Xv=((xv=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:xv}),xv.\u0275inj=r.Ob({factory:function(e){return new(e||xv)},providers:[],imports:[[m.c,Wv],Wv]}),xv),Gv=((wv=function(){function e(){_classCallCheck(this,e),this.color="primary",this.header=!0,this.timeFilterCollapse=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.options=this.layer.dataSource.options}},{key:"badge",get:function(){var e=this.options.timeFilter;return e&&e.enabled?1:void 0}},{key:"layer",get:function(){return this._layer},set:function(e){this._layer=e,e&&(this.options=this.layer.dataSource.options)}}]),e}()).\u0275fac=function(e){return new(e||wv)},wv.\u0275cmp=r.Lb({type:wv,selectors:[["igo-time-filter-button"]],inputs:{color:"color",header:"header",layer:"layer",map:"map"},decls:2,vars:2,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color",4,"ngIf"],["class","igo-layer-actions-container",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","history",3,"matBadge"],[1,"igo-layer-actions-container"],["ogcFilter",""],["igoListItem","",3,"header","layer",4,"ngIf"],["igoListItem","",3,"header","layer"]],template:function(e,t){1&e&&(r.Gc(0,sh,3,5,"button",0),r.Gc(1,lh,3,1,"div",1)),2&e&&(r.oc("ngIf",t.header&&t.options.timeFilterable&&t.options.timeFilter),r.Db(1),r.oc("ngIf",t.header&&t.options.timeFilterable&&t.options.timeFilter))},directives:function(){return[m.l,l.a,g.a,u.a,Ze.a,Vv,vr]},pipes:function(){return[U.d]},styles:[""],changeDetection:0}),wv),Bv=((Cv=function(){function e(t){_classCallCheck(this,e),this.dateAdapter=t,this.color="primary",this.listYears=[],this.startListYears=[],this.endListYears=[],this.playIcon="play-circle",this.resetIcon="replay",this.change=new r.o,this.yearChange=new r.o,this.dateAdapter.setLocale("fr")}return _createClass(e,[{key:"ngOnInit",value:function(){if(void 0===this.startDate&&(this.startDate=new Date(this.min)),void 0===this.endDate&&(this.endDate=new Date(this.max)),void 0===this.startYear&&(this.startYear=new Date(this.startDate).getFullYear(),this.initStartYear=this.startYear),void 0===this.endYear&&(this.endYear=new Date(this.endDate).getFullYear(),this.initEndYear=this.endYear),this.isRange){for(var e=this.startYear;e<this.endYear;e++)this.startListYears.push(e);for(var t=this.startYear+1;t<=this.endYear;t++)this.endListYears.push(t)}else for(var i=this.startYear;i<=this.endYear+1;i++)this.listYears.push(i);this.options.enabled=void 0===this.options.enabled||this.options.enabled,this.checkFilterValue(),this.options.enabled?this.isRange||"slider"!==this.style||"year"!==this.type||this.yearChange.emit(this.year):(this.storeCurrentFilterValue(),this.yearChange.emit(void 0))}},{key:"storeCurrentFilterValue",value:function(){this.isRange||this.style!==hf.SLIDER||this.type!==uf.YEAR||(this.options.value=this.year.toString())}},{key:"checkFilterValue",value:function(){var e=this.layer.dataSource.ol.getParams().TIME;if(this.isRange||this.style!==hf.SLIDER||this.type!==uf.YEAR){if(this.isRange&&this.style===hf.CALENDAR&&this.type===uf.YEAR&&e){this.startYear=parseInt(e.substr(0,4),10),this.endYear=parseInt(e.substr(5,4),10);for(var t=[],i=[],o=this.initStartYear;o<this.endYear;o++)t.push(o);for(var n=this.startYear+1;n<=this.initEndYear;n++)i.push(n);this.startListYears=t,this.endListYears=i}}else this.year=e?new Date(e.toString()).getFullYear()+1:this.options.value?new Date(this.options.value.toString()).getFullYear()+1:new Date(this.min).getFullYear()+1}},{key:"handleDateChange",value:function(e){this.setupDateOutput(),this.applyTypeChange(),this.change.emit(this.isRange?[this.startDate,this.endDate]:this.startDate)}},{key:"handleYearChange",value:function(e){if(this.isRange){this.endListYears=[];for(var t=this.startYear+1;t<=this.initEndYear;t++)this.endListYears.push(t);this.startListYears=[];for(var i=this.initStartYear+1;i<this.endYear;i++)this.startListYears.push(i);this.yearChange.emit([this.startYear,this.endYear])}else this.yearChange.emit(this.year)}},{key:"handleListYearChange",value:function(e){this.handleYearChange([this.startYear,this.endYear])}},{key:"handleListYearStartChange",value:function(e){this.change.emit([this.startDate,this.endDate])}},{key:"dateToNumber",value:function(e){return(e?new Date(e):new Date(this.min)).getTime()}},{key:"setSliderThumbLabel",value:function(e){var t=this.findThumbLabel(this.mySlider._elementRef.nativeElement.childNodes);t&&(t.textContent=e)}},{key:"findThumbLabel",value:function(e){var t,i=this;return e.forEach((function(e){"mat-slider-thumb-label-text"===e.className&&(t=e),e.children.length>0&&!t&&(t=i.findThumbLabel(e.childNodes))}),this),t}},{key:"toggleFilterState",value:function(){this.options.enabled=!this.options.enabled,this.options.enabled?!this.isRange&&hf.SLIDER&&this.type===uf.YEAR&&this.yearChange.emit(this.year):(this.stopFilter(),this.storeCurrentFilterValue(),this.change.emit(void 0))}},{key:"resetFilter",value:function(e){this.date=new Date(this.min),this.year=this.date.getFullYear()+1,!this.isRange&&hf.SLIDER&&this.type===uf.YEAR?this.yearChange.emit(this.year):(this.setupDateOutput(),this.change.emit(void 0))}},{key:"playFilter",value:function(e){this.interval?this.stopFilter():(this.playIcon="pause-circle",this.interval=setInterval((function(e){var t,i=new Date(e.max);t=void 0===e.date?e.min.getTime():e.date.getTime(),t+=e.mySlider.step,e.date=new Date(t),t>i.getTime()&&e.stopFilter(),e.handleDateChange({value:e.date,date:e.date})}),this.timeInterval,this))}},{key:"playYear",value:function(e){this.year+this.mySlider.step>this.max.getFullYear()+this.mySlider.step&&(this.stopFilter(),this.resetFilter(e)),this.interval?this.stopFilter():(this.playIcon="pause-circle",this.interval=setInterval((function(e){e.year=e.year+e.mySlider.step,e.year>e.max.getFullYear()&&e.stopFilter(),e.yearChange.emit(e.year)}),this.timeInterval,this))}},{key:"stopFilter",value:function(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.playIcon="play-circle"}},{key:"handleSliderDateChange",value:function(e){this.date=new Date(e.value),this.setSliderThumbLabel(this.handleSliderTooltip()),this.handleDateChange(e)}},{key:"handleSliderYearChange",value:function(e){this.year=e.value,this.yearChange.emit(this.year)}},{key:"handleSliderValue",value:function(){if(!0===this.options.current||!this.min){var e=new Date;this.date=this.getRoundedDate(e)}return this.type===uf.YEAR?this.year:void 0===this.date?this.min.getTime():this.date.getTime()}},{key:"handleSliderTooltip",value:function(){var e;switch(this.type){case uf.DATE:e=void 0===this.date?this.min.toDateString():this.date.toDateString();break;case uf.TIME:e=void 0===this.date?this.min.toTimeString():this.date.toTimeString();break;default:e=void 0===this.date?this.min.toUTCString():this.date.toUTCString()}return e}},{key:"setupDateOutput",value:function(){this.style===hf.SLIDER?(this.startDate=new Date(this.date),this.startDate.setSeconds(-this.step/1e3),this.endDate=new Date(this.startDate),this.endDate.setSeconds(this.step/1e3)):!this.isRange&&this.date?(this.endDate=new Date(this.date),this.startDate=new Date(this.date)):(!this.isRange||!this.date&&this.date)&&this.date||(this.startDate=void 0===this.startDate?new Date(this.min):this.startDate,this.endDate=void 0===this.endDate?new Date(this.max):this.endDate)}},{key:"applyTypeChange",value:function(){switch(this.type){case uf.DATE:void 0===this.startDate&&void 0===this.endDate||(this.startDate.setHours(0),this.startDate.setMinutes(0),this.startDate.setSeconds(0),this.endDate.setHours(23),this.endDate.setMinutes(59),this.endDate.setSeconds(59));break;case uf.TIME:if(this.style===hf.CALENDAR){if(this.startDate.getDay()!==this.min.getDay()){var e=this.startDate.getHours(),t=this.startDate.getMinutes();this.startDate=this.min,this.startDate.setHours(e),this.startDate.setMinutes(t)}if(this.endDate.getDay()!==this.min.getDay()){var i=this.endDate.getHours(),o=this.endDate.getMinutes();this.endDate=this.min,this.endDate.setHours(i),this.endDate.setMinutes(o)}}!this.isRange&&this.step>36e5&&(this.startDate.setMinutes(0),this.startDate.setSeconds(0),this.endDate.setMinutes(59),this.endDate.setSeconds(59))}}},{key:"getRangeMinDate",value:function(){return void 0===this.startDate?this.min:this.startDate}},{key:"getRangeMaxDate",value:function(){return void 0===this.endDate?this.max:this.endDate}},{key:"getRoundedDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=6e4*t;return new Date(Math.round(e.getTime()/i)*i)}},{key:"getStepDefinition",value:function(e){return Object(Mc.duration)(e).asMilliseconds()}},{key:"currentValue",set:function(e){if(e&&this.type!==uf.YEAR){var t=e.split("/");if(t.length>0){var i=new Date(t[0]),o=new Date(t[1]);isNaN(i.valueOf())||(this.startDate=i),isNaN(o.valueOf())||(this.endDate=o)}}}},{key:"type",get:function(){return void 0===this.options.type?uf.DATE:this.options.type}},{key:"isRange",get:function(){return void 0!==this.options.range&&this.options.style!==hf.SLIDER&&this.options.range}},{key:"style",get:function(){return void 0===this.options.style?hf.SLIDER:this.options.style}},{key:"step",get:function(){var e=108e5;if(void 0===this.options.step)switch(this.type){case uf.DATE:case uf.DATETIME:e=108e5;break;case uf.TIME:e=36e5;break;case uf.YEAR:e=31536e6;break;default:e=108e5}else e=this.getStepDefinition(this.options.step);return e}},{key:"timeInterval",get:function(){return void 0===this.options.timeInterval?2e3:this.options.timeInterval}},{key:"min",get:function(){if(this.options.min){var e=new Date(this.options.min);return new Date(e.getTime()+6e4*e.getTimezoneOffset())}}},{key:"max",get:function(){if(this.options.max){var e=new Date(this.options.max);return new Date(e.getTime()+6e4*e.getTimezoneOffset())}}},{key:"is",get:function(){return void 0!==this.options.range&&this.options.range}}]),e}()).\u0275fac=function(e){return new(e||Cv)(r.Rb(dt.c))},Cv.\u0275cmp=r.Lb({type:Cv,selectors:[["igo-time-filter-form"]],viewQuery:function(e,t){var i;1&e&&r.Oc(Sl.a,!0),2&e&&r.uc(i=r.fc())&&(t.mySlider=i.first)},inputs:{currentValue:"currentValue",layer:"layer",options:"options"},outputs:{change:"change",yearChange:"yearChange"},decls:5,vars:4,consts:[[4,"ngIf"],["class","igo-col igo-col-100 igo-col-100-m mat-typography",4,"ngIf"],["class","igo-col igo-col-100 igo-col-100-m",4,"ngIf"],[1,"igo-col","igo-col-100","igo-col-100-m"],["matSuffix","",3,"for"],["openOnFocus","true","timeInterval","5",3,"type"],["datetimePicker",""],["matInput","","autocomplete","false","readonly","readonly",3,"placeholder","matDatetimepicker","ngModel","min","max","ngModelChange","dateChange"],[1,"igo-col","igo-col-100"],["minDatetimePicker",""],["matInput","","autocomplete","false","readonly","readonly",3,"placeholder","matDatetimepicker","ngModel","min","max","ngModelChange","input","dateChange"],["maxDatetimePicker",""],[3,"placeholder","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"igo-col","igo-col-100","igo-col-100-m","mat-typography"],["id","time-slider","tickInterval","auto","thumbLabel","",3,"step","min","max","value","color","disabled","input","change"],["class","date-below",4,"ngIf"],[1,"igo-layer-actions-container"],["actions",""],["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","checked","disabled","change"],["mat-icon-button","","color","primary",3,"disabled","click"],[3,"svgIcon"],[1,"date-below"],["id","time-slider","tickInterval","auto","thumbLabel","",3,"step","min","max","value","input","selectionChange"],["mat-icon-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(r.Gc(0,dh,3,2,"div",0),r.Gc(1,vh,3,2,"div",0),r.Sb(2,"br"),r.Gc(3,kh,15,19,"div",1),r.Gc(4,Sh,6,6,"div",2)),2&e&&(r.oc("ngIf","calendar"===t.style&&"year"!==t.type),r.Db(1),r.oc("ngIf","calendar"===t.style&&"year"===t.type),r.Db(2),r.oc("ngIf",!t.isRange&&"slider"===t.style&&"year"===t.type),r.Db(1),r.oc("ngIf","slider"===t.style&&"year"!==t.type))},directives:[m.l,it.c,_l.d,it.h,_l.a,et.b,_l.b,tt.c,tt.p,tt.s,ot.a,m.k,dt.o,Sl.a,kl.a,g.a,l.a,u.a],pipes:[U.d],styles:[".igo-layer-filters-container[_ngcontent-%COMP%]{padding-left:5px}mat-slider[_ngcontent-%COMP%]     div.mat-slider-thumb-label{height:32px;margin:0 auto;width:32px}mat-slider[_ngcontent-%COMP%]     span.mat-slider-thumb-label-text{font-size:10px}#time-slider[_ngcontent-%COMP%]{margin:0 auto;width:70%}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){#time-slider[_ngcontent-%COMP%]{margin:0 auto;width:60%}}.date-below[_ngcontent-%COMP%]{margin:0}mat-form-field[_ngcontent-%COMP%]{text-align:center}mat-datetimepicker-toggle[_ngcontent-%COMP%]     .mat-icon{padding-bottom:30px}.igo-layer-actions-container[_ngcontent-%COMP%] > .mat-slide-toggle[_ngcontent-%COMP%]{vertical-align:middle}"]}),Cv),Vv=((Sv=function(){function e(t){_classCallCheck(this,e),this.timeFilterService=t,this.color="primary",this.showLegend$=new L.a(!1),this.filtersCollapsed=!1,this.header=!0}return _createClass(e,[{key:"handleYearChange",value:function(e){this.timeFilterService.filterByYear(this.datasource,e)}},{key:"handleDateChange",value:function(e){this.timeFilterService.filterByDate(this.datasource,e)}},{key:"toggleLegend",value:function(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}},{key:"toggleLegendOnClick",value:function(){this.filtersCollapsed||this.toggleLegend(this.showLegend$.value)}},{key:"setVisible",value:function(){this.layer.visible=!0}},{key:"toggleFiltersCollapsed",value:function(){this.filtersCollapsed=!this.filtersCollapsed}},{key:"datasource",get:function(){return this.layer.dataSource}}]),e}()).\u0275fac=function(e){return new(e||Sv)(r.Rb(Ob))},Sv.\u0275cmp=r.Lb({type:Sv,selectors:[["igo-time-filter-item"]],inputs:{header:"header",layer:"layer"},decls:8,vars:7,consts:[[4,"ngIf"],[1,"igo-datasource-filters-container"],["filters",""],[1,"igo-layer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],[3,"layer","options","currentValue","change","yearChange"],["mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","click"],["matLine","",3,"ngStyle","click"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","color",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","color",3,"matTooltip","click"],["svgIcon","eye-off"],[3,"layer"]],template:function(e,t){1&e&&(r.Gc(0,xh,5,7,"mat-list-item",0),r.Xb(1,"div",1,2),r.Xb(3,"div",3,4),r.Gc(5,Oh,1,1,"igo-layer-legend",5),r.jc(6,"async"),r.Wb(),r.Xb(7,"igo-time-filter-form",6),r.ec("change",(function(e){return t.handleDateChange(e)}))("yearChange",(function(e){return t.handleYearChange(e)})),r.Wb(),r.Wb()),2&e&&(r.oc("ngIf",t.header),r.Db(5),r.oc("ngIf",r.kc(6,5,t.showLegend$)),r.Db(2),r.oc("layer",t.layer)("options",t.datasource.options.timeFilter)("currentValue",t.datasource.options.params.TIME))},directives:[m.l,Bv,h.d,u.a,h.b,Fn,dt.k,m.m,l.a,g.a,lb],pipes:[m.b,U.d],styles:["[_nghost-%COMP%]{overflow:hidden}.igo-datasource-filters-container[_ngcontent-%COMP%]{display:inline-block;padding-top:5px;text-align:center;width:100%}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:1.125em;width:calc(100% - 18px)}"]}),Sv),Nv=((kv=function(){function e(t){_classCallCheck(this,e),this.cdRef=t,this._layers=[]}return _createClass(e,[{key:"layers",get:function(){return this._layers},set:function(e){this._layers=e,this.cdRef.detectChanges()}}]),e}()).\u0275fac=function(e){return new(e||kv)(r.Rb(r.h))},kv.\u0275cmp=r.Lb({type:kv,selectors:[["igo-time-filter-list"]],inputs:{layers:"layers"},decls:3,vars:6,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["igoListItem","",3,"header","layer"]],template:function(e,t){1&e&&(r.Xb(0,"igo-list",0),r.Gc(1,Ih,1,2,"ng-template",1),r.jc(2,"filterableDataSource"),r.Wb()),2&e&&(r.oc("navigation",!1)("selection",!1),r.Db(1),r.oc("ngForOf",r.lc(2,3,t.layers,"time")))},directives:[yr,m.k,Vv,vr],pipes:[xb],encapsulation:2,changeDetection:0}),kv),zv=((yv=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"wktToFeature",value:function(e,t,i){return(new Fc.a).readFeature(e,{dataProjection:t,featureProjection:i})}},{key:"extentToWkt",value:function(e,t,i){var o=Object(kc.s)(t,i,e);return o=this.roundCoordinateArray(o,e,0),{wktPoly:"POLYGON((\n      ".concat(t[0]," ").concat(t[1],",\n      ").concat(t[0]," ").concat(t[3],",\n      ").concat(t[2]," ").concat(t[3],",\n      ").concat(t[2]," ").concat(t[1],",\n      ").concat(t[0]," ").concat(t[1],"))"),wktLine:"LINESTRING(\n      ".concat(t[0]," ").concat(t[1],",\n      ").concat(t[0]," ").concat(t[3],",\n      ").concat(t[2]," ").concat(t[3],",\n      ").concat(t[2]," ").concat(t[1],",\n      ").concat(t[0]," ").concat(t[1],")"),wktMultiPoints:"MULTIPOINT(\n        ".concat(t[0]," ").concat(t[1],",\n        ").concat(t[0]," ").concat(t[3],",\n        ").concat(t[2]," ").concat(t[3],",\n        ").concat(t[2]," ").concat(t[1],")")}}},{key:"roundCoordinateArray",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=Object(kc.j)(t).getUnits();return-1!==["ft","m","us-ft"].indexOf(o)&&(e=this.roundArray(e,i)),e}},{key:"roundArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=0;i<e.length;)e[i]=e[i].toFixed(t),i++;return e}},{key:"snrcToWkt",value:function(e,t){e=e.toLowerCase();var i=[["m","n","o","p"],["l","k","j","i"],["e","f","g","h"],["d","c","b","a"]],o=[["13","14","15","16"],["12","11","10","09"],["05","06","07","08"],["04","03","02","01"]],n=!1,r=!1,a=!1;if(/\d{2,3}[a-p][0,1][0-9]/gi.test(e)?a=!0:/\d{2,3}[a-p]/gi.test(e)?r=!0:/\d{2,3}/gi.test(e)&&(n=!0),n?e+="a01":r&&(e+="01"),/\d{2,3}[a-p][0,1][0-9]/gi.test(e)){var s=e.split(/(?=[a-p])/gi),c=s[0],l=s[1][0],u=s[1].split(l)[1],h=1;3===c.length&&(h=2);var d=c.substring(0,h),p=c.substring(h),g=0,f=0,m=0,b=0;i.forEach((function(e){-1!==e.indexOf(l)&&(f=i.indexOf(e),g=e.indexOf(l))})),o.forEach((function(e){-1!==e.indexOf(u)&&(b=o.indexOf(e),m=e.indexOf(u))}));var v=0,y=0,k=0,S=0,C=8,w=4;r?(v=2*g,y=1*f,k=0,S=0,C=2,w=1):a&&(v=2*g,y=1*f,k=.5*m,S=.25*b,C=.5,w=.25);var x={ul:[{1:{from:-56,to:-64},2:{from:-64,to:-72},3:{from:-72,to:-80},4:{from:-80,to:-88},5:{from:-88,to:-96},6:{from:-96,to:-104},7:{from:-104,to:-112},8:{from:-112,to:-120},9:{from:-120,to:-128},10:{from:-128,to:-136}}[d].to+v+k,{1:{from:44,to:48},2:{from:48,to:52},3:{from:52,to:56},4:{from:56,to:60},5:{from:60,to:64},6:{from:64,to:68},7:{from:68,to:72},8:{from:72,to:76},9:{from:76,to:-128}}[p].to-y-S]};return x.lr=[x.ul[0]+C,x.ul[1]-w],x.ur=[x.ul[0],x.ul[1]-w],x.ll=[x.ul[0]+C,x.ul[1]],x.ul=Object(kc.r)([x.ul[0],x.ul[1]],"EPSG:4326",t),x.lr=Object(kc.r)([x.lr[0],x.lr[1]],"EPSG:4326",t),x.ur=Object(kc.r)([x.ur[0],x.ur[1]],"EPSG:4326",t),x.ll=Object(kc.r)([x.ll[0],x.ll[1]],"EPSG:4326",t),x.ul=this.roundCoordinateArray(x.ul,t,0),x.lr=this.roundCoordinateArray(x.lr,t,0),x.ur=this.roundCoordinateArray(x.ur,t,0),x.ll=this.roundCoordinateArray(x.ll,t,0),{wktPoly:"POLYGON(("+[x.ul.join(" "),x.ur.join(" "),x.lr.join(" "),x.ll.join(" "),x.ul.join(" ")].join(",")+"))",wktLine:"LINESTRING("+[x.ul.join(" "),x.ur.join(" "),x.lr.join(" "),x.ll.join(" "),x.ul.join(" ")].join(",")+")",wktMultiPoints:"MULTIPOINT("+[x.ul.join(" "),x.ur.join(" "),x.lr.join(" "),x.ll.join(" ")].join(",")+")"}}}}]),e}()).\u0275fac=function(e){return new(e||yv)},yv.\u0275prov=Object(r.Nb)({factory:function(){return new yv},token:yv,providedIn:"root"}),yv),qv=((vv=function(){function e(t){_classCallCheck(this,e),this.wktService=t,this.ogcFilterOperator=$g,this.ogcFilterOperators$=new L.a(void 0),this.value="",this.selectedField$=new L.a(void 0),this.fields$=new L.a([]),this.color="primary",this.currentFilterIsSpatial$=new L.a(!1),this.defaultStepMillisecond=6e3,this._snrc="",this.floatLabel="never",this.allOgcFilterOperators=(new Wg).operators,this.ogcFilterOperators$.next(this.allOgcFilterOperators),this.igoSpatialSelectors=[{type:"fixedExtent"},{type:"snrc"}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this,t=this.datasource.options.sourceFields.filter((function(e){return void 0===e.excludeFromOgcFilters||!e.excludeFromOgcFilters}));t.map((function(e){e.values&&e.values.sort()})),this.fields$.next(t),this.updateFieldsList(),this.selectedField$.next(this.fields$.value.find((function(t){return t.name===e.currentFilter.propertyName}))),this.updateValuesList(),this.selectedField$.subscribe((function(t){e.ogcFilterOperators$.next(e.allowedOperators),-1===Object.keys(e.allowedOperators).indexOf(e.currentFilter.operator)&&(e.currentFilter.operator=Object.keys(e.allowedOperators)[0],e.currentFilter.operator=Object.keys(e.allowedOperators)[0]),e.updateValuesList()})),this.currentFilterIsSpatial()}},{key:"updateFieldsList",value:function(e){this.filteredFields$=e&&e.length>0?Object(F.a)(this._filterFields(e)):this.fields$}},{key:"updateValuesList",value:function(e,t){this.filteredValues$=e&&e.length>0?Object(F.a)(this._filterValues(e)):this.selectedField$.value?Object(F.a)(this.selectedField$.value.values):Object(F.a)([]),e&&e.length>=2&&this.changeProperty(e,t)}},{key:"_filterFields",value:function(e){var t=new RegExp(e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),"gi");return this.fields$.value.filter((function(e){return t.test(e.alias.normalize("NFD").replace(/[\u0300-\u036f]/g,""))}))}},{key:"_filterValues",value:function(e){var t=new RegExp(e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,""),"gi");return this.selectedField$.value.values.filter((function(e){return t.test(e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,""))}))}},{key:"clearSelectedField",value:function(){this.currentFilter.propertyName="",this.selectedField$.next(void 0),this.clearProperty()}},{key:"isClearable",value:function(e){var t=this.detectProperty(e);if(t)return this.currentFilter[t]}},{key:"clearProperty",value:function(e){var t=this.detectProperty(e);if(t)return this.currentFilter[t]=""}},{key:"toggleFilterState",value:function(e){var t=this;this.datasource.options.ogcFilters.interfaceOgcFilters.find((function(e){return e.filterid===t.currentFilter.filterid})).active=e.checked,this.refreshFilters()}},{key:"deleteFilter",value:function(){var e=this,t=this.datasource.options.ogcFilters;t.interfaceOgcFilters=t.interfaceOgcFilters.filter((function(t){return t.filterid!==e.currentFilter.filterid})),this.refreshFilters()}},{key:"changeLogical",value:function(e){this.currentFilter.parentLogical=e,this.refreshFilters()}},{key:"changeOperator",value:function(e){this.currentFilter.operator=e,this.currentFilterIsSpatial(),this.currentFilterIsSpatial$.value&&0===this.currentFilter.wkt_geometry.length?this.changeSpatialSelector(this.currentFilter.igoSpatialSelector):this.refreshFilters()}},{key:"changeField",value:function(e){var t=this;this.currentFilter.propertyName=e,this.selectedField$.next(this.fields$.value.find((function(e){return e.name===t.currentFilter.propertyName}))),this.refreshFilters()}},{key:"changeCaseSensitive",value:function(e){this.currentFilter.matchCase=e.checked,this.refreshFilters()}},{key:"changeProperty",value:function(e,t){var i=this,o=this.detectProperty(t);o&&(this.datasource.options.ogcFilters.interfaceOgcFilters.find((function(e){return e.filterid===i.currentFilter.filterid}))[o]=e,this.refreshFilters())}},{key:"changeNumericProperty",value:function(e,t){this.changeProperty(parseFloat(e),t)}},{key:"changeSpatialSelector",value:function(e){this.currentFilter.igoSpatialSelector=e,"fixedExtent"===e&&this.changeMapExtentGeometry(!1),this.currentFilterIsSpatial(),this.refreshFilters()}},{key:"changeSNRC",value:function(e){this.snrc=e,this.changeSNRCGeometry()}},{key:"changeSNRCGeometry",value:function(){var e=this;this.datasource.options.ogcFilters.interfaceOgcFilters.find((function(t){return t.filterid===e.currentFilter.filterid}))&&(this.snrc&&"snrc"===this.currentFilter.igoSpatialSelector&&(this.currentFilter.wkt_geometry=this.wktService.snrcToWkt(this.snrc,this.map.projection).wktPoly),this.refreshFilters())}},{key:"changeMapExtentGeometry",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.datasource.options.ogcFilters.interfaceOgcFilters.find((function(t){return t.filterid===e.currentFilter.filterid}))&&("fixedExtent"===this.currentFilter.igoSpatialSelector&&(this.currentFilter.wkt_geometry=this.wktService.extentToWkt(this.map.projection,this.map.viewController.getExtent(),this.map.projection).wktPoly),t&&this.refreshFilters())}},{key:"detectProperty",value:function(e){switch(this.currentFilter.operator){case $g.PropertyIsNotEqualTo:case $g.PropertyIsEqualTo:case $g.PropertyIsGreaterThan:case $g.PropertyIsGreaterThanOrEqualTo:case $g.PropertyIsLessThan:case $g.PropertyIsLessThanOrEqualTo:return"expression";case $g.PropertyIsLike:return"pattern";case $g.PropertyIsBetween:return e&&1===e?"lowerBoundary":e&&2===e?"upperBoundary":void 0;case $g.During:return e&&1===e?"begin":e&&2===e?"end":void 0;default:return}}},{key:"currentFilterIsSpatial",value:function(){var e=!1;this.currentFilter&&(e=-1!==[$g.Contains,$g.Intersects,$g.Within].indexOf(this.currentFilter.operator)),this.currentFilterIsSpatial$.next(e)}},{key:"isTemporalOperator",value:function(){return this.currentFilter.operator.toLowerCase()===this.ogcFilterOperator.During.toLowerCase()}},{key:"snrc",set:function(e){(/^\d{2}$/gi.test(e)||/^\d{2}[a-p]$/gi.test(e)||/^\d{2}[a-l][0,1][0-9]$/gi.test(e))&&(this._snrc=e,this.currentFilter.igoSNRC=e)},get:function(){return this._snrc}},{key:"activeFilters",get:function(){return this.datasource.options.ogcFilters.interfaceOgcFilters.filter((function(e){return!0===e.active}))}},{key:"allowedOperators",get:function(){return(new Wg).computeAllowedOperators(this.fields$.value,this.currentFilter.propertyName,this.datasource.options.ogcFilters.allowedOperatorsType)}}]),e}()).\u0275fac=function(e){return new(e||vv)(r.Rb(zv))},vv.\u0275cmp=r.Lb({type:vv,selectors:[["igo-ogc-filter-form"]],inputs:{floatLabel:"floatLabel",refreshFilters:"refreshFilters",datasource:"datasource",map:"map",currentFilter:"currentFilter"},decls:42,vars:76,consts:[["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","checked","click","change"],[3,"ngClass"],["tooltip-position","above","matTooltipShowDelay","500",3,"disabled","value","matTooltip","selectionChange"],["tooltip-position","above","matTooltipShowDelay","500",3,"value","matTooltip"],["class","field",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[3,"ngClass","floatLabel"],["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","value","selectionChange"],["tooltip-position","above","matTooltipShowDelay","500",3,"value","matTooltip",4,"ngFor","ngForOf"],["class","spatialSelector",4,"ngIf"],["class","singleInput",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[1,"igo-layer-button-group"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","delete"],["class","snrc",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[4,"ngIf"],["class","dualInput",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[3,"datasource","currentFilter","datasourceChange","currentFilterChange","changeProperty",4,"ngIf"],[1,"field",3,"floatLabel","mouseenter","mouseleave"],["matInput","","tooltip-position","above","matTooltipShowDelay","500",3,"placeholder","disabled","matAutocomplete","value","matTooltip","input"],[3,"optionSelected"],["autoCompleteField","matAutocomplete"],["matTooltipShowDelay","500",3,"value","id","matTooltip",4,"ngFor","ngForOf"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"disabled","click",4,"ngIf"],["matTooltipShowDelay","500",3,"value","id","matTooltip"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"disabled","click"],["svgIcon","close"],[1,"spatialSelector"],[3,"disabled","value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"singleInput",3,"floatLabel","mouseenter","mouseleave"],["autoCompleteValues","matAutocomplete"],["matTooltipShowDelay","500",3,"value","matTooltip",4,"ngFor","ngForOf"],["matTooltipShowDelay","500",3,"value","matTooltip"],[1,"snrc",3,"floatLabel","mouseenter","mouseleave"],["matInput","","tooltip-position","above","matTooltipShowDelay","500",3,"placeholder","value","matTooltip","input"],["mat-button","","matSuffix","","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","click",4,"ngIf"],["mat-button","","matSuffix","","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","click"],["svgIcon","arrow-expand-all"],[1,"dualInput",3,"floatLabel","mouseenter","mouseleave"],["matInput","","type","number",3,"placeholder","disabled","matAutocomplete","value","input"],["autoDualValueOperator1","matAutocomplete"],["autoDualValueOperator2","matAutocomplete"],[3,"datasource","currentFilter","datasourceChange","currentFilterChange","changeProperty"]],template:function(e,t){1&e&&(r.Xb(0,"mat-checkbox",0),r.ec("click",(function(e){return e.stopPropagation()}))("change",(function(e){return t.toggleFilterState(e)})),r.jc(1,"translate"),r.Wb(),r.Xb(2,"mat-form-field",1),r.Xb(3,"mat-select",2),r.ec("selectionChange",(function(e){return t.changeLogical(e.value)})),r.jc(4,"translate"),r.Xb(5,"mat-option",3),r.jc(6,"translate"),r.Ic(7),r.jc(8,"translate"),r.Wb(),r.Xb(9,"mat-option",3),r.jc(10,"translate"),r.Ic(11),r.jc(12,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Gc(13,Fh,13,22,"mat-form-field",4),r.jc(14,"async"),r.jc(15,"async"),r.jc(16,"async"),r.jc(17,"async"),r.Xb(18,"mat-form-field",5),r.jc(19,"async"),r.jc(20,"async"),r.Xb(21,"mat-select",6),r.ec("selectionChange",(function(e){return t.changeOperator(e.value)})),r.jc(22,"translate"),r.jc(23,"translate"),r.Gc(24,_h,4,7,"mat-option",7),r.jc(25,"keyvalue"),r.jc(26,"async"),r.Wb(),r.Wb(),r.Gc(27,Dh,3,3,"mat-form-field",8),r.jc(28,"async"),r.Gc(29,jh,8,12,"mat-form-field",9),r.Xb(30,"div",10),r.Xb(31,"button",11),r.ec("click",(function(){return t.deleteFilter()})),r.jc(32,"translate"),r.Sb(33,"mat-icon",12),r.Wb(),r.Wb(),r.Gc(34,$h,4,7,"mat-form-field",13),r.jc(35,"async"),r.Gc(36,Wh,2,1,"ng-container",14),r.jc(37,"async"),r.Sb(38,"br"),r.Gc(39,Bh,8,11,"mat-form-field",15),r.Gc(40,zh,8,11,"mat-form-field",15),r.Gc(41,qh,1,2,"igo-ogc-filter-time",16)),2&e&&(r.oc("matTooltip",r.kc(1,27,"igo.geo.filter.toggleFilterState"))("checked",t.currentFilter.active),r.Db(2),r.oc("ngClass",r.sc(67,Hh,0!==t.activeFilters.indexOf(t.currentFilter)&&!0===t.currentFilter.active,0===t.activeFilters.indexOf(t.currentFilter)||!0!==t.currentFilter.active)),r.Db(1),r.oc("disabled",!t.currentFilter.active)("value",t.currentFilter.parentLogical)("matTooltip",t.currentFilter.parentLogical?r.kc(4,29,"igo.geo.operators.tooltip."+t.currentFilter.parentLogical):""),r.Db(2),r.oc("value",t.ogcFilterOperator.And)("matTooltip",r.kc(6,31,"igo.geo.operators.tooltip.And")),r.Db(2),r.Kc(" ",r.kc(8,33,"igo.geo.operators.And")," "),r.Db(2),r.oc("value",t.ogcFilterOperator.Or)("matTooltip",r.kc(10,35,"igo.geo.operators.tooltip.Or")),r.Db(2),r.Kc(" ",r.kc(12,37,"igo.geo.operators.Or")," "),r.Db(2),r.oc("ngIf",!r.kc(14,39,t.currentFilterIsSpatial$)&&r.kc(15,41,t.fields$)&&r.kc(16,43,t.fields$).length>0&&""!==r.kc(17,45,t.fields$)[0].name),r.Db(5),r.oc("ngClass",r.sc(70,Uh,!r.kc(19,47,t.currentFilterIsSpatial$),r.kc(20,49,t.currentFilterIsSpatial$)))("floatLabel",t.floatLabel),r.Db(3),r.oc("matTooltip",t.currentFilter.operator?r.kc(22,51,"igo.geo.operators.tooltip."+t.currentFilter.operator):r.kc(23,53,"igo.geo.filter.selectOperator"))("disabled",!t.currentFilter.active)("value",t.currentFilter.operator),r.Db(3),r.oc("ngForOf",r.kc(25,55,r.kc(26,57,t.ogcFilterOperators$))),r.Db(3),r.oc("ngIf",r.kc(28,59,t.currentFilterIsSpatial$)),r.Db(2),r.oc("ngIf",-1!==r.qc(73,Yh).indexOf(t.detectProperty())),r.Db(2),r.oc("matTooltip",r.kc(32,61,"igo.geo.filter.removeFilter")),r.Db(3),r.oc("ngIf",r.kc(35,63,t.currentFilterIsSpatial$)&&"snrc"===t.currentFilter.igoSpatialSelector),r.Db(2),r.oc("ngIf",r.kc(37,65,t.currentFilterIsSpatial$)&&"fixedExtent"===t.currentFilter.igoSpatialSelector),r.Db(3),r.oc("ngIf",!t.isTemporalOperator()&&-1!==r.qc(74,Kh).indexOf(t.detectProperty(1))),r.Db(1),r.oc("ngIf",!t.isTemporalOperator()&&-1!==r.qc(75,Zh).indexOf(t.detectProperty(2))),r.Db(1),r.oc("ngIf",t.isTemporalOperator()))},directives:function(){return[v.a,g.a,it.c,m.j,ot.a,dt.o,m.l,m.k,l.a,u.a,et.b,xl.c,xl.a,it.h,iy]},pipes:function(){return[U.d,m.b,mr]},styles:["[_nghost-%COMP%]{padding:5px 10px;width:100%}  .mat-form-field .mat-icon svg{color:#d3d3d3;height:1em;width:1em}.mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-select-arrow[_ngcontent-%COMP%]{visibility:hidden}.mat-slide-toggle[_ngcontent-%COMP%]{margin-top:10px}.logical[_ngcontent-%COMP%], .logicalHidden[_ngcontent-%COMP%]{flex-flow:column nowrap;margin-left:5px;max-width:45px;width:10%}.logicalHidden[_ngcontent-%COMP%],   .logical .mat-select-arrow,   .logicalHidden .mat-select-arrow{visibility:hidden}.field[_ngcontent-%COMP%]{margin-left:5px;width:20%}  .field .mat-select-arrow{visibility:hidden}.operator[_ngcontent-%COMP%]{margin-left:10px;text-align:center;width:12%}  .operator .mat-select-arrow{visibility:hidden}.spatialSelector[_ngcontent-%COMP%]{margin-left:5px;width:15%}  .spatialSelector .mat-select-arrow{visibility:hidden}.singleInput[_ngcontent-%COMP%]{margin-left:5px;width:30%}.snrc[_ngcontent-%COMP%]{margin-left:5px;width:20%}  .singleInput .mat-select-arrow{visibility:hidden}.dualInput[_ngcontent-%COMP%]{margin-left:5px;width:20%}  .dualInput .mat-select-arrow{visibility:hidden}.igo-layer-button-group[_ngcontent-%COMP%]{display:flex;float:right;padding-top:5px}.container[_ngcontent-%COMP%]{display:flex}"]}),vv),Hv=((bv=function(){function e(){_classCallCheck(this,e),this.color="primary"}return _createClass(e,[{key:"refreshFunc",get:function(){return this.refreshFilters}},{key:"advancedOgcFilters",get:function(){if(this.datasource.options.ogcFilters)return this.datasource.options.ogcFilters.advancedOgcFilters}}]),e}()).\u0275fac=function(e){return new(e||bv)},bv.\u0275cmp=r.Lb({type:bv,selectors:[["igo-ogc-filterable-form"]],inputs:{datasource:"datasource",map:"map",refreshFilters:"refreshFilters"},decls:2,vars:2,consts:[["igoListItem","",3,"refreshFilters","datasource","map",4,"ngIf"],[4,"ngIf"],["igoListItem","",3,"refreshFilters","datasource","map"],["ngFor","",3,"ngForOf"],[3,"currentFilter","refreshFilters","datasource","map"]],template:function(e,t){1&e&&(r.Gc(0,Jh,1,3,"igo-ogc-filter-toggle-button",0),r.Gc(1,ed,1,1,void 0,1)),2&e&&(r.oc("ngIf",!t.advancedOgcFilters),r.Db(1),r.oc("ngIf",t.advancedOgcFilters&&t.datasource.options.ogcFilters.editable))},directives:function(){return[m.l,Zv,vr,m.k,qv]},encapsulation:2}),bv),Uv=((mv=function(){function e(t,i){_classCallCheck(this,e),this.ogcFilterService=t,this.downloadService=i,this.color="primary",this.defaultLogicalParent=$g.And,this.hasActiveSpatialFilter=!1,this.filtersAreEditable=!0,this.filtersCollapsed=!0,this.hasPushButton=!1,this.showLegend$=new L.a(!1),this.header=!0,this.ogcFilterWriter=new Wg}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this.datasource.options.ogcFilters;switch(e.pushButtons&&e.pushButtons.bundles.length>0&&(void 0===e.advancedOgcFilters&&(e.advancedOgcFilters=!1),this.hasPushButton=!0),this.datasource.options.type){case"wms":this.ogcFilterService.setOgcWMSFiltersOptions(this.datasource);break;case"wfs":this.ogcFilterService.setOgcWFSFiltersOptions(this.datasource)}e&&(e.interfaceOgcFilters&&(this.lastRunOgcFilter=JSON.parse(JSON.stringify(e.interfaceOgcFilters)),e.interfaceOgcFilters.filter((function(e){return e.wkt_geometry})).length>=1&&(this.hasActiveSpatialFilter=!0)),this.filtersAreEditable=!!e.editable&&e.editable)}},{key:"addFilterToSequence",value:function(){this.filtersCollapsed=!1;var e,t=this.datasource.options.ogcFilters.interfaceOgcFilters||[],i=0===t.length?0:t[t.length-1].level,o="",n=this.datasource.options.sourceFields.filter((function(e){return!e.excludeFromOgcFilters}));n.length>0&&(o=void 0===n[0].name?"":n[0].name);var r=this.datasource.options;r.fieldNameGeometry?e=r.fieldNameGeometry:this.datasource.options.paramsWFS&&this.datasource.options.paramsWFS.fieldNameGeometry&&(e=this.datasource.options.paramsWFS.fieldNameGeometry);var a=this.ogcFilterWriter.computeAllowedOperators(this.datasource.options.sourceFields,o,this.datasource.options.ogcFilters.allowedOperatorsType),s=Object.keys(a)[0];t.push(this.ogcFilterWriter.addInterfaceFilter({propertyName:o,operator:s,active:!0,igoSpatialSelector:"fixedExtent",srsName:this.map.projection},e,i,this.defaultLogicalParent)),this.datasource.options.ogcFilters.interfaceOgcFilters=t}},{key:"openDownload",value:function(){this.downloadService.open(this.layer)}},{key:"refreshFilters",value:function(e){!0===e&&(this.lastRunOgcFilter=void 0);var t=this.datasource.options.ogcFilters,i=t.interfaceOgcFilters.filter((function(e){return!0===e.active}));if(0===i.length&&(t.filters=void 0,t.filtered=!1),i.length>1&&(i[0].parentLogical=i[1].parentLogical),this.hasActiveSpatialFilter=0!==i.filter((function(e){return-1!==["Contains","Intersects","Within"].indexOf(e.operator)})).length,JSON.stringify(this.lastRunOgcFilter)!==JSON.stringify(i)){if("wfs"===this.layer.dataSource.options.type)this.layer.dataSource.options.ogcFilters.filters=this.ogcFilterWriter.rebuiltIgoOgcFilterObjectFromSequence(i),this.layer.dataSource.ol.refresh();else if("wms"===this.layer.dataSource.options.type&&t.enabled){var o="";if(i.length>=1){var n=this.layer.dataSource,r=n.options.ogcFilters;r.filters=this.ogcFilterWriter.rebuiltIgoOgcFilterObjectFromSequence(i),o=this.ogcFilterWriter.buildFilter(r.filters,void 0,void 0,this.layer.dataSource.options.fieldNameGeometry,n.options)}this.ogcFilterService.filterByOgc(this.datasource,o),this.datasource.options.ogcFilters.filtered=0!==i.length}this.lastRunOgcFilter=JSON.parse(JSON.stringify(i))}}},{key:"setVisible",value:function(){this.layer.visible=!0}},{key:"isAdvancedOgcFilters",value:function(){return this.datasource.options.ogcFilters.advancedOgcFilters}},{key:"addFilterDisabled",value:function(){return!this.datasource.options.sourceFields||0===this.datasource.options.sourceFields.length}},{key:"changeOgcFiltersAdvancedOgcFilters",value:function(e){this.datasource.options.ogcFilters.advancedOgcFilters=e}},{key:"changeOgcFilterType",value:function(e){this.changeOgcFiltersAdvancedOgcFilters(e.checked),e.checked&&this.refreshFilters(!0)}},{key:"toggleLegend",value:function(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}},{key:"toggleLegendOnClick",value:function(){this.filtersCollapsed||this.toggleLegend(this.showLegend$.value)}},{key:"toggleFiltersCollapsed",value:function(){this.filtersCollapsed=!this.filtersCollapsed}},{key:"refreshFunc",get:function(){return this.refreshFilters.bind(this)}},{key:"datasource",get:function(){return this.layer.dataSource}},{key:"downloadable",get:function(){return this.datasource.options.download}}]),e}()).\u0275fac=function(e){return new(e||mv)(r.Rb(Ib),r.Rb(_b))},mv.\u0275cmp=r.Lb({type:mv,selectors:[["igo-ogc-filterable-item"]],inputs:{header:"header",layer:"layer",map:"map"},decls:11,vars:10,consts:[["class","igo-chevron","mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",3,"target","collapsed","click",4,"ngIf"],["matLine","","matTooltipShowDelay","500",3,"ngStyle","matTooltip","click",4,"ngIf"],[4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","color","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","color",3,"matTooltip","click",4,"ngIf"],["ogcFilters",""],["class","igo-layer-legend-container",4,"ngIf"],[3,"datasource","map","refreshFilters"],["class","mat-typography advancedOgcFilters",4,"ngIf"],["mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","click"],["matLine","","matTooltipShowDelay","500",3,"ngStyle","matTooltip","click"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","download"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","color","click"],["svgIcon","plus"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","color",3,"matTooltip","click"],["svgIcon","eye-off"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],[3,"layer"],[1,"mat-typography","advancedOgcFilters"],["labelPosition","before",3,"ngModel","change","ngModelChange"]],template:function(e,t){1&e&&(r.Xb(0,"mat-list-item"),r.Gc(1,td,1,2,"mat-icon",0),r.Gc(2,id,2,5,"h4",1),r.Gc(3,od,4,4,"span",2),r.Gc(4,nd,3,5,"button",3),r.Gc(5,rd,3,3,"button",4),r.Wb(),r.Xb(6,"div",null,5),r.Gc(8,sd,4,3,"div",6),r.Sb(9,"igo-ogc-filterable-form",7),r.Gc(10,cd,5,4,"section",8),r.Wb()),2&e&&(r.Db(1),r.oc("ngIf",t.header),r.Db(1),r.oc("ngIf",t.header),r.Db(1),r.oc("ngIf",t.downloadable&&t.header),r.Db(1),r.oc("ngIf",t.isAdvancedOgcFilters()&&t.filtersAreEditable),r.Db(1),r.oc("ngIf",!t.layer.visible&&t.header),r.Db(3),r.oc("ngIf",t.header),r.Db(1),r.oc("datasource",t.datasource)("map",t.map)("refreshFilters",t.refreshFunc),r.Db(1),r.oc("ngIf",t.hasPushButton&&t.filtersAreEditable))},directives:[h.d,m.l,Hv,u.a,h.b,Fn,dt.k,m.m,g.a,l.a,lb,yl.a,v.a,tt.p,tt.s],pipes:[U.d,m.b],styles:["[_nghost-%COMP%]{overflow:hidden}.advancedOgcFilters[_ngcontent-%COMP%]{display:inline-block;text-align:center;width:100%}.mat-list-item[_ngcontent-%COMP%]{height:auto}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:1.125em;width:calc(100% - 18px)}mat-icon.disabled[_ngcontent-%COMP%]{color:rgba(0,0,0,.38)}"]}),mv),Yv=((fv=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||fv)},fv.\u0275cmp=r.Lb({type:fv,selectors:[["igo-ogc-filterable-list"]],inputs:{layers:"layers",map:"map"},decls:3,vars:6,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["igoListItem","",3,"header","layer","map"]],template:function(e,t){1&e&&(r.Xb(0,"igo-list",0),r.Gc(1,ld,1,3,"ng-template",1),r.jc(2,"filterableDataSource"),r.Wb()),2&e&&(r.oc("navigation",!1)("selection",!1),r.Db(1),r.oc("ngForOf",r.lc(2,3,t.layers,"ogc")))},directives:[yr,m.k,Uv,vr],pipes:[xb],encapsulation:2,changeDetection:0}),fv),Kv=((gv=function(){function e(){_classCallCheck(this,e),this.color="primary",this.ogcFilterCollapse=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.options=this.layer.dataSource.options}},{key:"badge",get:function(){var e=this.options.ogcFilters;if(!e||e.advancedOgcFilters)return e&&e.filters&&!e.filters.filters?1:e&&e.filters&&e.filters.filters?e.filters.filters.length:void 0;if(e.pushButtons){var t=e.pushButtons.groups.find((function(e){return e.enabled})),i=0;return t&&t.computedButtons.map((function(e){return i+=e.buttons.filter((function(e){return e.enabled})).length})),i>0?i:void 0}}},{key:"layer",get:function(){return this._layer},set:function(e){this._layer=e,e&&(this.options=this.layer.dataSource.options)}}]),e}()).\u0275fac=function(e){return new(e||gv)},gv.\u0275cmp=r.Lb({type:gv,selectors:[["igo-ogc-filter-button"]],inputs:{color:"color",layer:"layer",map:"map",header:"header"},decls:2,vars:2,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color",4,"ngIf"],["class","igo-layer-actions-container",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","filter",3,"matBadge"],[1,"igo-layer-actions-container"],["ogcFilter",""],["igoListItem","",3,"header","map","layer",4,"ngIf"],["igoListItem","",3,"header","map","layer"]],template:function(e,t){1&e&&(r.Gc(0,ud,3,5,"button",0),r.Gc(1,dd,3,1,"div",1)),2&e&&(r.oc("ngIf",t.header&&t.options.ogcFilters&&t.options.ogcFilters.enabled&&(t.options.ogcFilters.pushButtons||t.options.ogcFilters.editable)),r.Db(1),r.oc("ngIf",t.options.ogcFilters&&t.options.ogcFilters.enabled&&(t.options.ogcFilters.pushButtons||t.options.ogcFilters.editable)))},directives:[m.l,l.a,g.a,u.a,Ze.a,Uv,vr],pipes:[U.d],styles:[""],changeDetection:0}),gv),Zv=((pv=function(){function e(t,i){_classCallCheck(this,e),this.ogcFilterService=t,this.formBuilder=i,this.color="primary",this.ogcFilterWriter=new Wg,this.buildForm()}return _createClass(e,[{key:"buildForm",value:function(){this.form=this.formBuilder.group({buttons:["",[tt.w.required]],group:["",[tt.w.required]]})}},{key:"getPushButtonsGroups",value:function(){return this.datasource.options.ogcFilters.pushButtons.groups}},{key:"ngOnInit",value:function(){var e=this;this.datasource.options.ogcFilters&&this.datasource.options.ogcFilters.pushButtons&&(this.currentPushButtonGroup=this.datasource.options.ogcFilters.pushButtons.groups.find((function(e){return e.enabled}))||this.datasource.options.ogcFilters.pushButtons.groups[0]),this.applyFilters(),this.form.get("group").valueChanges.pipe(Object(O.a)(750)).subscribe((function(){e.onChangeGroup(),e.applyFilters()})),this.form.get("buttons").valueChanges.pipe(Object(O.a)(750)).subscribe((function(){e.applyFilters()}))}},{key:"getToolTip",value:function(e){var t;return e.tooltip&&(t=Array.isArray(e.tooltip)?e.tooltip.join("\n"):e.tooltip),t||""}},{key:"getButtonColor",value:function(e){var t;return e.color&&(t={"background-color":e.enabled?"rgba(".concat(e.color,")"):"rgba(255,255,255,0)"}),t}},{key:"bundleIsVertical",value:function(e){return!!e.vertical&&e.vertical}},{key:"onChangeGroup",value:function(){var e=this;this.getPushButtonsGroups().map((function(e){return e.enabled=!1})),this.getPushButtonsGroups().find((function(t){return t===e.currentPushButtonGroup})).enabled=!0}},{key:"onButtonChange",value:function(e){e&&(e.enabled=!e.enabled)}},{key:"applyFilters",value:function(){var e="",t=[];this.currentPushButtonGroup.computedButtons.map((function(e){var i=[];e.buttons.filter((function(e){return!0===e.enabled})).forEach((function(e){return i.push(e.filters)})),i.length>=1&&t.push(1===i.length?i[0]:{logical:e.logical,filters:i})})),t.length>=1&&(e=this.ogcFilterWriter.buildFilter(1===t.length?t[0]:{logical:"And",filters:t})),"wms"===this.datasource.options.type&&this.ogcFilterService.filterByOgc(this.datasource,e),"wfs"===this.datasource.options.type&&this.datasource.ol.refresh()}},{key:"currentPushButtonGroup",get:function(){return this.form.get("group").value},set:function(e){this.form.patchValue({group:e})}}]),e}()).\u0275fac=function(e){return new(e||pv)(r.Rb(Ib),r.Rb(tt.e))},pv.\u0275cmp=r.Lb({type:pv,selectors:[["igo-ogc-filter-toggle-button"]],inputs:{refreshFilters:"refreshFilters",datasource:"datasource",map:"map"},decls:4,vars:3,consts:[[3,"formGroup"],["class","pushButtonSelector",4,"ngIf"],[1,"pushButtonGroups"],[4,"ngFor","ngForOf"],[1,"pushButtonSelector"],["tooltip-position","below","matTooltipShowDelay","500","formControlName","group",3,"matTooltip","value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","buttons","appearance","legacy","multiple","true",1,"mat-typography",3,"vertical"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"ngStyle","checked","matTooltip","value","change",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"ngStyle","checked","matTooltip","value","change"]],template:function(e,t){1&e&&(r.Xb(0,"form",0),r.Gc(1,gd,5,5,"div",1),r.Xb(2,"div",2),r.Gc(3,md,3,2,"ng-container",3),r.Wb(),r.Wb()),2&e&&(r.oc("formGroup",t.form),r.Db(1),r.oc("ngIf",t.getPushButtonsGroups().length>1),r.Db(2),r.oc("ngForOf",t.currentPushButtonGroup.computedButtons))},directives:[tt.x,tt.q,tt.i,m.l,m.k,it.c,ot.a,tt.p,tt.h,g.a,dt.o,Ol.b,Ol.a,m.m],pipes:[U.d],styles:[".mat-button-toggle-group[_ngcontent-%COMP%]{flex-wrap:wrap;margin:5px}.pushButtonGroups[_ngcontent-%COMP%], .pushButtonSelector[_ngcontent-%COMP%]{text-align:center}.mat-button-toggle[_ngcontent-%COMP%]{display:inline-flex}  .material-tooltip{white-space:pre-line}"]}),pv),Jv=((dv=function(){function e(){_classCallCheck(this,e),this.queryType=["Arrond","CircFed","CircProv","DirReg","Mun","MRC","AdmRegion","RegTour"],this.selectedTypeIndex=new tt.f(0),this.spatialType=Lb,this.activeDrawType=this.spatialType.Polygon,this.eventType=new r.o,this.eventQueryType=new r.o,this.zoneChange=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){0===this.selectedTypeIndex.value&&(this.type=this.spatialType.Predefined),1===this.selectedTypeIndex.value&&(this.type=this.activeDrawType),this.eventType.emit(this.type)}},{key:"onTypeChange",value:function(e){0===this.selectedTypeIndex.value&&(this.type=Lb.Predefined),1===this.selectedTypeIndex.value&&(this.type=this.activeDrawType),this.eventType.emit(this.type)}},{key:"onQueryTypeChange",value:function(e){this.eventQueryType.emit(this.selectedQueryType)}},{key:"onZoneChange",value:function(e){this.zoneChange.emit(e)}},{key:"onDrawTypeChange",value:function(e){this.activeDrawType=e,this.eventType.emit(this.activeDrawType)}},{key:"store",get:function(){return this._store},set:function(e){this._store=e}}]),e}()).\u0275fac=function(e){return new(e||dv)},dv.\u0275cmp=r.Lb({type:dv,selectors:[["igo-spatial-filter-type"]],inputs:{store:"store",selectedQueryType:"selectedQueryType",zone:"zone"},outputs:{eventType:"eventType",eventQueryType:"eventQueryType",zoneChange:"zoneChange"},decls:20,vars:24,consts:[[3,"selectedIndex","selectedIndexChange","selectedTabChange"],[3,"label"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"store","queryType","selectedZone","zoneChange"],[1,"spatial-type-toggle"],[3,"value","change"],[3,"value","matTooltip"],["svgIcon","pentagon-outline"],["svgIcon","record-circle-outline"],[3,"value"]],template:function(e,t){1&e&&(r.Xb(0,"mat-tab-group",0),r.ec("selectedIndexChange",(function(e){return t.selectedTypeIndex.setValue(e)}))("selectedTabChange",(function(e){return t.onTypeChange(e)})),r.Xb(1,"mat-tab",1),r.jc(2,"translate"),r.Xb(3,"mat-form-field"),r.Xb(4,"mat-label"),r.Ic(5),r.jc(6,"translate"),r.Wb(),r.Xb(7,"mat-select",2),r.ec("selectionChange",(function(e){return t.onQueryTypeChange(e)}))("valueChange",(function(e){return t.selectedQueryType=e})),r.Gc(8,bd,3,4,"mat-option",3),r.Wb(),r.Wb(),r.Xb(9,"igo-spatial-filter-list",4),r.ec("zoneChange",(function(e){return t.onZoneChange(e)})),r.Wb(),r.Wb(),r.Xb(10,"mat-tab",1),r.jc(11,"translate"),r.Xb(12,"div",5),r.Xb(13,"mat-button-toggle-group",6),r.ec("change",(function(e){return t.onDrawTypeChange(e.value)})),r.Xb(14,"mat-button-toggle",7),r.jc(15,"translate"),r.Sb(16,"mat-icon",8),r.Wb(),r.Xb(17,"mat-button-toggle",7),r.jc(18,"translate"),r.Sb(19,"mat-icon",9),r.Wb(),r.Wb(),r.Wb(),r.Wb(),r.Wb()),2&e&&(r.oc("selectedIndex",t.selectedTypeIndex.value),r.Db(1),r.oc("label",r.kc(2,14,"igo.geo.spatialFilter.predefined")),r.Db(4),r.Jc(r.kc(6,16,"igo.geo.spatialFilter.searchLabel")),r.Db(2),r.oc("value",t.selectedQueryType),r.Db(1),r.oc("ngForOf",t.queryType),r.Db(1),r.oc("store",t.store)("queryType",t.selectedQueryType)("selectedZone",t.zone),r.Db(1),r.oc("label",r.kc(11,18,"igo.geo.spatialFilter.draw")),r.Db(3),r.oc("value",t.activeDrawType),r.Db(1),r.oc("value",t.spatialType.Polygon)("matTooltip",r.kc(15,20,"igo.geo.spatialFilter.drawPolygon")),r.Db(3),r.oc("value",t.spatialType.Point)("matTooltip",r.kc(18,22,"igo.geo.spatialFilter.drawCircle")))},directives:function(){return[Tl.b,Tl.a,it.c,it.f,ot.a,m.k,Qv,Ol.b,Ol.a,g.a,u.a,dt.o]},pipes:function(){return[U.d]},styles:[".mat-form-field[_ngcontent-%COMP%]{margin-left:2px;padding:5px;width:95%}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-body-content{overflow:hidden}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-label{padding:10px}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-body-wrapper{margin-top:5px}.spatial-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.spatial-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%], .spatial-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}"],changeDetection:0}),dv),Qv=((hv=function(){function e(t){_classCallCheck(this,e),this.spatialFilterService=t,this.formControl=new tt.f,this.zoneChange=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.formValueChanges$$=this.formControl.valueChanges.subscribe((function(t){t.length&&e.store.view.filter((function(e){var i=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.properties.nom.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(i)}))}))}},{key:"ngOnDestroy",value:function(){this.formValueChanges$$.unsubscribe()}},{key:"displayFn",value:function(e){return e?e.properties.nom:void 0}},{key:"onZoneChange",value:function(e){var t=this;e&&this.queryType&&this.spatialFilterService.loadItemById(e,this.queryType).subscribe((function(e){t.selectedZone=e,t.zoneChange.emit(e)}))}},{key:"store",get:function(){return this._store},set:function(e){this._store=e}},{key:"queryType",get:function(){return this._queryType},set:function(e){this.formControl.setValue(""),this._queryType=e}}]),e}()).\u0275fac=function(e){return new(e||hv)(r.Rb(Fb))},hv.\u0275cmp=r.Lb({type:hv,selectors:[["igo-spatial-filter-list"]],inputs:{store:"store",queryType:"queryType",selectedZone:"selectedZone"},outputs:{zoneChange:"zoneChange"},decls:10,vars:9,consts:[[1,"form-list"],["type","text","matInput","",3,"placeholder","formControl","matAutocomplete"],["input",""],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(1&e&&(r.Xb(0,"form",0),r.Xb(1,"mat-form-field"),r.Sb(2,"input",1,2),r.jc(4,"translate"),r.Xb(5,"mat-autocomplete",3,4),r.ec("optionSelected",(function(e){return t.onZoneChange(e.option.value)})),r.Gc(7,vd,2,2,"mat-option",5),r.jc(8,"async"),r.Wb(),r.Wb(),r.Sb(9,"form"),r.Wb()),2&e){var i=r.vc(6);r.Db(2),r.pc("placeholder",r.kc(4,5,"igo.geo.spatialFilter.listLabel")),r.oc("formControl",t.formControl)("matAutocomplete",i),r.Db(3),r.oc("displayWith",t.displayFn),r.Db(2),r.oc("ngForOf",r.kc(8,7,t.store.view.all$()))}},directives:[tt.x,tt.q,tt.r,it.c,et.b,tt.c,xl.c,tt.p,tt.g,xl.a,m.k,dt.o],pipes:[U.d,m.b],styles:[".mat-form-field[_ngcontent-%COMP%]{margin-left:2px;padding:5px;width:95%}"],changeDetection:0}),hv),ey=((uv=function(){function e(t,i,o,n){_classCallCheck(this,e),this.cdRef=t,this.spatialFilterService=i,this.messageService=o,this.languageService=n,this.toggleSearch=new r.o,this.itemTypeChange=new r.o,this.thematicChange=new r.o,this.drawZoneEvent=new r.o,this.radiusEvent=new r.o,this.freehandControl=new r.o,this.clearButtonEvent=new r.o,this.clearSearchEvent=new r.o,this.export=new r.o,this.openWorkspace=new r.o,this.itemType=[Tb.Address,Tb.Thematics],this.selectedItemType=Tb.Address,this.treeControl=new El.j((function(e){return e.children})),this.displayedColumns=["name","select"],this.childrens=[],this.groups=[],this.thematics=[],this.dataSource=new Fl.d,this.selectedThematics=new lt.c(!0,[]),this.value$=new L.a(void 0),this.drawGuide$=new L.a(null),this.overlayStyle$=new L.a(void 0),this.drawStyle$=new L.a(void 0),this.formControl=new tt.f,this.geometryTypeField=!1,this.geometryTypes=["Point","Polygon"],this.drawGuideField=!1,this.drawGuide=null,this.drawGuidePlaceholder="",this.measure=!1,this.drawControlIsActive=!0,this.freehandDrawIsActive=!1,this.radiusFormControl=new tt.f,this.measureUnit=Eb.Meters}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.spatialFilterService.loadThematicsList().subscribe((function(t){var i,o=_createForOfIteratorHelper(t);try{for(o.s();!(i=o.n()).done;){var n=i.value;e.childrens.push(n),e.childrens.sort((function(e,t){return e.name.localeCompare(t.name)}))}}catch(r){o.e(r)}finally{o.f()}e.childrens.forEach((function(t){t.group&&-1===e.groups.indexOf(t.group)&&(e.groups.push(t.group),e.thematics.push({name:t.group,children:[]})),t.group||e.thematics.push({name:t.name,children:[],source:t.source}),e.thematics.sort((function(e,t){return e.name.localeCompare(t.name)}))})),e.thematics.forEach((function(t){var i,o=_createForOfIteratorHelper(e.childrens);try{for(o.s();!(i=o.n()).done;){var n=i.value;n.group===t.name&&t.children.push(n)}}catch(r){o.e(r)}finally{o.f()}}))})),this.dataSource.data=this.thematics,this.drawGuide$.next(null),this.value$.next(this.formControl.value?this.formControl.value:void 0),this.value$$=this.formControl.valueChanges.subscribe((function(t){e.value$.next(t||void 0)})),this.value$.subscribe((function(){e.getRadius(),e.cdRef.detectChanges()})),this.radiusChanges$$=this.radiusFormControl.valueChanges.subscribe((function(){e.getRadius(),e.cdRef.detectChanges()}))}},{key:"ngOnDestroy",value:function(){this.value$$.unsubscribe(),this.cdRef.detach()}},{key:"onItemTypeChange",value:function(e){this.selectedItemType=e.value,this.itemTypeChange.emit(this.selectedItemType)}},{key:"onMeasureUnitChange",value:function(e){this.measureUnit=e}},{key:"isPredefined",value:function(){return this.type===Lb.Predefined}},{key:"isPolygon",value:function(){return this.type===Lb.Polygon}},{key:"isPoint",value:function(){return this.type===Lb.Point}},{key:"hasChild",value:function(e,t){return!!t.children&&t.children.length}},{key:"onToggleClick",value:function(e){this.treeControl.isExpanded(e)?this.treeControl.collapse(e):this.treeControl.expand(e)}},{key:"isAllSelected",value:function(e){var t,i=this,o=0;return e?(t=e.children.length,e.children.forEach((function(e){i.selectedThematics.selected.find((function(t){return t===e}))&&o++}))):(t=this.selectedThematics.selected.length,this.thematics.forEach((function(e){-1===i.groups.indexOf(e.name)&&o++})),this.childrens.forEach((function(e){i.thematics.find((function(t){return t.source===e.source}))||o++}))),o>=1&&t===o}},{key:"hasChildrenSelected",value:function(e){var t=this,i=!1;return e.children.forEach((function(e){t.selectedThematics.selected.find((function(t){return t.source===e.source}))&&(i=!0)})),i}},{key:"masterToggle",value:function(){var e=this;this.isAllSelected()?this.selectedThematics.clear():this.selectAll();var t,i=[],o=_createForOfIteratorHelper(this.selectedThematics.selected);try{for(o.s();!(t=o.n()).done;){var n=t.value;i.push(n)}}catch(r){o.e(r)}finally{o.f()}this.isAllSelected()?this.thematics.forEach((function(t){e.hasChild(0,t)&&e.treeControl.expand(t)})):this.thematics.forEach((function(t){e.hasChild(0,t)&&e.treeControl.collapse(t)})),this.thematicChange.emit(i)}},{key:"selectAll",value:function(e){var t=this;e?this.hasChild(0,e)&&e.children.forEach((function(e){return t.selectedThematics.select(e)})):(this.thematics.forEach((function(e){-1===t.groups.indexOf(e.name)&&t.selectedThematics.select(e)})),this.childrens.forEach((function(e){t.selectedThematics.selected.find((function(t){return t.source===e.source}))||t.selectedThematics.select(e)})))}},{key:"childrensToggle",value:function(e){var t=this;this.isAllSelected(e)?e.children.forEach((function(e){return t.selectedThematics.deselect(e)})):this.selectAll(e);var i,o=[],n=_createForOfIteratorHelper(this.selectedThematics.selected);try{for(n.s();!(i=n.n()).done;){var r=i.value;o.push(r)}}catch(a){n.e(a)}finally{n.f()}this.treeControl.expand(e),this.thematicChange.emit(o)}},{key:"onToggleChange",value:function(e){var t=this,i=!1;void 0!==this.selectedThematics.selected.find((function(t){return t.source===e.source}))&&(i=!0),this.childrens.forEach((function(o){o===e&&!1===i&&t.selectedThematics.select(o),o===e&&!0===i&&t.selectedThematics.deselect(o)})),this.thematics.forEach((function(o){o===e&&!1===i&&t.selectedThematics.select(o),o===e&&!0===i&&t.selectedThematics.deselect(o)}));var o,n=[],r=_createForOfIteratorHelper(this.selectedThematics.selected);try{for(r.s();!(o=r.n()).done;){var a=o.value;n.push(a)}}catch(s){r.e(s)}finally{r.f()}this.thematicChange.emit(n)}},{key:"onDrawControlChange",value:function(){this.drawControlIsActive=!this.drawControlIsActive}},{key:"onfreehandControlChange",value:function(){this.freehandDrawIsActive=!this.freehandDrawIsActive,this.freehandControl.emit(this.freehandDrawIsActive)}},{key:"toggleSearchButton",value:function(){var e=this;(this.isPolygon()||this.isPoint())&&(this.drawZone=this.formControl.value,this.drawZone.meta={id:void 0,title:"Zone"},this.drawZone.properties={nom:"Zone",type:this.type},this.drawZoneEvent.emit(this.drawZone)),this.radiusEvent.emit(this.radius),this.toggleSearch.emit(),this.store.entities$.subscribe((function(t){t.length&&e.layers.length===e.thematicLength+1&&e.openWorkspace.emit()}))}},{key:"clearButton",value:function(){this.loading=!0,this.map.removeLayers(this.layers),this.loading=!1,this.store&&this.store.clear(),(this.isPoint()||this.isPolygon())&&(this.drawZone=void 0,this.formControl.reset()),this.clearButtonEvent.emit()}},{key:"clearSearch",value:function(){this.selectedThematics.clear(),this.thematicChange.emit([]),this.clearSearchEvent.emit()}},{key:"disableSearchButton",value:function(){if(this.type===Lb.Predefined){if(this.selectedItemType===Tb.Address&&void 0!==this.queryType&&void 0!==this.zone)return this.loading;if(this.selectedItemType===Tb.Thematics&&void 0!==this.queryType&&void 0!==this.zone&&this.selectedThematics.selected.length>0)return this.loading}if(this.type===Lb.Polygon||this.type===Lb.Point){if(this.selectedItemType===Tb.Address&&null!==this.formControl.value)return this.loading;if(this.selectedItemType===Tb.Thematics&&this.selectedThematics.selected.length>0&&null!==this.formControl.value)return this.loading}return!0}},{key:"getRadius",value:function(){var e;if(e=null!==this.formControl.value?this.formControl.value.radius:void 0,this.type===Lb.Point){if(this.freehandDrawIsActive){if(e){if(e>=1e4)return this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.radiusAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")),void this.formControl.reset();if(e!==this.radiusFormControl.value)return void this.radiusFormControl.setValue(e)}}else if(this.radiusFormControl.value>=1e4||this.radiusFormControl.value<0)return this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.radiusAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")),this.radius=1e3,this.radiusFormControl.setValue(this.radius),void this.drawGuide$.next(this.radius);this.radius=this.radiusFormControl.value,this.drawGuide$.next(this.radius),this.overlayStyle$.next(this.PointStyle),this.drawStyle$.next(this.PointStyle)}}},{key:"type",get:function(){return this._type},set:function(e){var t=this;this._type=e;var i=this.geometryTypes.findIndex((function(e){return e===t.type}));this.geometryType=this.geometryTypes[i],this.formControl.reset(),this.radius=void 0,this.drawGuide$.next(null),this.drawStyle$.next(void 0),this.type===Lb.Predefined&&this.formControl.setValue({type:"Point",coordinates:""}),this.type===Lb.Point?(this.radius=1e3,this.radiusFormControl.setValue(this.radius),this.PointStyle=function(e,i){var o=Object(kc.r)(e.getGeometry().getCoordinates(),t.map.projection,"EPSG:4326");return new Uc.Style({image:new Uc.Circle({radius:t.radius/Math.cos(Math.PI/180*o[1])/i,stroke:new Uc.Stroke({width:2,color:"rgba(0, 153, 255)"}),fill:new Uc.Fill({color:"rgba(0, 153, 255, 0.2)"})})})},this.overlayStyle=this.PointStyle,this.drawStyle$.next(this.overlayStyle)):(this.radius=void 0,this.PolyStyle=function(e,t){return new Uc.Style({stroke:new Uc.Stroke({width:2,color:"rgba(0, 153, 255)"}),fill:new Uc.Fill({color:"rgba(0, 153, 255, 0.2)"})})},this.overlayStyle=this.PolyStyle),this.overlayStyle$.next(this.overlayStyle)}},{key:"store",get:function(){return this._store},set:function(e){var t=this;this._store=e,this._store.entities$.subscribe((function(){t.cdRef.detectChanges()}))}},{key:"measureUnits",get:function(){return[Eb.Meters]}},{key:"thematicLength",get:function(){return this._thematicLength},set:function(e){this._thematicLength=e}}]),e}()).\u0275fac=function(e){return new(e||uv)(r.Rb(r.h),r.Rb(Fb),r.Rb(Ie),r.Rb(Le))},uv.\u0275cmp=r.Lb({type:uv,selectors:[["igo-spatial-filter-item"]],inputs:{type:"type",store:"store",thematicLength:"thematicLength",loading:"loading",map:"map",queryType:"queryType",zone:"zone",layers:"layers"},outputs:{toggleSearch:"toggleSearch",itemTypeChange:"itemTypeChange",thematicChange:"thematicChange",drawZoneEvent:"drawZoneEvent",radiusEvent:"radiusEvent",freehandControl:"freehandControl",clearButtonEvent:"clearButtonEvent",clearSearchEvent:"clearSearchEvent",export:"export",openWorkspace:"openWorkspace"},decls:26,vars:39,consts:[[3,"formControl","map","geometryType","drawGuide","measure","drawControlIsActive","freehandDrawIsActive","drawStyle","overlayStyle","radius"],[1,"header"],[3,"checked","labelPosition","change",4,"ngIf"],["class","radius-unit",4,"ngIf"],[1,"title","mat-typography"],[3,"value"],[3,"value","change",4,"ngFor","ngForOf"],["class","thematics",4,"ngIf"],[1,"buttons"],["mat-raised-button","","class","clear-search-button",3,"disabled","click",4,"ngIf"],["mat-raised-button","","class","clear-form-button",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",1,"search-button",3,"disabled","click"],["mat-raised-button","",1,"remove-button",3,"disabled","click"],["mat-raised-button","",1,"export-button",3,"disabled","click"],[3,"checked","labelPosition","change"],[1,"radius-unit"],[1,"radius-form"],[1,"radius"],["type","number","matInput","",3,"placeholder","formControl","value","readonly","input"],[1,"unit-field"],[3,"value","change"],[1,"thematics"],["matColumnDef","name"],["class","thematics-header",4,"matHeaderCellDef"],["matColumnDef","select"],["class","checks-header",4,"matHeaderCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"dataSource","treeControl"],["matTreeNodeToggle","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"thematics-header"],[1,"checks-header"],[3,"checked","indeterminate","change"],["matTreeNodeToggle",""],[1,"mat-tree-node"],["mat-icon-button","","disabled",""],[1,"tree-check",3,"checked","click","change"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"tree-check-2",3,"checked","indeterminate","change"],[1,"tree-ul"],["matTreeNodeOutlet",""],["mat-raised-button","",1,"clear-search-button",3,"disabled","click"],["mat-raised-button","",1,"clear-form-button",3,"disabled","click"]],template:function(e,t){1&e&&(r.Sb(0,"igo-geometry-form-field-input",0),r.jc(1,"async"),r.jc(2,"async"),r.jc(3,"async"),r.Xb(4,"div",1),r.Gc(5,yd,3,5,"mat-slide-toggle",2),r.Gc(6,kd,3,5,"mat-slide-toggle",2),r.Wb(),r.Gc(7,Sd,8,9,"div",3),r.Xb(8,"mat-label",4),r.Ic(9),r.jc(10,"translate"),r.Wb(),r.Xb(11,"mat-radio-group",5),r.Gc(12,Cd,3,4,"mat-radio-button",6),r.Wb(),r.Gc(13,Fd,11,5,"div",7),r.Xb(14,"div",8),r.Gc(15,_d,3,4,"button",9),r.Gc(16,Md,3,4,"button",10),r.Xb(17,"button",11),r.ec("click",(function(){return t.toggleSearchButton()})),r.Ic(18),r.jc(19,"translate"),r.Wb(),r.Xb(20,"button",12),r.ec("click",(function(){return t.clearButton()})),r.Ic(21),r.jc(22,"translate"),r.Wb(),r.Xb(23,"button",13),r.ec("click",(function(){return t.export.emit()})),r.Ic(24),r.jc(25,"translate"),r.Wb(),r.Wb()),2&e&&(r.oc("formControl",t.formControl)("map",t.map)("geometryType",t.geometryType)("drawGuide",r.kc(1,25,t.drawGuide$))("measure",t.measure)("drawControlIsActive",t.drawControlIsActive)("freehandDrawIsActive",t.freehandDrawIsActive)("drawStyle",r.kc(2,27,t.drawStyle$))("overlayStyle",r.kc(3,29,t.overlayStyle$))("radius",t.radius),r.Db(5),r.oc("ngIf",!t.isPredefined()),r.Db(1),r.oc("ngIf",!t.isPredefined()),r.Db(1),r.oc("ngIf",t.isPoint()),r.Db(2),r.Kc("",r.kc(10,31,"igo.geo.spatialFilter.search")," : "),r.Db(2),r.oc("value",t.selectedItemType),r.Db(1),r.oc("ngForOf",t.itemType),r.Db(1),r.oc("ngIf","Thematics"===t.selectedItemType),r.Db(2),r.oc("ngIf",t.isPredefined()),r.Db(1),r.oc("ngIf",t.isPolygon()||t.isPoint()),r.Db(1),r.oc("disabled",t.disableSearchButton()),r.Db(1),r.Kc(" ",r.kc(19,33,"igo.geo.spatialFilter.goSearch")," "),r.Db(2),r.oc("disabled",!t.store.entities$.getValue().length&&!t.zone&&!t.drawZone),r.Db(1),r.Kc(" ",r.kc(22,35,"igo.geo.spatialFilter.removeLayer")," "),r.Db(2),r.oc("disabled",!t.store.entities$.getValue().length),r.Db(1),r.Kc(" ",r.kc(25,37,"igo.geo.spatialFilter.exportLayer")," "))},directives:[Ev,tt.p,tt.g,m.l,it.f,Ll.b,m.k,l.a,kl.a,tt.x,tt.q,tt.r,it.c,tt.t,et.b,tt.c,Ll.a,Ke.j,Ke.c,Ke.e,Ke.g,Ke.i,Fl.b,Fl.f,Ke.d,v.a,Ke.f,Ke.h,Fl.e,Fl.h,Fl.a,u.a,Fl.g],pipes:[m.b,U.d],styles:[".header[_ngcontent-%COMP%]{margin-top:5px;width:100%}.mat-slide-toggle[_ngcontent-%COMP%]{margin-bottom:15px;padding:5px;width:98%}.mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 20px)}.radius-form[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{margin-left:5px}.title[_ngcontent-%COMP%]{font-size:medium}.mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-top:10px}.mat-radio-button[_ngcontent-%COMP%]{display:inline-flex;margin-left:16px;margin-top:10px;position:relative}.mat-form-field[_ngcontent-%COMP%]{margin-top:5px}.mat-column-select[_ngcontent-%COMP%]{overflow:auto}.buttons[_ngcontent-%COMP%]{margin-top:15px}.search-button[_ngcontent-%COMP%]{left:25px;width:150px}.remove-button[_ngcontent-%COMP%]{margin:12px;width:150px}.clear-form-button[_ngcontent-%COMP%], .clear-search-button[_ngcontent-%COMP%]{left:10px;width:150px}.thematics[_ngcontent-%COMP%]{margin-top:5px;max-height:30%}.results[_ngcontent-%COMP%], .thematics[_ngcontent-%COMP%]{overflow:auto;width:98%}.results[_ngcontent-%COMP%]{max-height:250px}.mat-column-typeResults[_ngcontent-%COMP%]{margin-right:5px;max-width:100px}.radius[_ngcontent-%COMP%]{width:90%}.radius[_ngcontent-%COMP%]     .mat-form-field-infix{display:inline-flex}.unit-field[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}.example-tree-invisible[_ngcontent-%COMP%]{display:none}.tree-ul[_ngcontent-%COMP%]{list-style-type:none;margin:0;padding:0 0 0 20px}.tree-check[_ngcontent-%COMP%], .tree-check-2[_ngcontent-%COMP%]{margin-left:auto;margin-right:5px;position:relative}.thematics-header[_ngcontent-%COMP%]{max-width:250px}.checks-header[_ngcontent-%COMP%]{max-width:calc(100% - 316px);overflow:hidden;padding:none}.mat-checkbox[_ngcontent-%COMP%]{padding:5px}.mat-tree-node[_ngcontent-%COMP%]{min-height:42px;position:relative;width:280px}.mat-header-cell[_ngcontent-%COMP%]{height:56px}"],changeDetection:0}),uv),ty=Mc,iy=((Mv=function(){function e(){_classCallCheck(this,e),this.changeProperty=new r.o,this.beginHourFormControl=new tt.f,this.beginMinuteFormControl=new tt.f,this.endHourFormControl=new tt.f,this.endMinuteFormControl=new tt.f,this._defaultMin="1900-01-01",this.ogcFilterOperator=$g,this.defaultStepMillisecond=6e4}return _createClass(e,[{key:"ngOnInit",value:function(){this.beginValue=this.parseFilter(this.handleMin()),this.endValue=this.parseFilter(this.handleMax()),this.updateHoursMinutesArray(),this.updateValues()}},{key:"parseFilter",value:function(e){if(!e)return new Date;if(isNaN(new Date(e).getTime())){if(e.search("now")>=0){var t=e.match(/years|months|weeks|days|hours|seconds/);if(e.match(/\+/)){var i=parseInt(e.substring(e.search("+")+1,t.index),10);return ty().add(i,t[0]).toDate()}if(e.match(/\-/)){var o=parseInt(e.substring(e.search("-")+1,t.index),10);return ty().subtract(o,t[0]).toDate()}return new Date}if(e.search("today")>=0){var n=ty().endOf("day").toDate(),r=e.match(/years|months|weeks|days|hours|seconds/);if(e.match(/\+/)){var a=parseInt(e.substring(e.search("+")+1,r.index),10);return ty(n).add(a,r[0]).toDate()}if(e.match(/\-/)){var s=parseInt(e.substring(e.search("-")+1,r.index),10);return ty(n).subtract(s,r[0]).toDate()}return n}return new Date}return e?new Date(e):new Date}},{key:"changeTemporalProperty",value:function(e,t){var i=this.getDateTime(e,t);2===t&&"date"===this.calendarType()&&(i=ty(i).endOf("day").toDate()),1===t?(this.beginValue=i,this.restrictedToStep()&&this.changeTemporalProperty(this.addStep(i),2)):this.endValue=i,this.updateHoursMinutesArray(),this.changeProperty.next({value:i.toISOString(),pos:t})}},{key:"handleDate",value:function(e){if(e&&""!==e)return new Date(e)}},{key:"calendarType",value:function(){return this.stepMilliseconds<864e5?"datetime":"date"}},{key:"yearSelected",value:function(e,t,i){this.stepIsYearDuration()&&(t&&t.close(),"end"===i?e=ty(e).endOf("year").toDate():"begin"===i&&this.restrictedToStep()&&this.yearSelected(e,void 0,"end"),this.changeTemporalProperty(e,"begin"===i?1:2))}},{key:"monthSelected",value:function(e,t,i){this.stepIsMonthDuration()&&(t&&t.close(),"end"===i?e=ty(e).endOf("month").toDate():"begin"===i&&this.restrictedToStep()&&this.monthSelected(e,void 0,"end"),this.changeTemporalProperty(e,"begin"===i?1:2))}},{key:"calendarView",value:function(){var e=this.stepMilliseconds,t=Math.abs(this.parseFilter(this.currentFilter.end).getTime()-this.parseFilter(this.currentFilter.begin).getTime());return this.stepIsYearDuration()?"multi-year":this.stepIsMonthDuration()?"year":e<864e5&&t<864e5?"clock":"month"}},{key:"stepIsYearDuration",value:function(){var e=ty.duration(this.step);return 0!==e.years()&&0===e.months()&&0===e.weeks()&&0===e.days()&&0===e.hours()&&0===e.minutes()}},{key:"stepIsMonthDuration",value:function(){var e=ty.duration(this.step);return 0!==e.months()&&0===e.weeks()&&0===e.days()&&0===e.hours()&&0===e.minutes()}},{key:"stepIsWeekDuration",value:function(){var e=ty.duration(this.step);return 0!==e.weeks()&&7===e.days()&&0===e.hours()&&0===e.minutes()}},{key:"stepIsDayDuration",value:function(){var e=ty.duration(this.step);return 0!==e.days()&&0===e.hours()&&0===e.minutes()}},{key:"stepIsHourDuration",value:function(){var e=ty.duration(this.step);return 0!==e.hours()&&0===e.minutes()}},{key:"stepIsMinuteDuration",value:function(){return 0!==ty.duration(this.step).minutes()}},{key:"dateFilter",value:function(e,t){var i=new Date(t),o=i.getTime()-new Date(this.handleMin()).getTime();if(this.stepIsMonthDuration()){var n=ty(i).diff(ty(this.handleMin()),"months",!0);if("end"===e){var r=ty(i).add(1,"d");return ty(r).diff(ty(this.handleMin()),"months",!0)%ty.duration(this.step).asMonths()==0}if("begin"===e)return n%ty.duration(this.step).asMonths()==0}else if(this.stepIsWeekDuration()){var a=ty(i).diff(ty(this.handleMin()),"weeks",!0);if("end"===e){var s=ty(i).add(1,"d");return ty(s).diff(ty(this.handleMin()),"weeks",!0)%ty.duration(this.step).asWeeks()==0}if("begin"===e)return a%ty.duration(this.step).asWeeks()==0}else if(this.stepIsDayDuration()){var c=ty(i).diff(ty(this.handleMin()),"days",!0);if("end"===e){var l=ty(i).add(1,"d"),u=ty(l).diff(ty(this.handleMin()),"days",!0)%ty.duration(this.step).asDays();return u<1e-7&&u>-1e-7||0===u}if("begin"===e){var h=c%ty.duration(this.step).asDays()+1;return h<1e-7&&h>-1e-7&&0!==h||1===h}}else{if(this.stepIsHourDuration())return ty(i).diff(ty(this.handleMin()),"hours",!0)%ty.duration(this.step).asHours()==0;if(this.stepIsMinuteDuration())return!0}return o%this.stepMilliseconds==0}},{key:"getDateTime",value:function(e,t){var i,o=new Date(e);switch(t){case 1:i=o.setHours(this.beginHourFormControl.value,this.beginMinuteFormControl.value);break;case 2:i=o.setHours(this.endHourFormControl.value,this.endMinuteFormControl.value)}return new Date(i||o)}},{key:"handleMinuteIncrement",value:function(){return this.stepIsMinuteDuration()?this.stepMilliseconds<36e5?this.stepMilliseconds/1e3==60?1:this.stepMilliseconds/1e3:this.stepMilliseconds%36e5/60:this.stepIsHourDuration()?60:1}},{key:"handleHourIncrement",value:function(){return this.stepIsHourDuration()?this.stepMilliseconds/1e3/60/60:1}},{key:"fullBeginHoursArray",value:function(e){var t=this;this.beginHours=Array.from(e?{length:(this.endHourFormControl.value-0)/this.handleHourIncrement()+1}:{length:23/this.handleHourIncrement()+1},(function(e,i){return 0+i*t.handleHourIncrement()})),this.beginHourFormControl.setValue(this.beginValue.getHours())}},{key:"fullEndHoursArray",value:function(e){var t=this;this.endHours=e?Array.from({length:(23-this.beginHourFormControl.value)/this.handleHourIncrement()+1},(function(e,i){return t.beginHourFormControl.value+i*t.handleHourIncrement()})):Array.from({length:23/this.handleHourIncrement()+1},(function(e,i){return 0+i*t.handleHourIncrement()})),this.endHourFormControl.setValue(this.endValue.getHours())}},{key:"fullBeginMinutesArray",value:function(e){var t=this;this.beginMinutes=Array.from(e?{length:(this.endMinuteFormControl.value-0)/this.handleMinuteIncrement()+1}:{length:59/this.handleMinuteIncrement()+1},(function(e,i){return 0+i*t.handleMinuteIncrement()})),this.beginMinuteFormControl.setValue(this.beginValue.getMinutes())}},{key:"fullEndMinutesArray",value:function(e){var t=this;this.endMinutes=e?Array.from({length:(59-this.beginMinuteFormControl.value)/this.handleMinuteIncrement()+1},(function(e,i){return t.beginMinuteFormControl.value+i*t.handleMinuteIncrement()})):Array.from({length:59/this.handleMinuteIncrement()+1},(function(e,i){return 0+i*t.handleMinuteIncrement()})),this.endMinuteFormControl.setValue(this.endValue.getMinutes())}},{key:"updateHoursMinutesArray",value:function(){var e=new Date(this.beginValue),t=new Date(this.endValue);e.setHours(0,0)===t.setHours(0,0)?(this.fullBeginHoursArray(!0),this.fullEndHoursArray(!0),this.beginValue.getHours()===this.endValue.getHours()&&(this.fullBeginMinutesArray(!0),this.fullEndMinutesArray(!0))):(this.fullBeginHoursArray(),this.fullEndHoursArray(),this.fullBeginMinutesArray(),this.fullEndMinutesArray())}},{key:"updateValues",value:function(){this.changeTemporalProperty(this.beginValue,1),this.changeTemporalProperty(this.endValue,2)}},{key:"restrictedToStep",value:function(){return!!this.currentFilter.restrictToStep&&this.currentFilter.restrictToStep}},{key:"addStep",value:function(e){return ty(e).add(this.stepMilliseconds,"milliseconds").toDate()}},{key:"handleMin",value:function(){return this.currentFilter.begin?this.currentFilter.begin:this.datasource.options.minDate?this.datasource.options.minDate:this._defaultMin}},{key:"handleMax",value:function(){return this.currentFilter.end?this.currentFilter.end:this.datasource.options.maxDate?this.datasource.options.maxDate:void 0}},{key:"step",get:function(){return this.datasource.options.stepDate?this.datasource.options.stepDate:this.currentFilter.step}},{key:"stepMilliseconds",get:function(){var e=ty.duration(this.step).asMilliseconds();return 0===e?this.defaultStepMillisecond:e}},{key:"beginValue",set:function(e){this._beginValue=e},get:function(){return this._beginValue}},{key:"endValue",set:function(e){this._endValue=e},get:function(){return this._endValue}}]),e}()).\u0275fac=function(e){return new(e||Mv)},Mv.\u0275cmp=r.Lb({type:Mv,selectors:[["igo-ogc-filter-time"]],viewQuery:function(e,t){var i;1&e&&(r.Oc(Dd,!0),r.Oc(Pd,!0),r.Oc(Ad,!0),r.Oc(jd,!0)),2&e&&(r.uc(i=r.fc())&&(t.endDatepickerTime=i.first),r.uc(i=r.fc())&&(t.beginDatepickerTime=i.first),r.uc(i=r.fc())&&(t.beginTime=i.first),r.uc(i=r.fc())&&(t.endTime=i.first))},inputs:{datasource:"datasource",currentFilter:"currentFilter"},outputs:{changeProperty:"changeProperty"},decls:14,vars:15,consts:[[1,"datetime-container"],[1,"datetime-input"],[1,"date-input"],["matSuffix","",3,"for"],["matInput","",3,"matDatepicker","placeholder","matDatepickerFilter","value","min","max","dateChange"],["begin",""],[1,"filler"],[3,"startView","startAt","yearSelected","monthSelected"],["beginDatepicker",""],[1,"time-input"],["class","hour-input",4,"ngIf"],["class","minute-input",4,"ngIf"],["class","datetime-input",4,"ngIf"],[1,"hour-input"],[3,"formControl","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"minute-input"],["end",""],["endDatepicker",""]],template:function(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",0),r.Xb(1,"div",1),r.Xb(2,"mat-form-field",2),r.Sb(3,"mat-datepicker-toggle",3),r.Xb(4,"input",4,5),r.ec("dateChange",(function(){r.yc(i);var e=r.vc(5);return t.changeTemporalProperty(e.value,1)})),r.jc(6,"translate"),r.Wb(),r.Sb(7,"span",6),r.Xb(8,"mat-datepicker",7,8),r.ec("yearSelected",(function(e){r.yc(i);var o=r.vc(9);return t.yearSelected(e,o,"begin")}))("monthSelected",(function(e){r.yc(i);var o=r.vc(9);return t.monthSelected(e,o,"begin")})),r.Wb(),r.Wb(),r.Xb(10,"div",9),r.Gc(11,$d,6,6,"mat-form-field",10),r.Gc(12,Wd,6,6,"mat-form-field",11),r.Wb(),r.Wb(),r.Gc(13,Nd,12,14,"div",12),r.Wb()}if(2&e){var o=r.vc(9);r.Db(3),r.oc("for",o),r.Db(1),r.oc("matDatepicker",o)("placeholder",r.kc(6,13,"igo.geo.timeFilter.startDate"))("matDatepickerFilter",t.dateFilter.bind(t,"begin"))("value",t.beginValue?t.beginValue:t.handleDate(t.datasource.options.minDate))("min",t.handleDate(t.datasource.options.minDate))("max",t.endValue&&!t.restrictedToStep()?t.endValue:t.handleDate(t.datasource.options.maxDate)),r.Eb("disabled",!t.currentFilter.active),r.Db(4),r.oc("startView",t.calendarView())("startAt",t.beginValue),r.Db(3),r.oc("ngIf","datetime"===t.calendarType()),r.Db(1),r.oc("ngIf","datetime"===t.calendarType()),r.Db(1),r.oc("ngIf",!t.restrictedToStep())}},directives:[it.c,Il.f,it.h,et.b,Il.c,Il.b,m.l,it.f,ot.a,tt.p,tt.g,m.k,dt.o],pipes:[U.d],styles:["input{margin:auto 5px!important;text-align:center!important}.datetime-container[_ngcontent-%COMP%]{text-align:center}.datetime-input[_ngcontent-%COMP%]{display:inline-block;margin:5px 25px}.date-input[_ngcontent-%COMP%]{margin-right:25px;width:120px}.time-input[_ngcontent-%COMP%]{display:inherit;margin-right:25px}.hour-input[_ngcontent-%COMP%], .minute-input[_ngcontent-%COMP%]{width:40px}.minute-input[_ngcontent-%COMP%]{margin-left:10px}"]}),Mv),oy=((_v=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:dt.f,useValue:"fr-FR"}]}}}]),e}()).\u0275mod=r.Pb({type:_v}),_v.\u0275inj=r.Ob({factory:function(e){return new(e||_v)},providers:[Ob,Ib,Fb],imports:[[m.c,tt.k,tt.u,xl.b,u.b,l.b,Tl.c,Ll.c,y.b,Ke.l,Fl.c,Ol.c,v.b,Sl.b,kl.b,it.e,et.c,dt.p,ot.b,h.e,g.b,Il.e,dt.m,_l.c,_l.e,Ce,vb,Mn,kr,br,Xv,Ze.b]]}),_v),ny=function(e){_inherits(i,_wrapNativeSuper(Error));var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return i}(),ry=function(e){_inherits(i,e);var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),e=t.call(this,"Invalid file"),Object.setPrototypeOf(_assertThisInitialized(e),i.prototype),e}return i}(ny),ay=function(e){_inherits(i,e);var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),e=t.call(this,"Nothing to export"),Object.setPrototypeOf(_assertThisInitialized(e),i.prototype),e}return i}(ny),sy=W(["GeoJSON","GML","GPX","KML","Shapefile","CSVcomma","CSVsemicolon","URL"]),cy=W(["UTF8","LATIN1"]),ly=((Dv=function(){function e(t){_classCallCheck(this,e),this.config=t,this.aggregateInComment=!0,this.ogreUrl=this.config.getConfig("importExport.url");var i=this.config.getConfig("importExport.gpxAggregateInComment");void 0!==i&&(this.aggregateInComment=i)}return _createClass(e,[{key:"export",value:function(e,t,i,o){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"EPSG:4326",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"EPSG:4326",a=this.generateFeature(e,t);return this.exportAsync(a,t,i,o,n,r)}},{key:"generateFeature",value:function(e,t){return t===sy.GPX&&this.aggregateInComment?this.generateAggratedFeature(e):e.map((function(e){var t=e.getKeys().filter((function(e){return!e.startsWith("_")})).reduce((function(t,i){return t[i]=e.get(i),t}),{geometry:e.getGeometry()});return new Vc.a(t)}))}},{key:"generateAggratedFeature",value:function(e){return e.map((function(e){var t=e.getKeys().filter((function(e){return!e.startsWith("_")})),i="",o=t.reduce((function(t,o){return void 0!==o&&"geometry"!==o&&(i+=o+":"+e.get(o)+"   \r\n"),t[o]=e.get(o),t}),{geometry:e.getGeometry()}),n=new Vc.a(o);return n.set("name",e.getId()),n.set("cmt",i),n}))}},{key:"exportAsync",value:function(t,i,o,n,r,a){var s=this;return new Ve.a((function(c){if(!0!==s.nothingToExport(t,i))if(Object.keys(e.ogreFormats).indexOf(i)>=0){if(void 0===s.ogreUrl)return void(e.noOgreFallbacks.indexOf(i)>=0?s.exportToFile(t,c,i,o,r,a):c.error(new ry));s.exportWithOgre(t,c,i,o,n,r,a)}else s.exportToFile(t,c,i,o,r,a);else c.error(new ay)}))}},{key:"exportToFile",value:function(e,t,i,o,n,r){var a,s;a=(new xc[i]).writeFeatures(e,{dataProjection:r,featureProjection:n,featureType:"feature",featureNS:"http://example.com/feature"}),s="".concat(o,".").concat(i.toLowerCase()),function(e,t){var i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("download",t),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}("data:text/plain;charset=utf-8,"+encodeURIComponent(a),s),t.complete()}},{key:"exportWithOgre",value:function(t,i,o,n,r,a,s){var c=(new xc.GeoJSON).writeFeatures(t,{dataProjection:s,featureProjection:a,featureType:"feature",featureNS:"http://example.com/feature"}),l=this.ogreUrl+"/convertJson",u=document.createElement("form");if(u.style.display="none",document.body.appendChild(u),u.setAttribute("method","post"),u.setAttribute("target","_blank"),u.setAttribute("action",l),r===cy.UTF8)u.acceptCharset="UTF-8",u.enctype="application/x-www-form-urlencoded; charset=utf-8;";else if(r===cy.LATIN1){var h=document.createElement("input");h.setAttribute("type","hidden"),h.setAttribute("name","encoding"),h.setAttribute("value","ISO-8859-1"),u.appendChild(h)}if("CSVsemicolon"===o){var d=document.createElement("input");d.setAttribute("type","hidden"),d.setAttribute("name","lco"),d.setAttribute("value","SEPARATOR=SEMICOLON"),u.appendChild(d)}var p=document.createElement("input");p.setAttribute("type","hidden"),p.setAttribute("name","json"),p.setAttribute("value",c),u.appendChild(p);var g=document.createElement("input"),f="Shapefile"===o?n+".zip":"".concat(n,".").concat(o.toLowerCase());"CSVcomma"!==o&&"CSVsemicolon"!==o||(f=n+".csv"),f=(f=f.replace(" ","_")).normalize("NFD").replace(/[\u0300-\u036f]/g,""),g.setAttribute("type","hidden"),g.setAttribute("name","outputName"),g.setAttribute("value",f),u.appendChild(g);var m=e.ogreFormats[o];"CSVcomma"!==o&&"CSVsemicolon"!==o||(m="CSV");var b=document.createElement("input");b.setAttribute("type","hidden"),b.setAttribute("name","format"),b.setAttribute("value",m),u.appendChild(b),u.submit(),document.body.removeChild(u),i.complete()}},{key:"nothingToExport",value:function(e,t){return 0===e.length||"GPX"===t&&void 0===e.find((function(e){return["Point","LineString","MultiLineString"].indexOf(e.getGeometry().getType())>=0}))}}]),e}()).\u0275fac=function(e){return new(e||Dv)(r.bc(ie))},Dv.ogreFormats={GML:"gml",GPX:"gpx",KML:"kml",Shapefile:"ESRI Shapefile",CSVcomma:"CSVcomma",CSVsemicolon:"CSVsemicolon"},Dv.noOgreFallbacks=["GML","GPX","KML"],Dv.\u0275prov=Object(r.Nb)({factory:function(){return new Dv(Object(r.bc)(ie))},token:Dv,providedIn:"root"}),Dv),uy=function(e){_inherits(i,_wrapNativeSuper(Error));var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return i}(),hy=function(e){_inherits(i,e);var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),e=t.call(this,"Invalid file"),Object.setPrototypeOf(_assertThisInitialized(e),i.prototype),e}return i}(uy),dy=function(e){_inherits(i,e);var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),e=t.call(this,"Failed to read file"),Object.setPrototypeOf(_assertThisInitialized(e),i.prototype),e}return i}(uy),py=function(e){_inherits(i,e);var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),e=t.call(this,"Nothing to import"),Object.setPrototypeOf(_assertThisInitialized(e),i.prototype),e}return i}(uy),gy=function(e){_inherits(i,e);var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),e=t.call(this,"File is too large"),Object.setPrototypeOf(_assertThisInitialized(e),py.prototype),e}return i}(uy),fy=function(e){_inherits(i,e);var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),e=t.call(this,"Invalid SRS definition"),Object.setPrototypeOf(_assertThisInitialized(e),py.prototype),e}return i}(uy);function my(e,t,i,o,n,r,a){if(0!==t.length){var s=Cy(e);r?function(e,t,i,o,n){var r,a,s,c=e.map((function(e){return Df(e,t.projection)}));if(o.getStyleList(i.toString()+".styleByAttribute")){var l=o.getStyleList(i.toString()+".styleByAttribute");r=function(e){return n.createStyleByAttribute(e,l)}}else if(o.getStyleList(i.toString()+".clusterStyle")){var u=o.getStyleList(i.toString()+".clusterParam");a=o.getStyleList(i.toString()+".distance");var h=n.createStyle(o.getStyleList(i.toString()+".clusterStyle"));r=function(e){return n.createClusterStyle(e,u,h)}}else if(o.getStyleList(i.toString()+".style"))r=n.createStyle(o.getStyleList(i.toString()+".style"));else if(o.getStyleList("default.clusterStyle")&&"Point"===e[0].geometry.type){var d=o.getStyleList("default.clusterParam");a=o.getStyleList("default.distance");var p=n.createStyle(o.getStyleList("default.clusterStyle"));r=function(e){return n.createClusterStyle(e,d,p)}}else r=n.createStyle(o.getStyleList("default.style"));o.getStyleList(i.toString()+".clusterStyle")?(s=new cf({distance:a,type:"cluster",queryable:!0})).ol.source.addFeatures(c):o.getStyleList(i.toString())?(s=new Pg({type:"vector",queryable:!0})).ol.addFeatures(c):o.getStyleList("default.clusterStyle")&&"Point"===e[0].geometry.type?(s=new cf({distance:a,type:"cluster",queryable:!0})).ol.source.addFeatures(c):(s=new Pg({type:"vector",queryable:!0})).ol.addFeatures(c);var g=new wf({title:i,source:s,style:r});t.addLayer(g),jf(t,c)}(t,i,s,r,a):function(e,t,i){var o=e.map((function(e){return Df(e,t.projection)})),n=Math.floor(255*Math.random()),r=Math.floor(255*Math.random()),a=Math.floor(255*Math.random()),s=new Uc.Stroke({color:[n,r,a,1],width:2}),c=new Uc.Fill({color:[n,r,a,.4]}),l=new Pg({type:"vector",queryable:!0});l.ol.addFeatures(o);var u=new wf({title:i,source:l,style:new Uc.Style({stroke:s,fill:c,image:new Uc.Circle({radius:5,stroke:s,fill:c})})});t.addLayer(u),jf(t,o)}(t,i,s);var c=n.translate,l=c.instant("igo.geo.dropGeoFile.success.title"),u=c.instant("igo.geo.dropGeoFile.success.text",{value:s});o.success(u,l)}else!function(e,t,i){var o=i.translate,n=o.instant("igo.geo.dropGeoFile.empty.title"),r=o.instant("igo.geo.dropGeoFile.empty.text",{value:e.name,mimeType:e.type});t.error(r,n)}(e,o,n)}function by(e,t,i,o){var n=o.translate,r=n.instant("igo.geo.dropGeoFile.invalid.title"),a=n.instant("igo.geo.dropGeoFile.invalid.text",{value:e.name,mimeType:e.type});i.error(a,r)}function vy(e,t,i,o){var n=o.translate,r=n.instant("igo.geo.dropGeoFile.unreadable.title"),a=n.instant("igo.geo.dropGeoFile.unreadable.text",{value:e.name});i.error(a,r)}function yy(e,t,i,o,n){var r=o.translate,a=r.instant("igo.geo.dropGeoFile.tooLarge.title"),s=r.instant("igo.geo.dropGeoFile.tooLarge.text",{value:e.name,size:n});i.error(s,a)}function ky(e,t,i){var o=i.translate,n=o.instant("igo.geo.dropGeoFile.invalidSRS.title"),r=o.instant("igo.geo.dropGeoFile.invalidSRS.text",{value:e.name,mimeType:e.type});t.error(r,n)}function Sy(e){return e.name.split(".").pop().toLowerCase()}function Cy(e){return e.name.substr(0,e.name.lastIndexOf("."))}var wy,xy,Oy,Iy=((Oy=function(){function e(t,i){_classCallCheck(this,e),this.http=t,this.config=i,this.ogreUrl=this.config.getConfig("importExport.url");var o=this.config.getConfig("importExport.clientSideFileSizeMaxMb");this.clientSideFileSizeMax=(o||30)*Math.pow(1024,2)}return _createClass(e,[{key:"import",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EPSG:4326",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"EPSG:4326";return this.importAsync(e,t,i)}},{key:"getFileImporter",value:function(t){var i=Sy(t),o=t.type,n=[].concat(_toConsumableArray(e.allowedMimeTypes),_toConsumableArray(e.allowedZipMimeTypes)),r=e.allowedExtensions;if(!(n.indexOf(o)<0&&r.indexOf(i)<0))return"application/json"===o||["json","geojson","kml","gpx"].indexOf(i)>=0?this.importFile:void 0!==this.ogreUrl?this.importFileWithOgre:void 0}},{key:"importAsync",value:function(e,t,i){var o=this;return new Ve.a((function(n){if(e.size>=o.clientSideFileSizeMax)n.error(new gy);else{var r=o.getFileImporter(e);void 0!==r?r.call(o,e,n,t,i):n.error(new hy)}}))}},{key:"importFile",value:function(e,t,i,o){var n=this,r=new FileReader;r.onload=function(r){try{var a=n.parseFeaturesFromFile(e,r.target.result,i,o);t.next(a)}catch(s){t.error(new dy)}t.complete()},r.onerror=function(e){t.error(new dy)},r.readAsText(e,"UTF-8")}},{key:"importFileWithOgre",value:function(e,t,i,o){var n=this,r=this.ogreUrl+"/convert",a=new FormData;a.append("upload",e),a.append("sourceSrs",i),a.append("targetSrs",o),a.append("formatOutput","GEOJSON"),a.append("skipFailures",""),this.http.post(r,a,{headers:new k.f}).subscribe((function(i){if(null!==i)if((i.errors||[]).length>0)t.error(new dy);else{var r=n.parseFeaturesFromGeoJSON(e,i,o);t.next(r),t.complete()}else t.error(new dy)}),(function(e){e.error.caught=!0;var i=e.error.msg||"";"No valid files found"===i?t.error(new hy):i.startWith("ERROR 1: Failed to process SRS definition")?t.error(new fy):t.error(new dy)}))}},{key:"parseFeaturesFromFile",value:function(e,t,i,o){var n,r=Sy(e),a=e.type,s=new xc.GeoJSON;if("application/vnd.google-earth.kml+xml"===a)n=new xc.KML;else if("application/gml+xml"===a)n=new xc.GML;else if("application/gpx+xml"===a)n=new xc.GPX;else switch(r){case"kml":n=new xc.KML;break;case"gpx":n=new xc.GPX;break;case"gml":n=new xc.GML;break;default:n=s}return n.readFeatures(t,{dataProjection:i,featureProjection:o}).map((function(t){return Object.assign(s.writeFeatureObject(t),{projection:o,meta:{id:G(),title:Cy(e)}})}))}},{key:"parseFeaturesFromGeoJSON",value:function(e,t,i){var o=new xc.GeoJSON;return o.readFeatures(t).map((function(t){return Object.assign(o.writeFeatureObject(t),{projection:i,meta:{id:G(),title:Cy(e)}})}))}}]),e}()).\u0275fac=function(e){return new(e||Oy)(r.bc(k.b),r.bc(ie))},Oy.allowedMimeTypes=["application/gml+xml","application/vnd.google-earth.kml+xml","application/gpx+xml","application/json"],Oy.allowedZipMimeTypes=["application/zip","application/x-zip-compressed","application/x-zip"],Oy.allowedExtensions=["geojson","kml","gpx","json","gml"],Oy.\u0275prov=Object(r.Nb)({factory:function(){return new Oy(Object(r.bc)(k.b),Object(r.bc)(ie))},token:Oy,providedIn:"root"}),Oy),Ly=((xy=function(){function e(t){_classCallCheck(this,e),this.injector=t,this.styleList={}}return _createClass(e,[{key:"getStyleList",value:function(e){return E.resolve(this.styleList,e)}},{key:"load",value:function(e){var t=this,i=e.default||{};if(!e.path)return this.styleList=i,!0;var o=this.injector.get(k.b);return new Promise((function(n,r){o.get(e.path).pipe(Object(C.a)((function(t){return console.log("StyleList file ".concat(e.path," could not be read")),n(!0),Object(T.a)(t.error||"Server error")}))).subscribe((function(e){t.styleList=E.mergeDeep(i,e),n(!0)}))}))}}]),e}()).\u0275fac=function(e){return new(e||xy)(r.bc(r.t))},xy.\u0275prov=Object(r.Nb)({factory:function(){return new xy(Object(r.bc)(r.p))},token:xy,providedIn:"root"}),xy),Ty=((wy=function(){function e(t,i,o,n,a,s,c,l,u,h){_classCallCheck(this,e),this.importService=t,this.exportService=i,this.languageService=o,this.messageService=n,this.styleListService=a,this.styleService=s,this.formBuilder=c,this.config=l,this.cdRef=u,this.storageService=h,this.formats$=new L.a(void 0),this.encodings$=new L.a(void 0),this.exportableLayers$=new L.a([]),this.inputProj="EPSG:4326",this.loading$=new L.a(!1),this.forceNaming=!1,this.controlFormat="format",this.espgCodeRegex=new RegExp("^\\d{4,6}"),this.popupChecked=!1,this.previousLayerSpecs$=new L.a(void 0),this.selectedMode="import",this.selectMode=new r.o,this.exportOptions$=new L.a(void 0),this.exportOptionsChange=new r.o,this.loadConfig(),this.buildForm()}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.layers$$=this.map.layers$.subscribe((function(t){e.exportableLayers$.next(t.filter((function(e){return e instanceof wf&&!0===e.exportable||e.dataSource.options.download&&e.dataSource.options.download.url})))}));var t=this.config.getConfig("importExport.clientSideFileSizeMaxMb");this.clientSideFileSizeMax=(t||30)*Math.pow(1024,2),this.fileSizeMb=this.clientSideFileSizeMax/Math.pow(1024,2),this.exportOptions$$=this.exportOptions$.pipe(Object(mc.a)((function(e){return!e}))).subscribe((function(t){e.form.patchValue(t,{emitEvent:!0}),t.layers&&e.computeFormats(t.layers.map((function(t){return e.map.getLayerById(t)})))})),this.formLayer$$=this.form.get("format").valueChanges.subscribe((function(t){var i,o=Object.keys(ly.ogreFormats);!e.popupChecked&&(null===(i=e.form.get("layers").value)||void 0===i?void 0:i.length)>1&&(o.indexOf(t)>=0||t===sy.URL)&&(e.handlePopup(!0)||e.form.patchValue({format:void 0},{emitEvent:!1}))})),this.formLayer$$=this.form.get("layers").valueChanges.subscribe((function(t){e.handlePreviousLayerSpecs();var i=t instanceof Array?t:[t];e.form.patchValue({layers:i},{emitEvent:!1});var o=i.map((function(t){return e.map.getLayerById(t)}));e.computeFormats(o),-1===Object.keys(e.formats$.value).indexOf(e.form.value.format)&&e.form.patchValue({format:void 0}),e.loading$.next(!0);var n=[];o.forEach((function(e){e instanceof wf&&0===e.dataSource.ol.getFeatures().length&&(n.push({id:e.id,visible:e.visible,opacity:e.opacity,queryable:e.queryable}),e.opacity=0,e.visible=!0)})),e.previousLayerSpecs$.next(n),setTimeout((function(){e.loading$.next(!1)}),500)})),this.formats$$=this.formats$.pipe(Object(mc.a)((function(e){return!e}))).subscribe((function(t){1===Object.keys(t).length&&e.form.patchValue({format:t[Object.keys(t)[0]]})})),this.encodings$$=this.encodings$.pipe(Object(mc.a)((function(e){return!e}))).subscribe((function(t){1===Object.keys(t).length&&e.form.patchValue({encoding:t[Object.keys(t)[0]]})})),this.exportableLayers$$=this.exportableLayers$.pipe(Object(mc.a)((function(e){return!e}))).subscribe((function(t){1===t.length&&e.form.patchValue({layers:t[0].id})})),this.form.controls[this.controlFormat].valueChanges.subscribe((function(t){e.form.patchValue(t===sy.CSVcomma||t===sy.CSVsemicolon?{encoding:cy.LATIN1}:{encoding:cy.UTF8}),e.cdRef.detectChanges()}))}},{key:"getWorkspaceByLayerId",value:function(e){var t=this.store.all().find((function(t){return t.layer.id===e}));if(t)return t}},{key:"getLayerTitleById",value:function(e){return this.map.getLayerById(e).title}},{key:"layerHasSelectedFeatures",value:function(e){var t=this.getWorkspaceByLayerId(e.id);if(t)return!!t.entityStore.stateView.firstBy((function(e){return!0===e.state.selected}))}},{key:"onlySelected",value:function(e,t){var i=this.form.value.layersWithSelection;e.checked?i.push(t):i=i.filter((function(e){return e!==t})),this.form.patchValue({layersWithSelection:i})}},{key:"onlySelectedClick",value:function(e,t){this.form.value.layers.find((function(e){return e===t}))&&e.stopPropagation()}},{key:"inLayersIdToExportSelectionOnly",value:function(e){return!!this.form.value.layersWithSelection.find((function(t){return t===e.id}))}},{key:"ngOnDestroy",value:function(){this.layers$$.unsubscribe(),this.exportableLayers$$.unsubscribe(),this.formats$$.unsubscribe(),this.encodings$$.unsubscribe(),this.formLayer$$.unsubscribe(),this.exportOptions$$&&this.exportOptions$$.unsubscribe(),this.exportOptionsChange.emit(this.form.value),this.handlePreviousLayerSpecs()}},{key:"handlePreviousLayerSpecs",value:function(){var e=this,t=this.previousLayerSpecs$.value;t&&t.length&&t.forEach((function(t){var i=e.map.getLayerById(t.id);i.visible=t.visible,i.opacity=t.opacity,i.queryable=t.queryable})),this.previousLayerSpecs$.next(void 0)}},{key:"importFiles",value:function(e){var t=this,i=this.inputProj;this.espgCodeRegex.test(i)&&(i="EPSG:"+i),this.loading$.next(!0);var o,n=_createForOfIteratorHelper(e);try{var r=function(){var e=o.value;t.importService.import(e,i).subscribe((function(i){return t.onFileImportSuccess(e,i)}),(function(i){return t.onFileImportError(e,i)}),(function(){t.loading$.next(!1)}))};for(n.s();!(o=n.n()).done;)r()}catch(a){n.e(a)}finally{n.f()}}},{key:"handlePopup",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];window.open("","_blank").close();var t=window.open("","_blank");return!t||t.closed||void 0===t.closed||null===t?(this.onPopupBlockedError(e),this.popupAllowed=!1):(t.close(),this.popupAllowed=!0,this.popupChecked=!0),this.popupAllowed}},{key:"handleExportFormSubmit",value:function(e){var t=this;this.loading$.next(!0);var i=Object.keys(ly.ogreFormats);!this.popupChecked&&e.layers.length>1&&(i.indexOf(e.format)>=0||e.format===sy.URL)&&!this.popupAllowed&&this.handlePopup(),e.layers.forEach((function(i){var o=t.map.getLayerById(i),n=o.title;void 0!==e.name&&(n=e.name);var r=o.dataSource.options;if(e.format===sy.URL&&r.download&&r.download.url)setTimeout((function(){window.open(r.download.url,"_blank"),t.loading$.next(!1)}),500);else{var a,s=t.getWorkspaceByLayerId(i);s&&s.entityStore&&s.entityStore.stateView.all().length?a=-1!==e.layersWithSelection.indexOf(i)&&e.featureInMapExtent?s.entityStore.stateView.all().filter((function(e){return e.state.inMapExtent&&e.state.selected})).map((function(e){return e.entity.ol})):-1===e.layersWithSelection.indexOf(i)||e.featureInMapExtent?e.featureInMapExtent?s.entityStore.stateView.all().filter((function(e){return e.state.inMapExtent})).map((function(e){return e.entity.ol})):s.entityStore.stateView.all().map((function(e){return e.entity.ol})):s.entityStore.stateView.all().filter((function(e){return e.state.selected})).map((function(e){return e.entity.ol})):(a=e.featureInMapExtent?o.dataSource.ol.getFeaturesInExtent(o.map.viewController.getExtent()):o.dataSource.ol.getFeatures(),o.dataSource instanceof cf&&(a=a.flatMap((function(e){return e.get("features")})))),t.exportService.export(a,e.format,n,e.encoding,t.map.projection).subscribe((function(){}),(function(e){return t.onFileExportError(e)}),(function(){t.onFileExportSuccess(),t.loading$.next(!1)}))}}))}},{key:"buildForm",value:function(){this.form=this.formBuilder.group(this.forceNaming?{format:["",[tt.w.required]],layers:[[],[tt.w.required]],layersWithSelection:[[]],encoding:[cy.UTF8,[tt.w.required]],featureInMapExtent:[!1,[tt.w.required]],name:["",[tt.w.required]]}:{format:["",[tt.w.required]],layers:[[],[tt.w.required]],layersWithSelection:[[]],encoding:[cy.UTF8,[tt.w.required]],featureInMapExtent:[!1,[tt.w.required]]})}},{key:"onFileImportSuccess",value:function(e,t){this.config.getConfig("importWithStyle")?my(e,t,this.map,this.messageService,this.languageService,this.styleListService,this.styleService):my(e,t,this.map,this.messageService,this.languageService)}},{key:"onFileImportError",value:function(e,t){this.loading$.next(!1),function(e,t,i,o,n){({"Invalid file":by,"File is too large":yy,"Failed to read file":vy,"Invalid SRS definition":ky})[t.message](e,t,i,o,n=n||30)}(e,t,this.messageService,this.languageService,this.fileSizeMb)}},{key:"onPopupBlockedError",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loading$.next(!1);var t=this.languageService.translate,i=t.instant("igo.geo.export.popupBlocked.title"),o=t.instant(e?"igo.geo.export.popupBlocked.selectAgain":"igo.geo.export.popupBlocked.retry"),n=t.instant("igo.geo.export.popupBlocked.text",{extraMessage:o});this.messageService.error(n,i,{timeOut:2e4})}},{key:"onFileExportError",value:function(e){this.loading$.next(!1),function(e,t,i){if(e instanceof ay)!function(e,t){var i=t.translate,o=i.instant("igo.geo.export.nothing.title"),n=i.instant("igo.geo.export.nothing.text");e.error(n,o)}(t,i);else{var o=i.translate,n=o.instant("igo.geo.export.failed.title"),r=o.instant("igo.geo.export.failed.text");t.error(r,n)}}(e,this.messageService,this.languageService)}},{key:"loadConfig",value:function(){void 0!==this.config.getConfig("importExport.forceNaming")&&(this.forceNaming=this.config.getConfig("importExport.forceNaming")),this.computeFormats(),this.loadEncodings()}},{key:"encodingDefaultValue",value:function(e){return e===sy.CSVcomma||e===sy.CSVsemicolon?(this.form.patchValue({encoding:cy.LATIN1}),cy.LATIN1):(this.form.patchValue({encoding:cy.UTF8}),cy.UTF8)}},{key:"loadEncodings",value:function(){this.encodings$.next(cy)}},{key:"computeFormats",value:function(e){if(e&&e.length){var t={onlyUrl:!1,onlyVector:!1,vectorAndUrl:!1};if(e.forEach((function(e){e&&(e instanceof wf||!e.dataSource.options.download||!e.dataSource.options.download.url?e.dataSource.options.download&&e.dataSource.options.download.url?t.vectorAndUrl=!0:e instanceof wf&&(t.onlyVector=!0):t.onlyUrl=!0)})),!0===t.onlyUrl&&!1===t.onlyVector)this.formats$.next(W(["URL"]));else if(!0===t.onlyVector&&!1===t.onlyUrl){if(this.computeFormats(),sy.URL in this.formats$.value){var i=Object.keys(this.formats$.value).filter((function(e){return"URL"!==e}));this.formats$.next(W(i))}}else if(!0===t.vectorAndUrl&&!1===t.onlyUrl&&!1===t.onlyVector){if(this.computeFormats(),!(sy.URL in this.formats$.value)){var o=Object.keys(this.formats$.value);o.push("URL"),this.formats$.next(W(o))}}else this.formats$.next([]),this.messageService.alert(this.languageService.translate.instant("igo.geo.export.noFormat.text"),this.languageService.translate.instant("igo.geo.export.noFormat.title"))}else if(void 0!==this.config.getConfig("importExport.formats")){var n=this.validateListFormat(this.config.getConfig("importExport.formats"));this.formats$.next(W(n))}else this.formats$.next(sy)}},{key:"validateListFormat",value:function(e){return e.filter((function(e){if(e.toUpperCase()===sy.CSVcomma.toUpperCase()||e.toUpperCase()===sy.CSVsemicolon.toUpperCase()||e.toUpperCase()===sy.GML.toUpperCase()||e.toUpperCase()===sy.GPX.toUpperCase()||e.toUpperCase()===sy.GeoJSON.toUpperCase()||e.toUpperCase()===sy.KML.toUpperCase()||e.toUpperCase()===sy.Shapefile.toUpperCase()||e.toUpperCase()===sy.URL.toUpperCase())return e})).map((function(e){return e.toUpperCase()===sy.CSVcomma.toUpperCase()?e=sy.CSVcomma:e.toUpperCase()===sy.CSVsemicolon.toUpperCase()?e=sy.CSVsemicolon:e.toUpperCase()===sy.GML.toUpperCase()?e=sy.GML:e.toUpperCase()===sy.GPX.toUpperCase()?e=sy.GPX:e.toUpperCase()===sy.GeoJSON.toUpperCase()?e=sy.GeoJSON:e.toUpperCase()===sy.KML.toUpperCase()?e=sy.KML:e.toUpperCase()===sy.Shapefile.toUpperCase()?e=sy.Shapefile:e.toUpperCase()===sy.URL.toUpperCase()?e=sy.URL:void 0}))}},{key:"modeChanged",value:function(e){this.selectMode.emit(e)}},{key:"onFileExportSuccess",value:function(){var e,t,i,o,n;e=this.messageService,t=this.languageService,i=t.translate,o=i.instant("igo.geo.export.success.title"),n=i.instant("igo.geo.export.success.text"),e.success(n,o)}},{key:"onImportExportChange",value:function(e){this.selectedMode=e.value}},{key:"layers",get:function(){return this.form.get("layers").value},set:function(e){this.form.patchValue({layers:e})}},{key:"popupAllowed",get:function(){return this.storageService.get("importExportPopupAllowed")||!1},set:function(e){this.storageService.set("importExportPopupAllowed",e)}}]),e}()).\u0275fac=function(e){return new(e||wy)(r.Rb(Iy),r.Rb(ly),r.Rb(Le),r.Rb(Ie),r.Rb(Ly),r.Rb(Tf),r.Rb(tt.e),r.Rb(ie),r.Rb(r.h),r.Rb($e))},wy.\u0275cmp=r.Lb({type:wy,selectors:[["igo-import-export"]],inputs:{selectedMode:"selectedMode",exportOptions$:"exportOptions$",map:"map",store:"store"},outputs:{selectMode:"selectMode",exportOptionsChange:"exportOptionsChange"},decls:14,vars:17,consts:[[1,"import-export-toggle","mat-typography"],[3,"value","change"],[3,"value"],["class","igo-form",4,"ngIf"],["class","mat-typography",4,"ngIf"],["class","igo-form",3,"formGroup",4,"ngIf"],[1,"igo-form"],[1,"igo-input-container"],["matInput","","name","inputProj",3,"placeholder","ngModel","ngModelChange"],[1,"igo-form-button-group"],["mat-raised-button","","type","button",3,"disabled","click"],[3,"shown"],["hidden","","type","file",3,"click","change"],["fileInput",""],[1,"mat-typography"],[1,"igo-form",3,"formGroup"],["multiple","",3,"value","valueChange"],["class","export-select-trigger",4,"ngIf"],[3,"ngClass","value","click",4,"ngFor","ngForOf"],["formControlName","format"],[4,"ngIf"],["disabled","true",4,"ngIf"],["class","igo-input-container",4,"ngIf"],["class","export-options mat-typography",4,"ngIf"],[1,"export-select-trigger"],[3,"ngClass","value","click"],["mat-line",""],[3,"labelPosition","click","checked","change",4,"ngIf"],[3,"labelPosition","click","checked","change"],[3,"value",4,"ngFor","ngForOf"],["disabled","true"],["matInput","","formControlName","name",3,"placeholder"],["formControlName","encoding"],[1,"export-options","mat-typography"],["formControlName","featureInMapExtent",3,"labelPosition"]],template:function(e,t){1&e&&(r.Xb(0,"div",0),r.Xb(1,"mat-button-toggle-group",1),r.ec("change",(function(e){return t.onImportExportChange(e)})),r.Xb(2,"mat-button-toggle",2),r.Ic(3),r.jc(4,"translate"),r.Wb(),r.Xb(5,"mat-button-toggle",2),r.Ic(6),r.jc(7,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Gc(8,zd,14,15,"form",3),r.Gc(9,Hd,14,15,"section",4),r.Gc(10,Ud,4,3,"section",4),r.jc(11,"async"),r.Gc(12,sp,34,35,"form",5),r.jc(13,"async")),2&e&&(r.Db(1),r.oc("value",t.selectedMode),r.Db(1),r.oc("value","import"),r.Db(1),r.Kc(" ",r.kc(4,9,"igo.geo.importExportForm.importTabTitle")," "),r.Db(2),r.oc("value","export"),r.Db(1),r.Kc(" ",r.kc(7,11,"igo.geo.importExportForm.exportTabTitle")," "),r.Db(2),r.oc("ngIf","import"===t.selectedMode),r.Db(1),r.oc("ngIf","import"===t.selectedMode),r.Db(1),r.oc("ngIf",0===r.kc(11,13,t.exportableLayers$).length&&"export"===t.selectedMode),r.Db(2),r.oc("ngIf",r.kc(13,15,t.exportableLayers$).length>0&&"export"===t.selectedMode))},directives:[Ol.b,Ol.a,m.l,tt.x,tt.q,tt.r,it.c,et.b,tt.c,tt.p,tt.s,l.a,wr,tt.i,it.f,ot.a,ot.c,m.k,tt.h,dt.o,m.j,kl.a],pipes:[U.d,m.b,mr],styles:["mat-option.igo-export-layer-mat-option[_ngcontent-%COMP%]{height:5em;line-height:1em}.import-export-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.import-export-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.import-export-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}h4[_ngcontent-%COMP%]{padding:0 5px}.igo-form[_ngcontent-%COMP%]{padding:15px 5px}.igo-input-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.igo-form-button-group[_ngcontent-%COMP%]{padding-top:10px;text-align:center}igo-spinner[_ngcontent-%COMP%]{padding-left:10px;position:absolute}.export-options[_ngcontent-%COMP%]{overflow-x:hidden}.export-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:10px;width:100%}.export-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.export-select-trigger[_ngcontent-%COMP%]{font-size:.75em;opacity:.75}"]}),wy),Fy=new r.s("styleListOptions");function _y(e){return{provide:Fy,useValue:e}}function My(e,t){return function(){return e.load(t)}}var Dy,Py,Ay,jy,Ry,$y,Ey,Wy,Xy,Gy,By,Vy,Ny,zy=(($y=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[_y({}),{provide:r.d,useFactory:My,multi:!0,deps:[Ly,Fy]}]}}}]),e}()).\u0275mod=r.Pb({type:$y}),$y.\u0275inj=r.Ob({factory:function(e){return new(e||$y)},imports:[[]]}),$y),qy=((Ry=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}()).\u0275mod=r.Pb({type:Ry}),Ry.\u0275inj=r.Ob({factory:function(e){return new(e||Ry)},imports:[[u.b,g.b,tt.k,tt.u,m.c,l.b,Ol.c,Tl.c,ot.b,dt.p,it.e,et.c,kl.b,Ce,Or,br,Wn,zy.forRoot()],zy]}),Ry),Hy=((jy=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:jy}),jy.\u0275inj=r.Ob({factory:function(e){return new(e||jy)},imports:[[m.c,Ce,An,u.b,l.b,g.b]]}),jy),Uy=((Ay=function(){function e(){_classCallCheck(this,e),this.measure$=new L.a(void 0),this._auto=!1,this.measureUnitChange=new r.o}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.toggleAutoUnit(!1)}},{key:"onMeasureUnitChange",value:function(e){this.measureUnit=e,this.measureUnitChange.emit(e)}},{key:"toggleAutoUnit",value:function(e){var t=this;void 0!==this.measure$$&&this.measure$$.unsubscribe(),!0===e&&(this.measure$$=this.measure$.subscribe((function(e){t.computeBestMeasureUnit(e)}))),this._auto=e}},{key:"computeBestMeasureUnit",value:function(e){var t=this.measureUnit;this.measureType===$b.Area?t=function(e){for(var t=Xb.SquareMeters,i=e,o=[Xb.SquareKilometers];i>1e6&&o.length>0;)i=Zb(e,t=o.pop());return t}(e):this.measureType===$b.Length&&(t=function(e){for(var t=Eb.Meters,i=e,o=[Eb.Kilometers];i>1e3&&o.length>0;)i=Kb(e,t=o.pop());return t}(e)),t!==this.measureUnit&&this.onMeasureUnitChange(t)}},{key:"measure",set:function(e){this.measure$.next(e)},get:function(){return this.measure$.value}},{key:"auto",set:function(e){this.toggleAutoUnit(e)},get:function(){return this._auto}},{key:"measureUnits",get:function(){return Object.values(this.measureType===$b.Area?Xb:Eb)}}]),e}()).\u0275fac=function(e){return new(e||Ay)},Ay.\u0275cmp=r.Lb({type:Ay,selectors:[["igo-measurer-item"]],inputs:{measure:"measure",auto:"auto",measureUnit:"measureUnit",measureType:"measureType",placeholder:"placeholder"},outputs:{measureUnitChange:"measureUnitChange"},decls:7,vars:11,consts:[[1,"measure-field"],["matInput","",3,"readonly","placeholder","value"],[1,"unit-field"],[3,"value","disabled","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(r.Xb(0,"mat-form-field",0),r.Sb(1,"input",1),r.jc(2,"measureFormat"),r.jc(3,"async"),r.Wb(),r.Xb(4,"mat-form-field",2),r.Xb(5,"mat-select",3),r.ec("selectionChange",(function(e){return t.onMeasureUnitChange(e.value)})),r.Gc(6,cp,3,4,"mat-option",4),r.Wb(),r.Wb()),2&e&&(r.Db(1),r.oc("readonly",!0)("placeholder",t.placeholder)("value",r.lc(2,6,r.kc(3,9,t.measure$)||0,t.measureUnit)),r.Db(4),r.oc("value",t.measureUnit)("disabled",t.auto),r.Db(1),r.oc("ngForOf",t.measureUnits))},directives:[it.c,et.b,ot.a,m.k,dt.o],pipes:[$v,m.b,U.d],styles:["[_nghost-%COMP%]{padding:5px 10px}.measure-field[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;width:100%}.measure-field[_ngcontent-%COMP%]{flex-flow:column nowrap}.unit-field[_ngcontent-%COMP%]{margin-left:10px;width:110px}"],changeDetection:0}),Ay),Yy=((Py=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Py}),Py.\u0275inj=r.Ob({factory:function(e){return new(e||Py)},imports:[[m.c,l.b,Ol.c,u.b,g.b,it.e,et.c,ot.b,kl.b,Ce,ar]]}),Py),Ky=((Dy=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Dy}),Dy.\u0275inj=r.Ob({factory:function(e){return new(e||Dy)},imports:[[],Yy]}),Dy),Zy=function(e){return e[e.None=0]="None",e[e.Move=1]="Move",e[e.Zoom=2]="Zoom",e[e.ZoomIfOutMapExtent=3]="ZoomIfOutMapExtent",e}({}),Jy=((Xy=function(){function e(){_classCallCheck(this,e),this.features$=new L.a([[],void 0])}return _createClass(e,[{key:"setFeatures",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zy.None;this.features$.next([e,t])}},{key:"clear",value:function(){this.features$.next([[],Zy.None])}}]),e}()).\u0275fac=function(e){return new(e||Xy)},Xy.\u0275prov=Object(r.Nb)({factory:function(){return new Xy},token:Xy,providedIn:"root"}),Xy),Qy=((Wy=function(){function e(t,i){_classCallCheck(this,e),this.component=t,this.overlayService=i,this.format=new fl.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.features$$=this.overlayService.features$.subscribe((function(t){return e.handleFeatures(t[0],t[1])}))}},{key:"ngOnDestroy",value:function(){this.features$$.unsubscribe()}},{key:"handleFeatures",value:function(e,t){}},{key:"map",get:function(){return this.component.map}}]),e}()).\u0275fac=function(e){return new(e||Wy)(r.Rb(om,2),r.Rb(Jy))},Wy.\u0275dir=r.Mb({type:Wy,selectors:[["","igoOverlay",""]]}),Wy),ek=((Ey=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}()).\u0275mod=r.Pb({type:Ey}),Ey.\u0275inj=r.Ob({factory:function(e){return new(e||Ey)},imports:[[]]}),Ey),tk=W(["Pdf","Image"]),ik=W(["A0","A1","A2","A3","A4","A5","Letter","Legal"]),ok=W(["landscape","portrait"]),nk=W(["72","96","150","300"]),rk=W(["Bmp","Gif","Jpeg","Png","Tiff"]),ak=((Ny=function(){function e(t,i,o){_classCallCheck(this,e),this.messageService=t,this.activityService=i,this.languageService=o}return _createClass(e,[{key:"print",value:function(e,t){var i=this,o=new P.a,n=t.paperFormat,r=+t.resolution,a=t.orientation;this.activityId=this.activityService.register();var s=new Xl({orientation:a,format:n.toLowerCase()}),c=[s.internal.pageSize.width,s.internal.pageSize.height],l=[20,10,20,10],u=[c[0]-l[3]-l[1],c[1]-l[0]-l[2]];return void 0!==t.title&&this.addTitle(s,t.title,c[0]),!0!==t.showProjection&&!0!==t.showScale||this.addProjScale(s,e,r,t.showProjection,t.showScale),""!==t.comment&&this.addComment(s,t.comment),this.addMap(s,e,r,u,l).subscribe((function(n){n===q.Done&&(!0===t.showLegend?i.addLegend(s,e,l,r):i.saveDoc(s)),n!==q.Done&&n!==q.Error||(i.activityService.unregister(i.activityId),o.next(q.Done))})),o}},{key:"getLayersLegendHtml",value:function(e,t,i){var o="",n=function(e,t){var i=[],o=document.createElement("canvas").getContext("2d");o.font="20px Calibri";var n,r=0,a=_createForOfIteratorHelper(e);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(!1!==s.visible){var c,l=_createForOfIteratorHelper(s.dataSource.getLegend(void 0,t)||[]);try{var u=function(){var e=c.value;if(void 0===e.url)return"continue";var t=s.title,n=new Image;n.crossOrigin="anonymous",n.src=e.url,n.onload=function(){o.fillText(t,0,r),o.drawImage(n,0,r+20),r+=n.height+5},i.push({title:t,url:e.url,image:n})};for(l.s();!(c=l.n()).done;)u()}catch(h){l.e(h)}finally{l.f()}}}}catch(h){a.e(h)}finally{a.f()}return i}(e.layers,e.viewController.getScale(i));return 0===n.length||(o+='<style media="screen" type="text/css">',o+=".html2canvas-container { width: "+t,o+="mm !important; height: 2000px !important; }",o+="</style>",o+='<font size="2" face="Courier New" >',o+='<div style="display:inline-block;max-width:'+t+'mm">',n.forEach((function(e){o+='<table border=1 style="display:inline-block;vertical-align:top">',o+='<tr><th width="170px">'+e.title+"</th>",o+='<td><img class="printImageLegend" src="'+e.url+'">',o+="</td></tr></table>"})),o+="</div>"),o}},{key:"getLayersLegendImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png",i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,n=new P.a,r=this.getLayersLegendHtml(e,200,o),a=this;t=t.toLowerCase(),0===r.length&&(r='<font size="12" face="Courier New" >',r+='<div align="center"><b>NO LEGEND</b></div>');var s=window.document.createElement("div");window.document.body.appendChild(s),s.innerHTML=r,setTimeout((function(){Bl()(s,{useCORS:!0}).then((function(e){var o=q.Done;try{i?a.generateCanvaFileToZip(e,"legendImage."+t):a.saveCanvasImageAsFile(e,"legendImage",t),s.parentNode.removeChild(s)}catch(r){o=q.Error}n.next(o)})).catch((function(e){console.log(e)}))}),500)}},{key:"addTitle",value:function(e,t,i){var o,n=812.8/96*t.length;o=n>i?0:(i-n)/2,e.setFont("courier"),e.setFontSize(32),e.text(t,o,15)}},{key:"addComment",value:function(e,t){var i=e.internal.pageSize.height-5;e.setFont("courier"),e.setFontSize(16),e.text(t,20,i)}},{key:"addProjScale",value:function(e,t,i,o,n){var r=this.languageService.translate,a=e.internal.pageSize.height-15,s="";!0===o&&(s+=r.instant("igo.geo.printForm.projection")+": "+t.projection),!0===n&&(!0===o&&(s+="   "),s+=r.instant("igo.geo.printForm.scale")+": ~ 1 / "+gg(t.viewController.getScale(i))),e.setFont("courier"),e.setFontSize(16),e.text(s,20,a)}},{key:"addLegend",value:function(e,t,i,o){var n=this,r=this,a=this.getLayersLegendHtml(t,e.internal.pageSize.width,o);if(""===a)return this.saveDoc(e),!0;var s=window.document.createElement("div");Bl()(s,{useCORS:!0}).then((function(t){var o;o=t.toDataURL("image/png"),e.addPage();var a=n.getImageSizeToFitPdf(e,t,i);e.addImage(o,"PNG",10,10,a[0],a[1]),r.saveDoc(e),s.parentNode.removeChild(s)})).catch((function(e){console.log(e)})),window.document.body.appendChild(s),s.innerHTML=a}},{key:"addCanvas",value:function(e,t,i){var o;if(void 0!==(o=t.toDataURL("image/jpeg"))){var n=this.getImageSizeToFitPdf(e,t,i);e.addImage(o,"JPEG",i[3],i[0],n[0],n[1]),e.rect(i[3],i[0],n[0],n[1])}}},{key:"addMap",value:function(e,t,i,o,n){var r,a=this,s=new P.a,c=t.ol.getSize(),l=t.ol.getView().calculateExtent(c),u=Math.round(o[0]*i/25.4),h=Math.round(o[1]*i/25.4);return t.ol.once("rendercomplete",(function(i){var o=i.target.getViewport().getElementsByTagName("canvas")[0],u=t.status$.subscribe((function(i){if(clearTimeout(r),i===q.Done){u.unsubscribe();var h=q.Done;try{a.addCanvas(e,o,n)}catch(d){h=q.Error,a.messageService.error(a.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),a.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"),"print")}a.renderMap(t,c,l),s.next(h)}}));r=window.setTimeout((function(){u.unsubscribe();var i=q.Done;try{a.addCanvas(e,o,n)}catch(r){i=q.Error,a.messageService.error(a.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),a.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"),"print")}a.renderMap(t,c,l),s.next(i)}),200)})),this.renderMap(t,[u,h],l),s}},{key:"defineNbFileToProcess",value:function(e){this.nbFileToProcess=e}},{key:"downloadMapImage",value:function(e,t){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"png",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",c=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],l=new P.a;this.activityId=this.activityService.register();var u=this.languageService.translate;e.ol.once("rendercomplete",(function(h){o=o.toLowerCase();var d=h.target.getViewport().getElementsByTagName("canvas")[0],p=document.createElement("canvas"),g=p.getContext("2d"),f=0,m=10,b=d.width,v=d.height;g.font="20px Calibri";var y=g.measureText(s).width;v=""!==a?v+30:v;var k=(v=!1!==n||!1!==r?v+30:v)-10,S=Math.ceil(y/b),C=(v=""!==s?v+30*S:v)-20*S+5;if(p.width=b,p.height=v,"jpeg"===o&&(g.fillStyle="#ffffff",g.fillRect(0,0,b,v),g.fillStyle="#000000"),""!==a&&(g.font="26px Calibri",f=30,g.textAlign="center",g.fillText(a,b/2,20)),g.font="20px Calibri",!1!==n){var w=u.instant("igo.geo.printForm.projection");g.textAlign="start",g.fillText(w+": "+e.projection,m,k),m+=200}if(!1!==r){var x=u.instant("igo.geo.printForm.scale"),O=e.viewController.getScale(t);g.textAlign="start",g.fillText(x+": ~ 1 / "+gg(O),m,k)}if(""!==s)if(g.textAlign="center",1===S)g.fillText(s,b/2,C);else for(var I,L=Math.floor(s.length/S),T="",F=0,_=0;_<S;_++)S-1>_?(I=(T=s.substr(F,L)).lastIndexOf(" "),g.fillText(T.substr(0,I),b/2,C),F+=I,C+=20):g.fillText(s.substr(F),b/2,C);g.drawImage(d,0,f);var M=q.Done;try{c?"tiff"===o.toLowerCase()?i.generateCanvaFileToZip(p,"map"+e.projection.replace(":","_")+"."+o):i.generateCanvaFileToZip(p,"map."+o):i.saveCanvasImageAsFile(p,"map",o)}catch(A){M=q.Error}if(l.next(M),"tiff"===o.toLowerCase()){var D=i.getWorldFileInformation(e),P=new Blob([D],{type:"text/plain;charset=utf-8"});c?i.addFileToZip("map"+e.projection.replace(":","_")+".tfw",P):(Object(Wl.saveAs)(P,"map"+e.projection+".tfw"),i.saveFileProcessing())}})),e.ol.renderSync()}},{key:"renderMap",value:function(e,t,i){e.ol.renderSync()}},{key:"saveDoc",value:function(e){e.save("map.pdf")}},{key:"getImageSizeToFitPdf",value:function(e,t,i){var o=e.internal.pageSize.getHeight()-(i[0]+i[2]),n=e.internal.pageSize.getWidth()-(i[1]+i[3]),r=t.height,a=t.width,s=r/o,c=a/n,l=s>c?s:c;return[l>1?a/l:a,l>1?r/l:r]}},{key:"getWorldFileInformation",value:function(e){var t=e.viewController.getResolution(),i=e.viewController.getExtent();return[t,0,0,-t,i[0]+t/.5,i[3]-t/.5].join("\n")}},{key:"saveCanvasImageAsFile",value:function(e,t,i){var o="image/"+i,n=this;try{e.toDataURL(),navigator.msSaveBlob?(navigator.msSaveBlob(e.msToBlob(),t+"."+i),this.saveFileProcessing()):e.toBlob((function(e){Object(Wl.saveAs)(e,t+"."+i),n.saveFileProcessing()}),o)}catch(r){this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"),"print")}}},{key:"generateCanvaFileToZip",value:function(e,t){var i=this;this.hasOwnProperty("zipFile")&&void 0!==this.zipFile||(this.zipFile=new Vl);try{e.toDataURL(),navigator.msSaveBlob?this.addFileToZip(t,e.msToBlob()):e.toBlob((function(e){i.addFileToZip(t,e)}),"image/jpeg")}catch(o){this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"),"print")}}},{key:"addFileToZip",value:function(e,t){this.zipFile.file(e,t),this.nbFileToProcess--,0===this.nbFileToProcess&&(this.getZipFile(),this.activityService.unregister(this.activityId))}},{key:"saveFileProcessing",value:function(){this.nbFileToProcess--,0===this.nbFileToProcess&&this.activityService.unregister(this.activityId)}},{key:"getZipFile",value:function(){var e=this;this.zipFile.generateAsync({type:"blob"}).then((function(t){Object(Wl.saveAs)(t,"map.zip"),delete e.zipFile}))}}]),e}()).\u0275fac=function(e){return new(e||Ny)(r.bc(Ie),r.bc(J),r.bc(Le))},Ny.\u0275prov=Object(r.Nb)({factory:function(){return new Ny(Object(r.bc)(Ie),Object(r.bc)(J),Object(r.bc)(Le))},token:Ny,providedIn:"root"}),Ny),sk=((Vy=function(){function e(t){_classCallCheck(this,e),this.printService=t,this.disabled=!1}return _createClass(e,[{key:"handleFormSubmit",value:function(e){if(this.disabled=!0,!0===e.isPrintService)this.printService.print(this.map,e).subscribe();else{var t=1;e.showLegend&&t++,"tiff"===e.imageFormat.toLowerCase()&&t++,this.printService.defineNbFileToProcess(t);var i=+e.resolution;this.printService.downloadMapImage(this.map,i,e.imageFormat,e.showProjection,e.showScale,e.showLegend,e.title,e.comment,e.doZipFile),e.showLegend&&this.printService.getLayersLegendImage(this.map,e.imageFormat,e.doZipFile,+i)}this.disabled=!1}},{key:"map",get:function(){return this._map},set:function(e){this._map=e}},{key:"outputFormat",get:function(){return this._outputFormat},set:function(e){this._outputFormat=e}},{key:"paperFormat",get:function(){return this._paperFormat},set:function(e){this._paperFormat=e}},{key:"orientation",get:function(){return this._orientation},set:function(e){this._orientation=e}},{key:"imageFormat",get:function(){return this._imageFormat},set:function(e){this._imageFormat=e}},{key:"resolution",get:function(){return this._resolution},set:function(e){this._resolution=e}}]),e}()).\u0275fac=function(e){return new(e||Vy)(r.Rb(ak))},Vy.\u0275cmp=r.Lb({type:Vy,selectors:[["igo-print"]],inputs:{map:"map",outputFormat:"outputFormat",paperFormat:"paperFormat",orientation:"orientation",imageFormat:"imageFormat",resolution:"resolution"},decls:1,vars:6,consts:[[3,"outputFormat","paperFormat","orientation","imageFormat","resolution","disabled","submit"]],template:function(e,t){1&e&&(r.Xb(0,"igo-print-form",0),r.ec("submit",(function(e){return t.handleFormSubmit(e)})),r.Wb()),2&e&&r.oc("outputFormat",t.outputFormat)("paperFormat",t.paperFormat)("orientation",t.orientation)("imageFormat",t.imageFormat)("resolution",t.resolution)("disabled",t.disabled)},directives:function(){return[ck]},encapsulation:2}),Vy),ck=((By=function(){function e(t){_classCallCheck(this,e),this.formBuilder=t,this.outputFormats=tk,this.paperFormats=ik,this.orientations=ok,this.resolutions=nk,this.imageFormats=rk,this.isPrintService=!0,this._disabled=!1,this.submit=new r.o,this.form=this.formBuilder.group({title:["",[]],comment:["",[]],outputFormat:["",[tt.w.required]],paperFormat:["",[tt.w.required]],imageFormat:["",[tt.w.required]],resolution:["",[tt.w.required]],orientation:["",[tt.w.required]],showProjection:!1,showScale:!1,showLegend:!1,doZipFile:[{hidden:this.isPrintService}]})}return _createClass(e,[{key:"ngOnInit",value:function(){this.doZipFileField.setValue(!1)}},{key:"handleFormSubmit",value:function(e,t){this.submitted=!0,e.isPrintService=this.isPrintService,t&&this.submit.emit(e)}},{key:"toggleImageSaveProp",value:function(){this.isPrintService="Image"!==this.outputFormatField.value}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e}},{key:"imageFormat",get:function(){return this.imageFormatField.value},set:function(e){this.imageFormatField.setValue(e||rk.Jpeg,{onlySelf:!0})}},{key:"outputFormat",get:function(){return this.outputFormatField.value},set:function(e){this.outputFormatField.setValue(e||tk.Pdf,{onlySelf:!0})}},{key:"paperFormat",get:function(){return this.paperFormatField.value},set:function(e){this.paperFormatField.setValue(e||ik.Letter,{onlySelf:!0})}},{key:"orientation",get:function(){return this.orientationField.value},set:function(e){this.orientationField.setValue(e||ok.landscape,{onlySelf:!0})}},{key:"resolution",get:function(){return this.resolutionField.value},set:function(e){this.resolutionField.setValue(e||nk[96],{onlySelf:!0})}},{key:"title",get:function(){return this.titleField.value},set:function(e){this.titleField.setValue(e,{onlySelf:!0})}},{key:"comment",get:function(){return this.commentField.value},set:function(e){this.commentField.setValue(e,{onlySelf:!0})}},{key:"showProjection",get:function(){return this.showProjectionField.value},set:function(e){this.showProjectionField.setValue(e,{onlySelf:!0})}},{key:"showScale",get:function(){return this.showScaleField.value},set:function(e){this.showScaleField.setValue(e,{onlySelf:!0})}},{key:"showLegend",get:function(){return this.showLegendField.value},set:function(e){this.showLegendField.setValue(e,{onlySelf:!0})}},{key:"doZipFile",get:function(){return this.doZipFileField.value},set:function(e){this.doZipFileField.setValue(e,{onlySelf:!0})}},{key:"outputFormatField",get:function(){return this.form.controls.outputFormat}},{key:"paperFormatField",get:function(){return this.form.controls.paperFormat}},{key:"imageFormatField",get:function(){return this.form.controls.imageFormat}},{key:"orientationField",get:function(){return this.form.controls.orientation}},{key:"resolutionField",get:function(){return this.form.controls.resolution}},{key:"commentField",get:function(){return this.form.controls.comment}},{key:"showProjectionField",get:function(){return this.form.controls.showProjection}},{key:"showScaleField",get:function(){return this.form.controls.showScale}},{key:"showLegendField",get:function(){return this.form.controls.showLegend}},{key:"doZipFileField",get:function(){return this.form.controls.doZipFile}},{key:"titleField",get:function(){return this.form.controls.title}}]),e}()).\u0275fac=function(e){return new(e||By)(r.Rb(tt.e))},By.\u0275cmp=r.Lb({type:By,selectors:[["igo-print-form"]],inputs:{disabled:"disabled",imageFormat:"imageFormat",outputFormat:"outputFormat",paperFormat:"paperFormat",orientation:"orientation",resolution:"resolution",title:"title",comment:"comment",showProjection:"showProjection",showScale:"showScale",showLegend:"showLegend",doZipFile:"doZipFile"},outputs:{submit:"submit"},decls:57,vars:65,consts:[[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],["matInput","","formControlName","title",3,"placeholder"],["matInput","","formControlName","comment",3,"placeholder"],[1,"print-slide-toggle-container","mat-typography"],["formControlName","showProjection",1,"print-option",3,"labelPosition"],["formControlName","showScale",1,"print-option",3,"labelPosition"],["formControlName","showLegend",1,"print-option",3,"labelPosition"],["formControlName","doZipFile",1,"print-option",3,"labelPosition"],["formControlName","outputFormat",3,"placeholder","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","paperFormat",3,"placeholder"],["formControlName","imageFormat",3,"placeholder"],[1,"igo-input-container",2,"display","none"],["formControlName","resolution",3,"placeholder"],["formControlName","orientation",3,"placeholder"],[1,"igo-form-button-group","print-button-top-padding"],["mat-raised-button","","type","button",3,"disabled","click"],[3,"value"]],template:function(e,t){1&e&&(r.Xb(0,"form",0),r.Xb(1,"div",1),r.Xb(2,"mat-form-field"),r.Sb(3,"input",2),r.jc(4,"translate"),r.Wb(),r.Wb(),r.Xb(5,"div",1),r.Xb(6,"mat-form-field"),r.Sb(7,"input",3),r.jc(8,"translate"),r.Wb(),r.Wb(),r.Xb(9,"div",1),r.Xb(10,"div",4),r.Xb(11,"mat-slide-toggle",5),r.Ic(12),r.jc(13,"translate"),r.Wb(),r.Xb(14,"mat-slide-toggle",6),r.Ic(15),r.jc(16,"translate"),r.Wb(),r.Xb(17,"mat-slide-toggle",7),r.Ic(18),r.jc(19,"translate"),r.Wb(),r.Xb(20,"mat-slide-toggle",8),r.Ic(21),r.jc(22,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Xb(23,"div",1),r.Xb(24,"mat-form-field"),r.Xb(25,"mat-select",9),r.ec("selectionChange",(function(){return t.toggleImageSaveProp()})),r.jc(26,"translate"),r.Gc(27,lp,2,2,"mat-option",10),r.jc(28,"keyvalue"),r.Wb(),r.Wb(),r.Wb(),r.Xb(29,"div",1),r.Xb(30,"mat-form-field"),r.Xb(31,"mat-select",11),r.jc(32,"translate"),r.Gc(33,up,3,4,"mat-option",10),r.jc(34,"keyvalue"),r.Wb(),r.Wb(),r.Wb(),r.Xb(35,"div",1),r.Xb(36,"mat-form-field"),r.Xb(37,"mat-select",12),r.jc(38,"translate"),r.Gc(39,hp,2,2,"mat-option",10),r.jc(40,"keyvalue"),r.Wb(),r.Wb(),r.Wb(),r.Xb(41,"div",13),r.Xb(42,"mat-form-field"),r.Xb(43,"mat-select",14),r.jc(44,"translate"),r.Gc(45,dp,2,2,"mat-option",10),r.jc(46,"keyvalue"),r.Wb(),r.Wb(),r.Wb(),r.Xb(47,"div",1),r.Xb(48,"mat-form-field"),r.Xb(49,"mat-select",15),r.jc(50,"translate"),r.Gc(51,pp,3,4,"mat-option",10),r.jc(52,"keyvalue"),r.Wb(),r.Wb(),r.Wb(),r.Xb(53,"div",16),r.Xb(54,"button",17),r.ec("click",(function(){return t.handleFormSubmit(t.form.value,t.form.valid)})),r.Ic(55),r.jc(56,"translate"),r.Wb(),r.Wb(),r.Wb()),2&e&&(r.oc("formGroup",t.form),r.Db(3),r.pc("placeholder",r.kc(4,31,"igo.geo.printForm.title")),r.Db(4),r.pc("placeholder",r.kc(8,33,"igo.geo.printForm.comment")),r.Db(4),r.oc("labelPosition","before"),r.Db(1),r.Kc(" ",r.kc(13,35,"igo.geo.printForm.showProjection")," "),r.Db(2),r.oc("labelPosition","before"),r.Db(1),r.Kc(" ",r.kc(16,37,"igo.geo.printForm.showScale")," "),r.Db(2),r.oc("labelPosition","before"),r.Db(1),r.Kc(" ",r.kc(19,39,"igo.geo.printForm.showLegend")," "),r.Db(2),r.Fc("display",t.isPrintService?"none":""),r.oc("labelPosition","before"),r.Db(1),r.Kc(" ",r.kc(22,41,"igo.geo.printForm.doZipFile")," "),r.Db(4),r.pc("placeholder",r.kc(26,43,"igo.geo.printForm.outputFormat")),r.Db(2),r.oc("ngForOf",r.kc(28,45,t.outputFormats)),r.Db(2),r.Fc("display",t.isPrintService?"block":"none"),r.Db(2),r.pc("placeholder",r.kc(32,47,"igo.geo.printForm.paperFormat")),r.Db(2),r.oc("ngForOf",r.kc(34,49,t.paperFormats)),r.Db(2),r.Fc("display",t.isPrintService?"none":"block"),r.Db(2),r.pc("placeholder",r.kc(38,51,"igo.geo.printForm.imageFormat")),r.Db(2),r.oc("ngForOf",r.kc(40,53,t.imageFormats)),r.Db(4),r.pc("placeholder",r.kc(44,55,"igo.geo.printForm.resolution")),r.Db(2),r.oc("ngForOf",r.kc(46,57,t.resolutions)),r.Db(2),r.Fc("display",t.isPrintService?"block":"none"),r.Db(2),r.pc("placeholder",r.kc(50,59,"igo.geo.printForm.orientation")),r.Db(2),r.oc("ngForOf",r.kc(52,61,t.orientations)),r.Db(3),r.oc("disabled",!t.form.valid||t.disabled),r.Db(1),r.Kc(" ",r.kc(56,63,"igo.geo.printForm.saveBtn")," "))},directives:[tt.x,tt.q,tt.i,it.c,et.b,tt.c,tt.p,tt.h,kl.a,ot.a,m.k,l.a,dt.o],pipes:[U.d,mr],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.print-slide-toggle-container[_ngcontent-%COMP%]{overflow-x:hidden}.print-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:10px;width:100%}.print-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.print-option[_ngcontent-%COMP%]{display:block;margin-bottom:15px;margin-right:10px}.print-button-top-padding[_ngcontent-%COMP%]{padding-top:25px}.igo-form[_ngcontent-%COMP%]{padding:10px 5px 5px}.igo-form-button-group[_ngcontent-%COMP%]{text-align:center}"]}),By),lk=((Gy=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Gy}),Gy.\u0275inj=r.Ob({factory:function(e){return new(e||Gy)},imports:[[m.c,tt.k,tt.u,u.b,l.b,ot.b,dt.p,et.c,it.e,kl.b,Ce,br]]}),Gy);function uk(e){return new eb(e.getConfig("searchSources."+eb.id)||{})}var hk,dk=((hk=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:Qm,useFactory:uk,multi:!0,deps:[ie]}]}}}]),e}()).\u0275mod=r.Pb({type:hk}),hk.\u0275inj=r.Ob({factory:function(e){return new(e||hk)},providers:[bm],imports:[[m.c]]}),hk),pk=function(){function e(t){_classCallCheck(this,e),this.sources=t}return _createClass(e,[{key:"getSources",value:function(){return this.sources}},{key:"getEnabledSources",value:function(){return this.getSources().filter((function(e){return!0===e.enabled}))}},{key:"enableSourcesByType",value:function(e){this.getSources().forEach((function(t){t.enabled=t.constructor.type===e}))}},{key:"setParamFromSetting",value:function(e,t){e.setParamFromSetting(t)}}]),e}();function gk(e){return void 0!==e.search}function fk(e){return void 0!==e.reverseSearch}function mk(e){return void 0!==e.reverseSearch&&!0===e.showInPointerSummary}var bk,vk=((bk=function(){function e(t,i){_classCallCheck(this,e),this.searchSourceService=t,this.mapService=i}return _createClass(e,[{key:"search",value:function(e){var t,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.termIsValid(e))return[];var n,r=function(e,t){var i,o,n,r,a,s,c,l,u,h,d,p,g,f,m,b,v,y,k,S,C,w,x,O,I,L,T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},F=new RegExp("(\\s*;\\s*[\\d]{4,6})","g"),_="([-+])?([\\d]{1,3})([,.](\\d+))?[\\s,]+([-+])?([\\d]{1,3})([,.](\\d+))?",M=new RegExp("^".concat(_,"$"),"g"),D="([0-9]{1,2})[:|\xb0]?\\s*([0-9]{1,2})?[:|'|\u2032|\u2019]?\\s*([0-9]{1,2}(?:.[0-9]+){0,1})?\\s*[\"|\u2033|\u201d]?\\s*",P="".concat(D,"([N|S|E|W|O]),?\\s*").concat(D,"([N|S|E|W|O])"),A=new RegExp("^"+P,"gi"),j="(UTM)-?(\\d{1,2})[\\s,]*(\\d+[.,]?\\d+)[\\s,]+(\\d+[.,]?\\d+)",R=new RegExp("^"+j,"gi"),$="(MTM)-?(\\d{1,2})[\\s,]*(\\d+[.,]?\\d+)[\\s,]+(\\d+[.,]?\\d+)",E=new RegExp("^"+$,"gi"),W="([-+])?(\\d{1,3})[,.](\\d+)",X="".concat(W,"\\s*[,]?\\s*").concat(W),G=new RegExp("^"+X,"g"),B="([-+])?(\\d{1,3})[\\s,.]{1}(\\d{1,2})[\\s,.]{1}(\\d{1,2})[.,]?(\\d{1,5})?",V="".concat(B,"\\s*[,.]?\\s*").concat(B),N=new RegExp("^"+V,"g"),z="LAT\\s*[\\s:]*\\s*([-+])?(\\d{1,2})[\\s.,]?(\\d+)?[\\s.,]?\\s*(\\d{1,2}([.,]\\d+)?)?\\s*(N|S|E|W)?\\s*LONG\\s*[\\s:]*\\s*([-+])?(\\d{1,3})[\\s.,]?(\\d+)?[\\s.,]?\\s*(\\d{1,2}([.,]\\d+)?)?\\s*(N|S|E|W)?\\s*UNC\\s*[\\s:]?\\s*(\\d+)\\s*CONF\\s*[\\s:]?\\s*(\\d{1,3})",q=new RegExp("^".concat(z,"?"),"gi"),H="([-+]?\\d+)[,.]?(\\d+)?[\\s,]+([-+]?\\d+)[,.]?(\\d+)?",U=new RegExp("^".concat(H,"$"),"g"),Y=!1;if(e=e.toLocaleUpperCase().trim(),F.test(e)?(l=(i=_slicedToArray(e.split(";").map((function(e){return e.trim()})),2))[0],L=i[1]):l=e,M.test(l))u=(o=_slicedToArray(l.match(_),9))[1],O=o[2],f=o[4],m=o[5],I=o[6],S=o[8],O=parseFloat((u||"")+O+"."+f),I=parseFloat((m||"")+I+"."+S);else if(A.test(l))h=(n=_slicedToArray(l.match(P),9))[1],d=n[2],p=n[3],g=n[4],b=n[5],v=n[6],y=n[7],k=n[8],"S"!==g&&"N"!==g||(h=[b,b=h][0],d=[v,v=d][0],p=[y,y=p][0],g=[k,k=g][0]),O=pg(parseFloat(h),parseFloat(d),parseFloat(p),g),I=pg(parseFloat(b),parseFloat(v),parseFloat(y),k);else if(R.test(l)){var K;Y=!0,C=(K=_slicedToArray(l.match(j),5))[2],O=K[3],I=K[4];var Z=Number(C)<10?"EPSG:3260"+C:"EPSG:326"+C,J=Object(kc.r)([parseFloat(O),parseFloat(I)],Z,"EPSG:4326"),Q=_slicedToArray(J,2);O=Q[0],I=Q[1]}else if(E.test(l)){var ee;Y=!0,C=(ee=_slicedToArray(l.match($),5))[2],O=ee[3],I=ee[4];var te=Number(C)<10?"EPSG:3218"+C:"EPSG:321"+(80+Number(C)),ie=Object(kc.r)([parseFloat(O),parseFloat(I)],te,"EPSG:4326"),oe=_slicedToArray(ie,2);O=oe[0],I=oe[1]}else if(N.test(l))u=(r=_slicedToArray(l.match(V),11))[1],h=r[2],d=r[3],p=r[4],f=r[5],m=r[6],b=r[7],v=r[8],y=r[9],S=r[10],O=pg(parseFloat((u||"")+h),parseFloat(d),parseFloat(p),g),I=pg(parseFloat((m||"")+b),parseFloat(v),parseFloat(y),k);else if(G.test(l))u=(a=_slicedToArray(l.match(X),7))[1],h=a[2],f=a[3],m=a[4],b=a[5],S=a[6],O=pg(parseFloat((u||"")+h),parseFloat(d),parseFloat(p),g),I=pg(parseFloat((m||"")+b),parseFloat(v),parseFloat(y),k);else if(q.test(l))m=(s=_slicedToArray(l.match(z),15))[1],b=s[2],v=s[3],y=s[4],k=s[6],u=s[7],h=s[8],d=s[9],p=s[10],g=s[12],w=s[13],x=s[14],g||(g="W"),O=d&&d.length>2?parseFloat((u||"")+h+"."+d):pg(parseFloat(h),parseFloat(d),parseFloat(p),g),I=v&&v.length>2?parseFloat((m||"")+b+"."+v):pg(parseFloat(b),parseFloat(v),parseFloat(y),k);else{var ne;if(!U.test(l))return{lonLat:void 0,message:"",radius:void 0,conf:void 0};Y=!0,O=(ne=_slicedToArray(l.match(H),5))[1],f=ne[2],I=ne[3],S=ne[4],f&&(O=parseFloat(O+"."+f)),S&&(I=parseFloat(I+"."+S))}if(T.forceNA&&!Y&&(O>0&&I>0&&(O>I?O=-O:I=-I),O>I&&(O=[I,I=O][0])),c=[Number(O),Number(I)],void 0!==L&&"4326"!==L||c[0]>180||c[0]<-180||c[1]>90||c[1]<-90){var re=L?"EPSG:"+L:t,ae="EPSG:4326";try{c=Object(kc.r)(c,re,ae)}catch(se){return{lonLat:void 0,message:"Projection "+re+" not supported",radius:void 0,conf:void 0}}}return{lonLat:c,message:"",radius:w?parseInt(w,10):void 0,conf:x?parseInt(x,10):void 0}}(e,(null===(t=this.mapService.getMap())||void 0===t?void 0:t.projection)||"EPSG:3857",{forceNA:o.forceNA});return r.lonLat?this.reverseSearch(r.lonLat,{distance:r.radius}):(r.message&&console.log(r.message),o.extent=null===(i=this.mapService.getMap())||void 0===i?void 0:i.viewController.getExtent("EPSG:4326"),n=o.getEnabledOnly||void 0===o.getEnabledOnly?this.searchSourceService.getEnabledSources():this.searchSourceService.getSources(),o.sourceId?n=n.filter((function(e){return e.getId()===o.sourceId})):o.searchType&&(n=n.filter((function(e){return e.getType()===o.searchType}))),n=n.filter(gk),this.searchSources(n,e,o))}},{key:"reverseSearch",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=i?mk:fk,n=this.searchSourceService.getEnabledSources().filter(o);return this.reverseSearchSources(n,e,t||{})}},{key:"searchSources",value:function(e,t,i){return e.map((function(e){return{request:e.search(t,i),reverse:!1,source:e}}))}},{key:"reverseSearchSources",value:function(e,t,i){return e.map((function(e){return{request:e.reverseSearch(t,i),reverse:!0,source:e}}))}},{key:"termIsValid",value:function(e){return"string"==typeof e&&""!==e}}]),e}()).\u0275fac=function(e){return new(e||bk)(r.bc(pk),r.bc(im))},bk.\u0275prov=Object(r.Nb)({factory:function(){return new bk(Object(r.bc)(pk),Object(r.bc)(im))},token:bk,providedIn:"root"}),bk),yk=function e(){_classCallCheck(this,e)},kk=function e(t){_classCallCheck(this,e),this.sources=t};function Sk(e){return new kk(e)}var Ck,wk,xk,Ok=((xk=function(){function e(t){_classCallCheck(this,e),this.directionsSourceService=t}return _createClass(e,[{key:"route",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0!==e.length)return this.directionsSourceService.sources.filter((function(e){return e.enabled})).map((function(o){return t.routeSource(o,e,i)}))}},{key:"routeSource",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.route(t,i)}}]),e}()).\u0275fac=function(e){return new(e||xk)(r.bc(kk))},xk.\u0275prov=Object(r.Nb)({factory:function(){return new xk(Object(r.bc)(kk))},token:xk,providedIn:"root"}),xk),Ik=((wk=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getStopsCoordinates",value:function(){var e=[];return this.stops&&this.stops.forEach((function(t){e.push(t.stopCoordinates)})),e}},{key:"setStops",value:function(e){this.stops=e}},{key:"getStops",value:function(){return this.stops}}]),e}()).\u0275fac=function(e){return new(e||wk)},wk.\u0275prov=r.Nb({token:wk,factory:wk.\u0275fac}),wk),Lk=((Ck=function(){function e(t,i,o,n,a,s,c,l,u){_classCallCheck(this,e),this.formBuilder=t,this.directionsService=i,this.languageService=o,this.messageService=n,this.searchService=a,this.queryService=s,this.directionsFormService=c,this.changeDetectorRefs=l,this.route=u,this.invalidKeys=["Control","Shift","Alt"],this.projection="EPSG:4326",this.routesQueries$$=[],this.stream$=new P.a,this.activeRoute$=new L.a(void 0),this.focusOnStop=!1,this.focusKey=[],this.debounce=200,this.length=2,this.stopsStore$=new L.a(void 0),this.submit=new r.o}return _createClass(e,[{key:"changeRoute",value:function(){this.showRouteGeometry(!0)}},{key:"prevent",value:function(e){e.preventDefault()}},{key:"ngOnInit",value:function(){var e=this;this.queryService.queryEnabled=!1,this.focusOnStop=!1,this.browserLanguage=this.languageService.getLanguage(),this.stopsForm=this.formBuilder.group({directionsType:"car",directionsMode:"driving",stopOrderPriority:!0,directionsFixedStartEnd:!1,stops:this.formBuilder.array([this.createStop("start"),this.createStop("end")])}),setTimeout((function(){e.initStores(),e.initOlInteraction()}),1),this.subscribeToFormChange(),this.routesQueries$$.push(this.stream$.pipe(Object(O.a)(this.debounce),Object(A.a)()).subscribe((function(t){return e.handleTermChanged(t)}))),this.stopsStore$.subscribe((function(){!0===e.routeFromFeatureDetail&&(e.directionsFormService.setStops([]),setTimeout((function(){e.resetForm(!1);var t,i=_createForOfIteratorHelper(e.stopsStore.all());try{for(i.s();!(t=i.n()).done;){var o=t.value;o.properties.id&&o.properties.id.toString().startsWith("directionsStop")&&e.stopsStore.delete(o)}}catch(u){i.e(u)}finally{i.f()}if(2===e.stopsStore.all().length){var n,r=0,a=[],s=_createForOfIteratorHelper(e.stopsStore.all());try{for(s.s();!(n=s.n()).done;){var c=n.value;a.push(c.geometry.coordinates),e.handleLocationProposals(c.geometry.coordinates,r),e.chooseProposal(c,r),r++}}catch(u){s.e(u)}finally{s.f()}e.writeStopsToFormService(a);var l=e.directionsService.route(a,{});l&&l.map((function(t){return e.routesQueries$$.push(t.subscribe((function(t){e.routesResults=t,e.activeRoute=e.routesResults[0],e.showRouteGeometry(!0),e.changeDetectorRefs.detectChanges()})))}))}else 1===e.stopsStore.all().length&&(e.handleLocationProposals(e.stopsStore.all()[0].geometry.coordinates,1),e.chooseProposal(e.stopsStore.all()[0],1),e.writeStopsToFormService(e.stopsStore.all()[0].geometry.coordinates))}),1),e.routeFromFeatureDetail=!1)}))}},{key:"ngOnDestroy",value:function(){this.unsubscribeRoutesQueries(),this.unlistenSingleClick(),this.queryService.queryEnabled=!0,this.freezeStores(),this.writeStopsToFormService()}},{key:"initStores",value:function(){var e=new Wf({motion:Mf.None}),t=this.stopsStore;Rf(t,new wf({title:"Directions - stops",zIndex:911,source:new Pg,showInLayerList:!1,exportable:!1,browsable:!1,style:Tk})),Vf(t,e);var i=this.routeStore;Rf(i,new wf({title:"Directions - route and vertex",zIndex:910,source:new Pg,showInLayerList:!1,exportable:!1,browsable:!1,style:Tk})),Vf(i,e)}},{key:"initOlInteraction",value:function(){var e,t=this,i=new ll.a({layers:[this.stopsStore.layer.ol],condition:Nl.j,hitTolerance:7,filter:function(e){return"stop"===e.get("type")}});i.on("select",(function(t){e=t.target.getFeatures()[0]}));var o=new ll.b({layers:[this.stopsStore.layer.ol],features:e});o.on("translating",(function(e){var i=e.features;0!==i.getLength()&&t.executeTranslation(i,!1,50,!0)})),o.on("translateend",(function(e){var i=e.features;0!==i.getLength()&&t.executeTranslation(i,!0,0,!1)}));var n=new ll.a({layers:[this.routeStore.layer.ol],condition:Nl.d,hitTolerance:7,filter:function(e){return"route"===e.getId()}});n.on("select",(function(e){if(!1===t.focusOnStop){var i=Object(kc.r)(e.mapBrowserEvent.coordinate,t.map.projection,t.projection);t.addStop();var o=t.stops.length-2;t.stops.at(o).patchValue({stopCoordinates:i}),t.handleLocationProposals(i,o),t.addStopOverlay(i,o),n.getFeatures().clear()}n.getFeatures().clear()})),this.map.ol.addInteraction(i),this.map.ol.addInteraction(o),this.map.ol.addInteraction(n)}},{key:"subscribeToFormChange",value:function(){var e=this;this.routesQueries$$.push(this.stopsForm.valueChanges.pipe(Object(O.a)(this.debounce)).subscribe((function(t){e.writeStopsToFormService()})))}},{key:"freezeStores",value:function(){var e=this.stopsStore,t=this.routeStore;this.map.removeLayer(e.layer),this.map.removeLayer(t.layer),e.deactivateStrategyOfType(Wf),t.deactivateStrategyOfType(Wf)}},{key:"executeTranslation",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.routeStore.clear();var r,a=e.getArray()[0],s=a.getId().split("_");switch(s[1]){case"start":r=0;break;case"end":r=this.stops.length-1;break;default:r=Number(s[1])}var c=Object(kc.r)(a.getGeometry().getCoordinates(),this.map.projection,this.projection);this.stops.at(r).patchValue({stopCoordinates:c,stopProposals:[]}),i&&this.handleLocationProposals(c,r);var l={steps:!0,overview:!1,alternatives:!0};n&&(l.overview=!0,l.steps=!1,l.alternatives=!1),o>0?(void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),this.lastTimeoutRequest=setTimeout((function(){t.getRoutes(void 0,l)}),o)):(clearTimeout(this.lastTimeoutRequest),this.getRoutes(void 0,l))}},{key:"handleLocationProposals",value:function(e,t){var i=this,o=[],n=[e[0].toFixed(5),e[1].toFixed(5)];this.stops.at(t).patchValue({stopPoint:n.join(",")}),this.searchService.reverseSearch(e,{zoom:this.map.viewController.getZoom()}).map((function(e){return i.routesQueries$$.push(e.request.pipe(Object(w.a)((function(e){return e}))).subscribe((function(e){if(e.forEach((function(t){0===o.filter((function(e){return e.source===t.source})).length&&o.push({source:t.source,results:e.map((function(e){return e.data}))})})),i.stops.at(t).patchValue({stopProposals:o}),e[0])if("icherchereverse"===e[0].source.getId()){for(var r=0,a=0;a<e.length;a++)if("adresses"===e[a].data.properties.type){r=a;break}i.stops.at(t).patchValue({stopPoint:Zi(e[r])}),"Point"===e[r].data.geometry.type&&i.stops.at(t).patchValue({stopCoordinates:e[r].data.geometry.coordinates})}else"coordinatesreverse"===e[0].source.getId()&&(i.stops.at(t).patchValue({stopPoint:[e[0].data.geometry.coordinates[0].toFixed(5),e[0].data.geometry.coordinates[1].toFixed(5)].join(",")}),"Point"===e[0].data.geometry.type&&i.stops.at(t).patchValue({stopCoordinates:e[0].data.geometry.coordinates}));else i.stops.at(t).patchValue({stopPoint:n.join(","),stopProposals:[]});i.changeDetectorRefs.detectChanges()})))}))}},{key:"directionsText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.stops.length;return 0===e?"start":e===t-1||1===t?"end":"intermediate"}},{key:"raiseStop",value:function(e){e>0&&this.moveStop(e,-1)}},{key:"lowerStop",value:function(e){e<this.stops.length-1&&this.moveStop(e,1)}},{key:"moveStop",value:function(e,t){var i=this.stops.at(e);this.removeStop(e),this.stops.insert(e+t,i),this.stops.at(e).patchValue({directionsText:this.directionsText(e)}),this.stops.at(e+t).patchValue({directionsText:this.directionsText(e+t)}),this.stops.at(e).value.stopCoordinates&&this.addStopOverlay(this.stops.at(e).value.stopCoordinates,e),this.stops.at(e+t).value.stopCoordinates&&this.addStopOverlay(this.stops.at(e+t).value.stopCoordinates,e+t)}},{key:"writeStopsToFormService",value:function(e){if(e)this.directionsFormService.setStops(e);else{var t=[];this.stops.value.forEach((function(e){e.stopCoordinates instanceof Array&&t.push(e)})),this.directionsFormService.setStops(t)}}},{key:"addStop",value:function(){this.stops.insert(this.stops.length-1,this.createStop())}},{key:"createStop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"intermediate";return this.formBuilder.group({stopPoint:[""],stopProposals:[[]],directionsText:e,stopCoordinates:["",[tt.w.required]]})}},{key:"removeStop",value:function(e){var t=this,i=this.getStopOverlayID(e);this.deleteStoreFeatureByID(this.stopsStore,i),this.stops.removeAt(e);var o=0;this.stops.value.forEach((function(e){t.stops.at(o).patchValue({directionsText:t.directionsText(o)}),t.addStopOverlay(t.stops.at(o).value.stopCoordinates,o),o++}))}},{key:"resetForm",value:function(e){this.routesResults=void 0;for(var t=this.stops.length,i=0;i<t;i++)this.stops.removeAt(0);this.stops.insert(0,this.createStop("start")),this.stops.insert(1,this.createStop("end")),!0===e&&this.stopsStore.clear(),this.routeStore.clear()}},{key:"formatStep",value:function(e,t){return this.formatInstruction(e.maneuver.type,e.maneuver.modifier,e.name,e.maneuver.bearing_after,t,e.maneuver.exit,t===this.activeRoute.steps.length-1)}},{key:"formatInstruction",value:function(e,t,i,o,n,r){var a,s,c,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u="forward",h="rotate-270",d=this.translateBearing(o),p=this.translateModifier(t),g=("straight"===t?"":"\xe0 ")+p,f=("straight"===t?"":"on the ")+p;if(t&&t.search("slight")>=0&&(f=p),"uturn"===t?(u="forward",h="rotate-90"):"sharp right"===t||"right"===t?(u="subdirectory-arrow-right",h="icon-flipped"):"slight right"===t?(u="forward",h="rotate-290"):"straight"===t?u="forward":"slight left"===t?(u="forward",h="rotate-250"):("left"===t||"sharp left"===t)&&(u="subdirectory-arrow-left",h="icon-flipped"),"turn"===e)"straight"===t?(a="Continuer sur "+i,s="Continue on "+i):"uturn"===t?(a="Faire demi-tour sur "+i,s="Make u-turn on "+i):(a="Tourner "+g+" sur "+i,s="Turn "+p+" onto "+i);else if("new name"===e)a="Continuer en direction "+d+" sur "+i,s="Head "+d+" on "+i,u="compass",h="";else if("depart"===e)a="Aller en direction "+d+" sur "+i,s="Head "+d+" on "+i,u="compass",h="";else if("arrive"===e)if(l){var m=", ";p||(g="",f="",m=""),a="Vous \xeates arriv\xe9"+m+g,s="You have reached your destination"+m+f}else a="Vous atteignez le point interm\xe9diare sur "+i,s="You have reached the intermediate stop onto "+i,u="map-marker",h="";else"merge"===e?(a="Continuer sur "+i,s="Continue on "+i,u="forward",h="rotate-270"):"on ramp"===e?(a="Prendre l'entr\xe9e d'autoroute "+g,s="Take the ramp "+f):"off ramp"===e?(a="Prendre la sortie d'autoroute "+g,s="Take exit "+f):"fork"===e?t.search("left")>=0?(a="Garder la gauche sur "+i,s="Merge left onto "+i):t.search("right")>=0?(a="Garder la droite sur "+i,s="Merge right onto "+i):(a="Continuer sur "+i,s="Continue on "+i):"end of road"===e?(a="\xc0 la fin de la route, tourner "+p+" sur "+i,s="At the end of the road, turn "+p+" onto "+i):"use lane"===e?(a="Prendre la voie de ... ",s="Take the lane ..."):"continue"===e&&"uturn"!==t?(a="Continuer sur "+i,s="Continue on "+i,u="forward",h="rotate-270"):"roundabout"===e?(a="Au rond-point, prendre la "+r,a+=1===r?"re":"e",a+=" sortie vers "+i,s="At the roundabout, take the "+r,s+=1===r?"st":"rd",s+=" exit towards "+i,u="chart-donut",h=""):"rotary"===e?(a="Rond-point rotary....",s="Roundabout rotary....",u="chart-donut",h=""):"roundabout turn"===e?(a="Rond-point, prendre la ...",s="Roundabout, take the ...",u="chart-donut",h=""):"exit roundabout"===e?(a="Poursuivre vers "+i,s="Continue to "+i,u="forward",h="rotate-270"):"notification"===e?(a="notification ....",s="notification ...."):"uturn"===t?(a="Faire demi-tour et continuer en direction "+d+" sur "+i,s="Make u-turn and head "+d+" on "+i):(a="???",s="???");return l&&(u="flag-variant",h=""),0===n&&(u="compass",h=""),"fr"===this.browserLanguage?c=a:"en"===this.browserLanguage&&(c=s),{instruction:c,image:u,cssClass:h}}},{key:"translateModifier",value:function(e){return"uturn"===e?this.languageService.translate.instant("igo.geo.directions.uturn"):"sharp right"===e?this.languageService.translate.instant("igo.geo.directions.sharp right"):"right"===e?this.languageService.translate.instant("igo.geo.directions.right"):"slight right"===e?this.languageService.translate.instant("igo.geo.directions.slight right"):"sharp left"===e?this.languageService.translate.instant("igo.geo.directions.sharp left"):"left"===e?this.languageService.translate.instant("igo.geo.directions.left"):"slight left"===e?this.languageService.translate.instant("igo.geo.directions.slight left"):"straight"===e?this.languageService.translate.instant("igo.geo.directions.straight"):e}},{key:"translateBearing",value:function(e){return e>=337||e<23?this.languageService.translate.instant("igo.geo.cardinalPoints.n"):e<67?this.languageService.translate.instant("igo.geo.cardinalPoints.ne"):e<113?this.languageService.translate.instant("igo.geo.cardinalPoints.e"):e<157?this.languageService.translate.instant("igo.geo.cardinalPoints.se"):e<203?this.languageService.translate.instant("igo.geo.cardinalPoints.s"):e<247?this.languageService.translate.instant("igo.geo.cardinalPoints.sw"):e<293?this.languageService.translate.instant("igo.geo.cardinalPoints.w"):e<337?this.languageService.translate.instant("igo.geo.cardinalPoints.nw"):void 0}},{key:"formatDistance",value:function(e){if(0!==e)return e>=1e5?Math.round(e/1e3)+" km":e>=1e4||e>=100?Math.round(e/100)/10+" km":e+" m"}},{key:"formatDuration",value:function(e){if(e>=3600){var t=Math.floor(e/3600),i=Math.round(60*(e/3600-t));return 60===i?t+1+" h":t+" h "+i+" min"}return e>=60?Math.round(e/60)+" min":e+" s"}},{key:"showSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.showRouteSegmentGeometry(e.geometry.coordinates,t)}},{key:"showRouteSegmentGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=new bl.a(e).transform("EPSG:4326",this.map.projection).getCoordinates(),o=new bl.d(i[0]),n=new Vc.a({geometry:o}),r=(new fl.a).writeGeometryObject(o,{featureProjection:this.map.projection,dataProjection:this.map.projection}),a=this.routeStore.get("vertex");this.routeStore.update({type:_f,geometry:r,projection:this.map.projection,properties:{id:"vertex",type:"vertex"},meta:{id:"vertex",revision:(a?a.meta.revision:0)+1},ol:n}),t&&this.map.viewController.zoomToExtent(n.getGeometry().getExtent())}},{key:"zoomRoute",value:function(e){if(e)this.map.viewController.zoomToExtent(e);else if(this.routeStore.layer){var t=this.routeStore.layer.ol.getSource().getFeatures().find((function(e){return"route"===e.getId()}));if(t){var i=t.getGeometry().getExtent();this.map.viewController.zoomToExtent(i)}}}},{key:"showRouteGeometry",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new bl.a(this.activeRoute.geometry.coordinates).transform("EPSG:4326",this.map.projection);e&&this.zoomRoute(t.getExtent());var i=(new fl.a).writeGeometryObject(t,{featureProjection:this.map.projection,dataProjection:this.map.projection}),o=this.routeStore.get("route"),n={type:_f,geometry:i,projection:this.map.projection,properties:{id:"route",type:"route"},meta:{id:"route",revision:(o?o.meta.revision:0)+1},ol:new Vc.a({geometry:t})};this.routeStore.update(n)}},{key:"getRoutes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.deleteStoreFeatureByID(this.routeStore,"vertex"),this.writeStopsToFormService();var o=this.directionsFormService.getStopsCoordinates();if(!(o.length<2)){var n=this.directionsService.route(o,i);n&&n.map((function(i){return e.routesQueries$$.push(i.subscribe((function(i){e.routesResults=i,e.activeRoute=e.routesResults[0],e.showRouteGeometry(t),e.changeDetectorRefs.detectChanges()})))}))}}},{key:"unlistenSingleClick",value:function(){0!==this.focusKey.length&&this.focusKey.forEach((function(e){Object(el.b)(e)}))}},{key:"unsubscribeRoutesQueries",value:function(){this.routesQueries$$.forEach((function(e){return e.unsubscribe()})),this.routesQueries$$=[]}},{key:"copyLinkToClipboard",value:function(){if($.copy(this.getUrl())){var e=this.languageService.translate,t=e.instant("igo.geo.directionsForm.dialog.copyTitle"),i=e.instant("igo.geo.directionsForm.dialog.copyMsgLink");this.messageService.success(i,t)}}},{key:"copyDirectionsToClipboard",value:function(){var e=this,t=this.languageService.translate.instant("igo.geo.directionsForm.instructions")+":\n",i="",o=this.languageService.translate.instant("igo.geo.directionsForm.summary")+": \n\t"+this.activeRoute.title+"\n\t"+this.formatDistance(this.activeRoute.distance)+"\n\t"+this.formatDuration(this.activeRoute.duration)+"\n\n"+this.languageService.translate.instant("igo.geo.directionsForm.stopsList")+":\n",n=this.languageService.translate.instant("igo.geo.directionsForm.link")+":\n\t"+this.getUrl(),r=1;this.stops.value.forEach((function(e){var t="",o="";e.stopPoint!==e.stopCoordinates?(o=e.stopPoint,t=" ("+[e.stopCoordinates[1],e.stopCoordinates[0]].join(",")+")"):o=[e.stopCoordinates[1],e.stopCoordinates[0]].join(","),i=i+"\t"+r.toLocaleString()+". "+o+t+"\n",r++}));var a=0;if(this.activeRoute.steps.forEach((function(i){var o=e.formatStep(i,a).instruction,n=void 0===e.formatDistance(i.distance)?"":" ("+e.formatDistance(i.distance)+")";t=t+"\t"+(a+1).toLocaleString()+". "+o+n+"\n",a++})),$.copy(o+i+"\n"+n+"\n\n"+t)){var s=this.languageService.translate,c=s.instant("igo.geo.directionsForm.dialog.copyTitle"),l=s.instant("igo.geo.directionsForm.dialog.copyMsg");this.messageService.success(l,c)}}},{key:"handleTermChanged",value:function(e){var t=this;if(void 0!==e||0!==e.length){var i=[];this.search$$&&this.search$$.unsubscribe(),this.searchService.search(e,{searchType:"Feature"}).map((function(e){return t.search$$=e.request.subscribe((function(e){e.filter((function(e){return e.data.geometry})).forEach((function(t){0===i.filter((function(e){return e.source===t.source})).length&&i.push({source:t.source,meta:t.meta,results:e.map((function(e){return e.data}))})})),t.stops&&t.stops.at(t.currentStopIndex).patchValue({stopProposals:i}),t.changeDetectorRefs.detectChanges()}))}))}}},{key:"setTerm",value:function(e){this.term=e,this.keyIsValid(e)&&(e.length>=this.length||0===e.length)&&this.stream$.next(e)}},{key:"keyIsValid",value:function(e){return void 0===this.invalidKeys.find((function(t){return t===e}))}},{key:"keyup",value:function(e,t){var i=this;this.setTerm(t.target.value),this.map.ol.un("singleclick",(function(t){i.handleMapClick(t,e)}))}},{key:"clearStop",value:function(e){var t=this.getStopOverlayID(e);this.deleteStoreFeatureByID(this.stopsStore,t),this.routeStore.clear();var i=this.stops.length;this.stops.removeAt(e),this.stops.insert(e,this.createStop(this.directionsText(e,i))),this.routesResults=void 0,this.getRoutes(!1)}},{key:"chooseProposal",value:function(e,t){if(void 0!==e){var i,o=e.geometry;if("Point"===o.type)i=o.coordinates;else if(o.type.search("Line")>=0)i=[(i=(new fl.a).readFeatures(o)[0].getGeometry().getFirstCoordinate())[0],i[1]];else if(o.type.search("Polygon")>=0){var n=(new fl.a).readFeatures(o);i=[(i=i="Polygon"===n[0].getGeometry().getType()?n[0].getGeometry().getInteriorPoint().getFirstCoordinate():n[0].getGeometry().getInteriorPoints().getFirstCoordinate())[0],i[1]]}void 0!==i&&(this.stops.at(t).patchValue({stopCoordinates:i}),this.addStopOverlay(i,t))}}},{key:"focus",value:function(e){var t=this;this.unlistenSingleClick(),this.currentStopIndex=e,this.focusOnStop=!0,this.focusKey.push(this.map.ol.once("singleclick",(function(i){t.handleMapClick(i,e)})))}},{key:"handleMapClick",value:function(e,t){var i=this;void 0===this.currentStopIndex?(this.addStop(),this.stops.at(t=this.stops.length-2).value.stopProposals=[]):t=this.currentStopIndex;var o=Object(kc.r)(e.coordinate,this.map.projection,this.projection);this.stops.at(t).patchValue({stopProposals:[],stopCoordinates:o}),this.handleLocationProposals(o,t),this.addStopOverlay(o,t),setTimeout((function(){i.focusOnStop=!1}),500)}},{key:"geolocateStop",value:function(e){jf(this.map,[this.map.geolocationFeature],Mf.Move);var t=this.map.viewController.getCenter(this.projection);this.stops.at(e).patchValue({stopCoordinates:t}),this.addStopOverlay(t,e),this.handleLocationProposals(t,e)}},{key:"addStopOverlay",value:function(e,t){var i,o,n=this.directionsText(t);"start"===n?(i="green",o=this.languageService.translate.instant("igo.geo.directionsForm.start")):"end"===n?(i="red",o=this.languageService.translate.instant("igo.geo.directionsForm.end")):(i="yellow",o=this.languageService.translate.instant("igo.geo.directionsForm.intermediate")+" #"+t);var r=new bl.d(Object(kc.r)(e,this.projection,this.map.projection)),a=this.getStopOverlayID(t),s=(new fl.a).writeGeometryObject(r,{featureProjection:this.map.projection,dataProjection:this.map.projection}),c=this.stopsStore.get(a),l={type:_f,geometry:s,projection:this.map.projection,properties:{id:a,type:"stop",stopText:o,stopColor:i,stopOpacity:1},meta:{id:a,revision:(c?c.meta.revision:0)+1},ol:new Vc.a({geometry:r})};this.stopsStore.update(l),this.getRoutes()}},{key:"getStopOverlayID",value:function(e){return"directionsStop_"+(0===e?"start":e===this.stops.length-1?"end":e)}},{key:"deleteStoreFeatureByID",value:function(e,t){var i=e.get(t);i&&e.delete(i)}},{key:"getUrl",value:function(){if(this.route){var e=this.route.options.directionsCoordKey,t=[];this.directionsFormService&&this.directionsFormService.getStopsCoordinates()&&0!==this.directionsFormService.getStopsCoordinates().length&&this.directionsFormService.getStopsCoordinates().forEach((function(e){t.push(bg(e,6))}));var i="";return t.length>=2&&(i="".concat(e,"=").concat(t.join(";"))),"".concat(location.origin).concat(location.pathname,"?tool=directions&sidenav=1&").concat(i)}}},{key:"activeRoute",get:function(){return this._activeRoute},set:function(e){this._activeRoute=e,e&&this.activeRoute$.getValue()&&e.id!==this.activeRoute$.getValue().id&&this.activeRoute$.next(e)}},{key:"stopsStore",get:function(){return this._stopsStore},set:function(e){this._stopsStore=e,this.stopsStore$.next(e)}},{key:"routeFromFeatureDetail",get:function(){return this._routeFromFeatureDetail},set:function(e){this._routeFromFeatureDetail=e}},{key:"stops",get:function(){return this.stopsForm.get("stops")}}]),e}()).\u0275fac=function(e){return new(e||Ck)(r.Rb(tt.e),r.Rb(Ok),r.Rb(Le),r.Rb(Ie),r.Rb(vk),r.Rb(bm),r.Rb(Ik),r.Rb(r.h),r.Rb(Me,8))},Ck.\u0275cmp=r.Lb({type:Ck,selectors:[["igo-directions-form"]],inputs:{debounce:"debounce",length:"length",stopsStore:"stopsStore",routeFromFeatureDetail:"routeFromFeatureDetail",term:"term",map:"map",routeStore:"routeStore"},outputs:{submit:"submit"},decls:11,vars:10,consts:[[1,"igo-form",3,"formGroup"],["formArrayName","stops",4,"ngFor","ngForOf"],[1,"igo-form-button-group"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","primary",3,"matTooltip","click"],["svgIcon","map-marker-plus"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","primary",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click",4,"ngIf"],["class","igo-input-container",4,"ngIf"],["formArrayName","stops"],["inputs",""],[3,"formGroupName"],[1,"igo-input-container"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["matInput","","formControlName","stopPoint",3,"matAutocomplete","placeholder","focus","keyup","keydown.enter"],["mat-button","","matSuffix","","mat-icon-button","","color","warn","aria-label","Clear",3,"click",4,"ngIf"],["auto","matAutocomplete"],[3,"label","disabled",4,"ngFor","ngForOf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click"],["svgIcon","crosshairs-gps"],["mat-button","","matSuffix","","mat-icon-button","","color","warn","aria-label","Clear",3,"click"],["svgIcon","close"],[3,"label","disabled"],["matTooltipShowDelay","500",3,"value","matTooltip","onSelectionChange",4,"ngFor","ngForOf"],["matTooltipShowDelay","500",3,"value","matTooltip","onSelectionChange"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","delete"],["svgIcon","magnify-plus-outline"],["svgIcon","file-restore"],["svgIcon","content-copy"],["svgIcon","link"],[4,"ngIf"],["mat-header","",1,"igo-route-title","mat-typography"],["mat-subheader",""],["class","igo-steps","igoListItem","",3,"mouseenter","click",4,"ngFor","ngForOf"],[3,"placeholder","ngModel","selectionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["igoListItem","",1,"igo-steps",3,"mouseenter","click"],["mat-list-icon","",3,"ngClass","svgIcon"],["mat-line",""],["mat-line","",1,"right"]],template:function(e,t){1&e&&(r.Xb(0,"form",0),r.Gc(1,yp,13,9,"div",1),r.Xb(2,"div",2),r.Xb(3,"button",3),r.ec("click",(function(){return t.addStop()})),r.jc(4,"translate"),r.Sb(5,"mat-icon",4),r.Wb(),r.Gc(6,kp,3,3,"button",5),r.Gc(7,Sp,3,3,"button",6),r.Gc(8,Cp,3,3,"button",5),r.Gc(9,wp,3,3,"button",5),r.Wb(),r.Wb(),r.Gc(10,Tp,10,6,"div",7)),2&e&&(r.oc("formGroup",t.stopsForm),r.Db(1),r.oc("ngForOf",t.stops.controls),r.Db(2),r.oc("matTooltip",r.kc(4,8,"igo.geo.directionsForm.addStop")),r.Db(3),r.oc("ngIf",t.routesResults),r.Db(1),r.oc("ngIf",t.routesResults),r.Db(1),r.oc("ngIf",t.routesResults),r.Db(1),r.oc("ngIf",t.routesResults),r.Db(1),r.oc("ngIf",t.routesResults))},directives:[tt.x,tt.q,tt.i,m.k,l.a,g.a,u.a,m.l,tt.d,h.d,tt.j,it.c,et.b,tt.c,xl.c,tt.p,tt.h,xl.a,it.h,dt.n,dt.o,h.a,h.f,yl.a,ot.a,tt.s,h.c,m.j,dt.k],pipes:[U.d],styles:["mat-form-field[_ngcontent-%COMP%]{width:85%}.igo-route-title[_ngcontent-%COMP%]{font-weight:700}.igo-steps[_ngcontent-%COMP%]{cursor:pointer}form[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}.mat-line[_ngcontent-%COMP%]{white-space:pre-wrap!important;word-wrap:break-word!important}.mat-line.right[_ngcontent-%COMP%]{text-align:right}.rotate-90[_ngcontent-%COMP%]{transform:rotate(90deg)}.rotate-45[_ngcontent-%COMP%]{transform:rotate(45deg)}.rotate-270[_ngcontent-%COMP%]{transform:rotate(270deg)}.rotate-250[_ngcontent-%COMP%]{transform:rotate(250deg)}.rotate-290[_ngcontent-%COMP%]{transform:rotate(290deg)}.icon-flipped[_ngcontent-%COMP%]{transform:scaleY(-1)}"]}),Ck);function Tk(e,t){var i=[new Uc.Style({geometry:e.getGeometry(),image:new Uc.Circle({radius:7,stroke:new Uc.Stroke({color:"#FF0000",width:3})})})],o=new Uc.Style({image:new Uc.Icon({src:"./assets/igo2/geo/icons/place_"+e.get("stopColor")+"_36px.svg",opacity:e.get("stopOpacity"),imgSize:[36,36],anchor:[.5,.92]}),text:new Uc.Text({text:e.get("stopText"),font:"12px Calibri,sans-serif",fill:new Uc.Fill({color:"#000"}),stroke:new Uc.Stroke({color:"#fff",width:3}),overflow:!0})}),n=[new Uc.Style({stroke:new Uc.Stroke({color:"#6a7982",width:10,opacity:.75})}),new Uc.Style({stroke:new Uc.Stroke({color:"#4fa9dd",width:6,opacity:.75})})];return"stop"===e.get("type")?o:"vertex"===e.get("type")?i:"route"===e.get("type")?n:void 0}var Fk,_k=((Fk=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}()).\u0275mod=r.Pb({type:Fk}),Fk.\u0275inj=r.Ob({factory:function(e){return new(e||Fk)},providers:[Ik,{provide:kk,useFactory:Sk,deps:[yk]}],imports:[[m.c,tt.k,tt.u,u.b,l.b,h.e,yl.b,it.e,et.c,dt.p,ot.b,g.b,xl.b,Ce]]}),Fk);function Mk(e){return new pk(e)}var Dk,Pk,Ak,jk=((Ak=function(){function e(t){_classCallCheck(this,e),this.languageService=t}return _createClass(e,[{key:"formatResult",value:function(e){return e}}]),e}()).\u0275fac=function(e){return new(e||Ak)(r.bc(Le))},Ak.\u0275prov=r.Nb({token:Ak,factory:Ak.\u0275fac}),Ak),Rk=((Pk=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o,n,r,a){var s;_classCallCheck(this,i),(s=t.call(this,n)).http=e,s.languageService=o,s.formatter=r,s.title$=new L.a(""),s.hashtagsLieuxToKeep=[],s.languageService.translate.get(s.options.title).subscribe((function(e){return s.title$.next(e)}));var c=a.get(Hs);return s.settings.length&&(c?c.authenticate$.subscribe((function(){s.getAllowedTypes()})):s.getAllowedTypes()),s}return _createClass(i,[{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){var e=this.options.params&&this.options.params.limit?Number(this.options.params.limit):void 0,t=this.options.params&&this.options.params.ecmax?Number(this.options.params.ecmax):void 0,i=this.options.params&&this.options.params.type?this.options.params.type.replace(/\s/g,"").toLowerCase().split(","):["adresses","codes-postaux","routes","municipalites","mrc","regadmin","lieux"];return{title:"igo.geo.search.icherche.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/icherche",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.icherche.type.address",value:"adresses",enabled:-1!==i.indexOf("adresses"),hashtags:["adresse"]},{title:"igo.geo.search.icherche.type.oldAddress",value:"anciennes-adresses",enabled:-1!==i.indexOf("anciennes-adresses"),hashtags:["anciennes-adresses"]},{title:"igo.geo.search.icherche.type.postalCode",value:"codes-postaux",enabled:-1!==i.indexOf("codes-postaux"),hashtags:["code-postal"]},{title:"igo.geo.search.icherche.type.road",value:"routes",enabled:-1!==i.indexOf("routes"),hashtags:["route"]},{title:"igo.geo.search.icherche.type.city",value:"municipalites",enabled:-1!==i.indexOf("municipalites"),hashtags:["municipalit\xe9","mun"]},{title:"igo.geo.search.icherche.type.oldCity",value:"anciennes-municipalites",enabled:-1!==i.indexOf("anciennes-municipalites"),hashtags:["anciennes-municipalites"]},{title:"igo.geo.search.icherche.type.mrc",value:"mrc",enabled:-1!==i.indexOf("mrc"),hashtags:["mrc"]},{title:"igo.geo.search.icherche.type.regadmin",value:"regadmin",enabled:-1!==i.indexOf("regadmin"),hashtags:["r\xe9gion-administrative","regadmin"]},{title:"igo.geo.search.icherche.type.entreprise",value:"entreprises",enabled:-1!==i.indexOf("entreprises"),available:!1,hashtags:["entreprise"]},{title:"igo.geo.search.icherche.type.place",value:"lieux",enabled:-1!==i.indexOf("lieux"),hashtags:["lieu"]},{title:"igo.geo.search.icherche.type.sumi",value:"bornes-sumi",enabled:-1!==i.indexOf("bornes-sumi"),hashtags:["borne","bornes","sumi"]},{title:"igo.geo.search.icherche.type.km",value:"bornes-km",enabled:!1,hashtags:["borne","bornes","rep\xe8re","km"]},{title:"igo.geo.search.icherche.type.cadastre",value:"cadastre",enabled:!1}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"1",value:1,enabled:1===e},{title:"5",value:5,enabled:5===e||!e},{title:"10",value:10,enabled:10===e},{title:"25",value:25,enabled:25===e},{title:"50",value:50,enabled:50===e}]},{type:"radiobutton",title:"ecmax",name:"ecmax",values:[{title:"10 %",value:10,enabled:10===t},{title:"30 %",value:30,enabled:30===t||!t},{title:"50 %",value:50,enabled:50===t},{title:"75 %",value:75,enabled:75===t},{title:"100 %",value:100,enabled:100===t}]},{type:"radiobutton",title:"restrictExtent",name:"loc",values:[{title:"igo.geo.search.icherche.restrictExtent.map",value:"true",enabled:!1},{title:"igo.geo.search.icherche.restrictExtent.quebec",value:"false",enabled:!0}]}]}}},{key:"search",value:function(e,t){var i=this,o=this.computeRequestParams(e,t||{});return o.get("type").length?(this.options.params.page=o.get("page")||"1",this.http.get(this.searchUrl+"/geocode",{params:o}).pipe(Object(w.a)((function(e){return i.extractResults(e)})),Object(C.a)((function(e){throw e.error.toDisplay=!0,e.error.title=i.languageService.translate.instant(i.getDefaultOptions().title),e})))):Object(F.a)([])}},{key:"getAllowedTypes",value:function(){var e=this;return this.http.get(this.searchUrl+"/types").subscribe((function(t){e.settings.find((function(e){return"type"===e.name})).values.forEach((function(i){var o=new RegExp("^".concat(i.value,"(\\.|$)")),n=t.filter((function(e){return o.test(e)}));i.available=n.length>0,"lieux"===i.value&&(e.hashtagsLieuxToKeep=_toConsumableArray(new Set(n.map((function(e){return e.split(".")})).reduce((function(e,t){return e.concat(t)})).filter((function(e){return"lieux"!==e})))))}))}))}},{key:"computeRequestParams",value:function(e,t){var i=Object.assign({geometry:!0,bbox:!0,icon:!0,type:"adresses,codes-postaux,municipalites,mrc,regadmin,lieux,entreprises,bornes-sumi"},this.params,this.computeOptionsParam(e,t||{}).params,{q:this.computeTerm(e),page:t.page});if("true"===i.loc){var o=_slicedToArray(t.extent,4),n=o[0],r=o[1],a=o[2],s=o[3];i.loc="".concat(n,",").concat(r,";").concat(a,",").concat(r,";").concat(a,",").concat(s,";").concat(n,",").concat(s,";").concat(n,",").concat(r)}else"false"===i.loc&&delete i.loc;return-1!==i.q.indexOf("#")&&(i.type="lieux"),new k.g({fromObject:E.removeUndefined(i)})}},{key:"extractResults",value:function(e){var t=this;return e.features.map((function(i){return t.formatter.formatResult(t.dataToResult(i,e))}))}},{key:"dataToResult",value:function(e,t){var i=this.computeProperties(e),o=[this.getId(),i.type,i.code].join(".");return{source:this,data:{type:_f,projection:"EPSG:4326",geometry:e.geometry,extent:e.bbox,properties:i,meta:{id:o,title:e.properties.nom}},meta:{dataType:_f,id:o,title:e.properties.nom,titleHtml:(e.highlight.title||e.properties.nom)+(e.highlight.title2?" <small> "+e.highlight.title2+"</small>":"")+(e.highlight.title3?"<br><small> "+e.highlight.title3+"</small>":""),icon:e.icon||"map-marker",nextPage:t.features.length%+this.options.params.limit==0&&+this.options.params.page<10}}}},{key:"computeProperties",value:function(e){var t=E.removeKeys(e.properties,i.propertiesBlacklist);if(void 0===e.geometry)return Object.assign({type:e.index},t);var o,n,r={GoogleMaps:""};if("Point"===e.geometry.type)o=tb.getGoogleMapsCoordLink(e.geometry.coordinates[0],e.geometry.coordinates[1]);else{var a=Object(wl.a)(e.geometry);o=tb.getGoogleMapsCoordLink(a.geometry.coordinates[0],a.geometry.coordinates[1])}n=tb.getGoogleMapsNameLink("routes"===e.index?e.properties.nom+", "+e.properties.municipalite:"municipalites"===e.index?e.properties.nom+", ville":"mrc"===e.index?"mrc+"+e.properties.nom:"regadmin"===e.index?e.properties.nom+",+QC":e.properties.nom||e.highlight.title),r.GoogleMaps="<a href="+o+' target="_blank">'+this.languageService.translate.instant("igo.geo.searchByCoord")+"</a> <br /> <a href="+n+' target="_blank">'+this.languageService.translate.instant("igo.geo.searchByName")+"</a>","Point"===e.geometry.type&&(r.GoogleStreetView=tb.getGoogleStreetViewLink(e.geometry.coordinates[0],e.geometry.coordinates[1]));var s={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign({type:e.index},t,r,s)}},{key:"computeTerm",value:function(e){var t=this;return(e.match(/(#[^\s]+)/g)||[]).some((function(e){var i=e.substring(1);return t.hashtagsLieuxToKeep.some((function(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===i.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}))}))||(e=e.replace(/(#[^\s]*)/g,"")),e.replace(/[^\w\xc0-\xff !\-\(\),'#]+/g,"")}},{key:"computeOptionsParam",value:function(e,t){var o=_get(_getPrototypeOf(i.prototype),"getHashtagsValid",this).call(this,e,"type");return o&&(t.params=Object.assign(t.params||{},{type:o.join(",")})),t}},{key:"title",get:function(){return this.title$.getValue()}}]),i}(Qm)).\u0275fac=function(e){return new(e||Pk)(r.bc(k.b),r.bc(Le),r.bc("options"),r.bc(jk),r.bc(r.t))},Pk.\u0275prov=r.Nb({token:Pk,factory:Pk.\u0275fac}),Pk.id="icherche",Pk.type=_f,Pk.propertiesBlacklist=[],Pk),$k=((Dk=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o,n,r){var a;_classCallCheck(this,i),(a=t.call(this,n)).http=e,a.languageService=o,a.title$=new L.a(""),a.languageService.translate.get(a.options.title).subscribe((function(e){return a.title$.next(e)}));var s=r.get(Hs);return a.settings.length&&(s?s.authenticate$.subscribe((function(){a.getAllowedTypes()})):a.getAllowedTypes()),a}return _createClass(i,[{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){var e=this.options.params&&this.options.params.type?this.options.params.type.replace(/\s/g,"").toLowerCase().split(","):["adresses","municipalites","mrc","regadmin"];return{title:"igo.geo.search.ichercheReverse.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/terrapi",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.icherche.type.address",value:"adresses",enabled:-1!==e.indexOf("adresses")},{title:"igo.geo.search.icherche.type.road",value:"routes",enabled:-1!==e.indexOf("routes"),available:!1},{title:"igo.geo.search.icherche.type.district",value:"arrondissements",enabled:-1!==e.indexOf("arrondissements")},{title:"igo.geo.search.icherche.type.city",value:"municipalites",enabled:-1!==e.indexOf("municipalites")},{title:"igo.geo.search.icherche.type.mrc",value:"mrc",enabled:-1!==e.indexOf("mrc")},{title:"igo.geo.search.icherche.type.regadmin",value:"regadmin",enabled:-1!==e.indexOf("regadmin")}]},{type:"radiobutton",title:"radius",name:"buffer",values:[{title:"100 m",value:100,enabled:!this.options.distance||100===this.options.distance},{title:"500 m",value:500,enabled:500===this.options.distance},{title:"1 km",value:1e3,enabled:1e3===this.options.distance},{title:"2 km",value:2e3,enabled:2e3===this.options.distance},{title:"5 km",value:5e3,enabled:5e3===this.options.distance}]}]}}},{key:"reverseSearch",value:function(e,t){var i=this,o=this.computeRequestParams(e,t||{});return o.get("type").length?this.http.get(this.searchUrl+"/locate",{params:o}).pipe(Object(w.a)((function(e){return i.extractResults(e)}))):Object(F.a)([])}},{key:"getAllowedTypes",value:function(){var e=this;return this.http.get(this.searchUrl+"/types").subscribe((function(t){e.settings.find((function(e){return"type"===e.name})).values.forEach((function(e){e.available=t.indexOf(e.value)>-1}))}))}},{key:"computeRequestParams",value:function(e,t){return(t.distance||this.options.distance)&&(t.params=Object.assign(t.params||{},{buffer:t.distance||this.options.distance})),new k.g({fromObject:Object.assign({loc:e.join(","),sort:"distance",geometry:!0,icon:!0},t.params||{},this.params)})}},{key:"extractResults",value:function(e){var t=this;return e.features.map((function(e){return t.dataToResult(e)}))}},{key:"getSubtitle",value:function(e){if(!this.settings.length)return"";var t="";switch(e.properties.type){case"arrondissements":t=e.properties.municipalite+" (Arrondissement)";break;default:var i=this.settings.find((function(e){return"type"===e.name})).values.find((function(t){return t.value===e.properties.type}));i&&(t=this.languageService.translate.instant(i.title))}return t}},{key:"dataToResult",value:function(e){var t=this.computeProperties(e),i=this.computeExtent(e),o=[this.getId(),t.type,t.code].join("."),n=e.properties.nom,r=" <small> "+this.getSubtitle(e)+"</small>";return{source:this,data:{type:_f,projection:"EPSG:4326",geometry:e.geometry,extent:i,properties:t,meta:{id:o,title:e.properties.nom}},meta:{dataType:_f,id:o,title:e.properties.nom,titleHtml:n+r,icon:e.icon||"map-marker"}}}},{key:"computeProperties",value:function(e){var t=E.removeKeys(e.properties,i.propertiesBlacklist),o={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign(t,o)}},{key:"computeExtent",value:function(e){return e.bbox?[e.bbox[0],e.bbox[2],e.bbox[1],e.bbox[3]]:void 0}},{key:"title",get:function(){return this.title$.getValue()}}]),i}(Qm)).\u0275fac=function(e){return new(e||Dk)(r.bc(k.b),r.bc(Le),r.bc("options"),r.bc(r.t))},Dk.\u0275prov=r.Nb({token:Dk,factory:Dk.\u0275fac}),Dk.id="icherchereverse",Dk.type=_f,Dk.propertiesBlacklist=[],Dk);function Ek(e){return new jk(e)}function Wk(e,t,i,o,n){return new Rk(e,t,i.getConfig("searchSources."+Rk.id),o,n)}function Xk(e,t,i,o){return new $k(e,t,i.getConfig("searchSources."+$k.id),o)}var Gk,Bk,Vk=((Bk=function(){function e(t){_classCallCheck(this,e),this.languageService=t}return _createClass(e,[{key:"formatResult",value:function(e){return e}}]),e}()).\u0275fac=function(e){return new(e||Bk)(r.bc(Le))},Bk.\u0275prov=r.Nb({token:Bk,factory:Bk.\u0275fac}),Bk),Nk=((Gk=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o,n){var r;return _classCallCheck(this,i),(r=t.call(this,e)).languageService=o,r.title$=new L.a(""),r.projections=n,r.languageService.translate.get(r.options.title).subscribe((function(e){return r.title$.next(e)})),r}return _createClass(i,[{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){return{title:"igo.geo.search.coordinates.name",order:1,showInSettings:!1}}},{key:"reverseSearch",value:function(e,t){return Object(F.a)([this.dataToResult(e)])}},{key:"dataToResult",value:function(e){var t=function(e,t){var i=Object(kc.r)(e,"EPSG:4326","EPSG:3857"),o=[{code:"EPSG:3857",alias:"Web mercator",coord:i,igo2CoordFormat:bg(i).join(", ")+" ; 3857"}],n=function(e){return Math.ceil((e[0]+180)/6)}(e),r=n<10?"EPSG:3260"+n:"EPSG:326"+n,a="UTM-"+n,s=Object(kc.r)(e,"EPSG:4326",r);o.push({code:r,alias:"UTM",coord:s,igo2CoordFormat:"".concat(a," ").concat(bg(s).join(", "))});var c=function(e){var t,i=e[0];return i<-51&&i>-54&&(t=1),i<-54&&i>-57&&(t=2),i<-57&&i>-60&&(t=3),i<-60&&i>-63&&(t=4),i<-63&&i>-66&&(t=5),i<-66&&i>-69&&(t=6),i<-69&&i>-72&&(t=7),i<-72&&i>-75&&(t=8),i<-75&&i>-78&&(t=9),i<-78&&i>-81&&(t=10),t}(e);if(c){var l=c<10?"EPSG:3218"+c:"EPSG:321"+(80+c),u="MTM-"+c,h=Object(kc.r)(e,"EPSG:4326",l);o.push({code:l,alias:"MTM",coord:h,igo2CoordFormat:"".concat(u," ").concat(bg(h).join(", "))})}return t.forEach((function(t){var i=Object(kc.r)(e,"EPSG:4326",t.code),n=t.code.split(":")[1];o.push({code:t.code,alias:t.alias||t.code,coord:i,igo2CoordFormat:"".concat(bg(i).join(", ")," ; ").concat(n)})})),o}(e,this.projections).reduce((function(e,t){return e[t.alias]=t.igo2CoordFormat,e}),{}),i=bg(e,6).join(", "),o={};return o[this.languageService.translate.instant("igo.geo.search.coordinates.coord")]=i,{source:this,data:{type:_f,projection:"EPSG:4326",geometry:{type:"Point",coordinates:[e[0],e[1]]},extent:void 0,properties:Object.assign({},o,t,{GoogleMaps:tb.getGoogleMapsCoordLink(e[0],e[1]),GoogleStreetView:tb.getGoogleStreetViewLink(e[0],e[1]),OpenStreetMap:ib.getOpenStreetMapLink(e[0],e[1],14)},{Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"}),meta:{id:e[0].toString()+","+e[1].toString(),title:i}},meta:{dataType:_f,id:e[0].toString()+","+e[1].toString(),title:i,icon:"map-marker"}}}},{key:"title",get:function(){return this.title$.getValue()}}]),i}(Qm)).\u0275fac=function(e){return new(e||Gk)(r.bc("options"),r.bc(Le),r.bc("projections"))},Gk.\u0275prov=r.Nb({token:Gk,factory:Gk.\u0275fac}),Gk.id="coordinatesreverse",Gk.type=_f,Gk);function zk(e){return new Vk(e)}function qk(e,t,i){return new Nk(e.getConfig("searchSources."+Nk.id),t,e.getConfig("projections")||[])}var Hk,Uk,Yk=((Uk=function(){function e(t){_classCallCheck(this,e),this.languageService=t}return _createClass(e,[{key:"formatResult",value:function(e){var t=this,i=["title","abstract","groupTitle","metadataUrl","downloadUrl","urlInfo","name"],o=Object.entries(e.properties).filter((function(e){var t=_slicedToArray(e,1)[0];return-1!==i.indexOf(t)})).reduce((function(e,i){var o,n=_slicedToArray(i,2),r=n[0],a=n[1];try{o=t.languageService.translate.instant("igo.geo.search.ilayer.properties."+r)}catch(s){o=r}return e[o]=a||"",e}),{}),n=Object.assign({},e);return n.properties=o,n}}]),e}()).\u0275fac=function(e){return new(e||Uk)(r.bc(Le))},Uk.\u0275prov=r.Nb({token:Uk,factory:Uk.\u0275fac}),Uk),Kk=((Hk=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o,n,r){var a;return _classCallCheck(this,i),(a=t.call(this,n)).http=e,a.languageService=o,a.formatter=r,a.title$=new L.a(""),a.languageService.translate.get(a.options.title).subscribe((function(e){return a.title$.next(e)})),a}return _createClass(i,[{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){var e=this.options.params&&this.options.params.limit?Number(this.options.params.limit):void 0;return{title:"igo.geo.search.ilayer.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/layers/search",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.ilayer.type.layer",value:"layer",enabled:!0,hashtags:["layer","layers","couche","couches"]},{title:"igo.geo.search.ilayer.type.groupLayer",value:"group",enabled:!1,hashtags:["gr-layer","gr-layers","gr-couche","gr-couches"]}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"1",value:1,enabled:1===e},{title:"5",value:5,enabled:5===e||!e},{title:"10",value:10,enabled:10===e},{title:"25",value:25,enabled:25===e},{title:"50",value:50,enabled:50===e}]}]}}},{key:"search",value:function(e,t){var i=this,o=this.computeSearchRequestParams(e,t||{});return o.get("q")&&o.get("type")?(this.options.params.page=o.get("page")||"1",this.http.get(this.searchUrl,{params:o}).pipe(Object(w.a)((function(e){return i.extractResults(e)})))):Object(F.a)([])}},{key:"computeSearchRequestParams",value:function(e,t){return new k.g({fromObject:E.removeUndefined(Object.assign({q:this.computeTerm(e)},this.params,this.computeOptionsParam(e,t||{}).params,{page:t.page}))})}},{key:"computeTerm",value:function(e){return e.replace(/(#[^\s]*)/g,"").replace(/[^\w\xc0-\xff !\-\(\),'#]+/g,"")}},{key:"computeOptionsParam",value:function(e,t){var o=_get(_getPrototypeOf(i.prototype),"getHashtagsValid",this).call(this,e,"type");return o&&(t.params=Object.assign(t.params||{},{type:o.join(",")})),t}},{key:"extractResults",value:function(e){var t=this;return e.items.map((function(i){return t.dataToResult(i,e)}))}},{key:"dataToResult",value:function(e,t){var i=this.computeLayerOptions(e),o=e.highlight.title||e.properties.title,n=e.highlight.groupTitle||e.properties.groupTitle,r=n?' <small style="color: #6f6969"> '+n+"</small>":"";return{source:this,meta:{dataType:"Layer",id:[this.getId(),e.properties.id].join("."),title:e.properties.title,titleHtml:o+r,icon:"Layer"===e.properties.type?"layers":"map",nextPage:t.items.length%+this.options.params.limit==0&&+this.options.params.page<10},data:i}}},{key:"computeLayerOptions",value:function(e){var t=e.properties.url,i=this.extractQueryParamsFromSourceUrl(t);return E.removeUndefined({sourceOptions:{id:e.properties.id,type:e.properties.format,url:t,queryFormat:i.queryFormat,queryHtmlTarget:i.queryHtmlTarget,params:{LAYERS:e.properties.name},optionsFromCapabilities:!0,crossOrigin:"anonymous"},title:e.properties.title,maxResolution:fg(Number(e.properties.maxScaleDenom)),minResolution:fg(Number(e.properties.minScaleDenom)),metadata:{url:e.properties.metadataUrl,extern:!0},properties:this.formatter.formatResult(e).properties})}},{key:"extractQueryParamsFromSourceUrl",value:function(e){var t,i,o=this.options.queryFormat;if(o){for(var n=function(){var i=a[r],n=o[i];if("*"===n)return t=Hg[i.toUpperCase()],"break";var s=n.urls;return Array.isArray(s)?(s.forEach((function(o){-1!==e.indexOf(o)&&(t=Hg[i.toUpperCase()])})),"break"):void 0},r=0,a=Object.keys(o);r<a.length&&"break"!==n();r++);t!==Hg.HTML&&t!==Hg.HTMLGML2||(i="iframe")}return{queryFormat:t,queryHtmlTarget:i}}},{key:"title",get:function(){return this.title$.getValue()}}]),i}(Qm)).\u0275fac=function(e){return new(e||Hk)(r.bc(k.b),r.bc(Le),r.bc("options"),r.bc(Yk))},Hk.\u0275prov=r.Nb({token:Hk,factory:Hk.\u0275fac}),Hk.id="ilayer",Hk.type="Layer",Hk);function Zk(e){return new Yk(e)}function Jk(e,t,i,o){return new Kk(e,t,i.getConfig("searchSources."+Kk.id),o)}var Qk,eS,tS,iS,oS,nS,rS,aS,sS,cS,lS,uS=[_f,"Layer"],hS=((nS=function(){function e(t){_classCallCheck(this,e),this.searchSourceService=t,this.searchType$=new L.a(void 0),this.searchTypes=uS,this.searchTypeChange=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.searchType$$=this.searchType$.pipe(Object(A.a)()).subscribe((function(t){return e.onSetSearchType(t)}))}},{key:"ngOnDestroy",value:function(){this.searchType$$.unsubscribe()}},{key:"onSearchTypeChange",value:function(e){this.setSearchType(e)}},{key:"getSearchTypeTitle",value:function(e){return"igo.geo.search.".concat(e.toLowerCase(),".title")}},{key:"setSearchType",value:function(e){this.searchType$.next(e)}},{key:"onSetSearchType",value:function(e){null!=e&&(this.searchSourceService.enableSourcesByType(e),this.searchTypeChange.emit(e))}},{key:"searchType",set:function(e){this.setSearchType(e)},get:function(){return this.searchType$.value}}]),e}()).\u0275fac=function(e){return new(e||nS)(r.Rb(pk))},nS.\u0275cmp=r.Lb({type:nS,selectors:[["igo-search-selector"]],inputs:{searchTypes:"searchTypes",searchType:"searchType"},outputs:{searchTypeChange:"searchTypeChange"},decls:9,vars:8,consts:[[1,"igo-search-selector"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"igo-search-selector-button",3,"matTooltip","matMenuTriggerFor"],["svgIcon","menu-down"],["xPosition","before","yPosition","above",1,"no-border-radius"],["searchSelectorMenu","matMenu"],[1,"igo-search-selector-radio-group",3,"value","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(1&e&&(r.Xb(0,"div",0),r.Xb(1,"button",1),r.jc(2,"translate"),r.Sb(3,"mat-icon",2),r.Wb(),r.Xb(4,"mat-menu",3,4),r.Xb(6,"mat-radio-group",5),r.ec("change",(function(e){return t.onSearchTypeChange(e.value)})),r.jc(7,"async"),r.Gc(8,Fp,3,4,"mat-radio-button",6),r.Wb(),r.Wb(),r.Wb()),2&e){var i=r.vc(5);r.Db(1),r.oc("matTooltip",r.kc(2,4,"igo.geo.search.menu.tooltip"))("matMenuTriggerFor",i),r.Db(5),r.oc("value",r.kc(7,6,t.searchType$)),r.Db(2),r.oc("ngForOf",t.searchTypes)}},directives:[l.a,g.a,y.c,u.a,y.d,Ll.b,m.k,Ll.a],pipes:[U.d,m.b],styles:[".igo-search-selector-button[_ngcontent-%COMP%]     div.mat-button-ripple-round{border-radius:0}.igo-search-selector-radio-group[_ngcontent-%COMP%]{display:inline-flex;flex-direction:column}.igo-search-selector-radio-group[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin:5px}"],changeDetection:0}),nS),dS=((oS=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:oS}),oS.\u0275inj=r.Ob({factory:function(e){return new(e||oS)},imports:[[m.c,g.b,u.b,l.b,y.b,Ll.c,Tl.c,v.b,Ce]]}),oS),pS=((iS=function(){function e(t,i){_classCallCheck(this,e),this.searchSourceService=t,this.mediaService=i,this.hasPointerReverseSearchSource=!1,this.searchSourcesAllEnabled=!1,this.buffer=[],this.lastKeyTime=Date.now(),this.pointerSummaryEnabled=!1,this.searchSourceChange=new r.o,this.pointerSummaryStatus=new r.o}return _createClass(e,[{key:"handleKeyboardEvent",value:function(e){"F2"===e.key&&(this.pointerSummaryEnabled=!this.pointerSummaryEnabled,this.pointerSummaryStatus.emit(this.pointerSummaryEnabled))}},{key:"ngOnInit",value:function(){this.hasPointerReverseSearchSource=this.hasReverseSearchSourcesForPointerSummary()}},{key:"getSearchSources",value:function(){var e=this.searchSourceService.getSources().filter(gk).filter((function(e){return e.available&&"map"!==e.getId()&&e.showInSettings})),t=this.searchSourceService.getSources().filter(fk).filter((function(e){return e.available&&"map"!==e.getId()&&e.showInSettings})),i=e.concat(t);return this.computeSourcesCheckAllBehavior(i),i}},{key:"hasReverseSearchSourcesForPointerSummary",value:function(){return!!this.searchSourceService.getEnabledSources().filter(mk).length}},{key:"settingsValueCheckedCheckbox",value:function(e,t,i,o){o.enabled=e.checked,t.setParamFromSetting(i),this.searchSourceChange.emit(t)}},{key:"computeSettingCheckAllBehavior",value:function(e){e.allEnabled=void 0===e.allEnabled?!e.values.find((function(e){return e.enabled})):!e.allEnabled}},{key:"computeSourcesCheckAllBehavior",value:function(e){var t=e.filter((function(e){return e.enabled})).length,i=e.filter((function(e){return!e.enabled})).length;this.searchSourcesAllEnabled=!(t>=i)}},{key:"checkUncheckAll",value:function(e,t,i){e.stopPropagation(),this.computeSettingCheckAllBehavior(i),i.values.forEach((function(e){e.enabled=i.allEnabled})),t.setParamFromSetting(i),this.searchSourceChange.emit(t)}},{key:"checkUncheckAllSources",value:function(e){var t=this;e.stopPropagation(),this.getSearchSources().map((function(e){e.enabled=t.searchSourcesAllEnabled,t.searchSourceChange.emit(e)}))}},{key:"settingsValueCheckedRadioButton",value:function(e,t,i,o){i.values.forEach((function(t){t.enabled=t.value!==o.value?!e.source.checked:e.source.checked})),t.setParamFromSetting(i),this.searchSourceChange.emit(t)}},{key:"onCheckSearchSource",value:function(e,t){t.enabled=e.checked,this.searchSourceChange.emit(t)}},{key:"getAvailableValues",value:function(e){return e.values.filter((function(e){return!1!==e.available}))}},{key:"getAvailableHashtagsValues",value:function(e){if(e.hashtags)return e.hashtags.map((function(e){return"#"+e})).join(", ")}},{key:"stopPropagation",value:function(e){e.stopPropagation()}},{key:"changePointerReverseSearch",value:function(e,t){t?(e.stopPropagation(),this.pointerSummaryEnabled=!this.pointerSummaryEnabled):this.pointerSummaryEnabled=e.checked,this.pointerSummaryStatus.emit(this.pointerSummaryEnabled)}},{key:"isTouchScreen",get:function(){return this.mediaService.isTouchScreen()}}]),e}()).\u0275fac=function(e){return new(e||iS)(r.Rb(pk),r.Rb(Ae))},iS.\u0275cmp=r.Lb({type:iS,selectors:[["igo-search-settings"]],hostBindings:function(e,t){1&e&&r.ec("keydown",(function(e){return t.handleKeyboardEvent(e)}),!1,r.xc)},inputs:{pointerSummaryEnabled:"pointerSummaryEnabled"},outputs:{searchSourceChange:"searchSourceChange",pointerSummaryStatus:"pointerSummaryStatus"},decls:9,vars:7,consts:[[1,"igo-search-settings"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"igo-search-settings-button",3,"matTooltip","matMenuTriggerFor"],["svgIcon","chevron-down"],[1,"no-border-radius"],["searchSettingsMenu","matMenu"],["class","checkAllButton",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"checkAllButton"],["mat-raised-button","",3,"click"],[1,"igo-search-settings-search-source"],[1,"igo-search-settings-checkbox",3,"checked","value","click","change"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["sub_menu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item",""],["yPosition","above",3,"ngSwitch"],["test_sub_menu","matMenu"],[4,"ngSwitchCase"],[1,"igo-search-settings-radio-group",3,"value"],["class","mat-typography",3,"value","checked","click","change",4,"ngFor","ngForOf"],[1,"mat-typography",3,"value","checked","click","change"],["class","mat-menu-item",3,"checked","value","matTooltip","click","change",4,"ngFor","ngForOf"],[1,"mat-menu-item",3,"checked","value","matTooltip","click","change"],[1,"pointer-summary-slide-toggle-container","mat-typography"],["tooltip-position","below","matTooltipShowDelay","500",1,"pointer-summary-option",3,"matTooltip","checked","labelPosition","change","click"]],template:function(e,t){if(1&e&&(r.Xb(0,"div",0),r.Xb(1,"button",1),r.jc(2,"translate"),r.Sb(3,"mat-icon",2),r.Wb(),r.Xb(4,"mat-menu",3,4),r.Gc(6,_p,5,5,"div",5),r.Gc(7,Wp,8,5,"ng-container",6),r.Gc(8,Xp,7,8,"span",7),r.Wb(),r.Wb()),2&e){var i=r.vc(5);r.Db(1),r.oc("matTooltip",r.kc(2,5,"igo.geo.search.menu.tooltip"))("matMenuTriggerFor",i),r.Db(5),r.oc("ngIf",t.getSearchSources().length>4),r.Db(1),r.oc("ngForOf",t.getSearchSources()),r.Db(1),r.oc("ngIf",t.hasPointerReverseSearchSource&&!t.isTouchScreen)}},directives:[l.a,g.a,y.c,u.a,y.d,m.l,m.k,v.a,y.a,m.n,m.o,Ll.b,Ll.a,yl.a,kl.a],pipes:[U.d],styles:[".checkAllButton[_ngcontent-%COMP%]{padding:0 5px;text-align:center}.igo-search-settings-button[_ngcontent-%COMP%]     div.mat-button-ripple-round{border-radius:0}.igo-search-settings-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.igo-search-settings-radio-group[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin:5px}.igo-search-settings-checkbox[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{display:flex}.igo-search-settings-search-source[_ngcontent-%COMP%]{display:flex;width:100%}.igo-search-settings-search-source[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{display:flex;margin-left:5px;margin-right:5px}.pointer-summary-option[_ngcontent-%COMP%]{display:block;margin-bottom:15px;margin-right:10px}.pointer-summary-slide-toggle-container[_ngcontent-%COMP%]{overflow-x:hidden}.pointer-summary-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:10px}"],changeDetection:0}),iS),gS=((tS=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:tS}),tS.\u0275inj=r.Ob({factory:function(e){return new(e||tS)},imports:[[m.c,g.b,u.b,l.b,y.b,Ll.c,v.b,yl.b,kl.b,Ce]]}),tS),fS=((eS=function(){function e(t,i,o){_classCallCheck(this,e),this.languageService=t,this.searchService=i,this.searchSourceService=o,this.placeholder$=new L.a("igo.geo.search.placeholder"),this.empty$=new L.a(!0),this.stream$=new L.a(""),this.searchTypes=uS,this.searchType$=new L.a(void 0),this.pointerSummaryStatus=new r.o,this.term$=new L.a(""),this.disabled$=new L.a(!1),this.pointerSummaryEnabled=!1,this.floatLabel="never",this.appearance="legacy",this.color="primary",this.debounce=200,this.minLength=2,this.searchSelector=!1,this.searchSettings=!1,this.forceNA=!1,this.searchTermChange=new r.o,this.search=new r.o,this.searchTypeChange=new r.o,this.clearFeature=new r.o,this.searchSettingsChange=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.term$$=this.term$.subscribe((function(t){e.empty$.next(void 0===t||0===t.length)})),this.stream$$=this.stream$.pipe(Object(yc.a)((function(t){return""===t?pc.a:Object(gc.a)(e.debounce)}))).subscribe((function(t){return e.onSetTerm(t)})),this.handlePlaceholder(),this.searchType$$=this.searchType$.pipe(Object(A.a)()).subscribe((function(t){return e.onSetSearchType(t)}))}},{key:"ngOnDestroy",value:function(){this.term$$.unsubscribe(),this.stream$$.unsubscribe(),this.searchType$$.unsubscribe()}},{key:"onKeyup",value:function(e){this.keyIsValid(e.key)&&this.setTerm(e.target.value)}},{key:"onClearButtonClick",value:function(){this.clear(),this.clearFeature.emit()}},{key:"onSearchTypeChange",value:function(e){this.setSearchType(e)}},{key:"setSearchType",value:function(e){this.searchType$.next(e)}},{key:"onSearchSettingsChange",value:function(){this.doSearch(this.term),this.searchSettingsChange.emit(),this.handlePlaceholder()}},{key:"setTerm",value:function(e){if(!this.disabled){(e=e||"")!==this.term&&this.term$.next(e);var t=e.replace(/(#[^\s]*)/g,"").trim();(t.length>=this.minLength||0===t.length)&&this.stream$.next(e)}}},{key:"clear",value:function(){this.term$.next(""),this.stream$.next(""),this.input.nativeElement.focus()}},{key:"keyIsValid",value:function(t){return-1===e.invalidKeys.indexOf(t)}},{key:"onSetTerm",value:function(e){this.searchTermChange.emit(e),this.doSearch(e)}},{key:"handlePlaceholder",value:function(){var e=_toConsumableArray(new Set(this.searchSourceService.getEnabledSources().filter((function(e){return!["map","coordinatesreverse"].includes(e.getId())})).map((function(e){return e.getType()})))),t="igo.geo.search.placeholder";1===e.length?t="igo.geo.search.".concat(e[0].toLowerCase(),".placeholder"):0===e.length&&(t="igo.geo.search.emptyType.placeholder"),this.placeholder$.next(t)}},{key:"onSetSearchType",value:function(e){if(null!=e){this.searchTypeChange.emit(e);var t="igo.geo.search.".concat(e.toLowerCase(),".placeholder");this.placeholder$.next(t),this.setTerm(this.term)}}},{key:"doSearch",value:function(e){var t=this;if(this.researches$$&&(this.researches$$.map((function(e){return e.unsubscribe()})),this.researches$$=void 0),""!==(e?e.replace(/(#[^\s]*)/g,"").trim():"")){var i=this.searchService.search(e,{forceNA:this.forceNA});this.researches$$=i.map((function(e){return e.request.subscribe((function(i){t.onResearchCompleted(e,i)}))}))}else void 0!==this.store&&this.store.clear()}},{key:"onResearchCompleted",value:function(e,t){if(this.search.emit({research:e,results:t}),void 0!==this.store){var i=this.store.all().filter((function(t){return t.source!==e.source})).concat(t);this.store.load(i)}}},{key:"searchType",set:function(e){this.setSearchType(e)},get:function(){return this.searchType$.value}},{key:"term",set:function(e){this.setTerm(e)},get:function(){return this.term$.value}},{key:"disabled",set:function(e){this.disabled$.next(e)},get:function(){return this.disabled$.value}},{key:"empty",get:function(){return 0===this.term.length}}]),e}()).\u0275fac=function(e){return new(e||eS)(r.Rb(Le),r.Rb(vk),r.Rb(pk))},eS.\u0275cmp=r.Lb({type:eS,selectors:[["igo-search-bar"]],viewQuery:function(e,t){var i;1&e&&r.Ec(Gp,!0),2&e&&r.uc(i=r.fc())&&(t.input=i.first)},inputs:{searchTypes:"searchTypes",pointerSummaryEnabled:"pointerSummaryEnabled",floatLabel:"floatLabel",appearance:"appearance",color:"color",debounce:"debounce",minLength:"minLength",searchSelector:"searchSelector",searchSettings:"searchSettings",forceNA:"forceNA",searchType:"searchType",term:"term",disabled:"disabled",placeholder:"placeholder",label:"label",searchIcon:"searchIcon",store:"store"},outputs:{pointerSummaryStatus:"pointerSummaryStatus",searchTermChange:"searchTermChange",search:"search",searchTypeChange:"searchTypeChange",clearFeature:"clearFeature",searchSettingsChange:"searchSettingsChange"},decls:16,vars:28,consts:[[1,"igo-search-bar-container",3,"ngClass"],[3,"floatLabel","appearance"],[4,"ngIf"],["matInput","","autocomplete","off",3,"ngClass","disabled","placeholder","value","keyup","touchend"],["input",""],[1,"search-bar-buttons"],["mat-icon-button","",3,"color",4,"ngIf"],["mat-icon-button","",3,"color","click",4,"ngIf"],[3,"searchTypes","searchType","searchTypeChange",4,"ngIf"],[3,"pointerSummaryEnabled","pointerSummaryStatus","searchSourceChange",4,"ngIf"],["mat-icon-button","",3,"color"],[3,"svgIcon"],["mat-icon-button","",3,"color","click"],["svgIcon","close"],[3,"searchTypes","searchType","searchTypeChange"],[3,"pointerSummaryEnabled","pointerSummaryStatus","searchSourceChange"]],template:function(e,t){1&e&&(r.Xb(0,"div",0),r.jc(1,"async"),r.Xb(2,"mat-form-field",1),r.Gc(3,Bp,2,1,"mat-label",2),r.Xb(4,"input",3,4),r.ec("keyup",(function(e){return t.onKeyup(e)}))("touchend",(function(e){return t.onKeyup(e)})),r.jc(6,"async"),r.jc(7,"async"),r.jc(8,"translate"),r.jc(9,"async"),r.Wb(),r.Wb(),r.Xb(10,"div",5),r.Gc(11,Vp,2,2,"button",6),r.Gc(12,Np,2,1,"button",7),r.jc(13,"async"),r.Gc(14,zp,2,4,"igo-search-selector",8),r.Gc(15,qp,1,1,"igo-search-settings",9),r.Wb(),r.Wb()),2&e&&(r.oc("ngClass",r.rc(24,Hp,r.kc(1,12,t.empty$))),r.Db(2),r.oc("floatLabel",t.floatLabel)("appearance",t.appearance),r.Db(1),r.oc("ngIf",t.label),r.Db(1),r.oc("ngClass",r.rc(26,Up,t.searchIcon))("disabled",r.kc(6,14,t.disabled$))("placeholder",t.placeholder?t.placeholder:r.kc(7,16,t.placeholder$)?r.kc(8,18,t.placeholder$.value):void 0)("value",r.kc(9,20,t.term$)),r.Db(7),r.oc("ngIf",void 0!==t.searchIcon),r.Db(1),r.oc("ngIf",!r.kc(13,22,t.empty$)),r.Db(2),r.oc("ngIf",t.searchSelector),r.Db(1),r.oc("ngIf",t.searchSettings))},directives:[m.j,it.c,m.l,et.b,it.f,l.a,u.a,hS,pS],pipes:[m.b,U.d],styles:['[_nghost-%COMP%]     .mat-form-field{padding:0 5px}[_nghost-%COMP%]     .mat-form-field-wrapper{margin-bottom:-1.5em}[_nghost-%COMP%]     span.mat-form-field-label-wrapper{top:-20px}[_nghost-%COMP%]     div.mat-form-field-infix{left:5px;padding:0 0 12px!important;right:5px}[_nghost-%COMP%]     div.mat-form-field-underline{display:none}.igo-search-bar-container[_ngcontent-%COMP%]{display:inline-flex;overflow:hidden;position:relative;width:100%}.igo-search-bar-container[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%]{width:calc(100% - 80px)}.igo-search-bar-container.empty[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%]{width:calc(100% - 40px)}.search-bar-buttons[_ngcontent-%COMP%]{display:inline-flex;position:relative;right:0;top:0}.search-bar-buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]:nth-child(2):before{border-right:1px solid #ddd;content:"";height:28px;left:0;top:5px}igo-search-selector[_ngcontent-%COMP%], igo-search-settings[_ngcontent-%COMP%]{background-color:#fff;border-radius:0;top:0}'],changeDetection:0}),eS.invalidKeys=["Control","Shift","Alt","ArrowDown","ArrowUp","ArrowRight","ArrowLeft"],eS),mS=((Qk=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Qk}),Qk.\u0275inj=r.Ob({factory:function(e){return new(e||Qk)},imports:[[m.c,tt.k,g.b,u.b,l.b,y.b,Ll.c,it.e,et.c,Ce,dS,gS]]}),Qk),bS=function(e){return e.Grouped="grouped",e.Flat="flat",e}({}),vS=((lS=function(){function e(t,i){_classCallCheck(this,e),this.cdRef=t,this.searchService=i,this.searchResultMode=bS,this.pageIterator=[],this.collapsed=[],this.mode=bS.Grouped,this.withZoomButton=!1,this.settingsChange$=new L.a(void 0),this.resultFocus=new r.o,this.resultUnfocus=new r.o,this.resultSelect=new r.o,this.moreResults=new r.o,this.resultMouseenter=new r.o,this.resultMouseleave=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.watcher=new dn(this.store,this.cdRef),this.settingsChange$.subscribe((function(){e.pageIterator=[]}))}},{key:"ngOnDestroy",value:function(){this.watcher.destroy()}},{key:"computeGroupTitle",value:function(e){var t=[e.source.title],i=e.results.length;return i>1&&t.push("(".concat(i,")")),t.join(" ")}},{key:"onResultSelect",value:function(e){this.store.state.get(e)&&!0===this.store.state.get(e).selected||(this.store.state.update(e,{focused:!0,selected:!0},!0),this.resultSelect.emit(e))}},{key:"liftResults",value:function(){var e=this;return this.store.view.all$().pipe(Object(yc.a)((function(e){return 0===e.length?pc.a:Object(gc.a)(200)})),Object(w.a)((function(t){return e.groupResults(t.sort(e.sortByOrder))})))}},{key:"sortByOrder",value:function(e,t){return e.source.displayOrder-t.source.displayOrder}},{key:"groupResults",value:function(e){var t=this,i=new Map;return e.forEach((function(e){var t=e.source,o=i.get(t);void 0===o&&(o=[],i.set(t,o)),o.push(e)})),Array.from(i.keys()).map((function(e){return void 0===t.pageIterator[e.getId()]&&(t.pageIterator[e.getId()]=1),{source:e,results:i.get(e)}}))}},{key:"isMoreResults",value:function(e){return e.results&&!0===e.results[e.results.length-1].meta.nextPage}},{key:"displayMoreResults",value:function(e){var t=this,i={sourceId:e.source.getId(),page:++this.pageIterator[e.source.getId()]};this.searchService.search(this.term,i).map((function(i){i.request.subscribe((function(o){var n=e.results.concat(o);o.length||(n[n.length-1].meta.nextPage=!1),t.moreResults.emit({research:i,results:n})}))}))}},{key:"term",get:function(){return this._term},set:function(e){this._term=e,this.pageIterator=[]}},{key:"results$",get:function(){return void 0===this._results$&&(this._results$=this.liftResults()),this._results$}}]),e}()).\u0275fac=function(e){return new(e||lS)(r.Rb(r.h),r.Rb(vk))},lS.\u0275cmp=r.Lb({type:lS,selectors:[["igo-search-results"]],contentQueries:function(e,t,i){var o;1&e&&r.Kb(i,Yp,!0),2&e&&r.uc(o=r.fc())&&(t.templateSearchToolbar=o.first)},inputs:{mode:"mode",withZoomButton:"withZoomButton",settingsChange$:"settingsChange$",term:"term",map:"map",store:"store",showIcons:"showIcons"},outputs:{resultFocus:"resultFocus",resultUnfocus:"resultUnfocus",resultSelect:"resultSelect",moreResults:"moreResults",resultMouseenter:"resultMouseenter",resultMouseleave:"resultMouseleave"},decls:4,vars:4,consts:[[3,"navigation"],["ngFor","",3,"ngForOf"],["groupTemplate",""],[3,"class","title","collapsed","toggle",4,"ngIf","ngIfElse"],["flatTemplate",""],["storeItemTemplate",""],[3,"title","collapsed","toggle"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","moreResults mat-typography",3,"click",4,"ngIf"],["igoListItem","","color","accent",3,"map","result","showIcons","withZoomButton","focused","selected","focus","unfocus","select","mouseenter","mouseleave"],["igoSearchItemToolbar","",3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"moreResults","mat-typography",3,"click"]],template:function(e,t){1&e&&(r.Xb(0,"igo-list",0),r.Gc(1,rg,5,2,"ng-template",1,2,r.Hc),r.jc(3,"async"),r.Wb()),2&e&&(r.oc("navigation",!0),r.Db(1),r.oc("ngForOf",r.kc(3,2,t.results$)))},directives:function(){return[yr,m.k,m.l,_n,m.q,yS,vr]},pipes:function(){return[m.b,U.d]},styles:[".moreResults[_ngcontent-%COMP%]{color:#00f;cursor:pointer;float:right;margin-right:10px;margin-top:5px}igo-list[_ngcontent-%COMP%]     mat-list{height:100%}"],changeDetection:0}),lS),yS=((cS=function(){function e(){_classCallCheck(this,e),this.withZoomButton=!1,this.zoomEvent=new r.o,this.format=new fl.a}return _createClass(e,[{key:"onZoomHandler",value:function(){var e=this.format.readFeature(this.result.data,{dataProjection:this.result.data.projection,featureProjection:this.map.projection});jf(this.map,[e],Mf.Default)}},{key:"title",get:function(){return Zi(this.result)}},{key:"titleHtml",get:function(){return e=this.result,(t=e.meta||{}).titleHtml?t.titleHtml:Yi(e,t.titleHtmlProperty||"titleHtml");var e,t}},{key:"tooltipHtml",get:function(){return this.titleHtml.replace(/<small?[^>]+(>|$)/g,"\n").replace(/<\/?[^>]+(>|$)/g,"")}},{key:"icon",get:function(){return Ji(this.result)}}]),e}()).\u0275fac=function(e){return new(e||cS)},cS.\u0275cmp=r.Lb({type:cS,selectors:[["igo-search-results-item"]],inputs:{withZoomButton:"withZoomButton",result:"result",map:"map",showIcons:"showIcons"},outputs:{zoomEvent:"zoomEvent"},ngContentSelectors:hg,decls:6,vars:4,consts:[["mat-list-avatar","",3,"svgIcon",4,"ngIf"],["matLine","","matTooltipShowDelay","500","matTooltipClass","search-result-tooltip",3,"innerHtml","matTooltip",4,"ngIf"],["matLine","","matTooltipShowDelay","500",3,"matTooltip",4,"ngIf"],["igoStopPropagation","","mat-icon-button","",3,"click",4,"ngIf"],["mat-list-avatar","",3,"svgIcon"],["matLine","","matTooltipShowDelay","500","matTooltipClass","search-result-tooltip",3,"innerHtml","matTooltip"],["matLine","","matTooltipShowDelay","500",3,"matTooltip"],["igoStopPropagation","","mat-icon-button","",3,"click"],["svgIcon","magnify"]],template:function(e,t){1&e&&(r.nc(ug),r.Xb(0,"mat-list-item"),r.Gc(1,ag,1,1,"mat-icon",0),r.Gc(2,sg,1,2,"h4",1),r.Gc(3,cg,2,2,"h4",2),r.Gc(4,lg,2,0,"button",3),r.mc(5),r.Wb()),2&e&&(r.Db(1),r.oc("ngIf",t.icon),r.Db(1),r.oc("ngIf",t.titleHtml),r.Db(1),r.oc("ngIf",!t.titleHtml),r.Db(1),r.oc("ngIf",t.withZoomButton))},directives:[h.d,m.l,u.a,h.b,dt.k,g.a,l.a,ir],styles:["[_nghost-%COMP%]     small{color:#8c8c8c}  .search-result-tooltip{white-space:pre-line}"],changeDetection:0}),cS),kS=((sS=function(){function e(t){_classCallCheck(this,e),this.layerService=t,this.tooltip$=new L.a("igo.geo.catalog.layer.addToMap"),this.inRange$=new L.a(!0),this.isPreview$=new L.a(!1),this.layersSubcriptions=[],this.mouseInsideAdd=!1,this._color="primary"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;"Layer"===this.layer.meta.dataType&&(this.added=-1!==this.map.layers.findIndex((function(t){return t.id===e.layer.data.sourceOptions.id}))),this.resolution$$=this.map.viewController.resolution$.subscribe((function(t){e.isInResolutionsRange(t),e.tooltip$.next(e.computeTooltip())}))}},{key:"ngOnDestroy",value:function(){this.resolution$$.unsubscribe()}},{key:"onMouseEvent",value:function(e){this.onToggleClick(e)}},{key:"onToggleClick",value:function(e){var t=this;if(void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),"mouseenter"!==e.type||!this.mouseInsideAdd)switch(e.type){case"click":this.isPreview$.value||(this.added?this.remove():this.add()),this.isPreview$.next(!1);break;case"mouseenter":this.isPreview$.value||this.added||(this.lastTimeoutRequest=setTimeout((function(){t.add(),t.isPreview$.next(!0)}),500)),this.mouseInsideAdd=!0;break;case"mouseleave":this.isPreview$.value&&(this.remove(),this.isPreview$.next(!1)),this.mouseInsideAdd=!1}}},{key:"add",value:function(){this.added||(this.added=!0,this.addLayerToMap())}},{key:"remove",value:function(){this.added&&(this.added=!1,this.removeLayerFromMap(),this.layersSubcriptions.map((function(e){return e.unsubscribe()})),this.layersSubcriptions=[])}},{key:"addLayerToMap",value:function(){var e=this;if(void 0!==this.map&&"Layer"===this.layer.meta.dataType){var t=this.layer.data;void 0===t.sourceOptions.optionsFromApi&&(t.sourceOptions.optionsFromApi=!0),this.layersSubcriptions.push(this.layerService.createAsyncLayer(t).subscribe((function(t){return e.map.addLayer(t)})))}}},{key:"removeLayerFromMap",value:function(){if(void 0!==this.map&&"Layer"===this.layer.meta.dataType){var e=this.map.getLayerById(this.layer.data.sourceOptions.id);this.map.removeLayer(e)}}},{key:"isInResolutionsRange",value:function(e){this.inRange$.next(e>=(this.layer.data.minResolution||0)&&e<=(this.layer.data.maxResolution||1/0))}},{key:"computeTooltip",value:function(){return this.added?this.inRange$.value?"igo.geo.catalog.layer.removeFromMap":"igo.geo.catalog.layer.removeFromMapOutRange":this.inRange$.value?"igo.geo.catalog.layer.addToMap":"igo.geo.catalog.layer.addToMapOutRange"}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}}]),e}()).\u0275fac=function(e){return new(e||sS)(r.Rb(Ff))},sS.\u0275cmp=r.Lb({type:sS,selectors:[["igo-search-add-button"]],inputs:{color:"color",added:"added",layer:"layer",map:"map"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click"],["matBadge","","igoMatBadgeIcon","eye-off","igoMatBadgeInverseColor","true","matBadgeDisabled","true","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","svgIcon"]],template:function(e,t){1&e&&r.Gc(0,dg,7,14,"button",0),2&e&&r.oc("ngIf","Layer"===t.layer.meta.dataType)},directives:[m.l,l.a,g.a,u.a,Ze.a,On],pipes:[U.d,m.b],styles:[""],changeDetection:0}),sS),SS=((aS=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:aS}),aS.\u0275inj=r.Ob({factory:function(e){return new(e||aS)},imports:[[m.c,Ze.b,g.b,u.b,h.e,l.b,Mn,kr,or,Ce,In,xg]]}),aS),CS=((rS=function(){function e(t,i,o,n){_classCallCheck(this,e),this.component=t,this.searchService=i,this.searchSourceService=o,this.mediaService=n,this.pointerSearchStore=new hn([]),this.reverseSearch$$=[],this.hasPointerReverseSearchSource=!1,this.searchPointerSummaryFeatureId="searchPointerSummaryFeatureId",this.igoSearchPointerSummaryDelay=1e3,this.igoSearchPointerSummaryEnabled=!1}return _createClass(e,[{key:"mouseout",value:function(){clearTimeout(this.lastTimeoutRequest),this.clearLayer()}},{key:"ngOnInit",value:function(){var e=this;this.listenToMapPointerMove(),this.subscribeToPointerStore(),this.map.status$.pipe(Object(He.a)(1)).subscribe((function(){e.store=new $f([],{map:e.map}),e.initStore()})),this.layers$$=this.map.layers$.subscribe((function(t){e.store&&!t.find((function(e){return"searchPointerSummaryId"===e.id}))&&e.initStore()}))}},{key:"initStore",value:function(){Rf(this.store,new wf({id:"searchPointerSummaryId",title:"searchPointerSummary",zIndex:900,source:new Pg,showInLayerList:!1,exportable:!1,browsable:!1,style:wS}))}},{key:"ngAfterContentChecked",value:function(){this.hasPointerReverseSearchSource=!!this.searchSourceService.getEnabledSources().filter(mk).length}},{key:"ngOnDestroy",value:function(){this.unlistenToMapPointerMove(),this.unsubscribeToPointerStore(),this.unsubscribeReverseSearch(),this.layers$$.unsubscribe()}},{key:"subscribeToPointerStore",value:function(){var e=this;this.store$$=this.pointerSearchStore.entities$.subscribe((function(t){e.entitiesToPointerOverlay(t)}))}},{key:"computeSummaryClosestFeature",value:function(e){var t={};return e.map((function(e){e.data.properties.type&&e.data.properties.distance>=0&&(t.hasOwnProperty(e.data.properties.type)?e.data.properties.distance<t[e.data.properties.type].distance&&(t[e.data.properties.type]={distance:e.data.properties.distance,title:e.meta.title}):t[e.data.properties.type]={distance:e.data.properties.distance,title:e.meta.title})})),t}},{key:"entitiesToPointerOverlay",value:function(e){var t=this.computeSummaryClosestFeature(e),i=Object.keys(t),o=[],n=[];e.map((function(e){var r=i.indexOf(e.data.properties.type);-1!==r?(n.push(t[e.data.properties.type].title),i.splice(r,1),o.push(e.data.properties.type)):-1===o.indexOf(e.data.properties.type)&&n.push(e.meta.title)})),n.length&&this.addPointerOverlay(n.join("\n"))}},{key:"listenToMapPointerMove",value:function(){var e=this;this.pointerMoveListener=this.map.ol.on("pointermove",(function(t){return e.onMapEvent(t)}))}},{key:"unsubscribeToPointerStore",value:function(){this.store$$.unsubscribe()}},{key:"unsubscribeReverseSearch",value:function(){this.reverseSearch$$.map((function(e){return e.unsubscribe()})),this.reverseSearch$$=[]}},{key:"unlistenToMapPointerMove",value:function(){this.map.ol.un(this.pointerMoveListener.type,this.pointerMoveListener.listener),this.pointerMoveListener=void 0}},{key:"onMapEvent",value:function(e){var t=this;!e.dragging&&this.igoSearchPointerSummaryEnabled&&this.hasPointerReverseSearchSource&&!this.mediaService.isTouchScreen()?(void 0!==this.lastTimeoutRequest&&(clearTimeout(this.lastTimeoutRequest),this.clearLayer(),this.unsubscribeReverseSearch()),this.lonLat=Object(kc.r)(e.coordinate,this.mapProjection,"EPSG:4326"),this.lastTimeoutRequest=setTimeout((function(){t.onSearchCoordinate()}),this.igoSearchPointerSummaryDelay)):this.clearLayer()}},{key:"onSearchCoordinate",value:function(){var e=this;this.pointerSearchStore.clear();var t=this.searchService.reverseSearch(this.lonLat,{params:{geometry:"false",icon:"false"}},!0),i=function(i){t.length>0&&e.reverseSearch$$.push(t[i].request.subscribe((function(o){e.onSearch({research:t[i],results:o})})))};for(var o in t)i(o)}},{key:"onSearch",value:function(e){var t=e.results,i=this.pointerSearchStore.all().filter((function(t){return t.source!==e.research.source})).concat(t);this.pointerSearchStore.load(i)}},{key:"addPointerOverlay",value:function(e){this.clearLayer();var t=new bl.d(Object(kc.r)(this.lonLat,"EPSG:4326",this.mapProjection)),i=new Vc.a({geometry:t}),o=(new fl.a).writeGeometryObject(t,{featureProjection:this.mapProjection,dataProjection:this.mapProjection});this.store.setLayerFeatures([{type:_f,geometry:o,projection:this.mapProjection,properties:{id:this.searchPointerSummaryFeatureId,pointerSummary:e},meta:{id:this.searchPointerSummaryFeatureId},ol:i}],Mf.None)}},{key:"clearLayer",value:function(){this.store&&this.store.clearLayer()}},{key:"map",get:function(){return this.component.map}},{key:"mapProjection",get:function(){return this.component.map.projection}}]),e}()).\u0275fac=function(e){return new(e||rS)(r.Rb(om,2),r.Rb(vk),r.Rb(pk),r.Rb(Ae))},rS.\u0275dir=r.Mb({type:rS,selectors:[["","igoSearchPointerSummary",""]],hostBindings:function(e,t){1&e&&r.ec("mouseout",(function(){return t.mouseout()}))},inputs:{igoSearchPointerSummaryDelay:"igoSearchPointerSummaryDelay",igoSearchPointerSummaryEnabled:"igoSearchPointerSummaryEnabled"}}),rS);function wS(e,t){return new Uc.Style({image:new Uc.Icon({src:"./assets/igo2/geo/icons/cross_black_18px.svg",imgSize:[18,18]}),text:new Uc.Text({text:e.get("pointerSummary"),textAlign:"left",textBaseline:"bottom",font:"12px Calibri,sans-serif",fill:new Uc.Fill({color:"#000"}),backgroundFill:new Uc.Fill({color:"rgba(255, 255, 255, 0.5)"}),backgroundStroke:new Uc.Stroke({color:"rgba(200, 200, 200, 0.75)",width:2}),stroke:new Uc.Stroke({color:"#fff",width:3}),overflow:!0,offsetX:10,offsetY:-10,padding:[2.5,2.5,2.5,2.5]})})}var xS,OS,IS=((OS=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:pk,useFactory:Mk,deps:[Qm]},{provide:jk,useFactory:Ek,deps:[Le]},{provide:Vk,useFactory:zk,deps:[Le]},{provide:Yk,useFactory:Zk,deps:[Le]}]}}}]),e}()).\u0275mod=r.Pb({type:OS}),OS.\u0275inj=r.Ob({factory:function(e){return new(e||OS)},imports:[[m.c,mS,dS,SS,gS],mS,dS,SS,gS]}),OS),LS=((xS=function(){function e(t){_classCallCheck(this,e),this.cdRef=t,this.complete=new r.o,this.cancel=new r.o}return _createClass(e,[{key:"onUpdateInputs",value:function(){this.cdRef.detectChanges()}},{key:"onClose",value:function(){this.cancel.emit()}}]),e}()).\u0275fac=function(e){return new(e||xS)(r.Rb(r.h))},xS.\u0275cmp=r.Lb({type:xS,selectors:[["igo-ogc-filter"]],inputs:{layer:"layer",map:"map"},outputs:{complete:"complete",cancel:"cancel"},decls:1,vars:3,consts:[["igoListItem","",3,"layer","header","map"]],template:function(e,t){1&e&&r.Sb(0,"igo-ogc-filterable-item",0),2&e&&r.oc("layer",t.layer)("header",!1)("map",t.map)},directives:[Uv],styles:[""],changeDetection:0}),xS),TS=new r.s("OgcFilterWidget");function FS(e){return e.create(LS)}var _S,MS,DS,PS,AS,jS,RS,$S=((_S=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:_S}),_S.\u0275inj=r.Ob({factory:function(e){return new(e||_S)},imports:[[m.c,l.b,Ce,oy]]}),_S),ES=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this,e)).options=e,o}return _createClass(i,[{key:"layer",get:function(){return this.options.layer}},{key:"map",get:function(){return this.options.map}}]),i}(fa),WS=((MS=function(){function e(t){_classCallCheck(this,e),this.storageService=t}return _createClass(e,[{key:"createWorkspace",value:function(e,t){var i=new ES({id:e.id,title:e.title,layer:e,map:t,entityStore:this.createFeatureStore(e,t),actionStore:new kn([]),meta:{tableTemplate:void 0}});return this.createTableTemplate(i,e),i}},{key:"createFeatureStore",value:function(e,t){var i=new $f([],{map:t});i.bindLayer(e);var o=new Xf({}),n=new Ef({}),r=new fn({}),a=new Bf({layer:new wf({zIndex:300,source:new Pg,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?Mf.Default:Mf.None,many:!0,dragBox:!0});return this.storageService.set("rowsInMapExtent",!0,je.SESSION),i.addStrategy(o,!0),i.addStrategy(n,!0),i.addStrategy(a,!0),i.addStrategy(r,!1),i.addStrategy(this.createFilterInMapExtentStrategy(),!0),i}},{key:"createTableTemplate",value:function(e,t){var i=t.dataSource.options.sourceFields||[];if(0!==i.length){var o=i.map((function(e){return{name:"properties."+e.name,title:e.alias?e.alias:e.name}}));e.meta.tableTemplate={selection:!0,sort:!0,columns:o}}else e.entityStore.entities$.pipe(Object(mc.a)((function(e){return 0===e.length})),Object(He.a)(1)).subscribe((function(t){var i=t[0].ol.getKeys().filter((function(e){return!e.startsWith("_")&&"geometry"!==e&&e!==t[0].ol.getGeometryName()&&!e.match(/boundedby/gi)})).map((function(e){return{name:"properties."+e,title:e}}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}}))}},{key:"createFilterInMapExtentStrategy",value:function(){return new gn({filterClauseFunc:function(e){return!0===e.state.inMapExtent}})}},{key:"zoomAuto",get:function(){return this.storageService.get("zoomAuto")}}]),e}()).\u0275fac=function(e){return new(e||MS)(r.bc($e))},MS.\u0275prov=Object(r.Nb)({factory:function(){return new MS(Object(r.bc)($e))},token:MS,providedIn:"root"}),MS),XS=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var o;return _classCallCheck(this,i),(o=t.call(this,e)).options=e,o}return _createClass(i,[{key:"layer",get:function(){return this.options.layer}},{key:"map",get:function(){return this.options.map}}]),i}(fa),GS=((jS=function(){function e(t){_classCallCheck(this,e),this.storageService=t}return _createClass(e,[{key:"createWorkspace",value:function(e,t){var i=new XS({id:e.id,title:e.title,layer:e,map:t,entityStore:this.createFeatureStore(e,t),actionStore:new kn([]),meta:{tableTemplate:void 0}});return this.createTableTemplate(i,e),i}},{key:"createFeatureStore",value:function(e,t){var i=new $f([],{map:t});i.bindLayer(e);var o=new Xf({}),n=new Ef({}),r=new fn({}),a=new Bf({layer:new wf({zIndex:300,source:new Pg,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?Mf.Default:Mf.None,many:!0,dragBox:!0});return this.storageService.set("rowsInMapExtent",!0,je.SESSION),i.addStrategy(o,!0),i.addStrategy(n,!0),i.addStrategy(a,!0),i.addStrategy(r,!1),i.addStrategy(this.createFilterInMapExtentStrategy(),!0),i}},{key:"createTableTemplate",value:function(e,t){var i=t.dataSource.options.sourceFields||[];if(0!==i.length){var o=i.map((function(e){return{name:"properties."+e.name,title:e.alias?e.alias:e.name}}));e.meta.tableTemplate={selection:!0,sort:!0,columns:o}}else e.entityStore.entities$.pipe(Object(mc.a)((function(e){return 0===e.length})),Object(He.a)(1)).subscribe((function(t){var i=t[0].ol.getKeys().filter((function(e){return!e.startsWith("_")&&"geometry"!==e&&e!==t[0].ol.getGeometryName()&&!e.match(/boundedby/gi)})).map((function(e){return{name:"properties."+e,title:e}}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}}))}},{key:"createFilterInMapExtentStrategy",value:function(){return new gn({filterClauseFunc:function(e){return!0===e.state.inMapExtent}})}},{key:"zoomAuto",get:function(){return this.storageService.get("zoomAuto")}}]),e}()).\u0275fac=function(e){return new(e||jS)(r.bc($e))},jS.\u0275prov=Object(r.Nb)({factory:function(){return new jS(Object(r.bc)($e))},token:jS,providedIn:"root"}),jS),BS=((AS=function(){function e(t,i,o){_classCallCheck(this,e),this.component=t,this.wfsWorkspaceService=i,this.featureWorkspaceService=o,this.entities$$=[]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.layers$$=this.map.layers$.pipe(Object(O.a)(50)).subscribe((function(t){return e.onLayersChange(t)}))}},{key:"ngOnDestroy",value:function(){this.layers$$.unsubscribe(),this.entities$$.map((function(e){return e.unsubscribe()}))}},{key:"onLayersChange",value:function(e){var t=this,i=e.filter((function(e){return t.layerIsEditable(e)})),o=i.map((function(e){return e.id})),n=i.map((function(e){return t.getOrCreateWorkspace(e)})).filter((function(e){return void 0!==e})),r=this.workspaceStore.all().filter((function(e){return o.indexOf(e.id)<0}));r.length>0&&(r.forEach((function(e){e.entityStore.deactivateStrategyOfType(Ef),e.deactivate()})),this.workspaceStore.state.updateMany(r,{active:!1,selected:!1}),this.workspaceStore.deleteMany(r)),n.length>0&&this.workspaceStore.insertMany(n)}},{key:"getOrCreateWorkspace",value:function(e){if(void 0===this.workspaceStore.get(e.id)){if(e.dataSource instanceof zg)return this.wfsWorkspaceService.createWorkspace(e,this.map);if(e.dataSource instanceof Pg&&!0===e.exportable)return this.featureWorkspaceService.createWorkspace(e,this.map)}}},{key:"layerIsEditable",value:function(e){var t=e.dataSource;if(t instanceof zg)return!0;if(t instanceof Pg)return!0;if(t instanceof Kg){var i=t.options||{};return i.ogcFilters&&i.ogcFilters.enabled}return!1}},{key:"workspaceStore",get:function(){return this.component.store}}]),e}()).\u0275fac=function(e){return new(e||AS)(r.Rb(pa),r.Rb(WS),r.Rb(GS))},AS.\u0275dir=r.Mb({type:AS,selectors:[["","igoWorkspaceSelector",""]],inputs:{map:"map"}}),AS),VS=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=r.Pb({type:e}),e.\u0275inj=r.Ob({factory:function(t){return new(t||e)},imports:[[m.c]]}),e}(),NS=((PS=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:PS}),PS.\u0275inj=r.Ob({factory:function(e){return new(e||PS)},imports:[[m.c]]}),PS),zS=((DS=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:DS}),DS.\u0275inj=r.Ob({factory:function(e){return new(e||DS)},providers:[{provide:TS,useFactory:FS,deps:[ua]}],imports:[[m.c,ha,VS,NS,$S],VS,NS,$S]}),DS),qS=function(e){return e[e.GeoJSON=0]="GeoJSON",e[e.JSON=1]="JSON",e}({}),HS=function(e){return e.Route="Route",e.Trip="Trip",e}({}),US=((RS=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o){var n;return _classCallCheck(this,i),(n=t.call(this)).http=e,n.config=o,n.directionsUrl="https://geoegl.msp.gouv.qc.ca/services/itineraire/route/v1/driving/",n.options=n.config.getConfig("directionsSources.osrm")||{},n.directionsUrl=n.options.url||n.directionsUrl,n}return _createClass(i,[{key:"getName",value:function(){return i._name}},{key:"route",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.getRouteParams(i);return this.http.get(this.directionsUrl+e.join(";"),{params:o}).pipe(Object(w.a)((function(e){return t.extractRoutesData(e)})))}},{key:"extractRoutesData",value:function(e){var t=this,i=[];return e.routes.forEach((function(o){i.push(t.formatRoute(o,e.waypoints))})),i}},{key:"getRouteParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.alternatives=void 0===e.alternatives||e.alternatives,e.steps=void 0===e.steps||e.steps,e.geometries=void 0!==e.geometries?e.geometries:"geojson",e.overview=void 0!==e.overview&&e.overview,new k.g({fromObject:{alternatives:e.alternatives?"true":"false",overview:e.overview?"simplified":"full",steps:e.steps?"true":"false",geometries:e.geometries?e.geometries:"geojson"}})}},{key:"formatRoute",value:function(e,t){var o=[];return e.legs.forEach((function(e){e.steps.forEach((function(e){o.push(e)}))})),{id:G(),title:e.legs[0].summary,source:i._name,sourceType:HS.Route,order:1,format:qS.GeoJSON,icon:"directions",projection:"EPSG:4326",waypoints:t,distance:e.distance,duration:e.duration,geometry:e.geometry,legs:e.legs,steps:o,weight:e.weight,weight_name:e.weight_name}}},{key:"enabled",get:function(){return!1!==this.options.enabled},set:function(e){this.options.enabled=e}}]),i}(yk)).\u0275fac=function(e){return new(e||RS)(r.bc(k.b),r.bc(ie))},RS.\u0275prov=r.Nb({token:RS,factory:RS.\u0275fac}),RS._name="OSRM Qu\xe9bec",RS);function YS(e,t){return new US(e,t)}var KS,ZS=((KS=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o,n){var r;return _classCallCheck(this,i),(r=t.call(this,n)).http=e,r.languageService=o,r}return _createClass(i,[{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){return{title:"Cadastre (Qu\xe9bec)",searchUrl:"https://carto.cptaq.gouv.qc.ca/php/find_lot_v1.php?"}}},{key:"search",value:function(e,t){var i=this;e=(e=(e=e.endsWith(",")?e.slice(0,-1):e).startsWith(",")?e.substr(1):e).replace(/ /g,"");var o=this.computeSearchRequestParams(e,t||{});return o.get("numero")&&o.get("numero").match(/^[0-9,]+$/g)?this.http.get(this.searchUrl,{params:o,responseType:"text"}).pipe(Object(w.a)((function(e){return i.extractResults(e)}))):Object(F.a)([])}},{key:"computeSearchRequestParams",value:function(e,t){return new k.g({fromObject:Object.assign({numero:e,epsg:"4326"},this.params,t.params||{})})}},{key:"extractResults",value:function(e){var t=this;return e.split("<br />").filter((function(e){return e.length>0})).map((function(e){return t.dataToResult(e)}))}},{key:"dataToResult",value:function(e){var t=e.split(";"),i=t[0],o=this.computeGeometry(t[7]),n={NoLot:i,Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"},r=[this.getId(),"cadastre",i].join(".");return{source:this,meta:{dataType:_f,id:r,title:i,icon:"map-marker"},data:{type:_f,projection:"EPSG:4326",geometry:o,properties:n,meta:{id:r,title:i}}}}},{key:"computeGeometry",value:function(e){var t=(new Fc.a).readFeature(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});return{type:t.getGeometry().getType(),coordinates:t.getGeometry().getCoordinates()}}}]),i}(Qm)).\u0275fac=function(e){return new(e||KS)(r.bc(k.b),r.bc(Le),r.bc("options"))},KS.\u0275prov=r.Nb({token:KS,factory:KS.\u0275fac}),KS.id="cadastre",KS.type=_f,KS);function JS(e,t,i){return new ZS(e,t,i.getConfig("searchSources."+ZS.id))}var QS,eC=((QS=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,o){var n;return _classCallCheck(this,i),(n=t.call(this,o)).http=e,n}return _createClass(i,[{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){return{title:"Nominatim (OSM)",searchUrl:"https://nominatim.openstreetmap.org/search",settings:[{type:"checkbox",title:"results type",name:"amenity",values:[{title:"igo.geo.search.nominatim.type.food",value:"bar,bbq,biergaten,cafe,drinking_water,fast_food,food_court,ice_cream,pub,restaurant",enabled:!1},{title:"igo.geo.search.nominatim.type.health",value:"baby_hatch,clinic,dentist,doctors,hospital,nursing_home,pharmacy,social_facility,veterinary",enabled:!1},{title:"igo.geo.search.nominatim.type.entertainment",value:"arts_centre,brothel,casino,cinema,community_center_fountain,gambling,nightclub,planetarium                           ,public_bookcase,social_centre,stripclub,studio,swingerclub,theatre,internet_cafe",enabled:!1},{title:"igo.geo.search.nominatim.type.finance",value:"atm,bank,bureau_de_change",enabled:!1}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"10",value:10,enabled:!0},{title:"20",value:20,enabled:!1},{title:"50",value:50,enabled:!1}]},{type:"radiobutton",title:"restrictExtent",name:"countrycodes",values:[{title:"igo.geo.search.nominatim.country.canada",value:"CA",enabled:!0},{title:"igo.geo.search.nominatim.country.all",value:null,enabled:!1}]},{type:"radiobutton",title:"multiple object",name:"dedupe",values:[{title:"igo.geo.search.searchSources.settings.true",value:0,enabled:!1},{title:"igo.geo.search.searchSources.settings.false",value:1,enabled:!0}]}]}}},{key:"search",value:function(e,t){var i=this,o=this.computeSearchRequestParams(e,t||{});return o.get("q")?this.http.get(this.searchUrl,{params:o}).pipe(Object(w.a)((function(e){return i.extractResults(e)}))):Object(F.a)([])}},{key:"computeSearchRequestParams",value:function(e,t){return new k.g({fromObject:Object.assign({q:this.computeTerm(e),format:"json"},this.params,t.params||{})})}},{key:"extractResults",value:function(e){var t=this;return e.map((function(e){return t.dataToResult(e)}))}},{key:"dataToResult",value:function(e){var t=this.computeProperties(e),i=this.computeGeometry(e),o=this.computeExtent(e),n=[this.getId(),"place",e.place_id].join(".");return{source:this,meta:{dataType:_f,id:n,title:e.display_name,icon:"map-marker"},data:{type:_f,projection:"EPSG:4326",geometry:i,extent:o,properties:t,meta:{id:n,title:e.display_name}}}}},{key:"computeProperties",value:function(e){return{display_name:e.display_name,place_id:e.place_id,osm_type:e.osm_type,class:e.class,type:e.type}}},{key:"computeGeometry",value:function(e){return{type:"Point",coordinates:[parseFloat(e.lon),parseFloat(e.lat)]}}},{key:"computeExtent",value:function(e){return[parseFloat(e.boundingbox[2]),parseFloat(e.boundingbox[0]),parseFloat(e.boundingbox[3]),parseFloat(e.boundingbox[1])]}},{key:"computeTerm",value:function(e){return this.computeTermTags(e)}},{key:"computeTermTags",value:function(e){var t=_get(_getPrototypeOf(i.prototype),"getHashtagsValid",this).call(this,e,"amenity");return t?t.length?(e=e.replace(/(#[^\s]*)/g,""),t.forEach((function(t){e+="+["+t+"]"})),e):null:this.computeTermSettings(e)}},{key:"computeTermSettings",value:function(e){return this.options.settings.forEach((function(t){"amenity"===t.name&&t.values.forEach((function(t){t.enabled&&"string"==typeof t.value&&t.value.split(",").forEach((function(t){e+="+["+t+"]"}))}))})),e}}]),i}(Qm)).\u0275fac=function(e){return new(e||QS)(r.bc(k.b),r.bc("options"))},QS.\u0275prov=r.Nb({token:QS,factory:QS.\u0275fac}),QS.id="nominatim",QS.type=_f,QS);function tC(e,t){return new eC(e,t.getConfig("searchSources."+eC.id))}function iC(e){return e.entityStore.getStrategyOfType(gn).active$.pipe(Object(w.a)((function(e){return e?"igo.geo.workspace.inMapExtent.active.tooltip":"igo.geo.workspace.inMapExtent.inactive.tooltip"})))}function oC(e){return e.entityStore.getStrategyOfType(gn).active$.pipe(Object(w.a)((function(e){return"igo.geo.workspace.zoomAuto.tooltip"})))}function nC(e){return e.entityStore.stateView.manyBy$((function(e){return!0===e.state.selected})).pipe(Object(w.a)((function(e){return e.length>=1})))}function rC(e,t){if(1&e&&(r.Xb(0,"p"),r.Ic(1),r.Wb()),2&e){var i=r.ic();r.Db(1),r.Jc(i.pointerCoord)}}var aC,sC,cC=f.e.forChild([{path:"simple-map",component:(aC=function(){function e(t,i,o,n){var r=this;_classCallCheck(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.mediaService=n,this.pointerCoordDelay=0,this.map=new tm({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,rotation:.75},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe((function(e){r.map.addLayer(r.layerService.createLayer({title:"OSM",source:e}))}))}return _createClass(e,[{key:"onPointerMove",value:function(e){this.pointerCoord=e}},{key:"media",get:function(){return this.mediaService.getMedia()}},{key:"isTouchScreen",get:function(){return this.mediaService.isTouchScreen()}}]),e}(),aC.\u0275fac=function(e){return new(e||aC)(r.Rb(Le),r.Rb(mf),r.Rb(Ff),r.Rb(Ae))},aC.\u0275cmp=r.Lb({type:aC,selectors:[["app-simple-map"]],decls:18,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/simple-map"],["igoPointerPosition","",3,"map","view","pointerPositionDelay","pointerPositionCoord"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[4,"ngIf"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Simple Map"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"Dependencies: LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"hr"),r.Wb(),r.Xb(13,"igo-map-browser",1),r.ec("pointerPositionCoord",(function(e){return t.onPointerMove(e)})),r.Sb(14,"igo-zoom-button",2),r.Sb(15,"igo-geolocate-button",2),r.Sb(16,"igo-rotation-button",3),r.Wb(),r.Wb(),r.Gc(17,rC,2,1,"p",4)),2&e&&(r.Db(13),r.oc("map",t.map)("view",t.view)("pointerPositionDelay",t.pointerCoordDelay),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("map",t.map)("showIfNoRotation",!0),r.Db(1),r.oc("ngIf",!t.isTouchScreen))},directives:[b.a,b.e,b.f,b.c,om,nm,rm,am,sm,m.l],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),aC)}]),lC=((sC=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:sC}),sC.\u0275inj=r.Ob({factory:function(e){return new(e||sC)},imports:[[m.c,cC,b.d,l.b,Hy]]}),sC);function uC(e,t){if(1&e&&(r.Sb(0,"igo-metadata-button",6),r.Sb(1,"igo-download-button",6),r.Sb(2,"igo-ogc-filter-button",7),r.Sb(3,"igo-time-filter-button",7),r.Sb(4,"igo-track-feature-button",8)),2&e){var i=t.layer;r.oc("layer",i),r.Db(1),r.oc("layer",i),r.Db(1),r.oc("header",!0)("layer",i),r.Db(1),r.oc("header",!0)("layer",i),r.Db(1),r.oc("layer",i)("trackFeature",!0)}}var hC,dC,pC,gC,fC,mC,bC=f.e.forChild([{path:"layer",component:(hC=function e(t,i,o){var n=this;_classCallCheck(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"OSM",visible:!0,baseLayer:!0,source:e}))})),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"}}}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"WFS ",visible:!0,source:e}))})),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:"geojson_utf8",srsName:"EPSG:32198",outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"12072"}},formatOptions:{dataProjection:"EPSG:32198"}}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"WFS (Custom EPSG)",visible:!0,source:e}))})),this.layerService.createAsyncLayer({sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"MELS_CS_ANGLO_S",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"R\xe9seau routier",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",params:{LAYERS:"bgr_v_sous_route_res_sup_act",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"lieu habit\xe9",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",optionsFromCapabilities:!0,params:{LAYERS:"lieuhabite",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"sh_dis_eco",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_dis_eco",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"nurc:Arc_Sample_Parent",visible:!1,legendOptions:{display:!0,stylesAvailable:[{name:"rain",title:"Pluie"},{name:"raster",title:"D\xe9faut"}]},sourceOptions:{type:"wms",url:"https://demo.geo-solutions.it/geoserver/ows",optionsFromCapabilities:!0,params:{LAYERS:"nurc:Arc_Sample",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"Avertissements routier",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",params:{LAYERS:"evenements",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",refreshIntervalSec:15,params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"}}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle",source:e,metadata:{url:"https://www.donneesquebec.ca/recherche/fr/dataset/historique-publique-d-embacles-repertories-au-msp",extern:!0}}))}))},hC.\u0275fac=function(e){return new(e||hC)(r.Rb(Le),r.Rb(mf),r.Rb(Ff))},hC.\u0275cmp=r.Lb({type:hC,selectors:[["app-layer"]],decls:19,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/layer"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],["floatLabel","never",3,"map","layers","expandLegendOfVisibleLayers","queryBadge"],["igoLayerItemToolbar",""],[3,"layer"],[3,"header","layer"],[3,"layer","trackFeature"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Simple Map"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"Dependencies: LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"hr"),r.Wb(),r.Xb(13,"igo-map-browser",1),r.Sb(14,"igo-zoom-button",2),r.Wb(),r.Xb(15,"igo-panel",3),r.Xb(16,"igo-layer-list",4),r.Gc(17,uC,5,8,"ng-template",null,5,r.Hc),r.Wb(),r.Wb(),r.Wb()),2&e&&(r.Db(13),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map),r.Db(2),r.oc("map",t.map)("layers",t.map.layers)("expandLegendOfVisibleLayers",!1)("queryBadge",!0))},directives:[b.a,b.e,b.f,b.c,om,rm,Sr,db,wg,Mb,Kv,Gv,mb],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),hC)}]),vC=((dC=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:dC}),dC.\u0275inj=r.Ob({factory:function(e){return new(e||dC)},imports:[[bC,b.d,l.b,u.b,Cr,Hy,vb,oy,xg,Db]]}),dC),yC=f.e.forChild([{path:"legend",component:(pC=function e(t,i,o){var n=this;_classCallCheck(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"OSM",visible:!0,baseLayer:!0,source:e}))})),this.layerService.createAsyncLayer({title:"legend with display:false",visible:!0,legendOptions:{display:!1,html:"test html"},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_dis_eco",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"legend in html",visible:!0,legendOptions:{display:!0,html:"<h2>HTML l\xe9gende</h2>"},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_sreg_eco",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"legend with url param",visible:!0,legendOptions:{url:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxASEhUQEBISFRUVFRAQFRUQFRUVFRAPFRUWFhUVFRUYHSggGBolGxUVITEiJSkrLi4uFx8zODMsNygtLisBCgoKDg0OGhAQGy0dHyUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tKy0tLS0tLS0tLf/AABEIAKgBLAMBIgACEQEDEQH/xAAbAAABBQEBAAAAAAAAAAAAAAACAQMEBQYAB//EADwQAAIBAwEGAwYFAgUEAwAAAAECAAMEESEFEjFBUWETInEGFDKBkaFCscHR8FJyFSNTYoIzQ5LxFqLh/8QAGQEAAwEBAQAAAAAAAAAAAAAAAAECAwQF/8QAJREBAQACAgEFAAEFAAAAAAAAAAECERIhAwQTMUFRYRQiI3Gh/9oADAMBAAIRAxEAPwB0QhAEMTFQhCEEQhACEIQRFEYEIQgiEIAU6IIsAWLEnQAp0KmBqSdFBY+g5D1OBGD4nxYBHQafQzLPzTDLVbYeHLObh2LARwwyD+4PQiFNJZZuMrLLqlnRJ0ZFiTp0A6KEOM4OITuF8q4L8ydVp9sc2+0atrlw/hVGLBw2MnO66gsMdBpjHeYZeoxmXGOjH0+Vx5UsSLEm7ndEM6IYAhgmEYJgCGCYRgmIBMEwjAJgAmAYRgkwAGjTxxjGniBipGo5UjcAthCEAGEIwMQhAEIGAHFEERcxgYiiBmEDADzFgAxcwA50HMXMANh5H/tA+rrJhXy8JDXJDAcSpx6jB/SE18u6uuhGnqeU4vPP8m7+PR9N34tT9V20FZD4ifMcmHSSra5V1DKdD9Qeh7yLd1d4HAOJm7W9q27NlWKE55cOozzleLLTPz4b7bPM7MrbXbC1AFRQGb4d84OemP17Rk7YYsUREJUn8XxhfjI7gzp5xyXGrjMj3l5uYVfjYeX/AGrzb15D5mRau0N0Bt3e3uAVhoO56ympms1Z6lTtgaaDHAdgBiZZ+Tc1G3i8fe60FsN0AZ1iLUzXpDTRifqpHGVh2ioGMP8AIQtm3G9WUdmbX+04nNw3Y7+Wsb/peRJ0Qz0HkOMQzokQcTBM4xCYBxgGKTBJgCEwTFJgEwBCYBMUmCTABaMvHGMacxGZeNw3jUCWwMIGNAwgYwdBhAxoGEDAHAYQMbBigwBzMIGNAwgYA4DFzGwYWYwPMXMbzCBgD1PjxxylRUuEpv4J0PDXPx9BLNDrI17bMtd2PmVgrNngHwNdZzeeTqur02dm4RquAWK4A111yOxme2tXZicaAcuZGf3/ADl7UrFtRwA68x69jM/eVGffZcBkyxA0bdAGZHjna/Jl0pKdJmuFUN8A3ufyA+UGz3jVABIOWBOez5z05fWSrxs0qV2g1DbrY/pJAx35H6yMoxWDjhq2Ou8Dp/5GdDmBYsy7yF87rnGpx/NZfWd4yrg65JGeJHM6SjpjcthUK+apUI7glifyMnUKhV9zPH4vpjT7yMpteF0tL6qwAK6j0zr6x72YY1HLlQNwNnHMnQfrIyVAujHThx0lt7MhQKqjj5W/46iRjO42zyvG6XGYhMSJmdLjdmITOJgkwBSYJMQmITAOJgkziYJMA4mATOJgEwDiYBM4mATAOYxpzCJjTGIG3MbzFcwMwCzBhAxpQekPdPSPVLcOAwgYzgxd6GjPAwsxkNFDQB7MUNGhnpDCGPVLcOAxQY3unpFzA9nQYoMaBhAxBO2bS3qijvk+g1kXbFVqlY0qWAB56jHn0EnbPfw1ZzngeExu3L2qRu0iVNVtWGclQPyyZz+T+7LTfx9Y7XdfaNvRQh2ydFAXBJY6AADhrjjMlW2jRSqCyVFLb2vlO8uobKjQj9oT2lMUmpHILbp8TGSHU6b2OIzIVwtVt1moFmUEK9IhlI7a9esMJB5Ll9L1dnqLUCk29TJJ05KSfuAT9BK/w/PpodBwGdOGny9NInsrfstSpQq+UMDuqdd0jj+hkg4Fbf5Zzj7Qm5bKq9yWHLq1QUEeqd1UffAxx5LpzPDSU9G/pl2dKTnd0YlgCfly4R72huHqV6dKjhgi4wdBvEfY6SOthUGfFZKYbG8KZLVHA5Y5SsZNdoz3vpate0agXdyuQG3X4gH85P8AZ2p4dfdfmCgP+08P0lNcW3jDK090IMIc6jHAd47sWuxanv8AEFR8wZOuul7beoMEiBmFVyTnrGjmdHbmKTBJiZnYgCExCYpWAYg4mAWiEwC0AItAJiFoBaAKTAJiFoJMA5jGnMJjG2gDTmDmKwMHBhomsFsI4trLJLaP07aepxjjtqmNn2jbWA6TRi1gNbCK4Y0TLJnvch0hrZdpc+COkcShJ4YnyyVVOzjwtO0tVoiOCkJWoXalNnANl2l74U4UIaxPtRe59oq2faXvgTnTAJ0+gkZSKm2M9pK2F8NSQeOnT9pQJbFqbVq9ZRpujGm4O2ect/amoynLZ3dfh00PUzMW9AK2uMH4S3mHbAPOeLbvderJrUO+IHXcRqjqOBekx9QGUg4+RjKW1VGyhK9cAjP/ABM0lihGFqPT64Ua/wD1kza9gXVGViMHOFpv59eBMmZ96O4xjaNBxVNTdw7ndXPEA8TIj3JBPE68wdZtKeyvGTB31ZSSrqGTB5EZOT85namyqu97rk+Lx8TAx4e98Weu7p1zNMcti46VtrSZnFRR5hkH04D6ayStlU1YAknJydSPU/WaB9jigoCbxYnLMys28Txzidsy2KKcsxzyKFQO2WzFzK4M8XXIR9/e0KsWA83TdXQQrOo6VlBXy7+8OfHiJZ7QsS2rboA1UhRnI4a6SHswO9dd4g6jkVOnYiPG7icpp6LTtwVB7RDajpBt78DRvvH/AH1ZvPPYxvilR/dlne7iSPGUwHdYf1U/C9j+TDWwgGzzHGrATkuR1mmPqML8xN8GU+Ki1LDtGv8ADzLujWUyQKAM6Zhhe3PblOmaNlBNjNT7oOkZqW4j9vEuVZr3CC1oJoDbxipZw4Q+VULUBGzb9polsIZsBF7cHJmPdD0ie5zTe4RPcu0qeKJudaJbacaMaW9ne9TH3m3tnRTMUWxMKjWllQIMfvUe3FctnFNsZdLTE40BF7lPhFL7tE92ls9CR3oGL3aOEREoR8W8NaZEdEPdo4REa2kPaFLdQky33pA2yM0mHaTl5bqqmE2yF8ErJgg4xxI4ntnjMc9N0yppgINTUYjyjkWc8PQYlvR2luVGSrndUgZ6k8FH3k7aNrTqqoqaLxWmuSSepxr+vpPPn8uxmLFwrb9Niyg6u5O4D0A+Jzrw9Jq7C/p1BuFjjucHeHHOD3GnLnrpMnteg4ICEBVyCyjSmnMKvXlnnnAwDqxb3wUhcYxhDg5wF1K/fB6lm7StS9lu/bf+5Mo8gU548vrxMpG2NW8fxd8cMbpXQjP1kKx2zcAZVsjjg8DrJr+0tXnTXPDOsXU+D+Vi1uxH+YFUDnnOR+kp9pbVpou4nDUZ46+n8/SQ7zaNWpjeY45gcBKa+vV1GBk/U6/nz/8AcJjunbqHql+w1NUlTwHEHtrofQiFb3qrh38nJQOHqU5fKV1FN3LvjH9J4N0P84QqVJqzg/g7jgOhmmmdu2pvr1t1cZ1Gc/hP04SGu2WQ7rR2nWVk3AVwowN7OCZn9s13yKemBqMYixm+itaVdtA8DJ9ttANznm4uWXnLSy2lgZzDLx/gmbZ3lbTIMrqN6d7GZWU9rqeJkb3vLgrFMP1VybaxdidJorJmHGUGwwzAEiX7XAAwY/H5ssPhOfjmS0R1Mbq0hK1nIGQY5bXe8NTOvH1Eyc98OkoUYnu8RLgR9amZtM2dxAtvOahJIEBjK5xPFEqUwJBeprJt3UAEzdzdeY6zPLzaOePbcps9e0L/AA4dJW09o1BxWSKe1+oM5OUdXE89liAodYX+KrOF6hj5wcTyXhHGODaYkZipgG3Uw5jinC/U84a3APOVhsl6wDa9GMXKjiuBVWGMGUPgVOTSXRFQcY5kNLTwRIm0LfyH0MEXbDiI1dbSBUiPotMNtawR8OOKZO7nAL/zny5a6jF3l/cU3L587ZHDRKY00HLJ4dh3mr2lvhjVpkFMtvr1A79ZE8ajcDBAD8xzHQZ+k5rdNpNswdsOiDxBlm1HLGuhx24/MSDUuVxvU9NBkdcgZ/naX+1dj7zDGCNEHYAfw/OUd7sKoDoDz4fQSsbiLMg0L9eRZTofLwJ5nEsVvSQMEHn007zPvs6qOXI4wOcdt7e4A3TqOGvDMu4xPKrK8r1GGE0zrK0lE1Ygtr9ZEqUq+8QoYZ5dPST9mbHz56p0HIx6khbtqRs62asByAz5Tkj+cZZ3VZKaGjTxvt9usgXF+f8Ap0RjGBnkO8C2UJlmbLccnv0zJ190966iws3VFwQGxqe31lZcMu8TjGekds7nVmYZz5cc4l5bEciM8MjEufKag3FvkZWQDvLLClX3TumSXtlaVtOlNTZidJodhW53gWjFCgqydZVSGzIzvS8Me29s75KaY5yBd7Wzw+0qQ5PGMuxBnJa6pjFqu1anDlJFLaeBrKRq2kAVsysUZRa0/aDdfBOk0uydso/AzynajkHIh7P2g9MhgSJ1Y7nbmuq9sN0McZWXe1FHEiZq22m1ZNG+kS22O1U5ZjD3h7azvdrKRoZlbi5JYnM1dD2YTmWPzjh2BRGm4PpJ7vdPUnw0NGgx+IYhtbCW7UpFqWy88iGhtULa68ZKS1XtHfcFJyHM6tZNyePUG3NZ9DGXsao+FozVsq/4XEVLW6/1F+kWv4Dmo3A6GMV2uRwUH5yZv3K8d0wm2qy/HSPy1ho0K2vao+ND8pY09rrzBHqIFLbFBtOB7x2rbpUGVIilB9b6mw4iQ7w02U4xwMYr7PbGglXWsXXJ1Eq5CRQ1qLGk3hnO4xGP9szW6lQgklH+IngSM66GW3+IFC6qMgtu4P4uWgme2xc+bygZGpI7Hh9dJGrs9xOb3mm3HfGOXEAc+8JNsgndIKnkCMcOEpBt5kwTjQa4568B9oR21Tc+dRoQo7aZOvpF7d+4rnPqr1LpSQB3PXGRgfpGGZs4ABGn01IP86SppIh1QkajTPLOknWTMjEE59f6c4+uknjpUy2kJqx0Hy5aZlZtO6GoB04a8AeklOzZYKJQ3jK2jNjtLwxRlkb97J8qDA4EnnOe4Pwrr8v3nF6IGCfl1hU95x/lKFX+o8Zqz2KgAmrnXiB0mh9/NWhlk0XTMzFeg40G8x68pK2O1Viafhs2RoADmFn2UokUE4IkqpSKiC9AqcEFSDqDxEnOuV1itVIrLepvHEuLeljUyBQoYOZNNWZZ1rhE4NOqtI9N51SpMuDbloDVI2z44Rlt5jhQT/aM/lJFLZF2w0oVPmMfnNJGWWSDdJvSFd6LiXjez17/AKLfMr+8hXexrofFRf5YP5TWVjew+z+0igmq2f7UAYXHGU+xvZhviqndHTnLC62Va6qr+YDkRmZZZY29LmOWu24ttpBlGCIFVWJ4mZT2c2dVQ5Z/T0mqLGLnvo+Om4DwWAPKMLCDTfbLTmtUPLEaOzRyJj2/6wg8Ogrq+yHPwuZCqbGuR8NQ/OX+8YYc9fyhqBl22Rd/6sae0vV/Eh9QZqKtZxwUn+3EHxcjJRvprFYcrJVEqf8AdoBu6a/Yxmnof8moyH+ipn9ZsPBzqAV9RKu+2dVbiiOv0Mjirki2ntCVIS4XHLe5H5y2uHpumQRqJm721qoMeE7pzUgkj+085SJfvRPlLGm3JshkPTBi3Z8nqX4RtpWtKmlR6jYPiNu4x5RMlV2Z4qnwgxUebI54zgA8M/vNPV2OtxVFWuc0qYyFzoWJzrJVrWp1AapA8FDu00XgzD8Rx3hy0VxYil7NVCm8FJAIAAGdSAePPlIdXZaqPMCOJJweWh/Oenrf1ar+HTUIAN9ieRI8oA689eEZuEWoDSuAjZ47vlA7b2fN8oTy/o4fjzZaCqcjTHCPVr8annqPUHj+8l7Z2HUouSgLodQVGcfIcJR1mA0PPryM11Kjek6zqkNkNnXnKe8phqrdznEstnWdWq2KSlsfTHrNLsj2URH8W4IJ4hAeJ7mFymI1az+yNg75B0A5F8y7q0UoEK64HBWOCra6AGLta7u97IUIg0AQ4wO3IwrfaAqLuVNQ2hBBAJ7f0kdpF3e1TU6NeDSqkKh3W6/hbtkcD2jaq1u281XXBwFVgQegbGD9Yxf7JqU8VKJ38fhPxYGvz/PSS6hS5okjRlBOD8SkcQecc/4VDWvKdUZyS3VskyOwPIymt3K1N09cazTWNMtooLHoNZVx0UyRKNJzyku12RVqHyAn0ms2T7Lu2GqkAdBrNTQtqNEYAGn84CRdLlrIbO9i3YDxHx2XUy+tfY61p6shc/7tf/yWr7RxooP/AIn8sSK+0UY+YVVPZTg/XSLo7s74NOmMU6aL6LGffQ3lzg+kYN1RByXYf8WB9eOPtHqN5bVPxjPDJGDJCsudpVkbcYadeokG6vqg83FTx04TV07ZOJdHXln9JL8OnjAVT2wBCSj4YY12chcZzoMSds72NtUqeNVyznXU6D5cJqVorn/poMcMYMSuBzXP7R446K3Y1taOBhRpwkKvbrn4BCNUE+Rs9uYjqk8xH0O04Oen3hmQaVxHQ8pKauOs7HeRd4wlJ6wCSSP/AFBL9MxsRcmAPo/Uzt8dzGgIYWMONbtAas3yhPpIdZzHsaSTV7/eMXNJXGHVWHRgD+cbWqOAEcCdY52FTfbCouhRVZAcE+G3T1z9pSXexqlNadOnh0Vt473kxrkZHMCbMiRquDpJuMPahegtOmFGMsxZyPxdsyjvL2lTfKrvMRrnXHp0mpvLEOMA4lDtL2WqMd5GGnUcfpMbhdtJlNKOl7TVN4gBR2lXdWdC8rA1PIx0O7oGMXbOzqlFt90I5EjUGVlglZ6quadUIuSCqnX7TTDH7ic7GztLBLVXRMKgAJJ1Zmmd2rdMy75JGuF5GOUPfXfd3SygkgucEjlkTrzYl61QOyAqOQPOTwvLsTKadTu2NMipwA4HnGNneEy7yjUHjnOnTEtP/itzVQhmCZ+ZxFs/YitSXcVxgnU45RzHorlNoV9cimA3MlcfvHqQtCQ7O9NyDnChlIP9XD85p7T2ctwAKi75HNjmHfez1vU0A3ca+XT6yuPSeW2HX2cUtvU7iiykg+clGHyOn3m02PbW9BQDUTqSGBLH5cpW3fskRqnm7DQ/aV52Qy6MHHqTC205I2F17UUlG7SBbvwEz9z7Q12/Hx5KMYjVts4D8DH6mFb7IqbxCocciREfR+32rWHmZyf1k239oXPHQyPU2DXOuAOgzGDs9wQCsCae020rDDYj1SiG1plfRgCJkLi2qLjcU9TLjZVZ9CYocy0sjQdf+zSz/tHGLb+Lzor8s/vJi3MJLnJ0jvRy7O0Cw/CAPU/vHDUx3iUzn4sQXccBHpBqqik7w0PUfr1jxRzqpGO/WNEQPFxwMVitomHzHkqHrEnQkI5TrmOi4nTpRDW5jouDOnRmIV2jq3ESdFQJ68YJJnToASkLqZFr7S1wonTobBErMRrG3M6dEAKxkynV0nTowi3Qpt8QBi0FpcAonToEbr2VPO9gQhTUjAnTpROWniGyTp0ZK+uwBgb/AEE6dIqofpEwy4X4hn1nToqccbxQMhRH7a7zyAnToYlXVq0ZVA3ETp0mnB1LVcaxilQXOAIk6HxSSjSAEra+8moiTppZuJnRy3vAeJklWXOQZ06R8KO+IesBlnTo7Q//2Q=="},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_reg_eco",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"}}}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"WFS ",visible:!0,source:e}))})),this.layerService.createAsyncLayer({sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"MELS_CS_ANGLO_S",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"R\xe9seau routier",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",params:{LAYERS:"bgr_v_sous_route_res_sup_act",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"lieu habit\xe9",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",optionsFromCapabilities:!0,params:{LAYERS:"lieuhabite",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"2 styles nurc:Arc_Sample_Parent",visible:!0,legendOptions:{display:!0,stylesAvailable:[{name:"rain",title:"Pluie"},{name:"raster",title:"D\xe9faut"}]},sourceOptions:{type:"wms",url:"https://demo.geo-solutions.it/geoserver/ows",optionsFromCapabilities:!0,params:{LAYERS:"nurc:Arc_Sample",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"Avertissements routier",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",params:{LAYERS:"evenements",VERSION:"1.3.0"}}}).subscribe((function(e){return n.map.addLayer(e)})),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",refreshIntervalSec:15,params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"}}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle",visible:!0,source:e,metadata:{url:"https://www.donneesquebec.ca/recherche/fr/dataset/historique-publique-d-embacles-repertories-au-msp",extern:!0}}))}))},pC.\u0275fac=function(e){return new(e||pC)(r.Rb(Le),r.Rb(mf),r.Rb(Ff))},pC.\u0275cmp=r.Lb({type:pC,selectors:[["app-legend"]],decls:17,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/layer"],[3,"map","view"],["color","primary",3,"map"],["title","Legends"],[3,"layers","excludeBaseLayers","allowShowAllLegends","updateLegendOnResolutionChange","showAllLegendsValue"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Simple Map with a legend list"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"Dependencies: LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"hr"),r.Wb(),r.Xb(13,"igo-map-browser",1),r.Sb(14,"igo-zoom-button",2),r.Wb(),r.Xb(15,"igo-panel",3),r.Sb(16,"igo-layer-legend-list",4),r.Wb(),r.Wb()),2&e&&(r.Db(13),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map),r.Db(2),r.oc("layers",t.map.layers)("excludeBaseLayers",!0)("allowShowAllLegends",!0)("updateLegendOnResolutionChange",!1)("showAllLegendsValue",!1))},directives:[b.a,b.e,b.f,b.c,om,rm,Sr,fb],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),pC)}]),kC=((gC=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:gC}),gC.\u0275inj=r.Ob({factory:function(e){return new(e||gC)},imports:[[yC,b.d,l.b,u.b,Cr,Hy,vb,oy,xg,Db]]}),gC),SC=f.e.forChild([{path:"overlay",component:(fC=function(){function e(t,i,o){_classCallCheck(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new tm({overlay:!0,controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe((function(t){e.map.addLayer(e.layerService.createLayer({title:"OSM",source:t}))}))}},{key:"ngAfterViewInit",value:function(){this.map.overlay.setFeatures([{type:_f,projection:"EPSG:4326",meta:{id:1},properties:{},geometry:{type:"Point",coordinates:[-73,46.6]}},{type:_f,projection:"EPSG:4326",meta:{id:2},properties:{},geometry:{type:"LineString",coordinates:[[-72,47.8],[-73.5,47.4],[-72.4,48.6]]}},{type:_f,projection:"EPSG:4326",meta:{id:3},properties:{},geometry:{type:"Polygon",coordinates:[[[-71,46.8],[-73,47],[-71.2,46.6]]]}}],Mf.None)}}]),e}(),fC.\u0275fac=function(e){return new(e||fC)(r.Rb(Le),r.Rb(mf),r.Rb(Ff))},fC.\u0275cmp=r.Lb({type:fC,selectors:[["app-overlay"]],decls:15,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/overlay"],[3,"map","view"],["color","primary",3,"map"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Overlay"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"Dependencies: LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"hr"),r.Wb(),r.Xb(13,"igo-map-browser",1),r.Sb(14,"igo-zoom-button",2),r.Wb(),r.Wb()),2&e&&(r.Db(13),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map))},directives:[b.a,b.e,b.f,b.c,om,rm],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),fC)}]),CC=((mC=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:mC}),mC.\u0275inj=r.Ob({factory:function(e){return new(e||mC)},imports:[[SC,b.d,l.b,Hy,ek]]}),mC);function wC(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-form",4),r.ec("submitForm",(function(e){return r.yc(i),r.ic().onSubmit(e)})),r.jc(1,"async"),r.Sb(2,"igo-form-group",5),r.Xb(3,"div",6),r.Xb(4,"button",7),r.ec("click",(function(){return r.yc(i),r.ic().fillForm()})),r.Ic(5," Fill Form "),r.Wb(),r.Xb(6,"button",7),r.ec("click",(function(){return r.yc(i),r.ic().clearForm()})),r.Ic(7," Clear Form "),r.Wb(),r.Xb(8,"button",8),r.Ic(9," Submit "),r.Wb(),r.Wb(),r.Wb()}if(2&e){var o=t.ngIf,n=r.ic();r.oc("form",o)("formData",r.kc(1,4,n.data$)),r.Db(2),r.oc("group",o.groups[0]),r.Db(6),r.oc("disabled",n.submitDisabled)}}var xC,OC,IC,LC,TC,FC,_C=f.e.forChild([{path:"geometry",component:(xC=function(){function e(t,i,o,n){_classCallCheck(this,e),this.languageService=t,this.formService=i,this.dataSourceService=o,this.layerService=n,this.map=new tm({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:15},this.form$=new L.a(void 0),this.data$=new L.a(void 0),this.submitDisabled=!0}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe((function(t){e.map.addLayer(e.layerService.createLayer({title:"OSM",source:t}))}));var t=[{name:"geometry",title:"Geometry",options:{validator:tt.w.required},type:"geometry",inputs:{map:this.map,geometryTypeField:!0,geometryType:"Polygon",drawGuideField:!0,drawGuide:50,drawGuidePlaceholder:"Draw Guide",drawStyle:new Uc.Style({stroke:new Uc.Stroke({color:[255,0,0,1],width:2}),fill:new Uc.Fill({color:[255,0,0,.2]}),image:new Uc.Circle({radius:8,stroke:new Uc.Stroke({color:[255,0,0,1]}),fill:new Uc.Fill({color:[255,0,0,.2]})})})}},{name:"name",title:"Name",options:{validator:tt.w.required}}].map((function(t){return e.formService.field(t)})),i=this.formService.form([],[this.formService.group({name:"info"},t)]);this.valueChanges$$=i.control.valueChanges.subscribe((function(){e.submitDisabled=!i.control.valid})),this.form$.next(i)}},{key:"ngOnDestroy",value:function(){this.valueChanges$$.unsubscribe()}},{key:"fillForm",value:function(){this.data$.next({name:"Place",geometry:JSON.stringify({type:"Polygon",coordinates:[[[-106,42],[-107,31],[-81,32],[-82,42],[-106,42]]]})})}},{key:"clearForm",value:function(){this.form$.value.control.reset()}},{key:"onSubmit",value:function(e){alert(JSON.stringify(e))}}]),e}(),xC.\u0275fac=function(e){return new(e||xC)(r.Rb(Le),r.Rb(Yn),r.Rb(mf),r.Rb(Ff))},xC.\u0275cmp=r.Lb({type:xC,selectors:[["app-geometry"]],decls:13,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/form"],[3,"map","view"],["color","primary",3,"map"],[3,"form","formData","submitForm",4,"ngIf"],[3,"form","formData","submitForm"],[3,"group"],["formButtons",""],["mat-stroked-button","","type","button","color","primary",3,"click"],["mat-flat-button","","type","submit","color","primary",3,"disabled"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Geometry Form"),r.Wb(),r.Xb(5,"mat-card-content"),r.Ic(6," See the "),r.Xb(7,"a",0),r.Ic(8,"code of this example"),r.Wb(),r.Wb(),r.Xb(9,"igo-map-browser",1),r.Sb(10,"igo-zoom-button",2),r.Wb(),r.Gc(11,wC,10,6,"igo-form",3),r.jc(12,"async"),r.Wb()),2&e&&(r.Db(9),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("ngIf",r.kc(12,4,t.form$)))},directives:[b.a,b.e,b.f,b.c,om,rm,m.l,qn,Jn,l.a],pipes:[m.b],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}igo-map-browser[_ngcontent-%COMP%]{width:500px;height:500px}"]}),xC)}]),MC=((OC=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:OC}),OC.\u0275inj=r.Ob({factory:function(e){return new(e||OC)},imports:[[m.c,_C,l.b,b.d,er,Xv,Hy]]}),OC),DC=f.e.forChild([{path:"feature",component:(IC=function(){function e(t,i,o){_classCallCheck(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.tableTemplate={selection:!0,selectMany:!0,sort:!0,columns:[{name:"properties.id",title:"ID"},{name:"properties.name",title:"Name"},{name:"properties.description",title:"Description"}]},this.store=new $f([],{map:this.map})}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this,t=new Wf({});this.store.addStrategy(t);var i=new Bf({map:this.map,motion:Mf.Default});this.store.addStrategy(i),this.store.load([{meta:{id:1},type:"Feature",geometry:{type:"Point",coordinates:[-72,47.8]},projection:"EPSG:4326",properties:{id:1,name:"Name 1",description:"Description 1"}},{meta:{id:2},type:"Feature",geometry:{type:"LineString",coordinates:[[-72,47.8],[-73.5,47.4],[-72.4,48.6]]},projection:"EPSG:4326",properties:{id:2,name:"Name 2",description:"Description 2"}},{meta:{id:3},type:"Feature",geometry:{type:"Polygon",coordinates:[[[-71,46.8],[-73,47],[-71.2,46.6]]]},projection:"EPSG:4326",properties:{id:3,name:"Name 3",description:"Description 3"}}]),this.layerService.createAsyncLayer({title:"MVT test",visible:!0,sourceOptions:{type:"mvt",url:"https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/ne:ne_10m_admin_0_countries@EPSG:900913@pbf/{z}/{x}/{-y}.pbf",queryable:!0},mapboxStyle:{url:"assets/mapboxStyleExample-vectortile.json",source:"ahocevar"}}).subscribe((function(t){return e.map.addLayer(t)})),this.dataSourceService.createAsyncDataSource({type:"vector"}).subscribe((function(o){var n=e.layerService.createLayer({title:"Vector Layer",source:o,animation:{duration:2e3},mapboxStyle:{url:"assets/mapboxStyleExample-feature.json",source:"source_nameX"}});e.map.addLayer(n),e.store.bindLayer(n),t.activate(),i.activate()}))}},{key:"ngOnDestroy",value:function(){this.store.destroy()}}]),e}(),IC.\u0275fac=function(e){return new(e||IC)(r.Rb(Le),r.Rb(mf),r.Rb(Ff))},IC.\u0275cmp=r.Lb({type:IC,selectors:[["app-feature"]],decls:12,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geom/feature"],[3,"map","view"],["color","primary",3,"map"],[3,"store","template"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Feature"),r.Wb(),r.Xb(5,"mat-card-content"),r.Ic(6," See the "),r.Xb(7,"a",0),r.Ic(8,"code of this example"),r.Wb(),r.Wb(),r.Xb(9,"igo-map-browser",1),r.Sb(10,"igo-zoom-button",2),r.Wb(),r.Sb(11,"igo-entity-table",3),r.Wb()),2&e&&(r.Db(9),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("store",t.store)("template",t.tableTemplate))},directives:[b.a,b.e,b.f,b.c,om,rm,bn],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),IC)}]),PC=((LC=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:LC}),LC.\u0275inj=r.Ob({factory:function(e){return new(e||LC)},imports:[[DC,m.c,b.d,l.b,u.b,Cr,ar,Hy,Rb]]}),LC),AC=f.e.forChild([{path:"measure",component:(TC=function e(t,i,o){var n=this;_classCallCheck(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new tm({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,projection:"EPSG:3857"},this.store=new $f([],{map:this.map}),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"OSM",source:e}))}))},TC.\u0275fac=function(e){return new(e||TC)(r.Rb(Le),r.Rb(mf),r.Rb(Ff))},TC.\u0275cmp=r.Lb({type:TC,selectors:[["app-measure"]],decls:16,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/measure"],[3,"map","view"],["color","primary",3,"map"],[3,"store","map"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Simple Map"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"Dependencies: LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"hr"),r.Wb(),r.Xb(13,"igo-map-browser",1),r.Sb(14,"igo-zoom-button",2),r.Wb(),r.Sb(15,"igo-measurer",3),r.Wb()),2&e&&(r.Db(13),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("store",t.store)("map",t.map))},directives:[b.a,b.e,b.f,b.c,om,rm,Rv],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-measurer[_ngcontent-%COMP%]     mat-divider{position:inherit!important;left:inherit!important;width:160px!important}"]}),TC)}]),jC=((FC=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:FC}),FC.\u0275inj=r.Ob({factory:function(e){return new(e||FC)},imports:[[AC,b.d,Hy,Ky]]}),FC);function RC(e,t){if(1&e&&(r.Vb(0),r.Xb(1,"h1"),r.Ic(2,"Query Title : "),r.Xb(3,"span",5),r.Ic(4),r.Wb(),r.Wb(),r.Sb(5,"igo-feature-details",6),r.Ub()),2&e){var i=t.ngIf,o=r.ic();r.Db(4),r.Jc(o.getTitle(i)),r.Db(1),r.oc("feature",i)}}var $C,EC,WC,XC,GC=f.e.forChild([{path:"query",component:($C=function(){function e(t,i,o,n){var r=this;_classCallCheck(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.overlayService=n,this.feature$=new L.a(void 0),this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe((function(e){r.map.addLayer(r.layerService.createLayer({title:"OSM",source:e}))})),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",queryable:!0,queryTitle:"num_rts",params:{layers:"bgr_v_sous_route_res_sup_act",version:"1.3.0"}}).subscribe((function(e){r.map.addLayer(r.layerService.createLayer({title:"WMS",source:e,sourceOptions:e.options}))})),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",queryable:!0,queryFormat:Hg.HTMLGML2,queryHtmlTarget:Yg.IFRAME,params:{layers:"bgr_v_sous_route_res_sup_act",version:"1.3.0"}}).subscribe((function(e){r.map.addLayer(r.layerService.createLayer({title:"WMS html with a pre call in GML",source:e,sourceOptions:e.options}))})),this.dataSourceService.createAsyncDataSource({type:"vector",queryable:!0,queryTitle:"So beautiful ${name}",sourceFields:[{name:"name",alias:"Alias name"},{name:"description",alias:"Alias description"}]}).subscribe((function(e){r.map.addLayer(r.layerService.createLayer({title:"Vector Layer",source:e,sourceOptions:e.options})),r.addFeatures(e)}))}return _createClass(e,[{key:"addFeatures",value:function(e){var t=new Vc.a({name:"feature1",geometry:new gl.a([kc.r([-72,47.8],"EPSG:4326","EPSG:3857"),kc.r([-73.5,47.4],"EPSG:4326","EPSG:3857"),kc.r([-72.4,48.6],"EPSG:4326","EPSG:3857")])}),i=new Vc.a({name:"feature2",geometry:new pl.a(kc.r([-73,46.6],"EPSG:4326","EPSG:3857"))}),o=new Vc.a({name:"feature3",geometry:new dl.b([[kc.r([-71,46.8],"EPSG:4326","EPSG:3857"),kc.r([-73,47],"EPSG:4326","EPSG:3857"),kc.r([-71.2,46.6],"EPSG:4326","EPSG:3857")]])});e.ol.addFeatures([t,i,o])}},{key:"handleQueryResults",value:function(e){var t,i=e.features;i.length&&(t=i[0]),this.feature$.next(t),this.map.overlay.setFeatures([t],Mf.None)}},{key:"getTitle",value:function(e){return Zi(e)}}]),e}(),$C.\u0275fac=function(e){return new(e||$C)(r.Rb(Le),r.Rb(mf),r.Rb(Ff),r.Rb(Jy))},$C.\u0275cmp=r.Lb({type:$C,selectors:[["app-query"]],decls:18,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/query"],["igoOverlay","","igoQuery","",3,"map","view","queryFeatures","query"],["color","primary",3,"map"],["title","Details"],[4,"ngIf"],[2,"background-color","#e0e0e0"],[3,"feature"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Query"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"Dependencies: LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"hr"),r.Wb(),r.Xb(13,"igo-map-browser",1),r.ec("query",(function(e){return t.handleQueryResults(e)})),r.Sb(14,"igo-zoom-button",2),r.Wb(),r.Xb(15,"igo-panel",3),r.Gc(16,RC,6,2,"ng-container",4),r.jc(17,"async"),r.Wb(),r.Wb()),2&e&&(r.Db(13),r.oc("map",t.map)("view",t.view)("queryFeatures",!0),r.Db(1),r.oc("map",t.map),r.Db(2),r.oc("ngIf",r.kc(17,5,t.feature$)))},directives:[b.a,b.e,b.f,b.c,om,Qy,Jm,rm,Sr,m.l,Pb],pipes:[m.b],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),$C)}]),BC=((EC=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:EC}),EC.\u0275inj=r.Ob({factory:function(e){return new(e||EC)},imports:[[GC,m.c,b.d,l.b,u.b,Cr,Hy,ek,dk,Rb]]}),EC),VC=f.e.forChild([{path:"catalog",component:(WC=function(){function e(t,i,o,n){_classCallCheck(this,e),this.configService=t,this.languageService=i,this.layerService=o,this.catalogService=n,this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.catalogStore=new hn([]),this.catalogItemStore=new hn([])}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe((function(t){return e.map.addLayer(t)})),this.loadCatalogs()}},{key:"onCatalogSelectChange",value:function(e){this.loadCatalogItems(e.catalog)}},{key:"loadCatalogs",value:function(){var e=this;this.catalogService.loadCatalogs().subscribe((function(t){e.catalogStore.clear(),e.catalogStore.load(t)}))}},{key:"loadCatalogItems",value:function(e){var t=this;this.catalogService.loadCatalogItems(e).subscribe((function(e){t.catalogItemStore.clear(),t.catalogItemStore.load(e)}))}}]),e}(),WC.\u0275fac=function(e){return new(e||WC)(r.Rb(ie),r.Rb(Le),r.Rb(Ff),r.Rb(ob))},WC.\u0275cmp=r.Lb({type:WC,selectors:[["app-catalog"]],decls:23,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/catalog"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],[3,"map","view"],["color","primary",3,"map"],["title","Catalog Library"],[3,"store","catalogSelectChange"],["title","Catalog Browser"],[3,"store","map"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Catalog"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"Dependencies: ConfigService, LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"br"),r.Ic(13," See catalog section of the "),r.Xb(14,"a",1),r.Ic(15," environment config"),r.Wb(),r.Sb(16,"hr"),r.Wb(),r.Xb(17,"igo-map-browser",2),r.Sb(18,"igo-zoom-button",3),r.Wb(),r.Xb(19,"igo-panel",4),r.Xb(20,"igo-catalog-library",5),r.ec("catalogSelectChange",(function(e){return t.onCatalogSelectChange(e)})),r.Wb(),r.Wb(),r.Xb(21,"igo-panel",6),r.Sb(22,"igo-catalog-browser",7),r.Wb(),r.Wb()),2&e&&(r.Db(17),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map),r.Db(2),r.oc("store",t.catalogStore),r.Db(2),r.oc("store",t.catalogItemStore)("map",t.map))},directives:[b.a,b.e,b.f,b.c,om,rm,Sr,kb,nb],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),WC)}]),NC=((XC=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:XC}),XC.\u0275inj=r.Ob({factory:function(e){return new(e||XC)},providers:[ne({default:a.igo})],imports:[[m.c,VC,b.d,l.b,u.b,g.b,se,Cr,Hy,wb]]}),XC),zC=i("p9/F");function qC(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",14),r.ec("click",(function(){return r.yc(i),r.ic(2).clearFilter()})),r.Sb(1,"mat-icon",15),r.Wb()}}function HC(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-form-field",11),r.Xb(1,"input",12),r.ec("ngModelChange",(function(e){return r.yc(i),r.ic().term=e})),r.jc(2,"translate"),r.Wb(),r.Gc(3,qC,2,0,"button",13),r.Wb()}if(2&e){var o=r.ic();r.oc("ngClass",o.auth.authenticated?"context-filter-min-width":"context-filter-max-width"),r.Db(1),r.oc("placeholder",r.kc(2,4,"igo.context.contextManager.filterPlaceHolder"))("ngModel",o.term),r.Db(2),r.oc("ngIf",o.term.length)}}function UC(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",16),r.ec("click",(function(){return r.yc(i),r.ic().toggleSort(!0)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",17),r.Wb()}2&e&&r.oc("matTooltip",r.kc(1,1,"igo.context.contextManager.sortAlphabetically"))}function YC(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",16),r.ec("click",(function(){return r.yc(i),r.ic().toggleSort(!1)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",18),r.Wb()}2&e&&r.oc("matTooltip",r.kc(1,1,"igo.context.contextManager.sortContextOrder"))}function KC(e,t){if(1&e&&r.Sb(0,"igo-actionbar",19),2&e){var i=r.ic();r.oc("iconColor",i.color)("store",i.actionStore)("withIcon",!0)("withTitle","overlay"===i.actionbarMode)("horizontal",!1)("mode",i.actionbarMode)}}function ZC(e,t){if(1&e&&(r.Xb(0,"button",20),r.jc(1,"translate"),r.Sb(2,"mat-icon",21),r.Wb()),2&e){r.ic();var i=r.vc(7);r.oc("matTooltip",r.kc(1,2,"igo.context.contextManager.filterUser"))("matMenuTriggerFor",i)}}function JC(e,t){if(1&e&&(r.Xb(0,"button",27),r.Ic(1),r.Wb()),2&e){var i=r.ic().$implicit,o=r.vc(6);r.oc("matMenuTriggerFor",o),r.Db(1),r.Kc(" ",i.title," ")}}function QC(e,t){if(1&e&&(r.Xb(0,"button",9),r.Ic(1),r.Wb()),2&e){var i=r.ic().$implicit;r.Db(1),r.Kc(" ",i.title," ")}}function ew(e,t){if(1&e){var i=r.Yb();r.Xb(0,"mat-checkbox",8),r.ec("click",(function(e){return r.yc(i),e.stopPropagation()}))("change",(function(){r.yc(i);var e=t.$implicit,o=r.ic().$implicit;return r.ic().userSelection(e,o)})),r.Ic(1),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic(2);r.oc("checked",n.getPermission(o).checked),r.Db(1),r.Kc(" ",o.title," ")}}function tw(e,t){if(1&e){var i=r.Yb();r.Vb(0),r.Xb(1,"span",7),r.Xb(2,"mat-checkbox",22),r.ec("click",(function(e){return r.yc(i),e.stopPropagation()}))("change",(function(){r.yc(i);var e=t.$implicit;return r.ic().userSelection(e)})),r.Wb(),r.Gc(3,JC,2,2,"button",23),r.Gc(4,QC,2,1,"button",24),r.Wb(),r.Xb(5,"mat-menu",null,25),r.Gc(7,ew,2,2,"mat-checkbox",26),r.Wb(),r.Ub()}if(2&e){var o=t.$implicit,n=r.ic();r.Db(2),r.oc("checked",n.getPermission(o).checked)("indeterminate",n.getPermission(o).indeterminate),r.Db(1),r.oc("ngIf",o.childs),r.Db(1),r.oc("ngIf",!o.childs),r.Db(3),r.oc("ngForOf",o.childs)}}function iw(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-context-item",31),r.ec("edit",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).edit.emit(e)}))("delete",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).delete.emit(e)}))("clone",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).clone.emit(e)}))("save",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).save.emit(e)}))("hide",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).hideContext(e)}))("show",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).showContext(e)}))("favorite",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).favorite.emit(e)}))("manageTools",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).manageTools.emit(e)}))("managePermissions",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).managePermissions.emit(e)}))("select",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).select.emit(e)}))("unselect",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).unselect.emit(e)})),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic(3);r.oc("selected",n.selectedContext&&n.selectedContext.uri===o.uri)("context",o)("default",o.id&&n.defaultContextId&&n.defaultContextId===o.id)}}function ow(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-collapsible",30),r.ec("toggle",(function(e){r.yc(i);var t=r.ic().$implicit,o=r.ic();return o.collapsed[o.titleMapping[t.key]]=e})),r.jc(1,"translate"),r.Gc(2,iw,1,3,"ng-template",10),r.Wb()}if(2&e){var o=r.ic().$implicit,n=r.ic();r.oc("title",r.kc(1,3,n.titleMapping[o.key]))("collapsed",n.collapsed[n.titleMapping[o.key]]),r.Db(2),r.oc("ngForOf",o.value)}}function nw(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-context-item",32),r.ec("select",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).select.emit(e)}))("unselect",(function(){r.yc(i);var e=t.$implicit;return r.ic(3).unselect.emit(e)})),r.Wb()}if(2&e){var o=t.$implicit,n=r.ic(3);r.oc("selected",n.selectedContext&&n.selectedContext.uri===o.uri)("context",o)("default",n.defaultContextId===o.id)}}function rw(e,t){if(1&e&&r.Gc(0,nw,1,3,"ng-template",10),2&e){var i=r.ic().$implicit;r.oc("ngForOf",i.value)}}function aw(e,t){if(1&e&&(r.Gc(0,ow,3,5,"igo-collapsible",28),r.Gc(1,rw,1,1,void 0,29)),2&e){var i=t.$implicit,o=r.ic();r.oc("ngIf",i.value.length&&o.auth.authenticated),r.Db(1),r.oc("ngIf",i.value.length&&!o.auth.authenticated)}}function sw(e,t){if(1&e&&r.Sb(0,"mat-icon",7),2&e){var i=r.ic(2);r.pc("svgIcon",i.context.icon?i.context.icon:"public"===i.context.scope?"earth":"star")}}function cw(e,t){if(1&e&&r.Sb(0,"img",8),2&e){var i=r.ic(2);r.oc("src",i.context.iconImage,r.Bc)}}function lw(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",4),r.ec("click",(function(){r.yc(i);var e=r.ic();return e.favoriteClick(e.context)})),r.jc(1,"translate"),r.Gc(2,sw,1,1,"mat-icon",5),r.Gc(3,cw,1,1,"img",6),r.Wb()}if(2&e){var o=r.ic();r.oc("matTooltip",o.auth.authenticated?r.kc(1,4,"igo.context.contextManager.favorite"):"")("color",o.default?"primary":"default"),r.Db(2),r.oc("ngIf",!o.context.iconImage),r.Db(1),r.oc("ngIf",o.context.iconImage)}}function uw(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",17),r.ec("click",(function(){r.yc(i);var e=r.ic(2);return e.save.emit(e.context)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",18),r.Wb()}if(2&e){var o=r.ic(2);r.oc("matTooltip",r.kc(1,2,"igo.context.contextManager.save"))("color",o.color)}}function hw(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",17),r.ec("click",(function(){r.yc(i);var e=r.ic(2);return e.managePermissions.emit(e.context)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",19),r.Wb()}if(2&e){var o=r.ic(2);r.oc("matTooltip",r.kc(1,2,"igo.context.contextManager.managePermissions"))("color",o.color)}}function dw(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",17),r.ec("click",(function(){r.yc(i);var e=r.ic(2);return e.clone.emit(e.context)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",20),r.Wb()}if(2&e){var o=r.ic(2);r.oc("matTooltip",r.kc(1,2,"igo.context.contextManager.clone"))("color",o.color)}}function pw(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",21),r.ec("click",(function(){r.yc(i);var e=r.ic(2);return e.edit.emit(e.context)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",22),r.Wb()}if(2&e){var o=r.ic(2);r.oc("color",o.color)("matTooltip",r.kc(1,2,"igo.context.contextManager.edit"))}}function gw(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",21),r.ec("click",(function(){r.yc(i);var e=r.ic(2);return e.hide.emit(e.context)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",23),r.Wb()}if(2&e){var o=r.ic(2);r.oc("color",o.color)("matTooltip",r.kc(1,2,"igo.context.contextManager.hide"))}}function fw(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",21),r.ec("click",(function(){r.yc(i);var e=r.ic(2);return e.show.emit(e.context)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",24),r.Wb()}if(2&e){var o=r.ic(2);r.oc("color",o.color)("matTooltip",r.kc(1,2,"igo.context.contextManager.show"))}}function mw(e,t){if(1&e){var i=r.Yb();r.Xb(0,"button",25),r.ec("click",(function(){r.yc(i);var e=r.ic(2);return e.delete.emit(e.context)})),r.jc(1,"translate"),r.Sb(2,"mat-icon",26),r.Wb()}2&e&&r.oc("matTooltip",r.kc(1,1,"igo.context.contextManager.delete"))}function bw(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",9),r.Gc(1,uw,3,4,"button",10),r.Xb(2,"div",11,12),r.Gc(4,hw,3,4,"button",10),r.Gc(5,dw,3,4,"button",10),r.Gc(6,pw,3,4,"button",13),r.Gc(7,gw,3,4,"button",13),r.Gc(8,fw,3,4,"button",13),r.Gc(9,mw,3,3,"button",14),r.Wb(),r.Xb(10,"button",15),r.ec("click",(function(){r.yc(i);var e=r.ic();return e.collapsed=!e.collapsed})),r.Sb(11,"mat-icon",16),r.Wb(),r.Wb()}if(2&e){var o=r.vc(3),n=r.ic();r.Db(1),r.oc("ngIf",n.collapsed&&n.selected&&(n.context.permission===n.typePermission[n.typePermission.write]||n.context.imported)),r.Db(3),r.oc("ngIf",n.canShare&&!n.context.imported),r.Db(1),r.oc("ngIf",!n.context.imported),r.Db(1),r.oc("ngIf",n.context.permission===n.typePermission[n.typePermission.write]&&!n.context.imported),r.Db(1),r.oc("ngIf",!n.context.hidden&&!n.context.imported),r.Db(1),r.oc("ngIf",n.context.hidden&&!n.context.imported),r.Db(1),r.oc("ngIf",n.context.permission===n.typePermission[n.typePermission.write]||n.context.imported),r.Db(1),r.oc("color",n.color)("target",o)("collapsed",n.collapsed)}}var vw=function(e){return{"mat-list-item-light":e}};Error;var yw,kw=function(e){return e[e.null=0]="null",e[e.read=1]="read",e[e.write=2]="write",e}({}),Sw=((yw=function(){function e(t,i,o,n,r,a){var s=this;_classCallCheck(this,e),this.http=t,this.authService=i,this.languageService=o,this.config=n,this.messageService=r,this.route=a,this.context$=new L.a(void 0),this.contexts$=new L.a({ours:[]}),this.defaultContextId$=new L.a(void 0),this.editedContext$=new L.a(void 0),this.importedContext=[],this.mapViewFromRoute={},this.options=Object.assign({basePath:"contexts",contextListFile:"_contexts.json",defaultContextUri:"_default"},this.config.getConfig("context")),this.baseUrl=this.options.url,this.readParamsFromRoute(),this.authService.authenticate$.subscribe((function(e){e&&s.baseUrl?s.get().subscribe((function(e){s.handleContextsChange(e)})):(s.contexts$.pipe(Object(vc.a)()).subscribe((function(e){s.handleContextsChange(e)})),s.loadContexts())}))}return _createClass(e,[{key:"get",value:function(e,t){var i=this.baseUrl+"/contexts";return e&&this.authService.authenticated&&(i+="?permission="+e.join(),t&&(i+="&hidden=true")),this.http.get(i)}},{key:"getById",value:function(e){return this.http.get(this.baseUrl+"/contexts/"+e)}},{key:"getDetails",value:function(e){var t=this;return this.http.get("".concat(this.baseUrl,"/contexts/").concat(e,"/details")).pipe(Object(C.a)((function(i){return t.handleError(i,e)})))}},{key:"getDefault",value:function(){var e=this;return this.http.get(this.baseUrl+"/contexts/default").pipe(Object(x.a)((function(t){e.defaultContextId$.next(t.id)})))}},{key:"getProfilByUser",value:function(){return this.baseUrl?this.http.get(this.baseUrl+"/profils?"):Object(F.a)([])}},{key:"setDefault",value:function(e){return this.http.post(this.baseUrl+"/contexts/default",{defaultContextId:e})}},{key:"hideContext",value:function(e){return this.http.post(this.baseUrl+"/contexts/"+e+"/hide",{})}},{key:"showContext",value:function(e){return this.http.post(this.baseUrl+"/contexts/"+e+"/show",{})}},{key:"delete",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o={ours:[]};return Object.keys(this.contexts$.value).forEach((function(i){return o[i]=t.contexts$.value[i].filter((function(t){return t.id!==e}))})),i?(this.importedContext=this.importedContext.filter((function(t){return t.id!==e})),Object(F.a)(this.contexts$.next(o))):this.http.delete(this.baseUrl+"/contexts/"+e).pipe(Object(x.a)((function(e){t.contexts$.next(o)})))}},{key:"create",value:function(e){var t=this;return this.http.post(this.baseUrl+"/contexts",JSON.stringify(e)).pipe(Object(w.a)((function(e){return e.permission=t.authService.authenticated?kw[kw.write]:kw[kw.read],t.contexts$.value.ours.unshift(e),t.contexts$.next(t.contexts$.value),e})))}},{key:"clone",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.http.post(this.baseUrl+"/contexts/"+e+"/clone",JSON.stringify(i)).pipe(Object(w.a)((function(e){return e.permission=kw[kw.write],t.contexts$.value.ours.unshift(e),t.contexts$.next(t.contexts$.value),e})))}},{key:"update",value:function(e,t){return this.http.patch(this.baseUrl+"/contexts/"+e,JSON.stringify(t))}},{key:"addToolAssociation",value:function(e,t){return this.http.post("".concat(this.baseUrl,"/contexts/").concat(e,"/tools"),JSON.stringify({toolId:t}))}},{key:"deleteToolAssociation",value:function(e,t){return this.http.delete("".concat(this.baseUrl,"/contexts/").concat(e,"/tools/").concat(t))}},{key:"getPermissions",value:function(e){return this.http.get(this.baseUrl+"/contexts/"+e+"/permissions")}},{key:"addPermissionAssociation",value:function(e,t,i){var o=this;return this.http.post("".concat(this.baseUrl,"/contexts/").concat(e,"/permissions"),JSON.stringify({profil:t,typePermission:i})).pipe(Object(C.a)((function(e){return[o.handleError(e,void 0,!0)]})))}},{key:"deletePermissionAssociation",value:function(e,t){return this.http.delete("".concat(this.baseUrl,"/contexts/").concat(e,"/permissions/").concat(t))}},{key:"getLocalContexts",value:function(){var e=this.getPath(this.options.contextListFile);return this.http.get(e).pipe(Object(w.a)((function(e){return{ours:e}})))}},{key:"getLocalContext",value:function(e){var t=this,i=this.getPath(e+".json");return this.http.get(i).pipe(Object(bc.a)((function(i){if(!i.base)return Object(F.a)(i);var o=t.getPath(i.base+".json");return t.http.get(o).pipe(Object(w.a)((function(e){var t=i;return t.map=E.mergeDeep(e.map,i.map),t.layers=(e.layers||[]).concat(i.layers||[]).reverse().filter((function(e,t,i){return!e.id||i.findIndex((function(t){return t.id===e.id}))===t})).reverse(),t.toolbar=i.toolbar||e.toolbar,t.message=i.message||e.message,t.tools=(i.tools||[]).concat(e.tools||[]).filter((function(e,t,i){return i.findIndex((function(t){return t.name===e.name}))===t})),t})),Object(C.a)((function(i){return t.handleError(i,e)})))})),Object(C.a)((function(i){return t.handleError(i,e)})))}},{key:"loadContexts",value:function(e,t){var i=this;(this.baseUrl?this.get(e,t):this.getLocalContexts()).subscribe((function(e){e.ours=i.importedContext.concat(e.ours),i.contexts$.next(e)}))}},{key:"loadDefaultContext",value:function(){var e=this,t=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!t&&e.baseUrl&&e.authService.authenticated?e.getDefault().subscribe((function(t){e.defaultContextUri=t.uri,e.addContextToList(t),e.setContext(t)}),(function(){e.defaultContextId$.next(void 0),e.loadContext(e.defaultContextUri)})):e.loadContext(e.defaultContextUri)};this.route&&this.route.options.contextKey?this.route.queryParams.pipe(Object(O.a)(100)).subscribe((function(i){var o=i[e.route.options.contextKey],n=!1;o&&(e.defaultContextUri=o,n=!0),t(n)})):t()}},{key:"loadContext",value:function(e){var t=this,i=this.context$.value;i&&i.uri===e||this.getContextByUri(e).pipe(Object(vc.a)()).subscribe((function(e){t.addContextToList(e),t.setContext(e)}),(function(i){e!==t.options.defaultContextUri&&t.loadContext(t.options.defaultContextUri)}))}},{key:"setContext",value:function(e){this.handleContextMessage(e);var t=this.context$.value;if(t&&e&&e.id===t.id)return void 0===e.map.view.keepCurrentView&&(e.map.view.keepCurrentView=!0),void this.context$.next(e);e.map||(e.map={view:{}}),Object.assign(e.map.view,this.mapViewFromRoute),this.context$.next(e)}},{key:"loadEditedContext",value:function(e){var t=this;this.getContextByUri(e).subscribe((function(e){t.setEditedContext(e)}))}},{key:"setEditedContext",value:function(e){this.editedContext$.next(e)}},{key:"getContextFromMap",value:function(e,t){var i,o=e.ol.getView(),n=o.getProjection().getCode(),r=new pl.a(o.getCenter()).transform(n,"EPSG:4326"),a={uri:G(),title:"",scope:"private",map:{view:{center:r.getCoordinates(),zoom:o.getZoom(),projection:n,maxZoomOnExtent:e.viewController.maxZoomOnExtent}},layers:[],tools:[]},s=0,c=_createForOfIteratorHelper(!0===t?e.layers$.getValue().filter((function(e){return!0===e.baseLayer||"searchPointerSummaryId"===e.options.id})).sort((function(e,t){return e.zIndex-t.zIndex})):e.layers$.getValue().sort((function(e,t){return e.zIndex-t.zIndex})));try{for(c.s();!(i=c.n()).done;){var l=i.value,u={id:l.options.id?String(l.options.id):void 0,layerOptions:{title:l.options.title,zIndex:++s,visible:l.visible},sourceOptions:{type:l.dataSource.options.type,params:l.dataSource.options.params,url:l.dataSource.options.url,queryable:l.queryable}};u.sourceOptions.type&&a.layers.push(u)}}catch(h){c.e(h)}finally{c.f()}return a.tools=this.tools.map((function(e){return{id:String(e.id),global:e.global}})),a}},{key:"getContextFromLayers",value:function(e,t,i){var o=this.context$.getValue(),n=e.ol.getView(),r=n.getProjection().getCode(),a={uri:i,title:i,map:{view:{center:new pl.a(n.getCenter()).transform(r,"EPSG:4326").getCoordinates(),zoom:n.getZoom(),projection:r}},layers:[],toolbar:[],tools:[],extraFeatures:[]},s=e.layers$.getValue();return a.layers=s.filter((function(e){return e.baseLayer})).map((function(e){return{baseLayer:!0,sourceOptions:e.options.sourceOptions,title:e.options.title,visible:e.visible}})),t.forEach((function(e){var t=o.layers.find((function(t){return e.id===t.source.id&&!t.baseLayer}));if(t){var i=t.style;t.styleByAttribute?i=void 0:t.clusterBaseStyle&&(i=void 0,delete t.sourceOptions.source,delete t.sourceOptions.format),a.layers.push({baseLayer:t.baseLayer,title:e.options.title,zIndex:e.zIndex,styleByAttribute:t.styleByAttribute,clusterBaseStyle:t.clusterBaseStyle,style:i,clusterParam:t.clusterParam,visible:e.visible,opacity:e.opacity,sourceOptions:t.sourceOptions})}else if("VECTOR"!==e.ol.type){var n=e.options;n.zIndex=e.zIndex,delete n.source,a.layers.push(n)}else{var r,s=new fl.a;r=e.ol.getSource()instanceof qc.a?s.writeFeatures(e.ol.getSource().getSource().getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}):s.writeFeatures(e.ol.getSource().getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}),(r=JSON.parse(r)).name=e.options.title,a.extraFeatures.push(r)}})),a.toolbar=this.toolbar,a.tools=this.tools,a}},{key:"setTools",value:function(e){this.tools=e}},{key:"setToolbar",value:function(e){this.toolbar=e}},{key:"handleContextMessage",value:function(e){this.contextMessage&&this.messageService.remove(this.contextMessage.id);var t=e.message;t&&(t.title=t.title?this.languageService.translate.instant(t.title):void 0,t.text=t.text?this.languageService.translate.instant(t.text):void 0,this.messageService.message(t))}},{key:"getContextByUri",value:function(e){if(this.baseUrl){for(var t,i=0,o=Object.keys(this.contexts$.value);i<o.length;i++){var n=o[i];if(t=this.contexts$.value[n].find((function(t){return t.uri===e})))break}return t&&t.imported?Object(F.a)(t):this.getDetails(t?t.id:e)}var r=this.contexts$.value.ours.find((function(t){return t.uri===e&&!0===t.imported}));return r?Object(F.a)(r):this.getLocalContext(e)}},{key:"getContextLayers",value:function(e){var t=[];return e.layers$.getValue().forEach((function(e){e.baseLayer||"searchPointerSummaryId"===e.options.id||t.push(e)})),t}},{key:"readParamsFromRoute",value:function(){var e=this;this.route&&this.route.queryParams.subscribe((function(t){var i=e.route.options.centerKey;i&&t[i]&&(e.mapViewFromRoute.center=t[i].split(",").map(Number),e.mapViewFromRoute.geolocate=!1);var o=e.route.options.projectionKey;o&&t[o]&&(e.mapViewFromRoute.projection=t[o]);var n=e.route.options.zoomKey;n&&t[n]&&(e.mapViewFromRoute.zoom=Number(t[n]))}))}},{key:"getPath",value:function(e){return"".concat(this.options.basePath.replace(/\/$/,""),"/").concat(e)}},{key:"handleError",value:function(e,t,i){var o=this.contexts$.value.ours.find((function(e){return e.uri===t})),n=o?o.title:t;throw e.error.title=this.languageService.translate.instant("igo.context.contextManager.invalid.title"),e.error.message=this.languageService.translate.instant("igo.context.contextManager.invalid.text",{value:n}),e.error.toDisplay=!0,i&&(e.error.title=this.languageService.translate.instant("igo.context.contextManager.errors.addPermissionTitle"),e.error.message=this.languageService.translate.instant("igo.context.contextManager.errors.addPermission")),e}},{key:"handleContextsChange",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.context$.value,o=this.editedContext$.value;t&&this.findContext(i)?(void 0===i.map.view.keepCurrentView&&(i.map.view.keepCurrentView=!0),this.context$.next(i),this.baseUrl&&this.authService.authenticated&&this.getDefault().subscribe()):this.loadDefaultContext();var n=this.findContext(o);n&&"write"===n.permission||this.setEditedContext(void 0)}},{key:"addContextToList",value:function(e){if(!this.findContext(e)){var t={id:e.id,uri:e.uri,title:e.title,scope:e.scope,permission:kw[kw.read]};this.contexts$.value&&this.contexts$.value.public&&(this.contexts$.value.public.push(t),this.contexts$.next(this.contexts$.value))}}},{key:"findContext",value:function(e){if(!e)return!1;for(var t,i=this.contexts$.value,o=0,n=Object.keys(i);o<n.length&&!(t=i[n[o]].find((function(t){return e.id&&t.id===e.id||e.uri&&t.uri===e.uri})));o++);return t}},{key:"defaultContextUri",get:function(){return this._defaultContextUri||this.options.defaultContextUri},set:function(e){this._defaultContextUri=e}}]),e}()).\u0275fac=function(e){return new(e||yw)(r.bc(k.b),r.bc(Hs),r.bc(Le),r.bc(ie),r.bc(Ie),r.bc(Me,8))},yw.\u0275prov=Object(r.Nb)({factory:function(){return new yw(Object(r.bc)(k.b),Object(r.bc)(Hs),Object(r.bc)(Le),Object(r.bc)(ie),Object(r.bc)(Ie),Object(r.bc)(Me,8))},token:yw,providedIn:"root"}),yw);Error;var Cw,ww,xw,Ow,Iw,Lw,Tw,Fw,_w,Mw,Dw,Pw,Aw,jw,Rw,$w,Ew,Ww,Xw,Gw,Bw=((xw=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}()).\u0275mod=r.Pb({type:xw}),xw.\u0275inj=r.Ob({factory:function(e){return new(e||xw)},imports:[[tt.k,tt.u,m.c,l.b,Ol.c,yl.b,Tl.c,ot.b,dt.p,it.e,et.c,v.b,Ce,Or,g.b]]}),xw),Vw=((ww=function(){function e(t,i){_classCallCheck(this,e),this.contextService=i,this.component=t}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.context$$=this.contextService.context$.pipe(Object(qe.a)((function(e){return void 0!==e}))).subscribe((function(t){return e.handleContextChange(t)}))}},{key:"ngOnDestroy",value:function(){this.context$$.unsubscribe()}},{key:"handleContextChange",value:function(e){if(void 0!==e.map){var t=e.map.view;this.component.view&&!0===t.keepCurrentView||(this.component.view=t)}}},{key:"map",get:function(){return this.component.map}}]),e}()).\u0275fac=function(e){return new(e||ww)(r.Rb(om),r.Rb(Sw))},ww.\u0275dir=r.Mb({type:ww,selectors:[["","igoMapContext",""]]}),ww),Nw=((Cw=function(){function e(t,i,o,n,r,a,s){_classCallCheck(this,e),this.component=t,this.contextService=i,this.layerService=o,this.configService=n,this.styleListService=r,this.styleService=a,this.route=s,this.contextLayers=[],this.removeLayersOnContextChange=!0}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;if(this.context$$=this.contextService.context$.pipe(Object(qe.a)((function(e){return void 0!==e}))).subscribe((function(t){return e.handleContextChange(t)})),this.route&&this.route.options.visibleOnLayersKey&&this.route.options.visibleOffLayersKey&&this.route.options.contextKey)var t=this.route.queryParams.subscribe((function(i){Object.keys(i).length>0&&(e.queryParams=i,t.unsubscribe())}))}},{key:"ngOnDestroy",value:function(){this.context$$.unsubscribe()}},{key:"handleContextChange",value:function(e){var t=this;if(void 0!==e.layers){!0===this.removeLayersOnContextChange?this.map.removeAllLayers():this.map.removeLayers(this.contextLayers),this.contextLayers=[];var i=Object(Ne.a).apply(void 0,_toConsumableArray(e.layers.map((function(e,i){return t.layerService.createAsyncLayer(e)}))));i.pipe(Object(zC.a)(i.pipe(Object(O.a)(500)))).subscribe((function(i){i=i.filter((function(e){return void 0!==e})).map((function(e){return e.visible=t.computeLayerVisibilityFromUrl(e),e.zIndex=e.zIndex,e})),t.contextLayers.concat(i),t.map.addLayers(i),e.extraFeatures&&e.extraFeatures.forEach((function(e){var i=new fl.a,o=e.name;e=JSON.stringify(e),e=i.readFeatures(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}),t.configService.getConfig("importWithStyle")?function(e,t,i,o,n){var r,a,s;if(o.getStyleList(i.toString()+".styleByAttribute")){var c=o.getStyleList(i.toString()+".styleByAttribute");r=function(e){return n.createStyleByAttribute(e,c)}}else if(o.getStyleList(i.toString()+".clusterStyle")){var l=o.getStyleList(i.toString()+".clusterParam");a=o.getStyleList(i.toString()+".distance");var u=n.createStyle(o.getStyleList(i.toString()+".clusterStyle"));r=function(e){return n.createClusterStyle(e,l,u)}}else r=o.getStyleList(i.toString()+".style")?n.createStyle(o.getStyleList(i.toString()+".style")):n.createStyle(o.getStyleList("default.style"));o.getStyleList(i.toString()+".clusterStyle")?(s=new cf({distance:a,type:"cluster",queryable:!0})).ol.source.addFeatures(e):(s=new Pg({type:"vector",queryable:!0})).ol.addFeatures(e);var h=new wf({title:i,source:s,style:r});t.addLayer(h)}(e,t.map,o,t.styleListService,t.styleService):function(e,t,i){var o=Math.floor(255*Math.random()),n=Math.floor(255*Math.random()),r=Math.floor(255*Math.random()),a=new Uc.Stroke({color:[o,n,r,1],width:2}),s=new Uc.Fill({color:[o,n,r,.4]}),c=new Pg({type:"vector",queryable:!0});c.ol.addFeatures(e);var l=new wf({title:i,source:c,style:new Uc.Style({stroke:a,fill:s,image:new Uc.Circle({radius:5,stroke:a,fill:s})})});t.addLayer(l)}(e,t.map,o)}))}))}}},{key:"computeLayerVisibilityFromUrl",value:function(e){var t=this.queryParams,i=e.id,o=e.visible;if(!t||!i)return o;var n=t[this.route.options.contextKey];if(n===this.contextService.context$.value.uri||!n){var r="",a="",s=[],c=[];this.route.options.visibleOnLayersKey&&t[this.route.options.visibleOnLayersKey]&&(r=t[this.route.options.visibleOnLayersKey]),this.route.options.visibleOffLayersKey&&t[this.route.options.visibleOffLayersKey]&&(a=t[this.route.options.visibleOffLayersKey]),"*"===r&&(o=!0),"*"===a&&(o=!1),s=r.split(","),c=a.split(","),s.indexOf(i)>-1&&(o=!0),c.indexOf(i)>-1&&(o=!1)}return o}},{key:"map",get:function(){return this.component.map}}]),e}()).\u0275fac=function(e){return new(e||Cw)(r.Rb(om),r.Rb(Sw),r.Rb(Ff),r.Rb(ie),r.Rb(Ly),r.Rb(Tf),r.Rb(Me,8))},Cw.\u0275dir=r.Mb({type:Cw,selectors:[["","igoLayerContext",""]],inputs:{removeLayersOnContextChange:"removeLayersOnContextChange"}}),Cw),zw=function(e){return e.always="always",e.never="never",e.default="default",e}({}),qw=((Gw=function e(t){_classCallCheck(this,e),this.dialogRef=t}).\u0275fac=function(e){return new(e||Gw)(r.Rb(Je.f))},Gw.\u0275cmp=r.Lb({type:Gw,selectors:[["igo-bookmark-dialog"]],decls:14,vars:14,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],["matInput","","required","","autocomplete","off","maxlength","128",3,"placeholder","ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","","color","primary",3,"disabled","click"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(r.Xb(0,"h1",0),r.Ic(1),r.jc(2,"translate"),r.Wb(),r.Xb(3,"div",1),r.Xb(4,"mat-form-field"),r.Xb(5,"input",2),r.ec("ngModelChange",(function(e){return t.title=e})),r.jc(6,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Xb(7,"div",3),r.Xb(8,"button",4),r.ec("click",(function(){return t.dialogRef.close(t.title)})),r.Ic(9),r.jc(10,"translate"),r.Wb(),r.Xb(11,"button",5),r.ec("click",(function(){return t.dialogRef.close(!1)})),r.Ic(12),r.jc(13,"translate"),r.Wb(),r.Wb()),2&e&&(r.Db(1),r.Jc(r.kc(2,6,"igo.context.bookmarkButton.dialog.title")),r.Db(4),r.oc("placeholder",r.kc(6,8,"igo.context.bookmarkButton.dialog.placeholder"))("ngModel",t.title),r.Db(3),r.oc("disabled",!t.title),r.Db(1),r.Kc(" ",r.kc(10,10,"igo.common.confirmDialog.confirmBtn")," "),r.Db(3),r.Kc(" ",r.kc(13,12,"igo.common.confirmDialog.cancelBtn")," "))},directives:[Je.g,Je.d,it.c,et.b,tt.c,tt.v,tt.l,tt.p,tt.s,Je.c,l.a],pipes:[U.d],encapsulation:2}),Gw),Hw=((Xw=function(){function e(t,i,o,n,a,s){_classCallCheck(this,e),this.cdRef=t,this.contextService=i,this.auth=o,this.dialog=n,this.languageService=a,this.storageService=s,this.contextsInitial={ours:[]},this.contexts$=new L.a(this.contextsInitial),this.change$=new Ge.a(1),this._contexts={ours:[]},this.collapsed=[],this.select=new r.o,this.unselect=new r.o,this.edit=new r.o,this.delete=new r.o,this.save=new r.o,this.clone=new r.o,this.create=new r.o,this.hide=new r.o,this.show=new r.o,this.showHiddenContexts=new r.o,this.favorite=new r.o,this.managePermissions=new r.o,this.manageTools=new r.o,this.filterPermissionsChanged=new r.o,this.titleMapping={ours:"igo.context.contextManager.ourContexts",shared:"igo.context.contextManager.sharedContexts",public:"igo.context.contextManager.publicContexts"},this.permissions=[],this.actionStore=new kn([]),this.actionbarMode=yn.Overlay,this.color="primary",this.showHidden=!1,this._term="",this._sortedAlpha=void 0,this.showContextFilter=zw.always,this.thresholdToFilter=5}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.change$$=this.change$.pipe(Object(yc.a)((function(){return 0===e.contexts.ours.length?pc.a:Object(gc.a)(50)}))).subscribe((function(){e.contexts$.next(e.filterContextsList(e.contexts))})),this.actionStore.load([{id:"emptyContext",title:this.languageService.translate.instant("igo.context.contextManager.emptyContext"),icon:"map-outline",tooltip:this.languageService.translate.instant("igo.context.contextManager.emptyContextTooltip"),handler:function(){e.createContext(!0)}},{id:"contextFromMap",title:this.languageService.translate.instant("igo.context.contextManager.contextMap"),icon:"map-check",tooltip:this.languageService.translate.instant("igo.context.contextManager.contextMapTooltip"),handler:function(){e.createContext(!1)}}])}},{key:"next",value:function(){this.change$.next()}},{key:"filterContextsList",value:function(e){var t=this;if(""===this.term)return this.sortedAlpha&&(e=this.sortContextsList(e)),e;var i={ours:e.ours.filter((function(e){var i=t.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(i)}))};if(this.contexts.public){var o=e.public.filter((function(e){var i=t.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(i)}));i.public=o}if(this.contexts.shared){var n=e.shared.filter((function(e){var i=t.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(i)}));i.shared=n}return this.sortedAlpha&&(i=this.sortContextsList(i)),i}},{key:"ngOnDestroy",value:function(){this.change$$.unsubscribe()}},{key:"showFilter",value:function(){switch(this.showContextFilter){case zw.always:return!0;case zw.never:return!1;default:var e=this.contexts.ours.length;return e+=this.contexts.public?this.contexts.public.length:0,(e+=this.contexts.shared?this.contexts.shared.length:0)>=this.thresholdToFilter}}},{key:"sortContextsList",value:function(e){var t=this;if(e){var i=JSON.parse(JSON.stringify(e));return i.ours.sort((function(e,i){return t.normalize(e.title)<t.normalize(i.title)?-1:t.normalize(e.title)>t.normalize(i.title)?1:0})),i.shared?i.shared.sort((function(e,i){return t.normalize(e.title)<t.normalize(i.title)?-1:t.normalize(e.title)>t.normalize(i.title)?1:0})):i.public&&i.public.sort((function(e,i){return t.normalize(e.title)<t.normalize(i.title)?-1:t.normalize(e.title)>t.normalize(i.title)?1:0})),i}}},{key:"normalize",value:function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}},{key:"toggleSort",value:function(e){this.sortedAlpha=e}},{key:"clearFilter",value:function(){this.term=""}},{key:"createContext",value:function(e){var t=this;this.dialog.open(qw,{disableClose:!1}).afterClosed().subscribe((function(i){i&&t.create.emit({title:i,empty:e})}))}},{key:"getPermission",value:function(e){if(e)return this.permissions.find((function(t){return t.name===e.name}))}},{key:"userSelection",value:function(e,t){var i=this.getPermission(e);if(i&&(i.checked=!i.checked,this.storageService.set("contexts.permissions."+i.name,i.checked),i.indeterminate=!1),t){var o,n=!1,r=_createForOfIteratorHelper(t.childs);try{for(r.s();!(o=r.n()).done;){var a=o.value;if(this.getPermission(a).checked!==i.checked){n=!0;break}}}catch(d){r.e(d)}finally{r.f()}var s=this.getPermission(t);s&&(s.checked=i.checked,this.storageService.set("contexts.permissions."+s.name,i.checked),s.indeterminate=n)}if(e.childs){var c,l=_createForOfIteratorHelper(e.childs);try{for(l.s();!(c=l.n()).done;){var u=c.value,h=this.getPermission(u);h&&h.checked!==i.checked&&(h.checked=i.checked,this.storageService.set("contexts.permissions."+h.name,i.checked))}}catch(d){l.e(d)}finally{l.f()}}this.filterPermissionsChanged.emit(this.permissions)}},{key:"hideContext",value:function(e){if(e.hidden=!0,!this.showHidden){var t={ours:[],shared:[],public:[]};t.ours=this.contexts.ours.filter((function(t){return t.id!==e.id})),t.shared=this.contexts.shared.filter((function(t){return t.id!==e.id})),t.public=this.contexts.public.filter((function(t){return t.id!==e.id})),this.contexts=t}this.hide.emit(e)}},{key:"showContext",value:function(e){e.hidden=!1,this.show.emit(e)}},{key:"contexts",get:function(){return this._contexts},set:function(e){this._contexts=e,this.cdRef.detectChanges(),this.next()}},{key:"selectedContext",get:function(){return this._selectedContext},set:function(e){this._selectedContext=e,this.cdRef.detectChanges()}},{key:"map",get:function(){return this._map},set:function(e){this._map=e}},{key:"defaultContextId",get:function(){return this._defaultContextId},set:function(e){this._defaultContextId=e}},{key:"term",set:function(e){this._term=e,this.next()},get:function(){return this._term}},{key:"sortedAlpha",get:function(){return this._sortedAlpha},set:function(e){this._sortedAlpha=e,this.next()}}]),e}()).\u0275fac=function(e){return new(e||Xw)(r.Rb(r.h),r.Rb(Sw),r.Rb(Hs),r.Rb(Je.b),r.Rb(Le),r.Rb($e))},Xw.\u0275cmp=r.Lb({type:Xw,selectors:[["igo-context-list"]],inputs:{contexts:"contexts",selectedContext:"selectedContext",map:"map",defaultContextId:"defaultContextId",term:"term"},outputs:{select:"select",unselect:"unselect",edit:"edit",delete:"delete",save:"save",clone:"clone",create:"create",hide:"hide",show:"show",showHiddenContexts:"showHiddenContexts",favorite:"favorite",managePermissions:"managePermissions",manageTools:"manageTools",filterPermissionsChanged:"filterPermissionsChanged"},decls:17,vars:16,consts:[[3,"navigation"],[3,"ngClass",4,"ngIf"],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["class","add-context-button","icon","plus",3,"iconColor","store","withIcon","withTitle","horizontal","mode",4,"ngIf"],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","matMenuTriggerFor",4,"ngIf"],["accountMenu","matMenu"],[4,"ngFor","ngForOf"],[1,"profilsMenu"],[1,"mat-menu-item",3,"checked","click","change"],["mat-menu-item",""],["ngFor","",3,"ngForOf"],[3,"ngClass"],["matInput","","type","text",3,"placeholder","ngModel","ngModelChange"],["mat-button","","mat-icon-button","","matSuffix","","class","clear-button","aria-label","Clear","color","warn",3,"click",4,"ngIf"],["mat-button","","mat-icon-button","","matSuffix","","aria-label","Clear","color","warn",1,"clear-button",3,"click"],["svgIcon","close"],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","click"],["color","primary","svgIcon","sort-alphabetical-variant"],["color","warn","svgIcon","sort-variant-remove"],["icon","plus",1,"add-context-button",3,"iconColor","store","withIcon","withTitle","horizontal","mode"],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","matMenuTriggerFor"],["color","primary","svgIcon","filter-menu"],[1,"mat-menu-item",3,"checked","indeterminate","click","change"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["subAccountMenu","matMenu"],["class","mat-menu-item",3,"checked","click","change",4,"ngFor","ngForOf"],["mat-menu-item","",3,"matMenuTriggerFor"],[3,"title","collapsed","toggle",4,"ngIf"],[4,"ngIf"],[3,"title","collapsed","toggle"],["igoListItem","","color","accent",3,"selected","context","default","edit","delete","clone","save","hide","show","favorite","manageTools","managePermissions","select","unselect"],["igoListItem","","color","accent",3,"selected","context","default","select","unselect"]],template:function(e,t){1&e&&(r.Xb(0,"igo-list",0),r.Gc(1,HC,4,6,"mat-form-field",1),r.Gc(2,UC,3,3,"button",2),r.Gc(3,YC,3,3,"button",2),r.Gc(4,KC,1,6,"igo-actionbar",3),r.Gc(5,ZC,3,4,"button",4),r.Xb(6,"mat-menu",null,5),r.Gc(8,tw,8,5,"ng-container",6),r.Xb(9,"span",7),r.Xb(10,"mat-checkbox",8),r.ec("click",(function(e){return e.stopPropagation()}))("change",(function(){return t.showHiddenContexts.emit()})),r.Wb(),r.Xb(11,"button",9),r.Ic(12),r.jc(13,"translate"),r.Wb(),r.Wb(),r.Wb(),r.Gc(14,aw,2,2,"ng-template",10),r.jc(15,"keyvalue"),r.jc(16,"async"),r.Wb()),2&e&&(r.oc("navigation",!0),r.Db(1),r.oc("ngIf",t.showFilter()),r.Db(1),r.oc("ngIf",!t.sortedAlpha),r.Db(1),r.oc("ngIf",t.sortedAlpha),r.Db(1),r.oc("ngIf",t.auth.authenticated),r.Db(1),r.oc("ngIf",t.auth.authenticated&&t.users&&t.users.length),r.Db(3),r.oc("ngForOf",t.users),r.Db(2),r.oc("checked",t.showHidden),r.Db(2),r.Kc(" ",r.kc(13,10,"igo.context.contextManager.showHidden")," "),r.Db(2),r.oc("ngForOf",r.kc(15,12,r.kc(16,14,t.contexts$))))},directives:function(){return[yr,m.l,y.d,m.k,v.a,y.a,it.c,m.j,et.b,tt.c,tt.p,tt.s,l.a,it.h,u.a,g.a,Sn,y.c,_n,Yw,vr]},pipes:function(){return[U.d,mr,m.b]},styles:[".context-filter-max-width[_ngcontent-%COMP%]{margin:5px;padding-left:6px;width:calc(100% - 100px)}.context-filter-min-width[_ngcontent-%COMP%]{margin:5px;padding-left:6px;width:calc(100% - 135px)}.clear-button[_ngcontent-%COMP%]{padding-right:5px}mat-form-field[_ngcontent-%COMP%]{height:40px}.profilsMenu[_ngcontent-%COMP%]{display:flex}.profilsMenu[_ngcontent-%COMP%] > mat-checkbox[_ngcontent-%COMP%]{width:8px}.add-context-button[_ngcontent-%COMP%]{display:inline-flex;margin:0;width:40px}"],changeDetection:0}),Xw),Uw=((Ww=function(){function e(t,i,o,n,r,a,s,c){_classCallCheck(this,e),this.contextService=i,this.mapService=o,this.languageService=n,this.confirmDialogService=r,this.messageService=a,this.auth=s,this.storageService=c,this.component=t}return _createClass(e,[{key:"onSelect",value:function(e){this.contextService.loadContext(e.uri)}},{key:"onEdit",value:function(e){this.contextService.loadEditedContext(e.uri)}},{key:"onSave",value:function(e){var t=this,i=this.mapService.getMap(),o=this.contextService.getContextFromMap(i),n=function(){var i=t.languageService.translate,o=i.instant("igo.context.contextManager.dialog.saveMsg",{value:e.title}),n=i.instant("igo.context.contextManager.dialog.saveTitle");t.messageService.success(o,n)};if(e.imported)return o.title=e.title,this.contextService.delete(e.id,!0),void this.contextService.create(o).subscribe((function(e){t.contextService.loadContext(e.uri),n()}));this.contextService.update(e.id,{layers:o.layers,map:{view:o.map.view}}).subscribe((function(){n()}))}},{key:"onFavorite",value:function(e){var t=this;this.contextService.setDefault(e.id).subscribe((function(){t.contextService.defaultContextId$.next(e.id);var i=t.languageService.translate,o=i.instant("igo.context.contextManager.dialog.favoriteMsg",{value:e.title}),n=i.instant("igo.context.contextManager.dialog.favoriteTitle");t.messageService.success(o,n)}))}},{key:"onManageTools",value:function(e){this.contextService.loadEditedContext(e.uri)}},{key:"onManagePermissions",value:function(e){this.contextService.loadEditedContext(e.uri)}},{key:"onDelete",value:function(e){var t=this,i=this.languageService.translate;this.confirmDialogService.open(i.instant("igo.context.contextManager.dialog.confirmDelete")).subscribe((function(o){o&&t.contextService.delete(e.id,e.imported).subscribe((function(){var o=i.instant("igo.context.contextManager.dialog.deleteMsg",{value:e.title}),n=i.instant("igo.context.contextManager.dialog.deleteTitle");t.messageService.info(o,n)}))}))}},{key:"onClone",value:function(e){var t=this;this.contextService.clone(e.id,{title:e.title+"-copy",uri:e.uri+"-copy"}).subscribe((function(){var i=t.languageService.translate,o=i.instant("igo.context.contextManager.dialog.cloneMsg",{value:e.title}),n=i.instant("igo.context.contextManager.dialog.cloneTitle");t.messageService.success(o,n)}))}},{key:"onCreate",value:function(e){var t=this,i=e.title,o=e.empty,n=this.contextService.getContextFromMap(this.component.map,o);n.title=i,this.contextService.create(n).subscribe((function(){var e=t.languageService.translate,i=e.instant("igo.context.bookmarkButton.dialog.createTitle"),o=e.instant("igo.context.bookmarkButton.dialog.createMsg",{value:n.title});t.messageService.success(o,i),t.contextService.loadContext(n.uri)}))}},{key:"loadContexts",value:function(){var e,t=["none"],i=_createForOfIteratorHelper(this.component.permissions);try{for(i.s();!(e=i.n()).done;){var o=e.value;!0!==o.checked&&!0!==o.indeterminate||t.push(o.name)}}catch(n){i.e(n)}finally{i.f()}this.contextService.loadContexts(t,!!this.component.showHidden)}},{key:"showHiddenContexts",value:function(){this.component.showHidden=!this.component.showHidden,this.storageService.set("contexts.showHidden",this.component.showHidden),this.loadContexts()}},{key:"onShowContext",value:function(e){this.contextService.showContext(e.id).subscribe()}},{key:"onHideContext",value:function(e){this.contextService.hideContext(e.id).subscribe()}},{key:"ngOnInit",value:function(){var e=this;this.component.contexts={ours:[]},this.component.showHidden=this.storageService.get("contexts.showHidden"),this.contexts$$=this.contextService.contexts$.subscribe((function(t){return e.handleContextsChange(t)})),this.defaultContextId$$=this.contextService.defaultContextId$.subscribe((function(t){e.component.defaultContextId=t})),this.selectedContext$$=this.contextService.context$.pipe(Object(O.a)(100)).subscribe((function(t){return e.component.selectedContext=t})),this.auth.authenticate$.subscribe((function(t){t&&e.contextService.getProfilByUser().subscribe((function(t){e.component.users=t,e.component.permissions=[];var i,o=_createForOfIteratorHelper(e.component.users.reduce((function(e,t){return e=e.concat(t),t.childs?e.concat(t.childs):e}),[]));try{for(o.s();!(i=o.n()).done;){var n=i.value,r={name:n.name,checked:e.storageService.get("contexts.permissions."+n.name)};null===r.checked&&(r.checked=!0),e.component.permissions.push(r)}}catch(u){o.e(u)}finally{o.f()}var a,s=["none"],c=_createForOfIteratorHelper(e.component.permissions);try{for(c.s();!(a=c.n()).done;){var l=a.value;!0!==l.checked&&!0!==l.indeterminate||s.push(l.name)}}catch(u){c.e(u)}finally{c.f()}e.contextService.loadContexts(s,!!e.component.showHidden)}))}))}},{key:"ngOnDestroy",value:function(){this.contexts$$.unsubscribe(),this.selectedContext$$.unsubscribe(),this.defaultContextId$$.unsubscribe()}},{key:"handleContextsChange",value:function(e){this.component.contexts=e}}]),e}()).\u0275fac=function(e){return new(e||Ww)(r.Rb(Hw,2),r.Rb(Sw),r.Rb(im),r.Rb(Le),r.Rb(Pn),r.Rb(Ie),r.Rb(Hs),r.Rb($e))},Ww.\u0275dir=r.Mb({type:Ww,selectors:[["","igoContextListBinding",""]],hostBindings:function(e,t){1&e&&r.ec("select",(function(e){return t.onSelect(e)}))("edit",(function(e){return t.onEdit(e)}))("save",(function(e){return t.onSave(e)}))("favorite",(function(e){return t.onFavorite(e)}))("manageTools",(function(e){return t.onManageTools(e)}))("managePermissions",(function(e){return t.onManagePermissions(e)}))("delete",(function(e){return t.onDelete(e)}))("clone",(function(e){return t.onClone(e)}))("create",(function(e){return t.onCreate(e)}))("filterPermissionsChanged",(function(){return t.loadContexts()}))("showHiddenContexts",(function(){return t.showHiddenContexts()}))("show",(function(e){return t.onShowContext(e)}))("hide",(function(e){return t.onHideContext(e)}))}}),Ww),Yw=((Ew=function(){function e(t,i){_classCallCheck(this,e),this.auth=t,this.storageService=i,this.typePermission=kw,this.color="primary",this.collapsed=!0,this._default=!1,this.edit=new r.o,this.delete=new r.o,this.save=new r.o,this.clone=new r.o,this.hide=new r.o,this.show=new r.o,this.favorite=new r.o,this.managePermissions=new r.o,this.manageTools=new r.o}return _createClass(e,[{key:"favoriteClick",value:function(e){this.auth.authenticated&&this.favorite.emit(e)}},{key:"context",get:function(){return this._context},set:function(e){this._context=e}},{key:"default",get:function(){return this._default},set:function(e){this._default=e}},{key:"hidden",get:function(){return this.context.hidden}},{key:"canShare",get:function(){return!0===this.storageService.get("canShare")}}]),e}()).\u0275fac=function(e){return new(e||Ew)(r.Rb(Hs),r.Rb($e))},Ew.\u0275cmp=r.Lb({type:Ew,selectors:[["igo-context-item"]],inputs:{context:"context",default:"default",selected:"selected"},outputs:{edit:"edit",delete:"delete",save:"save",clone:"clone",hide:"hide",show:"show",favorite:"favorite",managePermissions:"managePermissions",manageTools:"manageTools"},decls:5,vars:6,consts:[[1,"mat-list-item",3,"ngClass"],["mat-list-avatar","","mat-icon-button","","igoStopPropagation","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["matLine",""],["igoStopPropagation","","class","igo-actions-container",4,"ngIf"],["mat-list-avatar","","mat-icon-button","","igoStopPropagation","","matTooltipShowDelay","500",3,"matTooltip","color","click"],[3,"svgIcon",4,"ngIf"],[3,"src",4,"ngIf"],[3,"svgIcon"],[3,"src"],["igoStopPropagation","",1,"igo-actions-container"],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],[1,"igo-actions-expand-container"],["actions",""],["mat-icon-button","","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["mat-icon-button","","color","warn","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","igoCollapse","",3,"color","target","collapsed","click"],["svgIcon","dots-horizontal"],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","content-save"],["svgIcon","account-arrow-right"],["svgIcon","content-copy"],["mat-icon-button","","matTooltipShowDelay","500",3,"color","matTooltip","click"],["svgIcon","pencil"],["svgIcon","eye"],["svgIcon","eye-off"],["mat-icon-button","","color","warn","matTooltipShowDelay","500",3,"matTooltip","click"],["svgIcon","delete"]],template:function(e,t){1&e&&(r.Xb(0,"mat-list-item",0),r.Gc(1,lw,4,6,"button",1),r.Xb(2,"h4",2),r.Ic(3),r.Wb(),r.Gc(4,bw,12,10,"div",3),r.Wb()),2&e&&(r.oc("ngClass",r.rc(4,vw,t.hidden)),r.Db(1),r.oc("ngIf",t.auth.authenticated),r.Db(2),r.Jc(t.context.title),r.Db(1),r.oc("ngIf",t.auth.authenticated))},directives:[h.d,m.j,m.l,dt.k,l.a,h.b,ir,g.a,u.a,Fn],pipes:[U.d],styles:["[_nghost-%COMP%]{overflow:hidden}.igo-actions-container[_ngcontent-%COMP%]{flex-shrink:0}.igo-actions-expand-container[_ngcontent-%COMP%]{display:inline-flex}mat-list-item[_ngcontent-%COMP%]     .mat-list-item-content .mat-list-text{padding:0}mat-icon.disabled[_ngcontent-%COMP%]{color:rgba(0,0,0,.38)}mat-list-item.mat-list-item-light[_ngcontent-%COMP%]     .mat-list-item-content{color:#969696}"],changeDetection:0}),Ew),Kw=(($w=function(){function e(t,i){_classCallCheck(this,e),this.http=t,this.config=i,this.baseUrl=this.config.getConfig("context.url")}return _createClass(e,[{key:"get",value:function(){return this.baseUrl?this.http.get(this.baseUrl+"/pois"):pc.a}},{key:"delete",value:function(e){return this.http.delete(this.baseUrl+"/pois/"+e)}},{key:"create",value:function(e){return this.http.post(this.baseUrl+"/pois",JSON.stringify(e))}}]),e}()).\u0275fac=function(e){return new(e||$w)(r.bc(k.b),r.bc(ie))},$w.\u0275prov=r.Nb({token:$w,factory:$w.\u0275fac}),$w),Zw=((Rw=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}()).\u0275mod=r.Pb({type:Rw}),Rw.\u0275inj=r.Ob({factory:function(e){return new(e||Rw)},providers:[Kw],imports:[[m.c,Ce,An,or,cc,tt.k,u.b,l.b,ot.b,dt.p,g.b,it.e,Je.e,et.c]]}),Rw),Jw=((jw=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}()).\u0275mod=r.Pb({type:jw}),jw.\u0275inj=r.Ob({factory:function(e){return new(e||jw)},imports:[[m.c,tt.k,tt.u,it.e,et.c,u.b,l.b,g.b,h.e,v.b,Ll.c,Je.e,y.b,dt.p,xl.b,cc,kr,br,Mn,or,Ce,Bw,Zw,wn]]}),jw),Qw=((Aw=function(){function e(){_classCallCheck(this,e),this.selectedMode$=new L.a(void 0),this.exportOptions$=new L.a(void 0)}return _createClass(e,[{key:"setMode",value:function(e){this.selectedMode$.next(e)}},{key:"setsExportOptions",value:function(e){this.exportOptions$.next(e)}}]),e}()).\u0275fac=function(e){return new(e||Aw)},Aw.\u0275prov=Object(r.Nb)({factory:function(){return new Aw},token:Aw,providedIn:"root"}),Aw),ex=((Pw=function(){function e(t,i){_classCallCheck(this,e),this.toolService=t,this.importExportState=i,this.openSidenav$=new L.a(void 0)}return _createClass(e,[{key:"toolToActivateFromOptions",value:function(e){if(e){if("importExport"===e.tool){var t=this.importExportState.exportOptions$.value;t?(t.layers=e.options.layers,t.featureInMapExtent=e.options.featureInMapExtent):t={layers:e.options.layers,featureInMapExtent:e.options.featureInMapExtent},this.importExportState.setsExportOptions(t),this.importExportState.setMode("export")}this.toolbox.getTool(e.tool)&&(this.toolbox.activateTool(e.tool),this.openSidenav$.next(!0))}}},{key:"toolbox",get:function(){return this.toolService.toolbox}}]),e}()).\u0275fac=function(e){return new(e||Pw)(r.bc(pr),r.bc(Qw))},Pw.\u0275prov=Object(r.Nb)({factory:function(){return new Pw(Object(r.bc)(pr),Object(r.bc)(Qw))},token:Pw,providedIn:"root"}),Pw),tx=((Dw=function(){function e(t){_classCallCheck(this,e),this.igoStorageService=t}return _createClass(e,[{key:"storageService",get:function(){return this.igoStorageService}}]),e}()).\u0275fac=function(e){return new(e||Dw)(r.bc($e))},Dw.\u0275prov=Object(r.Nb)({factory:function(){return new Dw(Object(r.bc)($e))},token:Dw,providedIn:"root"}),Dw),ix=((Mw=function(){function e(t,i){_classCallCheck(this,e),this.storageState=t,this.toolState=i,this.zoomAuto$=new L.a(!1)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.storageChange$$&&this.storageChange$$.unsubscribe()}},{key:"loadActions",value:function(e){var t=this.buildActions(e);e.actionStore.load(t)}},{key:"buildActions",value:function(e){var t=this;return this.zoomAuto$.next(this.zoomAuto),this.storageChange$$=this.storageService.storageChange$.pipe(Object(mc.a)((function(e){return"zoomAuto"!==e.key}))).subscribe((function(){t.zoomAuto$.next(t.zoomAuto),t.handleZoomAuto(e)})),[{id:"zoomAuto",checkbox:!0,title:"igo.geo.workspace.zoomAuto.title",tooltip:oC(e),checkCondition:this.zoomAuto$,handler:function(){t.handleZoomAuto(e),t.storageService.set("zoomAuto",!t.storageService.get("zoomAuto"))}},{id:"filterInMapExtent",checkbox:!0,title:"igo.geo.workspace.inMapExtent.title",tooltip:iC(e),checkCondition:this.rowsInMapExtent,handler:function(){var i=e.entityStore.getStrategyOfType(gn);i.active?i.deactivate():i.activate(),t.storageService.set("rowsInMapExtent",!t.storageService.get("rowsInMapExtent"),je.SESSION)}},{id:"selectedOnly",checkbox:!0,title:"igo.geo.workspace.selected.title",tooltip:"selectedOnly",checkCondition:!1,handler:function(){var t=e.entityStore.getStrategyOfType(fn);t.active?t.deactivate():t.activate()}},{id:"clearselection",icon:"select-off",title:"igo.geo.workspace.clearSelection.title",tooltip:"igo.geo.workspace.clearSelection.tooltip",handler:function(e){e.entityStore.state.updateMany(e.entityStore.view.all(),{selected:!1})},args:[e],availability:function(e){return nC(e)}},{id:"featureDownload",icon:"download",title:"igo.geo.workspace.download.title",tooltip:"igo.geo.workspace.download.tooltip",handler:function(e){var i=e.entityStore.getStrategyOfType(gn),o=e.entityStore.getStrategyOfType(fn);t.toolState.toolToActivateFromOptions({tool:"importExport",options:{layers:[e.layer.id],featureInMapExtent:i.active,layersWithSelection:o.active?[e.layer.id]:[]}})},args:[e]}]}},{key:"handleZoomAuto",value:function(e){e.entityStore.getStrategyOfType(Bf).setMotion(this.zoomAuto?Mf.Default:Mf.None)}},{key:"storageService",get:function(){return this.storageState.storageService}},{key:"zoomAuto",get:function(){return this.storageService.get("zoomAuto")}},{key:"rowsInMapExtent",get:function(){return this.storageService.get("rowsInMapExtent")}}]),e}()).\u0275fac=function(e){return new(e||Mw)(r.bc(tx),r.bc(ex))},Mw.\u0275prov=Object(r.Nb)({factory:function(){return new Mw(Object(r.bc)(tx),Object(r.bc)(ex))},token:Mw,providedIn:"root"}),Mw),ox=((_w=function(){function e(t,i,o){_classCallCheck(this,e),this.ogcFilterWidget=t,this.storageState=i,this.toolState=o,this.zoomAuto$=new L.a(!1)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.storageChange$$&&this.storageChange$$.unsubscribe()}},{key:"loadActions",value:function(e){var t=this.buildActions(e);e.actionStore.load(t)}},{key:"buildActions",value:function(e){var t=this;return this.zoomAuto$.next(this.zoomAuto),this.storageService.storageChange$.pipe(Object(mc.a)((function(e){return"zoomAuto"!==e.key}))).subscribe((function(){t.zoomAuto$.next(t.zoomAuto),t.handleZoomAuto(e)})),[{id:"zoomAuto",checkbox:!0,title:"igo.geo.workspace.zoomAuto.title",tooltip:oC(e),checkCondition:this.zoomAuto$,handler:function(){t.handleZoomAuto(e),t.storageService.set("zoomAuto",!t.storageService.get("zoomAuto"))}},{id:"filterInMapExtent",checkbox:!0,title:"igo.geo.workspace.inMapExtent.title",tooltip:iC(e),checkCondition:this.rowsInMapExtent,handler:function(){var i=e.entityStore.getStrategyOfType(gn);i.active?i.deactivate():i.activate(),t.storageService.set("rowsInMapExtent",!t.storageService.get("rowsInMapExtent"),je.SESSION)}},{id:"selectedOnly",checkbox:!0,title:"igo.geo.workspace.selected.title",tooltip:"selectedOnly",checkCondition:!1,handler:function(){var t=e.entityStore.getStrategyOfType(fn);t.active?t.deactivate():t.activate()}},{id:"clearselection",icon:"select-off",title:"igo.geo.workspace.clearSelection.title",tooltip:"igo.geo.workspace.clearSelection.tooltip",handler:function(e){e.entityStore.state.updateMany(e.entityStore.view.all(),{selected:!1})},args:[e],availability:function(e){return nC(e)}},{id:"wfsDownload",icon:"download",title:"igo.geo.workspace.download.title",tooltip:"igo.geo.workspace.download.tooltip",handler:function(e){var i=e.entityStore.getStrategyOfType(gn),o=e.entityStore.getStrategyOfType(fn);t.toolState.toolToActivateFromOptions({tool:"importExport",options:{layers:[e.layer.id],featureInMapExtent:i.active,layersWithSelection:o.active?[e.layer.id]:[]}})},args:[e]},{id:"ogcFilter",icon:"filter",title:"igo.geo.workspace.ogcFilter.title",tooltip:"igo.geo.workspace.ogcFilter.tooltip",handler:function(e,t){t.activateWidget(e,{map:t.map,layer:t.layer})},args:[this.ogcFilterWidget,e]}]}},{key:"handleZoomAuto",value:function(e){e.entityStore.getStrategyOfType(Bf).setMotion(this.zoomAuto?Mf.Default:Mf.None)}},{key:"storageService",get:function(){return this.storageState.storageService}},{key:"zoomAuto",get:function(){return this.storageService.get("zoomAuto")}},{key:"rowsInMapExtent",get:function(){return this.storageService.get("rowsInMapExtent")}}]),e}()).\u0275fac=function(e){return new(e||_w)(r.bc(TS),r.bc(tx),r.bc(ex))},_w.\u0275prov=Object(r.Nb)({factory:function(){return new _w(Object(r.bc)(TS),Object(r.bc)(tx),Object(r.bc)(ex))},token:_w,providedIn:"root"}),_w),nx=((Fw=function(){function e(t,i){_classCallCheck(this,e),this.featureActionsService=t,this.wfsActionsService=i,this.workspacePanelExpanded=!1,this.workspaceEnabled$=new L.a(!1),this.activeWorkspaceWidget$=new L.a(void 0),this.workspace$=new L.a(void 0),this.initWorkspaces()}return _createClass(e,[{key:"initWorkspaces",value:function(){var e=this;this._store=new da([]),this._store.stateView.firstBy$((function(e){return!0===e.state.active})).subscribe((function(t){e.workspace$.next(t?t.entity:void 0)})),this._store.stateView.all$().subscribe((function(t){t.map((function(t){t.entity.actionStore.empty&&(t.entity instanceof ES?e.wfsActionsService.loadActions(t.entity):t.entity instanceof XS&&e.featureActionsService.loadActions(t.entity))}))})),this.activeWorkspace$$=this.workspace$.subscribe((function(t){void 0!==e.activeWorkspaceWidget$$&&(e.activeWorkspaceWidget$$.unsubscribe(),e.activeWorkspaceWidget$$=void 0),void 0!==t&&(e.activeWorkspaceWidget$$=t.widget$.subscribe((function(t){return e.activeWorkspaceWidget$.next(t)})))}))}},{key:"setActiveWorkspaceByLayerId",value:function(e){var t=this.store.all().find((function(t){return t.layer.id===e}));t&&this.store.activateWorkspace(t)}},{key:"ngOnDestroy",value:function(){this.teardownWorkspaces()}},{key:"teardownWorkspaces",value:function(){this.store.clear(),void 0!==this.activeWorkspaceWidget$$&&this.activeWorkspaceWidget$$.unsubscribe(),void 0!==this.activeWorkspace$$&&this.activeWorkspace$$.unsubscribe()}},{key:"store",get:function(){return this._store}}]),e}()).\u0275fac=function(e){return new(e||Fw)(r.bc(ix),r.bc(ox))},Fw.\u0275prov=Object(r.Nb)({factory:function(){return new Fw(Object(r.bc)(ix),Object(r.bc)(ox))},token:Fw,providedIn:"root"}),Fw),rx=((Tw=function(){function e(t){_classCallCheck(this,e),this.searchSourceService=t,this.searchTerm$=new L.a(void 0),this.searchType$=new L.a(void 0),this.searchDisabled$=new L.a(!1),this.searchSettingsChange$=new L.a(void 0),this.selectedResult$=new L.a(void 0),this.store=new hn([])}return _createClass(e,[{key:"enableSearch",value:function(){this.searchDisabled$.next(!1)}},{key:"disableSearch",value:function(){this.searchDisabled$.next(!0)}},{key:"setSearchTerm",value:function(e){this.searchTerm$.next(e)}},{key:"setSearchType",value:function(e){this.searchSourceService.enableSourcesByType(e),this.searchType$.next(e)}},{key:"setSearchSettingsChange",value:function(){this.searchSettingsChange$.next(!0)}},{key:"setSelectedResult",value:function(e){this.selectedResult$.next(e)}},{key:"searchTypes",get:function(){return this.searchSourceService.getEnabledSources().map((function(e){return e.constructor.type}))}}]),e}()).\u0275fac=function(e){return new(e||Tw)(r.bc(pk))},Tw.\u0275prov=Object(r.Nb)({factory:function(){return new Tw(Object(r.bc)(pk))},token:Tw,providedIn:"root"}),Tw),ax=((Lw=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Lw}),Lw.\u0275inj=r.Ob({factory:function(e){return new(e||Lw)},imports:[[IS]]}),Lw),sx=((Iw=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Iw}),Iw.\u0275inj=r.Ob({factory:function(e){return new(e||Iw)},imports:[[m.c,u.b,l.b,Ce,Rb,IS,zn,Cr,Ab,En]]}),Iw),cx=((Ow=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Ow}),Ow.\u0275inj=r.Ob({factory:function(e){return new(e||Ow)},imports:[[],ax,sx]}),Ow),lx=["mapBrowser"];function ux(e,t){1&e&&(r.Xb(0,"span",11),r.Ic(1," F2 activate/desactivate the pointer location. "),r.Wb())}function hx(e,t){if(1&e&&r.Sb(0,"igo-search-add-button",12),2&e){var i=t.result,o=r.ic();r.oc("map",o.map)("layer",i)}}function dx(e,t){if(1&e&&(r.Xb(0,"igo-panel",11),r.Sb(1,"igo-feature-details",13),r.Wb()),2&e){var i=r.ic();r.Db(1),r.oc("feature",i.selectedFeature)}}function px(e,t){if(1&e&&r.Sb(0,"igo-actionbar",14),2&e){var i=r.ic();r.oc("store",i.store)("withIcon",!1)("horizontal",!0)("mode","context")}}var gx,fx,mx,bx,vx,yx,kx,Sx,Cx,wx,xx,Ox,Ix=f.e.forChild([{path:"search",component:(gx=function(){function e(t,i,o,n,r,a,s){var c=this;_classCallCheck(this,e),this.languageService=t,this.projectionService=i,this.mapService=o,this.layerService=n,this.searchState=r,this.searchService=a,this.mediaService=s,this.store=new kn([]),this.igoSearchPointerSummaryEnabled=!1,this.map=new tm({overlay:!0,controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.settingsChange$=new L.a(void 0),this.mapService.setMap(this.map),this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe((function(e){c.osmLayer=e,c.map.addLayer(e)}))}return _createClass(e,[{key:"onPointerSummaryStatusChange",value:function(e){this.igoSearchPointerSummaryEnabled=e}},{key:"onSearchTermChange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.term=e,e.replace(/(#[^\s]*)/g,"").trim().length<2&&(this.searchStore.clear(),this.selectedFeature=void 0)}},{key:"onSearch",value:function(e){var t=e.results;this.searchStore.state.updateAll({focused:!1,selected:!1});var i=this.searchStore.entities$.value.filter((function(t){return t.source!==e.research.source})).concat(t);this.searchStore.load(i)}},{key:"onSearchSettingsChange",value:function(){this.settingsChange$.next(!0)}},{key:"onResultFocus",value:function(e){this.tryAddFeatureToMap(e),this.selectedFeature=e.data}},{key:"tryAddFeatureToMap",value:function(e){e.meta.dataType===_f&&void 0!==e.data.geometry&&this.map.overlay.setFeatures([e.data],Mf.Default)}},{key:"ngOnInit",value:function(){this.store.load([{id:"coordinates",title:"coordinates",handler:this.onSearchCoordinate.bind(this)},{id:"googleMaps",title:"googleMap",handler:this.onOpenGoogleMaps.bind(this),args:["1"]},{id:"googleStreetView",title:"googleStreetView",handler:this.onOpenGoogleStreetView.bind(this)}])}},{key:"ngOnDestroy",value:function(){this.store.destroy()}},{key:"removeFeatureFromMap",value:function(){this.map.overlay.clear()}},{key:"onContextMenuOpen",value:function(e){var t=this.mapPosition(e),i=this.mapService.getMap().ol.getCoordinateFromPixel(t);this.mapProjection=this.mapService.getMap().projection,this.lonlat=kc.r(i,this.mapProjection,"EPSG:4326")}},{key:"mapPosition",value:function(e){var t=e;return t.y=t.y-this.mapBrowser.nativeElement.getBoundingClientRect().top+window.scrollY,t.x=t.x-this.mapBrowser.nativeElement.getBoundingClientRect().left+window.scrollX,[t.x,t.y]}},{key:"onPointerSearch",value:function(e){this.lonlat=e,this.onSearchCoordinate()}},{key:"onSearchCoordinate",value:function(){var e=this;this.searchStore.clear();var t=this.searchService.reverseSearch(this.lonlat),i=function(i){t.length>0&&t[i].request.subscribe((function(o){e.onSearch({research:t[i],results:o})}))};for(var o in t)i(o)}},{key:"onOpenGoogleMaps",value:function(){window.open(tb.getGoogleMapsCoordLink(this.lonlat[0],this.lonlat[1]))}},{key:"onOpenGoogleStreetView",value:function(){window.open(tb.getGoogleStreetViewLink(this.lonlat[0],this.lonlat[1]))}},{key:"searchStore",get:function(){return this.searchState.store}},{key:"isTouchScreen",get:function(){return this.mediaService.isTouchScreen()}}]),e}(),gx.\u0275fac=function(e){return new(e||gx)(r.Rb(Le),r.Rb(ff),r.Rb(im),r.Rb(Ff),r.Rb(rx),r.Rb(vk),r.Rb(Ae))},gx.\u0275cmp=r.Lb({type:gx,selectors:[["app-search"]],viewQuery:function(e,t){var i;1&e&&r.Ec(lx,!0,r.l),2&e&&r.uc(i=r.fc())&&(t.mapBrowser=i.first)},decls:31,vars:13,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/search"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],["title","Details",4,"ngIf"],["igoOverlay","","igoSearchPointerSummary","",3,"map","view","igoContextMenu","igoSearchPointerSummaryDelay","igoSearchPointerSummaryEnabled","menuPosition"],["mapBrowser",""],["color","primary",3,"map"],["title","Search"],[3,"searchSettings","store","pointerSummaryStatus","searchTermChange","search","clearFeature","searchSettingsChange"],["placeholder","false",3,"store","term","settingsChange$","resultFocus","resultSelect","moreResults"],["igoSearchItemToolbar",""],["actionbarMenu",""],["title","Details"],[3,"map","layer"],[3,"feature"],[3,"store","withIcon","horizontal","mode"]],template:function(e,t){if(1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Search"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"Dependencies: ConfigService, LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"br"),r.Ic(13," See search section of the "),r.Xb(14,"a",1),r.Ic(15," environment config"),r.Wb(),r.Sb(16,"hr"),r.Sb(17,"br"),r.Gc(18,ux,2,0,"span",2),r.Wb(),r.Xb(19,"igo-map-browser",3,4),r.ec("menuPosition",(function(e){return t.onContextMenuOpen(e)})),r.Sb(21,"igo-zoom-button",5),r.Wb(),r.Xb(22,"igo-panel",6),r.Xb(23,"igo-search-bar",7),r.ec("pointerSummaryStatus",(function(e){return t.onPointerSummaryStatusChange(e)}))("searchTermChange",(function(e){return t.onSearchTermChange(e)}))("search",(function(e){return t.onSearch(e)}))("clearFeature",(function(){return t.removeFeatureFromMap()}))("searchSettingsChange",(function(){return t.onSearchSettingsChange()})),r.Wb(),r.Xb(24,"igo-search-results",8),r.ec("resultFocus",(function(e){return t.onResultFocus(e)}))("resultSelect",(function(e){return t.onResultFocus(e)}))("moreResults",(function(e){return t.onSearch(e)})),r.Gc(25,hx,1,2,"ng-template",null,9,r.Hc),r.Wb(),r.Wb(),r.Gc(27,dx,2,1,"igo-panel",2),r.Wb(),r.Gc(28,px,1,4,"ng-template",null,10,r.Hc),r.Sb(30,"igo-message-center")),2&e){var i=r.vc(29);r.Db(18),r.oc("ngIf",!t.isTouchScreen),r.Db(1),r.oc("map",t.map)("view",t.view)("igoContextMenu",i)("igoSearchPointerSummaryDelay",500)("igoSearchPointerSummaryEnabled",t.igoSearchPointerSummaryEnabled),r.Db(2),r.oc("map",t.map),r.Db(2),r.oc("searchSettings",!0)("store",t.searchStore),r.Db(1),r.oc("store",t.searchStore)("term",t.term)("settingsChange$",t.settingsChange$),r.Db(3),r.oc("ngIf",t.selectedFeature)}},directives:[b.a,b.e,b.f,b.c,m.l,om,CS,jn,rm,Sr,fS,vS,we,kS,Pb,Sn],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{height:100%;width:100%;padding-top:10px}"]}),gx)}]),Lx=((fx=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:fx}),fx.\u0275inj=r.Ob({factory:function(e){return new(e||fx)},providers:[{provide:Qm,useFactory:qk,multi:!0,deps:[ie,Le,ff]},{provide:Qm,useFactory:JS,multi:!0,deps:[k.b,Le,ie]},{provide:Qm,useFactory:Wk,multi:!0,deps:[k.b,Le,ie,jk,r.t]},{provide:Qm,useFactory:Jk,multi:!0,deps:[k.b,Le,ie,Yk]},{provide:Qm,useFactory:tC,multi:!0,deps:[k.b,ie]},{provide:Qm,useFactory:Xk,multi:!0,deps:[k.b,Le,ie,r.t]}],imports:[[m.c,Ix,b.d,l.b,u.b,g.b,xe.forRoot(),Cr,Hy,IS.forRoot(),cx,wn,Rn,Rb]]}),fx),Tx=f.e.forChild([{path:"print",component:(mx=function e(t,i){var o=this;_classCallCheck(this,e),this.languageService=t,this.layerService=i,this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:9},this.layerService.createAsyncLayer({title:"Quebec Base Map",sourceOptions:{type:"wmts",url:"https://geoegl.msp.gouv.qc.ca/apis/carto/wmts/1.0.0/wmts",layer:"carte_gouv_qc_ro",matrixSet:"EPSG_3857",version:"1.3.0",crossOrigin:"anonymous"}}).subscribe((function(e){return o.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"School board",sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{LAYERS:"MELS_CS_ANGLO_S",VERSION:"1.3.0"},crossOrigin:"anonymous"}}).subscribe((function(e){return o.map.addLayer(e)})),this.layerService.createAsyncLayer({title:"Embacle",sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"},crossOrigin:"anonymous"}}).subscribe((function(e){return o.map.addLayer(e)}))},mx.\u0275fac=function(e){return new(e||mx)(r.Rb(Le),r.Rb(Ff))},mx.\u0275cmp=r.Lb({type:mx,selectors:[["app-print"]],decls:29,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/print"],[3,"map","view"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[3,"map"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Print"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"npm install --save html2canvas@1.0.0-alpha.12"),r.Wb(),r.Xb(8,"li"),r.Ic(9,"npm install --save jspdf@1.4.1"),r.Wb(),r.Xb(10,"li"),r.Ic(11,"npm install --save file-saver@1.3.8"),r.Wb(),r.Xb(12,"li"),r.Ic(13,"npm install --save jszip@3.1.5"),r.Wb(),r.Xb(14,"li"),r.Ic(15,"npm install --save stream@0.0.2"),r.Wb(),r.Xb(16,"li"),r.Ic(17,"Dependencies: LanguageService"),r.Wb(),r.Sb(18,"br"),r.Ic(19," See the "),r.Xb(20,"a",0),r.Ic(21,"code of this example"),r.Wb(),r.Sb(22,"hr"),r.Wb(),r.Xb(23,"igo-map-browser",1),r.Sb(24,"igo-zoom-button",2),r.Sb(25,"igo-geolocate-button",2),r.Sb(26,"igo-rotation-button",3),r.Wb(),r.Sb(27,"igo-print",4),r.Wb(),r.Sb(28,"igo-message-center")),2&e&&(r.Db(23),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("map",t.map)("showIfNoRotation",!1),r.Db(1),r.oc("map",t.map))},directives:[b.a,b.e,b.f,b.c,om,rm,am,sm,sk,we],styles:["igo-map-browser[_ngcontent-%COMP%]{width:900px;height:1000px}"]}),mx)}]),Fx=((bx=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:bx}),bx.\u0275inj=r.Ob({factory:function(e){return new(e||bx)},imports:[[Tx,b.d,l.b,xe,Hy,lk]]}),bx),_x=f.e.forChild([{path:"import-export",component:(vx=function e(t,i){var o=this;_classCallCheck(this,e),this.languageService=t,this.layerService=i,this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:9},this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe((function(e){return o.map.addLayer(e)}))},vx.\u0275fac=function(e){return new(e||vx)(r.Rb(Le),r.Rb(Ff))},vx.\u0275cmp=r.Lb({type:vx,selectors:[["app-import-export"]],decls:17,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/import-export"],[3,"map","view"],["color","primary",3,"map"],[3,"map"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Import / Export"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"Dependencies: LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"hr"),r.Wb(),r.Xb(13,"igo-map-browser",1),r.Sb(14,"igo-zoom-button",2),r.Wb(),r.Sb(15,"igo-import-export",3),r.Wb(),r.Sb(16,"igo-message-center")),2&e&&(r.Db(13),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("map",t.map))},directives:[b.a,b.e,b.f,b.c,om,rm,Ty,we],styles:["igo-map-browser[_ngcontent-%COMP%]{width:900px;height:1000px}"]}),vx)}]),Mx=((yx=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:yx}),yx.\u0275inj=r.Ob({factory:function(e){return new(e||yx)},providers:[_y({path:"./assets/import-style.json"})],imports:[[_x,b.d,l.b,xe,Hy,qy]]}),yx),Dx=f.e.forChild([{path:"directions",component:(kx=function e(t,i,o,n){var r=this;_classCallCheck(this,e),this.projectionService=t,this.languageService=i,this.layerService=o,this.mapService=n,this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:9,geolocate:!0},this.stopsStore=new $f([],{map:this.map}),this.routeStore=new $f([],{map:this.map}),this.mapService.setMap(this.map),this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe((function(e){return r.map.addLayer(e)}))},kx.\u0275fac=function(e){return new(e||kx)(r.Rb(ff),r.Rb(Le),r.Rb(Ff),r.Rb(im))},kx.\u0275cmp=r.Lb({type:kx,selectors:[["app-directions"]],decls:18,vars:9,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/directions"],[3,"map","view"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[3,"stopsStore","routeStore","map"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Directions"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"Dependencies: LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"hr"),r.Wb(),r.Xb(13,"igo-map-browser",1),r.Sb(14,"igo-zoom-button",2),r.Sb(15,"igo-geolocate-button",2),r.Sb(16,"igo-rotation-button",3),r.Wb(),r.Sb(17,"igo-directions-form",4),r.Wb()),2&e&&(r.Db(13),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("map",t.map)("showIfNoRotation",!1),r.Db(1),r.oc("stopsStore",t.stopsStore)("routeStore",t.routeStore)("map",t.map))},directives:[b.a,b.e,b.f,b.c,om,rm,am,sm,Lk],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),kx)}]),Px=((Sx=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Sx}),Sx.\u0275inj=r.Ob({factory:function(e){return new(e||Sx)},providers:[{provide:yk,useFactory:YS,multi:!0,deps:[k.b,ie]}],imports:[[Dx,b.d,l.b,xe,Hy,_k]]}),Sx),Ax=f.e.forChild([{path:"time-filter",component:(Cx=function e(t,i,o){var n=this;_classCallCheck(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"OSM",source:e}))})),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/ws/igo_gouvouvert.fcgi",params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"},timeFilterable:!0,timeFilter:{min:"2013",max:"2019",range:!1,type:uf.YEAR,style:hf.SLIDER,step:1,timeInterval:2e3}}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle YEAR",visible:!0,source:e}))}))},Cx.\u0275fac=function(e){return new(e||Cx)(r.Rb(Le),r.Rb(mf),r.Rb(Ff))},Cx.\u0275cmp=r.Lb({type:Cx,selectors:[["app-time-filter"]],decls:21,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/time-filter"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],[3,"layers"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Time filter"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"npm install --save moment@2.22.2"),r.Wb(),r.Xb(8,"li"),r.Ic(9,"npm install --save @mat-datetimepicker/core@3.0.0-beta.0"),r.Wb(),r.Xb(10,"li"),r.Ic(11,"Dependencies: LanguageService"),r.Wb(),r.Sb(12,"br"),r.Ic(13," See the "),r.Xb(14,"a",0),r.Ic(15,"code of this example"),r.Wb(),r.Sb(16,"hr"),r.Wb(),r.Xb(17,"igo-map-browser",1),r.Sb(18,"igo-zoom-button",2),r.Wb(),r.Xb(19,"igo-panel",3),r.Sb(20,"igo-time-filter-list",4),r.Wb(),r.Wb()),2&e&&(r.Db(17),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map),r.Db(2),r.oc("layers",t.map.layers))},directives:[b.a,b.e,b.f,b.c,om,rm,Sr,Nv],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),Cx)}]),jx=((wx=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:wx}),wx.\u0275inj=r.Ob({factory:function(e){return new(e||wx)},imports:[[Ax,b.d,l.b,u.b,Cr,Hy,oy]]}),wx),Rx=f.e.forChild([{path:"ogc-filter",component:(xx=function e(t,i,o){var n=this;_classCallCheck(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"OSM",source:e}))})),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"code_municipalite",alias:"# de la municipalit\xe9e"},{name:"date_observation",excludeFromOgcFilters:!0},{name:"urgence",values:["imm\xe9diate","inconnue"]}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Rg.All,filters:{logical:"Or",filters:[{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"},{operator:"Intersects",geometryName:"the_geom",wkt_geometry:"MULTIPOLYGON(((\n              -8379441.158019895 5844447.897707146,\n              -8379441.158019895 5936172.331649357,\n              -8134842.66750733 5936172.331649357,\n              -8134842.66750733 5844447.897707146,\n              -8379441.158019895 5844447.897707146\n            ), (\n              -8015003 5942074,\n              -8015003 5780349,\n              -7792364 5780349,\n              -7792364 5942074,\n              -8015003 5942074\n            )))"}]}}}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (PropertyIsEqualTo OR Intersects)",source:e,style:{circle:{radius:5,fill:{color:"white"},stroke:{color:"orange",width:1}}}}))})),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Rg.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-21T00:00:00-05:00",end:"2016-01-26T00:00:00-05:00"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2016-02-10T00:00:00-05:00",stepDate:"P2D"}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (During, Step: P2D)",id:"1",source:e,style:{circle:{radius:5,fill:{color:"white"},stroke:{color:"red",width:1}}}}))})),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Rg.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-01T04:00:00-05:00",end:"2016-01-12T16:00:00-05:00"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2016-02-14T20:00:00-05:00",stepDate:"PT4H"}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (During, Step: PT4H)",id:"2",source:e,style:{circle:{radius:5,fill:{color:"white"},stroke:{color:"blue",width:1}}}}))})),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Rg.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-01T00:00:00-05:00",end:"2016-03-01T00:00:00-05:00"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2018-12-31T00:00:00-05:00",stepDate:"P1M"}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (During, Step: P1M)",id:"3",source:e,style:{circle:{radius:5,fill:{color:"white"},stroke:{color:"yellow",width:1}}}}))})),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Rg.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-01T00:00:00-05:00",end:"2016-12-31T00:00:00-05:00"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2018-12-31T00:00:00-05:00",stepDate:"P1Y"}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (During, Step: P1Y)",id:"4",source:e,style:{circle:{radius:5,fill:{color:"white"},stroke:{color:"green",width:1}}}}))})),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Rg.All,filters:{operator:"During",propertyName:"date_observation",begin:"today - 2 days",end:"today"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2025-12-31T00:00:00-05:00",stepDate:"P1D"}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (During, Interval from Now, Step: P1D)",id:"5",source:e,style:{circle:{radius:5,fill:{color:"white"},stroke:{color:"black",width:1}}}}))})),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Rg.All,filters:{operator:"During",propertyName:"date_observation",begin:"2019-01-01 00:00:00",restrictToStep:!0}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2025-12-31T00:00:00-05:00",stepDate:"P1M"}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (During, RestrictToStep, Step: P1M)",id:"6",source:e,style:{circle:{radius:5,fill:{color:"black"},stroke:{color:"red",width:1}}}}))})),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"vg_observation_v_inondation23avril2017_wmst",VERSION:"1.3.0"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,filters:{operator:"During",propertyName:"date_observation"},allowedOperatorsType:Rg.Time}}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"Inondation (During, optionsFromCapabilities)",source:e}))})),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",urlWfs:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",params:{LAYERS:"radars_photos",VERSION:"1.3.0"},ogcFilters:{enabled:!0,editable:!0,pushButtons:{groups:[{title:"Nom du group1",name:"1",ids:["id1"]},{title:"Nom du group2",name:"2",ids:["id1","id2"]}],bundles:[{id:"id1",logical:"Or",buttons:[{title:"Radar photo fixe",enabled:!0,color:"0,0,255",tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo fixe"}},{title:"Radar photo mobile",enabled:!1,color:"255,200,0",tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo mobile"}},{title:"Radar photo fixe + feu rouge",enabled:!1,color:"0,200,0",tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo fixe et surveillance au feu rouge"}},{title:"Radar feu rouge",enabled:!1,color:"255,0,0",tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Appareil de surveillance au feu rouge"}}]},{id:"id2",logical:"Or",vertical:!0,buttons:[{title:"Montr\xe9al & Laval",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{logical:"Or",filters:[{operator:"PropertyIsEqualTo",propertyName:"region",expression:"Montr\xe9al"},{operator:"PropertyIsEqualTo",propertyName:"region",expression:"Laval"}]}},{title:"Outside Montr\xe9al & Laval",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{logical:"And",filters:[{operator:"PropertyIsNotEqualTo",propertyName:"region",expression:"Montr\xe9al"},{operator:"PropertyIsNotEqualTo",propertyName:"region",expression:"Laval"}]}}]}]},allowedOperatorsType:Rg.Basic},paramsWFS:{featureTypes:"radars_photos",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"1.1.0",outputFormat:"geojson",outputFormatDownload:"shp"}}).subscribe((function(e){n.map.addLayer(n.layerService.createLayer({title:"Filterable WMS layers with predefined filters (buttons)",source:e}))}))},xx.\u0275fac=function(e){return new(e||xx)(r.Rb(Le),r.Rb(mf),r.Rb(Ff))},xx.\u0275cmp=r.Lb({type:xx,selectors:[["app-ogc-filter"]],decls:17,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/ogc-filter"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],[3,"map","layers"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Ogc filter"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"Dependencies: LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"hr"),r.Wb(),r.Xb(13,"igo-map-browser",1),r.Sb(14,"igo-zoom-button",2),r.Wb(),r.Xb(15,"igo-panel",3),r.Sb(16,"igo-ogc-filterable-list",4),r.Wb(),r.Wb()),2&e&&(r.Db(13),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map),r.Db(2),r.oc("map",t.map)("layers",t.map.layers))},directives:[b.a,b.e,b.f,b.c,om,rm,Sr,Yv],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),xx)}]),$x=((Ox=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Ox}),Ox.\u0275inj=r.Ob({factory:function(e){return new(e||Ox)},imports:[[Rx,b.d,l.b,u.b,Cr,Hy,oy]]}),Ox);function Ex(e,t){if(1&e&&(r.Vb(0),r.Sb(1,"igo-feature-details",8),r.Ub()),2&e){var i=t.ngIf;r.Db(1),r.oc("feature",i)}}var Wx,Xx,Gx=f.e.forChild([{path:"spatial-filter",component:(Wx=function(){function e(t,i,o,n,r){var a=this;_classCallCheck(this,e),this.spatialFilterService=t,this.dataSourceService=i,this.layerService=o,this.messageService=n,this.languageService=r,this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-71.9,46.9],zoom:10},this.itemType=Tb.Address,this.layers=[],this.selectedFeature$=new L.a(void 0),this.format=new fl.a,this.store=new hn([]),this.spatialListStore=new hn([]),this.loading=!1,this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe((function(e){a.map.addLayer(a.layerService.createLayer({title:"OSM",source:e,baseLayer:!0,visible:!0}))}))}return _createClass(e,[{key:"getOutputType",value:function(e){this.type=e,this.queryType=void 0,this.radius=void 0}},{key:"getOutputQueryType",value:function(e){this.queryType=e,this.queryType&&this.loadFilterList()}},{key:"loadFilterList",value:function(){var e=this;this.spatialFilterService.loadFilterList(this.queryType).subscribe((function(t){t.sort((function(e,t){return e.properties.nom<t.properties.nom?-1:e.properties.nom>t.properties.nom?1:0})),e.spatialListStore.clear(),e.spatialListStore.load(t)}))}},{key:"getOutputToggleSearch",value:function(){this.loadThematics()}},{key:"getOutputClearSearch",value:function(){this.zone=void 0,this.queryType=void 0}},{key:"loadThematics",value:function(){var e=this;this.loading=!0,this.tryAddFeaturesToMap([this.zone]),this.thematics||(this.thematics=[{name:""}]),this.type===Lb.Polygon&&(this.radius=void 0),this.thematics.forEach((function(t){e.spatialFilterService.loadFilterItem(e.zone,e.itemType,e.queryType,t,e.radius).subscribe((function(t){e.store.insertMany(t);var i,o,n=[],r=[];t.forEach((function(e){"Point"===e.geometry.type?(n.push(e),i=e.meta.id):(r.push(e),o=e.meta.id)})),e.tryAddPointToMap(n,i),e.tryAddLayerToMap(r,o),e.loading=!1,t.length>=1e4&&e.messageService.alert(e.languageService.translate.instant("igo.geo.spatialFilter.maxSizeAlert"),e.languageService.translate.instant("igo.geo.spatialFilter.warning"),{timeOut:1e4}),t.length||e.messageService.alert(e.languageService.translate.instant("igo.geo.spatialFilter.zeroResults"),e.languageService.translate.instant("igo.geo.spatialFilter.warning"),{timeOut:1e4})}))}))}},{key:"onZoneChange",value:function(e){this.zone=e,e&&(this.tryAddFeaturesToMap([e]),this.zoomToFeatureExtent(e))}},{key:"tryAddFeaturesToMap",value:function(e){var t,i=this,o=1,n=_createForOfIteratorHelper(e);try{var r=function(){var n=t.value;if(i.type===Lb.Predefined){var r,a=_createForOfIteratorHelper(i.map.layers);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s.options._internal&&s.options._internal.code===n.properties.code)return{v:void 0};s.title.startsWith("Zone")&&i.map.removeLayer(s)}}catch(u){a.e(u)}finally{a.f()}}var c,l=_createForOfIteratorHelper(i.map.layers);try{for(l.s();!(c=l.n()).done;)c.value.title.startsWith("Zone")&&o++}catch(u){l.e(u)}finally{l.f()}i.dataSourceService.createAsyncDataSource({type:"vector",queryable:!0}).subscribe((function(t){var r=i.layerService.createLayer({title:"Zone "+o,_internal:{code:i.type===Lb.Predefined?n.properties.code:void 0},source:t,visible:!0,style:function(t,o){var n=e[0].coordinates;return new Uc.Style({image:new Uc.Circle({radius:n?i.radius/Math.cos(Math.PI/180*n[1])/o:void 0,fill:new Uc.Fill({color:"rgba(200, 200, 20, 0.2)"}),stroke:new Uc.Stroke({width:1,color:"orange"})}),stroke:new Uc.Stroke({width:1,color:"orange"}),fill:new Uc.Fill({color:"rgba(200, 200, 20, 0.2)"})})}}),a=e.map((function(e){return Df(e,i.map.projection)}));t.ol.addFeatures(a),i.map.addLayer(r),i.layers.push(r)}))};for(n.s();!(t=n.n()).done;){var a=r();if("object"==typeof a)return a.v}}catch(s){n.e(s)}finally{n.f()}}},{key:"tryAddPointToMap",value:function(e,t){var i=this,o=1;if(e.length>=1){if(void 0===this.map)return;var n,r=_createForOfIteratorHelper(this.map.layers);try{for(r.s();!(n=r.n()).done;)n.value.title.startsWith(e[0].meta.title)&&o++}catch(a){r.e(a)}finally{r.f()}this.dataSourceService.createAsyncDataSource({type:"cluster",id:t,queryable:!0,distance:120,meta:{title:"Cluster"}}).subscribe((function(t){var n=i.layerService.createLayer({title:e[0].meta.title+" "+o,source:t,visible:!0,clusterParam:{clusterRanges:[{minRadius:1,maxRadius:5,style:{}}]}}),r=e.map((function(e){return Df(e,i.map.projection)}));t.ol.source.addFeatures(r),i.map.layers.find((function(e){return e.id===n.id}))&&(i.map.removeLayer(i.map.layers.find((function(e){return e.id===n.id}))),o-=1,n.title=e[0].meta.title+" "+o,n.options.title=n.title),i.map.addLayer(n),i.layers.push(n)}))}}},{key:"tryAddLayerToMap",value:function(e,t){var i=this,o=1;if(e.length>1){if(void 0===this.map)return;var n,r=_createForOfIteratorHelper(this.map.layers);try{for(r.s();!(n=r.n()).done;)n.value.title.startsWith(e[0].meta.title)&&o++}catch(a){r.e(a)}finally{r.f()}this.dataSourceService.createAsyncDataSource({type:"vector",id:t,queryable:!0}).subscribe((function(t){var n=i.layerService.createLayer({title:e[0].meta.title+" "+o,source:t,visible:!0}),r=e.map((function(e){return Df(e,i.map.projection)}));t.ol.addFeatures(r),i.map.layers.find((function(e){return e.id===n.id}))&&(i.map.removeLayer(i.map.layers.find((function(e){return e.id===n.id}))),o-=1,n.title=e[0].meta.title+" "+o,n.options.title=n.title),i.map.addLayer(n),i.layers.push(n)}))}}},{key:"zoomToFeatureExtent",value:function(e){if(e){var t=this.format.readFeature(e,{dataProjection:e.projection,featureProjection:this.map.projection});jf(this.map,[t],Mf.Zoom)}}},{key:"handleQueryResults",value:function(e){var t,i=e.features;i.length&&(t=i[0]),this.selectedFeature$.next(t)}}]),e}(),Wx.\u0275fac=function(e){return new(e||Wx)(r.Rb(Fb),r.Rb(mf),r.Rb(Ff),r.Rb(Ie),r.Rb(Le))},Wx.\u0275cmp=r.Lb({type:Wx,selectors:[["app-spatial-filter"]],inputs:{type:"type",itemType:"itemType",freehandDrawIsActive:"freehandDrawIsActive"},decls:26,vars:17,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/spatial-filter"],["igoOverlay","","igoQuery","",3,"map","view","queryFeatures","query"],["color","primary",3,"map"],["title","Spatial Filter"],[3,"store","selectedQueryType","zone","eventType","eventQueryType","zoneChange"],[3,"type","queryType","map","zone","loading","store","layers","radiusEvent","freehandControl","drawZoneEvent","itemTypeChange","thematicChange","toggleSearch","clearButtonEvent","clearSearchEvent"],["title","Details"],[4,"ngIf"],[3,"feature"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Spatial filter"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"li"),r.Ic(7,"npm install --save moment@2.22.2"),r.Wb(),r.Xb(8,"li"),r.Ic(9,"npm install --save @mat-datetimepicker/core@3.0.0-beta.0"),r.Wb(),r.Xb(10,"li"),r.Ic(11,"Dependencies: LanguageService"),r.Wb(),r.Sb(12,"br"),r.Ic(13," See the "),r.Xb(14,"a",0),r.Ic(15,"code of this example"),r.Wb(),r.Sb(16,"hr"),r.Wb(),r.Xb(17,"igo-map-browser",1),r.ec("query",(function(e){return t.handleQueryResults(e)})),r.Sb(18,"igo-zoom-button",2),r.Wb(),r.Xb(19,"igo-panel",3),r.Xb(20,"igo-spatial-filter-type",4),r.ec("eventType",(function(e){return t.getOutputType(e)}))("eventQueryType",(function(e){return t.getOutputQueryType(e)}))("zoneChange",(function(e){return t.onZoneChange(e)})),r.Wb(),r.Xb(21,"igo-spatial-filter-item",5),r.ec("radiusEvent",(function(e){return t.radius=e}))("freehandControl",(function(e){return t.freehandDrawIsActive=e}))("drawZoneEvent",(function(e){return t.zone=e}))("itemTypeChange",(function(e){return t.itemType=e}))("thematicChange",(function(e){return t.thematics=e}))("toggleSearch",(function(){return t.getOutputToggleSearch()}))("clearButtonEvent",(function(e){return t.layers=e}))("clearSearchEvent",(function(){return t.getOutputClearSearch()})),r.Wb(),r.Wb(),r.Xb(22,"igo-panel",6),r.Gc(23,Ex,2,1,"ng-container",7),r.jc(24,"async"),r.Wb(),r.Sb(25,"igo-message-center"),r.Wb()),2&e&&(r.Db(17),r.oc("map",t.map)("view",t.view)("queryFeatures",!0),r.Db(1),r.oc("map",t.map),r.Db(2),r.oc("store",t.spatialListStore)("selectedQueryType",t.queryType)("zone",t.zone),r.Db(1),r.oc("type",t.type)("queryType",t.queryType)("map",t.map)("zone",t.zone)("loading",t.loading)("store",t.store)("layers",t.layers),r.Db(2),r.oc("ngIf",r.kc(24,15,t.selectedFeature$)))},directives:[b.a,b.e,b.f,b.c,om,Jm,rm,Sr,Jv,ey,m.l,we,Pb],pipes:[m.b],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}igo-form[_ngcontent-%COMP%]{display:none}igo-spatial-filter-item[_ngcontent-%COMP%]     .thematics-header{max-width:225px}"]}),Wx)}]),Bx=((Xx=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Xx}),Xx.\u0275inj=r.Ob({factory:function(e){return new(e||Xx)},imports:[[Gx,b.d,l.b,u.b,Cr,Hy,xe,dk,Rb,Ab,oy,er,m.c]]}),Xx);function Vx(e,t){if(1&e){var i=r.Yb();r.Xb(0,"igo-entity-table-paginator",6),r.ec("paginatorChange",(function(e){return r.yc(i),r.ic().paginatorChange(e)})),r.Wb()}if(2&e){var o=t.ngIf,n=r.ic();r.oc("store",o.entityStore)("paginatorOptions",n.paginatorOptions)("entitySortChange$",n.entitySortChange$)}}function Nx(e,t){if(1&e&&r.Sb(0,"igo-actionbar",10),2&e){var i=r.ic().ngIf,o=r.ic();r.oc("store",i.actionStore)("horizontal",!0)("withToggleButton",!0)("withTitle",!0)("mode",o.actionbarMode)}}function zx(e,t){if(1&e&&r.Sb(0,"igo-entity-table",11),2&e){var i=r.ic().ngIf,o=r.ic();r.oc("paginator",o.workspacePaginator)("scrollBehavior",o.scrollBehavior)("store",i.entityStore)("template",i.meta.tableTemplate)}}function qx(e,t){if(1&e&&(r.Vb(0),r.Gc(1,Nx,1,5,"igo-actionbar",7),r.Gc(2,zx,1,4,"igo-entity-table",8),r.Sb(3,"igo-workspace-widget-outlet",9),r.Ub()),2&e){var i=t.ngIf;r.Db(1),r.oc("ngIf",i.actionStore),r.Db(1),r.oc("ngIf",i.entityStore&&i.meta&&i.meta.tableTemplate),r.Db(1),r.oc("workspace",i)}}var Hx,Ux,Yx=f.e.forChild([{path:"workspace",component:(Hx=function(){function e(t,i,o,n){_classCallCheck(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.workspaceState=n,this.entitySortChange$=new L.a(!1),this.paginatorOptions={pageSize:5,pageSizeOptions:[1,5,10,15,30,50,100],showFirstLastButtons:!0},this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-72,47.2],zoom:5},this.actionbarMode=yn.Overlay,this.scrollBehavior=Hi.Instant}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.selectedWorkspace$=this.workspaceStore.stateView.firstBy$((function(e){return!0===e.state.selected})).pipe(Object(w.a)((function(e){var t=void 0===e?void 0:e.entity;return t&&t.actionStore.view.filter((function(e){return"wfsDownload"!==e.id})),t}))),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe((function(t){e.map.addLayer(e.layerService.createLayer({title:"OSM",source:t}))})),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",params:{featureTypes:"etablissement_mtq",fieldNameGeometry:"geometry",version:"2.0.0",outputFormat:"geojson"},sourceFields:[{name:"idetablis",alias:"ID"},{name:"nometablis",alias:"Name"},{name:"typetablis",alias:"Type"}]}).subscribe((function(t){e.map.addLayer(e.layerService.createLayer({title:"Simple WFS ",visible:!0,source:t}))}))}},{key:"paginatorChange",value:function(e){this.workspacePaginator=e}},{key:"workspaceStore",get:function(){return this.workspaceState.store}}]),e}(),Hx.\u0275fac=function(e){return new(e||Hx)(r.Rb(Le),r.Rb(mf),r.Rb(Ff),r.Rb(nx))},Hx.\u0275cmp=r.Lb({type:Hx,selectors:[["app-workspace"]],decls:16,vars:11,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/workspace"],[3,"map","view"],["color","primary",3,"map"],["igoWorkspaceSelector","",3,"store","map"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange",4,"ngIf"],[4,"ngIf"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange"],[3,"store","horizontal","withToggleButton","withTitle","mode",4,"ngIf"],["class","table-compact table-centered",3,"paginator","scrollBehavior","store","template",4,"ngIf"],[3,"workspace"],[3,"store","horizontal","withToggleButton","withTitle","mode"],[1,"table-compact","table-centered",3,"paginator","scrollBehavior","store","template"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Workspace"),r.Wb(),r.Xb(5,"mat-card-content"),r.Ic(6," See the "),r.Xb(7,"a",0),r.Ic(8,"code of this example"),r.Wb(),r.Wb(),r.Xb(9,"igo-map-browser",1),r.Sb(10,"igo-zoom-button",2),r.Wb(),r.Sb(11,"igo-workspace-selector",3),r.Gc(12,Vx,1,3,"igo-entity-table-paginator",4),r.jc(13,"async"),r.Gc(14,qx,4,3,"ng-container",5),r.jc(15,"async"),r.Wb()),2&e&&(r.Db(9),r.oc("map",t.map)("view",t.view),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("store",t.workspaceStore)("map",t.map),r.Db(1),r.oc("ngIf",r.kc(13,7,t.selectedWorkspace$)),r.Db(2),r.oc("ngIf",r.kc(15,9,t.selectedWorkspace$)))},directives:[b.a,b.e,b.f,b.c,om,rm,pa,BS,m.l,vn,ma,Sn,bn],pipes:[m.b],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}igo-entity-table[_ngcontent-%COMP%]{height:400px}igo-actionbar[_ngcontent-%COMP%]{height:48px}"]}),Hx)}]),Kx=((Ux=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Ux}),Ux.\u0275inj=r.Ob({factory:function(e){return new(e||Ux)},imports:[[m.c,Yx,b.d,l.b,u.b,xn,sr,va,Cr,Hy,zS]]}),Ux);function Zx(e,t){1&e&&r.Sb(0,"igo-metadata-button",10),2&e&&r.oc("layer",t.layer)}var Jx,Qx,eO,tO,iO,oO=f.e.forChild([{path:"context",component:(Jx=function e(t,i,o){_classCallCheck(this,e),this.languageService=t,this.mapService=i,this.overlayService=o,this.map=new tm({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.mapService.setMap(this.map)},Jx.\u0275fac=function(e){return new(e||Jx)(r.Rb(Le),r.Rb(im),r.Rb(Jy))},Jx.\u0275cmp=r.Lb({type:Jx,selectors:[["app-context"]],decls:27,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/context/context"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/contexts"],["igoMapContext","","igoLayerContext","",3,"map"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],["title","Contexts list"],["igoContextListBinding","",3,"map"],["title","Layers"],["igoLayerListBinding","",3,"map"],["igoLayerItemToolbar",""],[3,"layer"]],template:function(e,t){1&e&&(r.Xb(0,"mat-card"),r.Xb(1,"mat-card-subtitle"),r.Ic(2,"Geo"),r.Wb(),r.Xb(3,"mat-card-title"),r.Ic(4,"Context"),r.Wb(),r.Xb(5,"mat-card-content"),r.Xb(6,"p"),r.Ic(7,"* Dependencies: LanguageService"),r.Wb(),r.Sb(8,"br"),r.Ic(9," See the "),r.Xb(10,"a",0),r.Ic(11,"code of this example"),r.Wb(),r.Sb(12,"br"),r.Ic(13," See "),r.Xb(14,"a",1),r.Ic(15," contexts"),r.Wb(),r.Sb(16,"hr"),r.Wb(),r.Xb(17,"igo-map-browser",2),r.Sb(18,"igo-zoom-button",3),r.Sb(19,"igo-geolocate-button",3),r.Sb(20,"igo-rotation-button",4),r.Wb(),r.Xb(21,"igo-panel",5),r.Sb(22,"igo-context-list",6),r.Wb(),r.Xb(23,"igo-panel",7),r.Xb(24,"igo-layer-list",8),r.Gc(25,Zx,1,1,"ng-template",null,9,r.Hc),r.Wb(),r.Wb(),r.Wb()),2&e&&(r.Db(17),r.oc("map",t.map),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("map",t.map),r.Db(1),r.oc("map",t.map)("showIfNoRotation",!0),r.Db(2),r.oc("map",t.map),r.Db(2),r.oc("map",t.map))},directives:[b.a,b.e,b.f,b.c,om,Vw,Nw,rm,am,sm,Sr,Hw,Uw,db,gb,wg],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{margin-bottom:5px}"]}),Jx)}]),nO=((Qx=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:Qx}),Qx.\u0275inj=r.Ob({factory:function(e){return new(e||Qx)},imports:[[k.c,oO,b.d,l.b,u.b,Cr,Hy,vb,xg,ek,dk,Rb,Jw]]}),Qx),rO=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"**",redirectTo:"/home"}],aO=((iO=function e(){_classCallCheck(this,e)}).\u0275mod=r.Pb({type:iO}),iO.\u0275inj=r.Ob({factory:function(e){return new(e||iO)},imports:[[f.e.forRoot(rO,{useHash:!0})],f.e]}),iO),sO=((tO=function(){function e(t,i,o){_classCallCheck(this,e),this.changeDetectorRef=t,this.media=i,this.renderer=o,this.title="IGO",this.version=te,this.themeClass="deeppurple-theme",this.mobileQuery=i.matchMedia("(max-width: 600px)"),this._mobileQueryListener=function(){return t.detectChanges()},this.mobileQuery.addEventListener("change",this._mobileQueryListener),this.renderer.addClass(document.body,this.themeClass),this.detectOldBrowser()}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.mobileQuery.removeEventListener("change",this._mobileQueryListener)}},{key:"detectOldBrowser",value:function(){R.satisfies({ie:"<11",chrome:"<64",firefox:"<60"})&&console.log("Very old browser ! ",R.getBrowser())}}]),e}()).\u0275fac=function(e){return new(e||tO)(r.Rb(r.h),r.Rb(K.c),r.Rb(r.I))},tO.\u0275cmp=r.Lb({type:tO,selectors:[["app-root"]],decls:87,vars:8,consts:[[1,"example-container"],["color","primary",1,"example-toolbar"],["mat-icon-button","",3,"click"],["svgIcon","menu"],[1,"example-sidenav-container"],["opened","true","fixedTopGap","56",3,"mode","fixedInViewport"],["snav",""],["mat-list-item","","routerLink","."],["mat-list-item","","routerLink","activity"],["mat-list-item","","routerLink","config"],["mat-list-item","","routerLink","language"],["mat-list-item","","routerLink","media"],["mat-list-item","","routerLink","message"],["mat-list-item","","routerLink","request"],["mat-list-item","","routerLink","auth-form"],["mat-list-item","","routerLink","action"],["mat-list-item","","routerLink","dynamic-component"],["mat-list-item","","routerLink","entity-table"],["mat-list-item","","routerLink","entity-selector"],["mat-list-item","","routerLink","form"],["mat-list-item","","routerLink","table"],["mat-list-item","","routerLink","tool"],["mat-list-item","","routerLink","widget"],["mat-list-item","","routerLink","simple-map"],["mat-list-item","","routerLink","layer"],["mat-list-item","","routerLink","legend"],["mat-list-item","","routerLink","overlay"],["mat-list-item","","routerLink","geometry"],["mat-list-item","","routerLink","feature"],["mat-list-item","","routerLink","measure"],["mat-list-item","","routerLink","query"],["mat-list-item","","routerLink","catalog"],["mat-list-item","","routerLink","search"],["mat-list-item","","routerLink","print"],["mat-list-item","","routerLink","import-export"],["mat-list-item","","routerLink","directions"],["mat-list-item","","routerLink","time-filter"],["mat-list-item","","routerLink","ogc-filter"],["mat-list-item","","routerLink","spatial-filter"],["mat-list-item","","routerLink","workspace"],["mat-list-item","","routerLink","context"]],template:function(e,t){if(1&e){var i=r.Yb();r.Xb(0,"div",0),r.Xb(1,"mat-toolbar",1),r.Xb(2,"button",2),r.ec("click",(function(){return r.yc(i),r.vc(10).toggle()})),r.Sb(3,"mat-icon",3),r.Wb(),r.Xb(4,"h1"),r.Ic(5),r.Wb(),r.Xb(6,"h5"),r.Ic(7),r.Wb(),r.Wb(),r.Xb(8,"mat-sidenav-container",4),r.Xb(9,"mat-sidenav",5,6),r.Xb(11,"mat-nav-list"),r.Xb(12,"a",7),r.Ic(13,"Home"),r.Wb(),r.Sb(14,"hr"),r.Xb(15,"a",8),r.Ic(16,"Activity"),r.Wb(),r.Xb(17,"a",9),r.Ic(18,"Config"),r.Wb(),r.Xb(19,"a",10),r.Ic(20,"Language"),r.Wb(),r.Xb(21,"a",11),r.Ic(22,"Media"),r.Wb(),r.Xb(23,"a",12),r.Ic(24,"Message"),r.Wb(),r.Xb(25,"a",13),r.Ic(26,"Request"),r.Wb(),r.Sb(27,"hr"),r.Xb(28,"a",14),r.Ic(29,"Authentification"),r.Wb(),r.Sb(30,"hr"),r.Xb(31,"a",15),r.Ic(32,"Action"),r.Wb(),r.Xb(33,"a",16),r.Ic(34,"Dynamic Component"),r.Wb(),r.Xb(35,"a",17),r.Ic(36,"Entity Table"),r.Wb(),r.Xb(37,"a",18),r.Ic(38,"Entity Selector"),r.Wb(),r.Xb(39,"a",19),r.Ic(40,"Form"),r.Wb(),r.Xb(41,"a",20),r.Ic(42,"Table"),r.Wb(),r.Xb(43,"a",21),r.Ic(44,"Tool"),r.Wb(),r.Xb(45,"a",22),r.Ic(46,"Widget"),r.Wb(),r.Sb(47,"hr"),r.Xb(48,"a",23),r.Ic(49,"Simple map"),r.Wb(),r.Xb(50,"a",24),r.Ic(51,"Layer"),r.Wb(),r.Xb(52,"a",25),r.Ic(53,"Legend"),r.Wb(),r.Xb(54,"a",26),r.Ic(55,"Overlay"),r.Wb(),r.Xb(56,"a",27),r.Ic(57,"Geometry"),r.Wb(),r.Xb(58,"a",28),r.Ic(59,"Feature"),r.Wb(),r.Xb(60,"a",29),r.Ic(61,"Measure"),r.Wb(),r.Xb(62,"a",30),r.Ic(63,"Query"),r.Wb(),r.Xb(64,"a",31),r.Ic(65,"Catalog"),r.Wb(),r.Xb(66,"a",32),r.Ic(67,"Search"),r.Wb(),r.Xb(68,"a",33),r.Ic(69,"Print"),r.Wb(),r.Xb(70,"a",34),r.Ic(71,"Import/Export"),r.Wb(),r.Xb(72,"a",35),r.Ic(73,"Directions"),r.Wb(),r.Xb(74,"a",36),r.Ic(75,"Time filter"),r.Wb(),r.Xb(76,"a",37),r.Ic(77,"OGC filter"),r.Wb(),r.Xb(78,"a",38),r.Ic(79,"Spatial filter"),r.Wb(),r.Xb(80,"a",39),r.Ic(81,"Workspace"),r.Wb(),r.Sb(82,"hr"),r.Xb(83,"a",40),r.Ic(84,"Context"),r.Wb(),r.Wb(),r.Wb(),r.Xb(85,"mat-sidenav-content"),r.Sb(86,"router-outlet"),r.Wb(),r.Wb(),r.Wb()}2&e&&(r.Ib("example-is-mobile",t.mobileQuery.matches),r.Db(5),r.Jc(t.title),r.Db(2),r.Jc(t.version.lib),r.Db(1),r.Fc("margin-top",t.mobileQuery.matches?56:0,"px"),r.Db(1),r.oc("mode",t.mobileQuery.matches?"over":"side")("fixedInViewport",t.mobileQuery.matches))},directives:[p.a,l.a,u.a,d.b,d.a,h.g,h.d,f.d,d.c,f.f],styles:["h1[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:26px}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:absolute;top:0;bottom:0;left:0;right:0}.example-is-mobile[_ngcontent-%COMP%]   .example-toolbar[_ngcontent-%COMP%]{position:fixed;z-index:2}.example-sidenav-container[_ngcontent-%COMP%]{flex:1}.example-is-mobile[_ngcontent-%COMP%]   .example-sidenav-container[_ngcontent-%COMP%]{flex:1 0 auto}mat-sidenav[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.03)}.example-is-mobile[_ngcontent-%COMP%]   mat-sidenav[_ngcontent-%COMP%]{background-color:#fff}mat-sidenav-content[_ngcontent-%COMP%]{padding:10px}"]}),tO),cO=((eO=function e(t,i){_classCallCheck(this,e),t.addSvgIconSet(i.bypassSecurityTrustResourceUrl("./assets/igo2/core/icons/mdi.svg"))}).\u0275mod=r.Pb({type:eO,bootstrap:[sO]}),eO.\u0275inj=r.Ob({factory:function(e){return new(e||eO)(r.bc(u.c),r.bc(s.b))},imports:[[s.a,c.b,d.d,p.b,l.b,u.b,h.e,ka,Ca,xa,Ia,Ta,_a,Da,Va,Ha,Ya,es,ss,ls,vs,Ss,uc,lC,vC,kC,CC,MC,PC,jC,BC,NC,Lx,Fx,Mx,Px,jx,$x,Bx,Kx,nO,aO,s.e]]}),eO);a.production&&Object(r.W)(),s.g().bootstrapModule(cO).catch((function(e){return console.log(e)}))},RnhZ:function(e,t,i){var o={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-in":"7C5Q","./en-in.js":"7C5Q","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./en-sg":"t+mt","./en-sg.js":"t+mt","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fil":"1ppg","./fil.js":"1ppg","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-deva":"qvJo","./gom-deva.js":"qvJo","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./oc-lnc":"Fnuy","./oc-lnc.js":"Fnuy","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tk":"Wv91","./tk.js":"Wv91","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-mo":"OmwH","./zh-mo.js":"OmwH","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function n(e){var t=r(e);return i(t)}function r(e){if(!i.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}n.keys=function(){return Object.keys(o)},n.resolve=r,e.exports=n,n.id="RnhZ"},U9wj:function(e,t){function i(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id="U9wj"},Vrpm:function(e){e.exports=JSON.parse('{"igo":{"core":{"errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur serveur"}},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}}}}}')},et1m:function(e){e.exports=JSON.parse('{"igo":{"geo":{"catalog":{"layer.addToMap":"Add to map","layer.addToMapOutRange":"Add to map. The layer is not visible at the current scale. Please zoom in/out","layer.removeFromMap":"Remove from map","layer.removeFromMapOutRange":"Remove from map. The layer is not visible at the current scale. Please zoom in/out","group.addToMap":"Add all layers from this group to map","group.removeFromMap":"Remove all layers from this group to map","baseLayers":"Baselayers","unavailableTitle":"Catalog unavailable","unavailable":"The catalog \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions."},"clickOnMap":{"clickedFeature":"Clicked Feature"},"baselayersSwitcher":{"title":"Basemaps"},"dataSource":{"unavailableTitle":"Layer unavailable","optionsApiUnavailable":"Layer information could not be retrieved. Some layers may not present the correct information.","unavailable":"The layer \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions."},"dropGeoFile":{"invalid":{"text":"The file \'{{value}}\' is invalid ({{mimeType}})","title":"Invalid file"},"empty":{"text":"The file \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"success":{"text":"Imported file","title":"The layer \'{{value}}\' was added to the map"},"unreadable":{"text":"Unreadable file","title":"The file \'{{value}}\' is unreadable"},"tooLarge":{"text":"The file \'{{value}}\' is too large (Max: {{size}} MB)","title":"File too large"},"invalidSRS":{"text":"The projection is valid. It must start with EPSG:","title":"Invalid projection"}},"export":{"nothing":{"text":"No feature could be exported.","title":"Nothing to export"},"noFormat":{"text":"No export format valid for all selected layers. Please export the layers one at a time.","title":"No valid format"},"failed":{"text":"Failed to export","title":"Failed to export features"},"popupBlocked":{"text":"</br>Enable the popup in your browser. </br>For Chrome and Edge, on the right into the Address Bar.</br>{{extraMessage}}","selectAgain":"Fix it and re-select an output format.","retry":"Please retry to export","title":"Popup blocked by your browser"},"success":{"text":"Features have been exported.","title":"Features export success"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (comma delimited)","CSVsemicolon":"CSV (semicolon delimited)","URL":"URL"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Export","exportButtonLink":"Open the link","exportButtonLinks":"Open the links","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Layer","exportFileNamePlaceholder":"Filename","encodingPlaceholder":"Encoding","exportTabTitle":"Export","exportFeatureInExtent":"Export only features in map extent","exportNoLayersExportable":"There is no exportable layer in your map","exportSelectedFeature":"Export only selected features","importButton":"Import","importProjPlaceholder":"Coordinate system","importTabTitle":"Import","importClarifications":"Clarifications","importSizeMax":"The file size limit is {{size}} Mb","importFormatAuthorized":"Formats authorized: geojson, kml, gpx, gml, shapefile","importShpZip":"Shapefiles must be zipped.","other":"other","others":"others"},"operators":{"caseSensitive":"Case sensitive","And":"And","Or":"Or","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"between","During":"during (temporal)","PropertyIsNull":"is null","Intersects":"intersects (spatial)","Within":"within (spatial)","Contains":"contains (spatial)","tooltip":{"And":"Logical operator between filters where both conditions must be true","Or":"Logical operator between filters where at least one (1) condition must be true","PropertyIsEqualTo":"Identical (case sensitive)","PropertyIsNotEqualTo":"Different(case sensitive)","PropertyIsLike":"Like Example: *road* Finds any values that have \'road\' in any position. road* Finds any values that begin by \'road\'. wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (case sensitive)","PropertyIsGreaterThan":"Greater than","PropertyIsGreaterThanOrEqualTo":"Greater than or equal to ","PropertyIsLessThan":"Lesser than","PropertyIsLessThanOrEqualTo":"Lesser than or equal to","PropertyIsBetween":"Apply a range check between the lower and upper boundary (values are included)","During":"Apply a range check for time attributes","PropertyIsNull":"Return features where the attribute is null","Intersects":"Return features in geometric intersection with the provided geometry","Within":"Return feature which are completely contained by the provided geometry","Contains":"Return feature completely containing by the provided geometry"}},"sourceFields":{"selectField":"Choose a field"},"filter":{"addFilter":"Add an empty filter to the current list","removeFilter":"Remove the current filter from the filters\'s list","toggleFilterState":"Enable/disable the current filter","refreshFilters":"Update this datasource with the active filter(s). To enable this button, the layer must be visible (or in the defined scale ranges) or you must modify the current filter.","layerFiltered":"This layer is currently filtered","layerFilterable":"This layer is filterable","filterBy":"Filter by","advancedOgcFilters":"Advanced filters","placeholder":"Enter a value","placeholderSnrc":"Ex: 21L14","selectOperator":"Select an operator"},"spatialSelector":{"fixedExtent":"Fixed extent","btnSetExtent":"Define the extent of the spatial filter to the current view","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Hide Layer","lowerLayer":"Bring layer backward","hideSelectedLayers":"Hide selected layers","filterLowerLayer":"The backward movement is always done according to the order of the map!","filterPlaceholder":"Filter the layers list","activateSelectionMode":"Activate multiple selection mode","deactivateSelectionMode":"Deactivate multiple selection mode","tools":"Tools","selectAll":"Select all","deselectAll":"Deselect all","opacity":"Opacity","raiseLayer":"Bring layer forward","filterRaiseLayer":"The forward movement is always done according to the order of the map!","moreOptions":"More options","removeLayer":"Remove this layer from the map","showFeaturesList":"Show features list","showLayer":"Show Layer","showSelectedLayers":"Show selected layers","subsetLayersListKeyword":"Subset the layers\'s list by title or type (wms, wfs,...)","deleteKeyword":"Delete the keyword","subsetLayersListOnlyVisible":"Subset the layers\'s list by visibility","subsetLayersListOnlyInRange":"Subset the layers\'s list by resolution range","sortAlphabetically":"Sort the layers\'s list alphabetically","sortMapOrder":"Sort the layers\'s list based on layer\'s order on the map","resetLayersList":"Remove the current applied filter to layers\'s list","trackFeature":"Track the feature","legend":{"default":"Default","loadingLegendText":"Loading legend","noLegendText":"No legend available for this layer","noLegendScale":"No legend available for this scale","selectStyle":"Select the style of the legend","showAll":"Show all legends (non visible and out of range)","noLayersVisibleWithShowAllButton":"No layer currently visible. Activate the button above to see all the legends.","noLayersVisibleWithShowAllButtonButZoom":"No layer currently visible. If you zoom in the map, some layers will appear OR activate the button above to see all the legends.","noLayersVisible":"No layers currently visible.","noLayersVisibleButZoom":"No layers currently visible. However, if you zoom in the map, some layers will appear."}},"download":{"action":"Download data","title":"Downloading file","start":"Started. Check the download progression in your browser","end":"Completed"},"mapButtons":{"baselayerSwitcher":"Change base layer","geolocate":"Geolocate","offline":"Offline mode","online":"Online mode","zoomIn":"Zoom in ({{zoom}})","zoomOut":"Zoom out ({{zoom}})","resetRotation":"Set map to north","tipRotation":"Hold Alt and SHIFT while dragging on map to rotate the map."},"metadata":{"show":"Show metadata"},"printForm":{"corsErrorMessageBody":"Unable to print due to non-owned access rights","corsErrorMessageHeader":"Print","comment":"Comment","doZipFile":"Zip file","outputFormat":"Output format","paperFormat":"Paper format","paperFormats":{"A0":"A0","A1":"A1","A2":"A2","A3":"A3","A4":"A4","A5":"A5","Letter":"Letter","Legal":"Legal"},"imageFormat":"Image format","orientation":"Orientation","landscape":"Landscape","portrait":"Portrait","projection":"Projection","resolution":"Resolution","saveBtn":"Save","scale":"Scale","showLegend":"Show legend","showProjection":"Show projection","showScale":"Show scale","title":"Title"},"directionsForm":{"start":"Start","intermediate":"Intermediate","end":"End","directionsBtn":"Get route","resetDirectionsBtn":"Reset","zoomRoute":"Zoom on route","null":"","directions":"Directions","raiseStop":"Raise stop\'s priority","lowerStop":"Lower stop\'s priority","addStop":"Add a stop","removeStop":"Remove this stop","drivingOptions":"Options","summary":"Direction\'s summary","stopsList":"Stops\'s list","instructions":"Instructions","copy":"Copy directions","geolocate":"Use current localisation as stop","link":"Link","dialog":{"copyMsg":"Directions copied to clipboard","copyMsgLink":"Link for directions copied to clipboard","copyTitle":"Directions"}},"directions":{"uturn":"u-turn","sharp right":"sharp right","right":"right","slight right":"slightly on right","sharp left":"sharp left","left":"left","slight left":"slightly on left","straight":"forward"},"cardinalPoints":{"n":"north","ne":"northeast","e":"east","se":"southeast","s":"south","sw":"southwest","w":"west","nw":"northwest"},"search":{"placeholder":"Search for a localisation or a layer","emptyType.placeholder":"Please choose a search type","feature.title":"Localisation","feature.placeholder":"Search for a place localisation","layer.title":"Layer","layer.placeholder":"Search for a layer","ichercheReverse.name":"Search by coordinates","ilayer":{"name":"Layers","properties":{"abstract":"Abstract","groupTitle":"Group","title":"Title","type":"Type","url":"URL","metadataUrl":"Metadata","name":"Layer name","urlInfo":"URL - WMS/WFS","downloadUrl":"Data download"},"type":{"layer":"Layer","groupLayer":"Group of layers"}},"nominatim":{"type":{"food":"Food","health":"Health","entertainment":"Entertainment","finance":"Finance"},"country":{"all":"The world","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Address","oldAddress":"Old address","district":"District","postalCode":"Postal Code","city":"City","oldCity":"Old city","mrc":"MRC","regadmin":"Administrative Region","road":"Road","place":"Place","sumi":"SUMI mark","km":"Mileage mark","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordinates","coord":"Geographic (longitude, latitude)"},"menu.tooltip":"Search Options","settings":{"title":"Settings"},"pointerSearchSummary":{"title":"Pointer position","tooltip":"Based on every search source, show the summary of the pointer location. Use F2 to activate/desactivate."},"searchSources":{"selectAll":"Select All","unselectAll":"Unselect All","settings":{"results type":"Results type","ecmax":"Maximum deviation","radius":"Search radius","results limit":"Number of results","multiple object":"Multiple object","restrictExtent":"Restrict the extent","selectAll":"Select All","unselectAll":"Unselect All","true":"Yes","false":"No"}},"displayMoreResults":"Display more results"},"geometry":{"geometry":"Geometry","point":"Point","line":"Line","polygon":"Polygon"},"targetHtmlUrl":"Open the external link","searchByCoord":"Search by coordinates","searchByName":"Search by name","seeRouting":"See routing","timeFilter":{"date":"Date","endDate":"End Date","startDate":"Start Date","hour":"Hour","minute":"Minute"},"spatialFilter":{"predefined":"Predefined Zone","draw":"Draw","polygon":"Polygon","point":"Circle","drawPolygon":"Draw a polygon","drawCircle":"Draw a circle","searchLabel":"Search by","search":"Search","drawControl":"Activate draw control","listLabel":"Zone","layer":"Layer","goSearch":"Launch research","removeLayer":"Remove results","exportLayer":"Export results","clearForm":"Remove draw","clearSearch":"Reset","Address":"Addresses","Thematics":"Thematics","searchResults":"Search Results","type":"Type","radius":"Radius","radiusAlert":"Radius must be between 0 and 10000","maxSizeAlert":"Search results number exceeds 10000. Some may be missing.","zeroResults":"There are no results for this search.","warning":"Warning","freehandControl":"Freehand","group":{"toponyme":"Toponym","culturel":"Cultural","education":"Education","sante":"Health","securite":"Security","sepaq":"SEPAQ","transport":"Transportation"}},"terrapi":{"AdmRegion":"Administratives region","Mun":"Municipalities","Arrond":"Boroughs","CircFed":"Federals districts","CircProv":"Provincials districts","DirReg":"Regionals directorates","MRC":"RCM","RegTour":"Touristics regions","bornes":"Landmarks","hydro":"Hydrography","routes":"Roads","bati":"Buildings","batiment":"Buildings","camping":"Camping","equipement":"Equipment","commun":"Public","geographie":"Natural sites","parc":"Parks","secteur":"Sector","immeubles":"Tenement","sites":"Cultural sites","cpe":"Children\'s education center","public":"Public schools","prive":"Private school","gouvernemental":"Government schools","colleges":"Colleges","universites":"University","aine":"Residences for seniors","ambulance":"Ambulance zones","clinique":"Clinics","etabl":"Health institutions","gmf":"Family doctors group","naissance":"Birth house","pharmacie":"Pharmacy","casernes":"Fire stations","correctionnel":"Correctional centres","organisme":"Security organization","palais-justice":"Courthouses","penitencier-fed":"Federal penitentiaries","penitencier-prov":"Provincial penitentiaries","polices":"Police station"},"measure":{"dialog":{"title":"Sum of the selection","length.title":"Length","area.title":"Area","lengthInMeters":"Meters","lengthInKilometers":"Kilometers","lengthInMiles":"Miles","lengthInFeet":"Feet","areaInSquareMeters":"Meters\xb2","areaInSquareKilometers":"Kilometers\xb2","areaInSquareMiles":"Miles\xb2","areaInHectares":"Hectares","areaInAcres":"Acres","perimeterInMeters":"Perimeter in meters"},"area":"Area","areaHeader":"Area","length":"Length","lengthHeader":"Length / Perimeter","perimeter":"Perimeter","meters":"Meters","m":"m","kilometers":"Kilometers","km":"km","miles":"Miles","mi":"mi","feet":"Feet","ft":"ft","squareMeters":"Meters\xb2","m\xb2":"m\xb2","squareKilometers":"Kilometers\xb2","km\xb2":"km\xb2","squareMiles":"Miles\xb2","mi\xb2":"mi\xb2","squareFeet":"Feet\xb2","ft\xb2":"ft\xb2","hectares":"Hectares","ha":"ha","acres":"Acres","ac":"ac","toggleActive":"Activate measures","toggleMapTooltips":"Show map tooltips","toggleAutoUnits":"Auto Units","actionbar":{"calculate.tooltip":"Calculate","delete.tooltip":"Delete","modify.tooltip":"Modify"}},"workspace":{"ogcFilter.close":"Close","ogcFilter.title":"Filters","ogcFilter.tooltip":"Apply filters","download.title":"Download","download.tooltip":"Download","inMapExtent.title":"Show records in map extent only","inMapExtent.active.tooltip":"Show records in map extent only","inMapExtent.inactive.tooltip":"Show all records","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Show selected records only","selected.tooltip":"Show selected records only","clearSelection.title":"Deselect all","clearSelection.tooltip":"Deselect all records"},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}}}}}')},gAOA:function(e){e.exports=JSON.parse('{"igo":{"context":{"bookmarkButton":{"create":"Cr\xe9er un contexte","dialog":{"createMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9","createTitle":"Contexte cr\xe9\xe9","placeholder":"Titre","title":"Nouveau contexte"}},"contextManager":{"clone":"Cloner ce contexte","delete":"Supprimer ce contexte","dialog":{"cloneMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 clon\xe9","cloneTitle":"Contexte clon\xe9","copyMsg":"Texte copi\xe9","copyTitle":"Identifiant du contexte","confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer ce contexte ?","deleteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 supprim\xe9","deleteTitle":"Contexte supprim\xe9","favoriteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 d\xe9fini comme favori","favoriteTitle":"Favori enregistr\xe9","saveMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 enregistr\xe9","saveTitle":"Contexte enregistr\xe9"},"edit":"\xc9diter ce contexte","errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur de serveur"},"addPermission":"La permission que vous tentez d\'ajouter est d\xe9j\xe0 pr\xe9sente dans le contexte.","addPermissionEmpty":"La permission que vous tentez d\'ajouter n\'est pas valide","addPermissionTitle":"Erreur d\'ajout de permission"},"favorite":"D\xe9finir comme context favori","form":{"copy":"Copier l\'identifiant du contexte","edit":"Enregistrer","title":"Titre","titleRequired":"Le titre est obligatoire","uri":"Identifiant","uriRequired":"L\'identifiant est obligatoire"},"invalid":{"text":"Le contexte \\"{{value}}\\" est invalide. Le contexte par d\xe9faut a \xe9t\xe9 charg\xe9.","title":"Contexte invalide"},"managePermissions":"G\xe9rer les permissions du contexte","manageTools":"G\xe9rer les outils du contexte","ourContexts":"Mes contextes","publicContexts":"Contextes publics","save":"Sauvegarder ce contexte","sharedContexts":"Contextes partag\xe9s","filterPlaceHolder":"Filtrer par nom","sortAlphabetically":"Trier en ordre alphab\xe9tique","sortContextOrder":"Replacer selon la date de cr\xe9ation","userAccount":"Profils utilisateurs","filterUser":"Filtrer par groupe d\'utilisateur","emptyContext":"Contexte vide","emptyContextTooltip":"Cr\xe9er un nouveau contexte vide","contextMap":"Contexte \xe0 partir de la carte","contextMapTooltip":"Cr\xe9er un nouveau contexte \xe0 partir des couches la carte","hide":"Masquer ce contexte","show":"Montrer ce contexte","showHidden":"Montrer les contextes masqu\xe9s"},"contextImportExport":{"export":{"exportPlaceHolder":"Couches","exportContextName":"Nom du contexte","exportSelectAll":"Tout s\xe9lectionner","success":{"text":"Contexte export\xe9 avec succ\xe8s.","title":"Exportation r\xe9ussie"},"nothing":{"text":"Impossible d\u2019exporter, contexte non valide ou aucun contexte s\xe9lectionn\xe9.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de contexte rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"}},"import":{"success":{"title":"Contexte import\xe9","text":"Le context \'{{value}}\' a \xe9t\xe9 ajout\xe9 \xe0 la carte"},"empty":{"text":"Le context \'{{value}}\' est vide, impossible d\'importer","title":"Contexte vide"},"invalid":{"text":"Le context \'{{value}}\' est invalide.","title":"Context invalide"},"unreadable":{"text":"Le context \'{{value}}\' est impossible \xe0 lire","title":"Context illisible"},"tooLarge":{"text":"Le context \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Context trop volumineux"}}},"permission":{"addBtn":"Ajouter","delete":"Retirer la permission","dialog":{"addMsg":"La permission \'{{value}}\' a \xe9t\xe9 ajout\xe9e","addTitle":"Permission ajout\xe9e","deleteMsg":"La permission \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Permission retir\xe9e","scopeChangedMsg":"La port\xe9e du contexte a \xe9t\xe9 chang\xe9e pour {{value}}","scopeChangedTitle":"Changement de la port\xe9e"},"profil":"Profil","user":"Utilisateur ou groupe","profilRequired":"Le profil est obligatoire","read":"Lecture seule","readOnlyTitle":"Contexte en lecture seule","readOnlyMsg":"Vous pouvez seulement retirer la permission si le contexte est directement partag\xe9 \xe0 votre nom d\'utilisateur.","scope":{"private":"Priv\xe9","protected":"Prot\xe9g\xe9","shared":"Partag\xe9","public":"Public"},"write":"Lecture et \xe9criture"},"poiButton":{"create":"Cr\xe9er une zone d\'int\xe9r\xeat","dialog":{"confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer cette zone d\'int\xe9r\xeat ?","createMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9e","createTitle":"Zone d\'int\xe9r\xeat cr\xe9\xe9e","deleteMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Zone d\'int\xe9r\xeat supprim\xe9e","placeholder":"Titre","title":"Nouvelle zone d\'int\xe9r\xeat"},"placeholder":"Zones d\'int\xe9r\xeat"},"sidenav":{"goBack":"Revenir","mainMenu":"Revenir au menu principal"},"shareMap":{"button":"Partager la carte","copy":"Copier le lien","dialog":{"copyMsg":"Lien copi\xe9","copyTitle":"Lien"},"placeholderLink":"Lien","included":"Inclus dans le lien de partage :","context":"Le contexte ouvert lors de la cr\xe9ation du lien de partage.","center":"Les coordonn\xe9es du centre de la carte (longitude, latitude).","zoom":"Le niveau de zoom de la carte.","addedLayers":"Les couches ajout\xe9es via le catalogue ou via la barre de recherche.","visibleInvisible":"Le statut de visibilit\xe9 des couches.","excluded":"Exclus dans le lien de partage :","order":"L\'ordre des couches.","opacity":"Les modifications effectu\xe9es \xe0 l\'opacit\xe9 des couches.","filterOgc":"Les ajouts/modifications faits aux filtres par attribut.","filterTime":"La valeur en cours pour les filtres temporels."},"tool":{"dialog":{"addMsg":"L\'outil a \xe9t\xe9 ajout\xe9","addTitle":"Outil ajout\xe9","deleteMsg":"L\'outil a \xe9t\xe9 supprim\xe9","deleteTitle":"Outil retir\xe9"}},"userButton":{"dialog":{"email":"Courriel","expiration":"Expiration","user":"Utilisateur"},"infoTitle":"Info sur l\'utilisateur","logout":"Se d\xe9connecter"}}}}')},"kE/h":function(e){e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Access as anonymous","connection":"Connection","login":"Login","password":"Password","signOut":"Sign out","user":"User","welcome":"Welcome {{name}}!","deconnection":"You are logged out.","home":"Return to the home page","error":{"Password expired":"Password expired","Maximun logins exceeded":"Maximum logins exceeded","Login lockout":"Maximum number of attempts exceeded. Your account is locked.","Wrong password":"Wrong password","Invalid username":"Invalid username"},"microsoft":{"login":"Sign in with Microsoft"}},"common":{"confirmDialog":{"cancelBtn":"Cancel","confirmBtn":"Confirm","title":"Confirm"},"table":{"filter":"Filter"},"form":{"errors":{"required":"This field is required"}},"actionbar":{"scrollUp":"Scroll up","scrollDown":"Scroll down"},"interactiveTour":{"tooltipTourToolButton":"Interactive tour of the application","disaledTooltipTourToolButton":"To have access to this tool\'s tour, add contexts or layers","buttonTitle":"Discover","exitButton":"Exit","backButton":"Back","nextButton":"Next"},"paginator":{"firstPageLabel":"First page","itemsPerPageLabel":"Items per page:","lastPageLabel":"Last page","nextPageLabel":"Next page","previousPageLabel":"Previous page","of":"of"}},"context":{"bookmarkButton":{"create":"Create a new context","dialog":{"createMsg":"The context \'{{value}}\' was created","createTitle":"Context created","placeholder":"Title","title":"New context"}},"contextManager":{"clone":"Clone this context","delete":"Delete this context","dialog":{"cloneMsg":"The context \'{{value}}\' was cloned","cloneTitle":"Context cloned","copyMsg":"Text copied","copyTitle":"Context ID","confirmDelete":"Are you sure you want to delete this context?","deleteMsg":"The context \'{{value}}\' was deleted","deleteTitle":"Context deleted","favoriteMsg":"The context \'{{value}}\' was set as favorite","favoriteTitle":"Favorite saved","saveMsg":"The context \'{{value}}\' was saved","saveTitle":"Context saved"},"edit":"Edit this context","errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"},"addPermission":"The permission you are trying to add is already in the context.","addPermissionEmpty":"The permission you are trying to add is not valid","addPermissionTitle":"Add permission error"},"favorite":"Set as favorite context","form":{"copy":"Copy the context ID","edit":"Save","title":"Title","titleRequired":"Title required","uri":"ID","uriRequired":"ID required"},"invalid":{"text":"Context \'{{value}}\' is invalid. The default context was loaded.","title":"Invalid context"},"managePermissions":"Manage permissions context","manageTools":"Manage tools context","ourContexts":"Our contexts","publicContexts":"Public contexts","save":"Save this context","sharedContexts":"Shared contexts","filterPlaceHolder":"Filter by name","sortAlphabetically":"Sort alphabetically","sortContextOrder":"Replace according to the creation date","userAccount":"User account","filterUser":"Filter by user group","emptyContext":"Empty context","emptyContextTooltip":"Create a new empty context","contextMap":"Context from map","contextMapTooltip":"Create a new context from map layers","hide":"Hide this context","show":"Show up this context","showHidden":"Show hidden contexts"},"contextImportExport":{"export":{"exportPlaceHolder":"Layers","exportContextName":"Context name","exportSelectAll":"Select all","success":{"text":"Context has been exported.","title":"Context export success"},"nothing":{"text":"No context could be exported.","title":"Nothing to export"},"failed":{"text":"Failed to export","title":"Failed to export context"}},"import":{"success":{"title":"Imported context","text":"The context \'{{value}}\' was added to the map"},"empty":{"text":"The context \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"invalid":{"text":"The context \'{{value}}\' is invalid.","title":"Invalid context"},"unreadable":{"title":"Unreadable context","text":"The context \'{{value}}\' is unreadable"},"tooLarge":{"text":"The context \'{{value}}\' is too large (Max: {{size}} MB)","title":"Context too large"}}},"permission":{"addBtn":"Add","delete":"Remove permission","dialog":{"addMsg":"The permission \'{{value}}\' was added","addTitle":"Permission added","deleteMsg":"The permission \'{{value}}\' was removed","deleteTitle":"Permission removed","scopeChangedMsg":"The scope was changed to {{value}}","scopeChangedTitle":"Scope changed"},"profil":"Profil","user":"User or group","profilRequired":"Profil required","read":"Read only","readOnlyTitle":"Read-only context","readOnlyMsg":"You can only revoke permission if the context is shared directly to your username.","scope":{"private":"Private","protected":"Protected","shared":"Shared","public":"Public"},"write":"Read and Write"},"poiButton":{"create":"Create a new zone of interest","dialog":{"confirmDelete":"Are you sure you want to delete this zone of interest?","createMsg":"The zone of interest \'{{value}}\' was created","createTitle":"Zone of interest created","deleteMsg":"The zone of interest \'{{value}}\' was deleted","deleteTitle":"Zone of interest deleted","placeholder":"Title","title":"New zone of interest"},"placeholder":"Zones of interest"},"sidenav":{"goBack":"Go Back","mainMenu":"Main Menu"},"shareMap":{"button":"Share map","copy":"Copy to clipboard","dialog":{"copyMsg":"Link copied to clipboard","copyTitle":"Link"},"placeholderLink":"Link","included":"Included in shared URL :","context":"The context when creating the sharing link.","center":"The coordinates of the center of the map (longitude, latitude).","zoom":"The zoom level of the map.","addedLayers":"The layers added by the catalog or by the search bar.","visibleInvisible":"Visibility status of layers.","excluded":"Excluded in the shared URL :","order":"The order of the layers.","opacity":"Modifications made to the opacity of the layers.","filterOgc":"Additions / modifications made to filters by attribute.","filterTime":"The current value for time filters."},"tool":{"dialog":{"addMsg":"The tool \'{{value}}\' was added","addTitle":"Tool added","deleteMsg":"The tool \'{{value}}\' was removed","deleteTitle":"Tool removed"}},"userButton":{"dialog":{"email":"Email","expiration":"Expiration","user":"User"},"infoTitle":"User info","logout":"Logout"}},"core":{"errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"}},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}}},"geo":{"catalog":{"layer.addToMap":"Add to map","layer.addToMapOutRange":"Add to map. The layer is not visible at the current scale. Please zoom in/out","layer.removeFromMap":"Remove from map","layer.removeFromMapOutRange":"Remove from map. The layer is not visible at the current scale. Please zoom in/out","group.addToMap":"Add all layers from this group to map","group.removeFromMap":"Remove all layers from this group to map","baseLayers":"Baselayers","unavailableTitle":"Catalog unavailable","unavailable":"The catalog \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions."},"clickOnMap":{"clickedFeature":"Clicked Feature"},"baselayersSwitcher":{"title":"Basemaps"},"dataSource":{"unavailableTitle":"Layer unavailable","optionsApiUnavailable":"Layer information could not be retrieved. Some layers may not present the correct information.","unavailable":"The layer \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions."},"dropGeoFile":{"invalid":{"text":"The file \'{{value}}\' is invalid ({{mimeType}})","title":"Invalid file"},"empty":{"text":"The file \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"success":{"text":"Imported file","title":"The layer \'{{value}}\' was added to the map"},"unreadable":{"text":"Unreadable file","title":"The file \'{{value}}\' is unreadable"},"tooLarge":{"text":"The file \'{{value}}\' is too large (Max: {{size}} MB)","title":"File too large"},"invalidSRS":{"text":"The projection is valid. It must start with EPSG:","title":"Invalid projection"}},"export":{"nothing":{"text":"No feature could be exported.","title":"Nothing to export"},"noFormat":{"text":"No export format valid for all selected layers. Please export the layers one at a time.","title":"No valid format"},"failed":{"text":"Failed to export","title":"Failed to export features"},"popupBlocked":{"text":"</br>Enable the popup in your browser. </br>For Chrome and Edge, on the right into the Address Bar.</br>{{extraMessage}}","selectAgain":"Fix it and re-select an output format.","retry":"Please retry to export","title":"Popup blocked by your browser"},"success":{"text":"Features have been exported.","title":"Features export success"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (comma delimited)","CSVsemicolon":"CSV (semicolon delimited)","URL":"URL"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Export","exportButtonLink":"Open the link","exportButtonLinks":"Open the links","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Layer","exportFileNamePlaceholder":"Filename","encodingPlaceholder":"Encoding","exportTabTitle":"Export","exportFeatureInExtent":"Export only features in map extent","exportNoLayersExportable":"There is no exportable layer in your map","exportSelectedFeature":"Export only selected features","importButton":"Import","importProjPlaceholder":"Coordinate system","importTabTitle":"Import","importClarifications":"Clarifications","importSizeMax":"The file size limit is {{size}} Mb","importFormatAuthorized":"Formats authorized: geojson, kml, gpx, gml, shapefile","importShpZip":"Shapefiles must be zipped.","other":"other","others":"others"},"operators":{"caseSensitive":"Case sensitive","And":"And","Or":"Or","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"between","During":"during (temporal)","PropertyIsNull":"is null","Intersects":"intersects (spatial)","Within":"within (spatial)","Contains":"contains (spatial)","tooltip":{"And":"Logical operator between filters where both conditions must be true","Or":"Logical operator between filters where at least one (1) condition must be true","PropertyIsEqualTo":"Identical (case sensitive)","PropertyIsNotEqualTo":"Different(case sensitive)","PropertyIsLike":"Like Example: *road* Finds any values that have \'road\' in any position. road* Finds any values that begin by \'road\'. wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (case sensitive)","PropertyIsGreaterThan":"Greater than","PropertyIsGreaterThanOrEqualTo":"Greater than or equal to ","PropertyIsLessThan":"Lesser than","PropertyIsLessThanOrEqualTo":"Lesser than or equal to","PropertyIsBetween":"Apply a range check between the lower and upper boundary (values are included)","During":"Apply a range check for time attributes","PropertyIsNull":"Return features where the attribute is null","Intersects":"Return features in geometric intersection with the provided geometry","Within":"Return feature which are completely contained by the provided geometry","Contains":"Return feature completely containing by the provided geometry"}},"sourceFields":{"selectField":"Choose a field"},"filter":{"addFilter":"Add an empty filter to the current list","removeFilter":"Remove the current filter from the filters\'s list","toggleFilterState":"Enable/disable the current filter","refreshFilters":"Update this datasource with the active filter(s). To enable this button, the layer must be visible (or in the defined scale ranges) or you must modify the current filter.","layerFiltered":"This layer is currently filtered","layerFilterable":"This layer is filterable","filterBy":"Filter by","advancedOgcFilters":"Advanced filters","placeholder":"Enter a value","placeholderSnrc":"Ex: 21L14","selectOperator":"Select an operator"},"spatialSelector":{"fixedExtent":"Fixed extent","btnSetExtent":"Define the extent of the spatial filter to the current view","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Hide Layer","lowerLayer":"Bring layer backward","hideSelectedLayers":"Hide selected layers","filterLowerLayer":"The backward movement is always done according to the order of the map!","filterPlaceholder":"Filter the layers list","activateSelectionMode":"Activate multiple selection mode","deactivateSelectionMode":"Deactivate multiple selection mode","tools":"Tools","selectAll":"Select all","deselectAll":"Deselect all","opacity":"Opacity","raiseLayer":"Bring layer forward","filterRaiseLayer":"The forward movement is always done according to the order of the map!","moreOptions":"More options","removeLayer":"Remove this layer from the map","showFeaturesList":"Show features list","showLayer":"Show Layer","showSelectedLayers":"Show selected layers","subsetLayersListKeyword":"Subset the layers\'s list by title or type (wms, wfs,...)","deleteKeyword":"Delete the keyword","subsetLayersListOnlyVisible":"Subset the layers\'s list by visibility","subsetLayersListOnlyInRange":"Subset the layers\'s list by resolution range","sortAlphabetically":"Sort the layers\'s list alphabetically","sortMapOrder":"Sort the layers\'s list based on layer\'s order on the map","resetLayersList":"Remove the current applied filter to layers\'s list","trackFeature":"Track the feature","legend":{"default":"Default","loadingLegendText":"Loading legend","noLegendText":"No legend available for this layer","noLegendScale":"No legend available for this scale","selectStyle":"Select the style of the legend","showAll":"Show all legends (non visible and out of range)","noLayersVisibleWithShowAllButton":"No layer currently visible. Activate the button above to see all the legends.","noLayersVisibleWithShowAllButtonButZoom":"No layer currently visible. If you zoom in the map, some layers will appear OR activate the button above to see all the legends.","noLayersVisible":"No layers currently visible.","noLayersVisibleButZoom":"No layers currently visible. However, if you zoom in the map, some layers will appear."}},"download":{"action":"Download data","title":"Downloading file","start":"Started. Check the download progression in your browser","end":"Completed"},"mapButtons":{"baselayerSwitcher":"Change base layer","geolocate":"Geolocate","offline":"Offline mode","online":"Online mode","zoomIn":"Zoom in ({{zoom}})","zoomOut":"Zoom out ({{zoom}})","resetRotation":"Set map to north","tipRotation":"Hold Alt and SHIFT while dragging on map to rotate the map."},"metadata":{"show":"Show metadata"},"printForm":{"corsErrorMessageBody":"Unable to print due to non-owned access rights","corsErrorMessageHeader":"Print","comment":"Comment","doZipFile":"Zip file","outputFormat":"Output format","paperFormat":"Paper format","paperFormats":{"A0":"A0","A1":"A1","A2":"A2","A3":"A3","A4":"A4","A5":"A5","Letter":"Letter","Legal":"Legal"},"imageFormat":"Image format","orientation":"Orientation","landscape":"Landscape","portrait":"Portrait","projection":"Projection","resolution":"Resolution","saveBtn":"Save","scale":"Scale","showLegend":"Show legend","showProjection":"Show projection","showScale":"Show scale","title":"Title"},"directionsForm":{"start":"Start","intermediate":"Intermediate","end":"End","directionsBtn":"Get route","resetDirectionsBtn":"Reset","zoomRoute":"Zoom on route","null":"","directions":"Directions","raiseStop":"Raise stop\'s priority","lowerStop":"Lower stop\'s priority","addStop":"Add a stop","removeStop":"Remove this stop","drivingOptions":"Options","summary":"Direction\'s summary","stopsList":"Stops\'s list","instructions":"Instructions","copy":"Copy directions","geolocate":"Use current localisation as stop","link":"Link","dialog":{"copyMsg":"Directions copied to clipboard","copyMsgLink":"Link for directions copied to clipboard","copyTitle":"Directions"}},"directions":{"uturn":"u-turn","sharp right":"sharp right","right":"right","slight right":"slightly on right","sharp left":"sharp left","left":"left","slight left":"slightly on left","straight":"forward"},"cardinalPoints":{"n":"north","ne":"northeast","e":"east","se":"southeast","s":"south","sw":"southwest","w":"west","nw":"northwest"},"search":{"placeholder":"Search for a localisation or a layer","emptyType.placeholder":"Please choose a search type","feature.title":"Localisation","feature.placeholder":"Search for a place localisation","layer.title":"Layer","layer.placeholder":"Search for a layer","ichercheReverse.name":"Search by coordinates","ilayer":{"name":"Layers","properties":{"abstract":"Abstract","groupTitle":"Group","title":"Title","type":"Type","url":"URL","metadataUrl":"Metadata","name":"Layer name","urlInfo":"URL - WMS/WFS","downloadUrl":"Data download"},"type":{"layer":"Layer","groupLayer":"Group of layers"}},"nominatim":{"type":{"food":"Food","health":"Health","entertainment":"Entertainment","finance":"Finance"},"country":{"all":"The world","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Address","oldAddress":"Old address","district":"District","postalCode":"Postal Code","city":"City","oldCity":"Old city","mrc":"MRC","regadmin":"Administrative Region","road":"Road","place":"Place","sumi":"SUMI mark","km":"Mileage mark","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordinates","coord":"Geographic (longitude, latitude)"},"menu.tooltip":"Search Options","settings":{"title":"Settings"},"pointerSearchSummary":{"title":"Pointer position","tooltip":"Based on every search source, show the summary of the pointer location. Use F2 to activate/desactivate."},"searchSources":{"selectAll":"Select All","unselectAll":"Unselect All","settings":{"results type":"Results type","ecmax":"Maximum deviation","radius":"Search radius","results limit":"Number of results","multiple object":"Multiple object","restrictExtent":"Restrict the extent","selectAll":"Select All","unselectAll":"Unselect All","true":"Yes","false":"No"}},"displayMoreResults":"Display more results"},"geometry":{"geometry":"Geometry","point":"Point","line":"Line","polygon":"Polygon"},"targetHtmlUrl":"Open the external link","searchByCoord":"Search by coordinates","searchByName":"Search by name","seeRouting":"See routing","timeFilter":{"date":"Date","endDate":"End Date","startDate":"Start Date","hour":"Hour","minute":"Minute"},"spatialFilter":{"predefined":"Predefined Zone","draw":"Draw","polygon":"Polygon","point":"Circle","drawPolygon":"Draw a polygon","drawCircle":"Draw a circle","searchLabel":"Search by","search":"Search","drawControl":"Activate draw control","listLabel":"Zone","layer":"Layer","goSearch":"Launch research","removeLayer":"Remove results","exportLayer":"Export results","clearForm":"Remove draw","clearSearch":"Reset","Address":"Addresses","Thematics":"Thematics","searchResults":"Search Results","type":"Type","radius":"Radius","radiusAlert":"Radius must be between 0 and 10000","maxSizeAlert":"Search results number exceeds 10000. Some may be missing.","zeroResults":"There are no results for this search.","warning":"Warning","freehandControl":"Freehand","group":{"toponyme":"Toponym","culturel":"Cultural","education":"Education","sante":"Health","securite":"Security","sepaq":"SEPAQ","transport":"Transportation"}},"terrapi":{"AdmRegion":"Administratives region","Mun":"Municipalities","Arrond":"Boroughs","CircFed":"Federals districts","CircProv":"Provincials districts","DirReg":"Regionals directorates","MRC":"RCM","RegTour":"Touristics regions","bornes":"Landmarks","hydro":"Hydrography","routes":"Roads","bati":"Buildings","batiment":"Buildings","camping":"Camping","equipement":"Equipment","commun":"Public","geographie":"Natural sites","parc":"Parks","secteur":"Sector","immeubles":"Tenement","sites":"Cultural sites","cpe":"Children\'s education center","public":"Public schools","prive":"Private school","gouvernemental":"Government schools","colleges":"Colleges","universites":"University","aine":"Residences for seniors","ambulance":"Ambulance zones","clinique":"Clinics","etabl":"Health institutions","gmf":"Family doctors group","naissance":"Birth house","pharmacie":"Pharmacy","casernes":"Fire stations","correctionnel":"Correctional centres","organisme":"Security organization","palais-justice":"Courthouses","penitencier-fed":"Federal penitentiaries","penitencier-prov":"Provincial penitentiaries","polices":"Police station"},"measure":{"dialog":{"title":"Sum of the selection","length.title":"Length","area.title":"Area","lengthInMeters":"Meters","lengthInKilometers":"Kilometers","lengthInMiles":"Miles","lengthInFeet":"Feet","areaInSquareMeters":"Meters\xb2","areaInSquareKilometers":"Kilometers\xb2","areaInSquareMiles":"Miles\xb2","areaInHectares":"Hectares","areaInAcres":"Acres","perimeterInMeters":"Perimeter in meters"},"area":"Area","areaHeader":"Area","length":"Length","lengthHeader":"Length / Perimeter","perimeter":"Perimeter","meters":"Meters","m":"m","kilometers":"Kilometers","km":"km","miles":"Miles","mi":"mi","feet":"Feet","ft":"ft","squareMeters":"Meters\xb2","m\xb2":"m\xb2","squareKilometers":"Kilometers\xb2","km\xb2":"km\xb2","squareMiles":"Miles\xb2","mi\xb2":"mi\xb2","squareFeet":"Feet\xb2","ft\xb2":"ft\xb2","hectares":"Hectares","ha":"ha","acres":"Acres","ac":"ac","toggleActive":"Activate measures","toggleMapTooltips":"Show map tooltips","toggleAutoUnits":"Auto Units","actionbar":{"calculate.tooltip":"Calculate","delete.tooltip":"Delete","modify.tooltip":"Modify"}},"workspace":{"ogcFilter.close":"Close","ogcFilter.title":"Filters","ogcFilter.tooltip":"Apply filters","download.title":"Download","download.tooltip":"Download","inMapExtent.title":"Show records in map extent only","inMapExtent.active.tooltip":"Show records in map extent only","inMapExtent.inactive.tooltip":"Show all records","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Show selected records only","selected.tooltip":"Show selected records only","clearSelection.title":"Deselect all","clearSelection.tooltip":"Deselect all records"},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}}},"integration":{"tools":{"catalog":"Catalog","contexts":"Contexts","directions":"Directions","importExport":"Import & export","ogcFilter":"Filter by","map":"Map","layers":"Layers","legend":"Legend","measurer":"Measure","print":"Print","searchResults":"Search Results","shareMap":"Share","timeFilter":"Time Filter","about":"About","spatialFilter":"Spatial Filter"},"searchResultsTool":{"noResults":"No results","doSearch":"Do a search in the search bar.","examples":"You can use keywords to refine your search. Examples: <ul><li>#mun qu\xe9bec</li><li>#sante L\xe9vis</li><li>#cpe joyeux</li></ul>"},"about.html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Features overview</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Search Results </div><div class=\'describe\'>Located in the upper left portion of the interface, the search bar allows you to locate yourself using an address, location or GPS coordinates. The tool can also be used to search for a layer. </div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contexts </div><div class=\'describe\'> Visualize groupings of layers made by theme or by work context. When you select a <span class=\'bold_class\'>Context</span>, you will find in <span class=\'bold_class\'>Map</span> each of the layers it contains. You can add other layers to it from the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search</span> tool. <br><div class=\'red\'> <span class=\'bold_class\'>WARNING :</span> If you select another <span class=\'bold_class\'>Context</span>, all the layers displayed in the <span class=\'bold_class\'>Map</span> will be replaced. </div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Map </div><div class=\'describe\'>Personalize your map using the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search</span> tool. This space allows you to add, delete and interrogate layers.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Measure </div><div class=\'describe\'>Measure distances or areas on the map.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Directions </div><div class=\'describe\'> Build a route between two points (by placing the two points on the map or by looking for addresses). You can then add intermediate points, copy the description of the route to the clipboard or share the link.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalog </div><div class=\'describe\'> Find all the layers that can be added to the <span class=\'bold_class\'>Map</span>. Click on the desired layer to add it. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Import & export </div><div class=\'describe\'> Import or export a layer with a specific projection. You can also save or reload a context. It allows you to save contexts as anonymous. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Print </div><div class=\'describe\'>Print the map displayed on the screen. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Share </div><div class=\'describe\'> Create a URL that redirects to an exact representation of your map on the screen. This link can be shared or distributed in a document and allows you to \\"save\\" your map for later use. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> is a free web solution in geomatics, developed in collaborative mode by specialists from several departments and agencies of the government of Quebec. <p> Version :{{version.lib}}</p></div>","mapTool":{"empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","noLayersVisible":"There is no visible layers.","noLayersInRange":"There is no visible layers at the current scale. Please zoom in or out to discover theses layers."},"importExportTool":{"importExportData":"Layer","importExportContext":"Context"},"workspace":{"toggleWorkspace":"Open/Close the table view"}}}}')},rFtL:function(e){e.exports=JSON.parse("{\"igo\":{\"integration\":{\"tools\":{\"catalog\":\"Catalog\",\"contexts\":\"Contexts\",\"directions\":\"Directions\",\"importExport\":\"Import & export\",\"ogcFilter\":\"Filter by\",\"map\":\"Map\",\"layers\":\"Layers\",\"legend\":\"Legend\",\"measurer\":\"Measure\",\"print\":\"Print\",\"searchResults\":\"Search Results\",\"shareMap\":\"Share\",\"timeFilter\":\"Time Filter\",\"about\":\"About\",\"spatialFilter\":\"Spatial Filter\"},\"searchResultsTool\":{\"noResults\":\"No results\",\"doSearch\":\"Do a search in the search bar.\",\"examples\":\"You can use keywords to refine your search. Examples: <ul><li>#mun qu\xe9bec</li><li>#sante L\xe9vis</li><li>#cpe joyeux</li></ul>\"},\"about.html\":\"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id='about'> <div class='bold_class subtitle'>Features overview</div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z'> </path> </svg></mat-icon> Search Results </div><div class='describe'>Located in the upper left portion of the interface, the search bar allows you to locate yourself using an address, location or GPS coordinates. The tool can also be used to search for a layer. </div></div><br><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z'></path> </svg></mat-icon> Contexts </div><div class='describe'> Visualize groupings of layers made by theme or by work context. When you select a <span class='bold_class'>Context</span>, you will find in <span class='bold_class'>Map</span> each of the layers it contains. You can add other layers to it from the <span class='bold_class'>Catalog</span> or the <span class='bold_class'>Search</span> tool. <br><div class='red'> <span class='bold_class'>WARNING :</span> If you select another <span class='bold_class'>Context</span>, all the layers displayed in the <span class='bold_class'>Map</span> will be replaced. </div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z'> </path> </svg></mat-icon> Map </div><div class='describe'>Personalize your map using the <span class='bold_class'>Catalog</span> or the <span class='bold_class'>Search</span> tool. This space allows you to add, delete and interrogate layers.</div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z'> </path> </svg></mat-icon> Measure </div><div class='describe'>Measure distances or areas on the map.</div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z'> </path> </svg></mat-icon> Directions </div><div class='describe'> Build a route between two points (by placing the two points on the map or by looking for addresses). You can then add intermediate points, copy the description of the route to the clipboard or share the link.</div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z'></path> </svg></mat-icon> Catalog </div><div class='describe'> Find all the layers that can be added to the <span class='bold_class'>Map</span>. Click on the desired layer to add it. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z'></path> </svg></mat-icon> Import & export </div><div class='describe'> Import or export a layer with a specific projection. You can also save or reload a context. It allows you to save contexts as anonymous. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z'></path> </svg></mat-icon> Print </div><div class='describe'>Print the map displayed on the screen. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z'> </path> </svg></mat-icon> Share </div><div class='describe'> Create a URL that redirects to an exact representation of your map on the screen. This link can be shared or distributed in a document and allows you to \\\"save\\\" your map for later use. </div><br></div><div class='tool_name'> <p> <a href='http://igouverte.org/' target='_blank'><img src='./assets/igo2/core/logo.png' alt='IGO' height=32>IGO2</a> is a free web solution in geomatics, developed in collaborative mode by specialists from several departments and agencies of the government of Quebec. <p> Version :{{version.lib}}</p></div>\",\"mapTool\":{\"empty\":\"No layer is currently active on this map. \",\"customize\":\"Customize it by adding layer from the : \",\"search-tool\":\"Search tool\",\"catalog-tool\":\"Data catalog\",\"context-tool\":\"Context manager\",\"noLayersVisible\":\"There is no visible layers.\",\"noLayersInRange\":\"There is no visible layers at the current scale. Please zoom in or out to discover theses layers.\"},\"importExportTool\":{\"importExportData\":\"Layer\",\"importExportContext\":\"Context\"},\"workspace\":{\"toggleWorkspace\":\"Open/Close the table view\"}}}}")},rseE:function(e){e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Rester anonyme","connection":"Connexion","login":"Connecter","password":"Mot de passe","signOut":"Se d\xe9connecter","user":"Utilisateur","welcome":"Bienvenue {{name}}!","deconnection":"Vous \xeates d\xe9connect\xe9","home":"Retourner \xe0 la page d\'accueil","error":{"Password expired":"Votre mot de passe est expir\xe9","Maximun logins exceeded":"Nombre maximal de connexions d\xe9pass\xe9","Login lockout":"Nombre maximal d\'essai d\xe9pass\xe9. Votre compte est verrouill\xe9.","Wrong password":"Mot de passe incorrect","Invalid username":"Utilisateur invalide"},"google":{"login":"Se connecter avec Google","logged":"Connect\xe9 avec Google"},"microsoft":{"login":"Se connecter avec Microsoft"}}}}')},u54H:function(e){e.exports=JSON.parse('{"igo":{"context":{"bookmarkButton":{"create":"Create a new context","dialog":{"createMsg":"The context \'{{value}}\' was created","createTitle":"Context created","placeholder":"Title","title":"New context"}},"contextManager":{"clone":"Clone this context","delete":"Delete this context","dialog":{"cloneMsg":"The context \'{{value}}\' was cloned","cloneTitle":"Context cloned","copyMsg":"Text copied","copyTitle":"Context ID","confirmDelete":"Are you sure you want to delete this context?","deleteMsg":"The context \'{{value}}\' was deleted","deleteTitle":"Context deleted","favoriteMsg":"The context \'{{value}}\' was set as favorite","favoriteTitle":"Favorite saved","saveMsg":"The context \'{{value}}\' was saved","saveTitle":"Context saved"},"edit":"Edit this context","errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"},"addPermission":"The permission you are trying to add is already in the context.","addPermissionEmpty":"The permission you are trying to add is not valid","addPermissionTitle":"Add permission error"},"favorite":"Set as favorite context","form":{"copy":"Copy the context ID","edit":"Save","title":"Title","titleRequired":"Title required","uri":"ID","uriRequired":"ID required"},"invalid":{"text":"Context \'{{value}}\' is invalid. The default context was loaded.","title":"Invalid context"},"managePermissions":"Manage permissions context","manageTools":"Manage tools context","ourContexts":"Our contexts","publicContexts":"Public contexts","save":"Save this context","sharedContexts":"Shared contexts","filterPlaceHolder":"Filter by name","sortAlphabetically":"Sort alphabetically","sortContextOrder":"Replace according to the creation date","userAccount":"User account","filterUser":"Filter by user group","emptyContext":"Empty context","emptyContextTooltip":"Create a new empty context","contextMap":"Context from map","contextMapTooltip":"Create a new context from map layers","hide":"Hide this context","show":"Show up this context","showHidden":"Show hidden contexts"},"contextImportExport":{"export":{"exportPlaceHolder":"Layers","exportContextName":"Context name","exportSelectAll":"Select all","success":{"text":"Context has been exported.","title":"Context export success"},"nothing":{"text":"No context could be exported.","title":"Nothing to export"},"failed":{"text":"Failed to export","title":"Failed to export context"}},"import":{"success":{"title":"Imported context","text":"The context \'{{value}}\' was added to the map"},"empty":{"text":"The context \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"invalid":{"text":"The context \'{{value}}\' is invalid.","title":"Invalid context"},"unreadable":{"title":"Unreadable context","text":"The context \'{{value}}\' is unreadable"},"tooLarge":{"text":"The context \'{{value}}\' is too large (Max: {{size}} MB)","title":"Context too large"}}},"permission":{"addBtn":"Add","delete":"Remove permission","dialog":{"addMsg":"The permission \'{{value}}\' was added","addTitle":"Permission added","deleteMsg":"The permission \'{{value}}\' was removed","deleteTitle":"Permission removed","scopeChangedMsg":"The scope was changed to {{value}}","scopeChangedTitle":"Scope changed"},"profil":"Profil","user":"User or group","profilRequired":"Profil required","read":"Read only","readOnlyTitle":"Read-only context","readOnlyMsg":"You can only revoke permission if the context is shared directly to your username.","scope":{"private":"Private","protected":"Protected","shared":"Shared","public":"Public"},"write":"Read and Write"},"poiButton":{"create":"Create a new zone of interest","dialog":{"confirmDelete":"Are you sure you want to delete this zone of interest?","createMsg":"The zone of interest \'{{value}}\' was created","createTitle":"Zone of interest created","deleteMsg":"The zone of interest \'{{value}}\' was deleted","deleteTitle":"Zone of interest deleted","placeholder":"Title","title":"New zone of interest"},"placeholder":"Zones of interest"},"sidenav":{"goBack":"Go Back","mainMenu":"Main Menu"},"shareMap":{"button":"Share map","copy":"Copy to clipboard","dialog":{"copyMsg":"Link copied to clipboard","copyTitle":"Link"},"placeholderLink":"Link","included":"Included in shared URL :","context":"The context when creating the sharing link.","center":"The coordinates of the center of the map (longitude, latitude).","zoom":"The zoom level of the map.","addedLayers":"The layers added by the catalog or by the search bar.","visibleInvisible":"Visibility status of layers.","excluded":"Excluded in the shared URL :","order":"The order of the layers.","opacity":"Modifications made to the opacity of the layers.","filterOgc":"Additions / modifications made to filters by attribute.","filterTime":"The current value for time filters."},"tool":{"dialog":{"addMsg":"The tool \'{{value}}\' was added","addTitle":"Tool added","deleteMsg":"The tool \'{{value}}\' was removed","deleteTitle":"Tool removed"}},"userButton":{"dialog":{"email":"Email","expiration":"Expiration","user":"User"},"infoTitle":"User info","logout":"Logout"}}}}')},uzb9:function(e,t,i){var o={"./en.auth.json":"I3Mt","./en.common.json":"Gt+p","./en.context.json":"u54H","./en.core.json":"4/ac","./en.geo.json":"et1m","./en.integration.json":"rFtL","./en.json":"kE/h","./fr.auth.json":"rseE","./fr.common.json":"DKST","./fr.context.json":"gAOA","./fr.core.json":"Vrpm","./fr.geo.json":"BSSV","./fr.integration.json":"y2X8","./fr.json":"/2bg"};function n(e){var t=r(e);return i(t)}function r(e){if(!i.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}n.keys=function(){return Object.keys(o)},n.resolve=r,e.exports=n,n.id="uzb9"},y2X8:function(e){e.exports=JSON.parse("{\"igo\":{\"integration\":{\"tools\":{\"catalog\":\"Catalogue\",\"contexts\":\"Contextes\",\"directions\":\"Itin\xe9raire\",\"importExport\":\"Importer et exporter\",\"ogcFilter\":\"Filtrer par\",\"map\":\"Carte\",\"layers\":\"Couches\",\"legend\":\"L\xe9gende\",\"measurer\":\"Mesure\",\"print\":\"Imprimer\",\"searchResults\":\"R\xe9sultats de recherche\",\"shareMap\":\"Partager\",\"timeFilter\":\"Filtre temporel\",\"about\":\"\xc0 propos\",\"spatialFilter\":\"Filtre spatial\"},\"searchResultsTool\":{\"noResults\":\"Aucun r\xe9sultat\",\"doSearch\":\"Veuillez effectuer une recherche dans la barre de recherche ci-dessus.\",\"examples\":\"Vous pouvez utiliser des mots cl\xe9s pour pr\xe9ciser votre recherche. Exemples: <ul><li>#mun qu\xe9bec</li><li>#sante L\xe9vis</li><li>#cpe joyeux</li></ul>\"},\"about.html\":\"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id='about'> <div class='bold_class subtitle'>Aper\xe7u des fonctionnalit\xe9s</div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z'> </path> </svg></mat-icon> Recherche </div><div class='describe'> Situ\xe9e dans la portion sup\xe9rieure gauche de l\u2019interface, la barre de recherche permet de vous positionner \xe0 l\u2019aide d\u2019une adresse, d\u2019un lieu ou de coordonn\xe9es GPS et peut \xe9galement servir \xe0 chercher une couche. Il est aussi possible de rechercher un \xe9l\xe9ment par type de r\xe9sultats en utilisant le hashtag \xab # \xbb (par exemple, #municipalites qu\xe9bec). Les accents et les lettres majuscules n'importent pas lors de l'utilisation du hashtag.</div></div><br><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z'></path> </svg></mat-icon> Contextes </div><div class='describe'> Visualisez des regroupements de couches faits par th\xe8me ou par contexte de travail. Lorsque vous s\xe9lectionnez un <span class='bold_class'>Contexte</span>, vous trouverez dans <span class='bold_class'>Carte</span> chacune des couches qu\u2019il contient. Vous pouvez y ajouter d\u2019autres couches \xe0 partir du <span class='bold_class'>Catalogue</span> ou de l\u2019outil <span class='bold_class'>Recherche.</span> </div><br><div class='red'> <span class='bold_class'>ATTENTION :</span> Si vous s\xe9lectionnez un autre <span class='bold_class'>Contexte</span>, toutes les couches affich\xe9es dans <span class='bold_class'>Carte</span> seront remplac\xe9es. </div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z'> </path> </svg></mat-icon> Carte </div><div class='describe'> Personnalisez votre carte \xe0 partir du <span class='bold_class'>Catalogue</span> ou de l\u2019outil <span class='bold_class'>Recherche.</span> Cet espace permet d\u2019ajouter, de supprimer et d\u2019interroger des couches. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z'> </path> </svg></mat-icon> Outil de mesure </div><div class='describe'> Mesurez des distances ou des superficies sur la carte. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z'> </path> </svg></mat-icon> Itin\xe9raire </div><div class='describe'> Construisez un itin\xe9raire entre deux points (en placant les deux points dans la carte ou en cherchant des adresses). Vous pourrez ensuite ajouter des points interm\xe9diaires, copier la description de l'itin\xe9raire dans le presse papier ou partager le lien. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z'></path> </svg></mat-icon> Catalogue </div><div class='describe'> Trouvez toutes les couches qui peuvent \xeatre ajout\xe9es \xe0 la <span class='bold_class'>Carte.</span> Cliquez sur la couche d\xe9sir\xe9e pour l\u2019ajouter. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z'></path> </svg></mat-icon> Importer/Exporter </div><div class='describe'> Importez ou exportez un fichier vectoriel en sp\xe9cifiant la projection. Vous pouvez aussi sauvegarder ou recharger un contexte localement. Cela vous permet de sauvegarder des contextes en mode non-authentifi\xe9 ou anonyme. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z'></path> </svg></mat-icon> Imprimer </div><div class='describe'> Imprimez la carte affich\xe9e \xe0 l\u2019\xe9cran. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z'> </path> </svg></mat-icon> Partager </div><div class='describe'> Cr\xe9ez une adresse URL qui redirige vers une repr\xe9sentation exacte de votre carte qui se trouve \xe0 l\u2019\xe9cran. Ce lien peut \xeatre partag\xe9 ou diffus\xe9 dans un document et permet de \xab&nbspsauvegarder \xbb votre carte pour une utilisation ult\xe9rieure. </div><br></div><div class='tool_name'> <p> <a href='http://igouverte.org/' target='_blank'><img src='./assets/igo2/core/logo.png' alt='IGO' height=32>IGO2</a> est une solution Web libre en g\xe9omatique, d\xe9velopp\xe9e en mode collaboratif par des sp\xe9cialistes provenant de plusieurs minist\xe8res et organismes du gouvernement du Qu\xe9bec.</p><p>Version :{{version.lib}}</p></div>\",\"mapTool\":{\"empty\":\"La carte ne contient aucune couche de donn\xe9es.\",\"customize\":\"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : \",\"search-tool\":\"Recherche\",\"catalog-tool\":\"Catalogue de donn\xe9es\",\"context-tool\":\"Gestionnaire de contextes\",\"noLayersVisible\":\"Aucune couche visible.\",\"noLayersInRange\":\"Aucune couche visible dans la plage d'\xe9chelle active. Veuillez zoomer ou d\xe9zoomer pour d\xe9couvrir ces couches.\"},\"importExportTool\":{\"importExportData\":\"Couche\",\"importExportContext\":\"Contexte\"},\"workspace\":{\"toggleWorkspace\":\"Ouvrir/fermer la vue tabulaire\"}}}}")}},[[0,0,5]]]);
//# sourceMappingURL=main-es5.92939a2e70fc26b6aa9d.js.map